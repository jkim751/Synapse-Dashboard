/* Tailwind base */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import Quill CSS */
@import 'quill/dist/quill.snow.css';

/* ==========================================================================
   React Big Calendar — Cleaned Theme
   Goals:
   1) Preserve your current look & feel
   2) Month view: top-down event stacking
   3) Day view ONLY: width restriction for events
   ========================================================================== */

/* Base calendar container */
.rbc-calendar {
  width: 100%;
  height: 100%;
  border: none;
  font-family: "Inter", sans-serif;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Hide default RBC toolbar (you use a custom one) */
.rbc-toolbar,
.rbc-btn-group:first-child {
  display: none !important;
}

/* Toolbar label (if ever shown) */
.rbc-toolbar-label {
  text-align: right;
  padding: 0 20px;
  font-weight: 600;
  font-size: 18px;
}

/* Your action buttons look */
.rbc-btn-group:last-child {
  font-size: 13px;
}
.rbc-btn-group:last-child button {
  border: none;
  background-color: rgba(252, 113, 24, 0.7); /* fixed to rgba() */
  margin-left: 2px;
  padding: 6px 12px;
  border-radius: 4px;
}
.rbc-toolbar button.rbc-active {
  background-color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  border: 1px solid #d1d5db;
}

/* =========================================
   MONTH VIEW — Top-down stacking (reliable)
   ========================================= */

/* Keep RBC’s default block layout; no flex rewires in month view */
.rbc-month-view {
  flex: 1;
  display: block;
}
.rbc-month-header {
  border-bottom: 2px solid #e0e0e0;
  background-color: #f8fafc;
}
.rbc-month-header .rbc-header {
  padding: 12px 8px;
  font-weight: 600;
  font-size: 14px;
  text-align: center;
  border-right: 1px solid #e0e0e0;
  background-color: #f8fafc;
}

/* Day cell layout: grid ensures date label is row 1, events row 2 */
.rbc-month-view .rbc-date-cell {
  display: grid;
  grid-auto-rows: min-content;
  align-content: start;   /* hug top */
  justify-items: start;   /* left-align content */
  padding: 4px 2px;
  border-right: 1px solid #e0e0e0;
  font-size: 14px;
  font-weight: 500;
  position: relative;
}
.rbc-month-view .rbc-date-cell > a {
  grid-row: 1;
  margin-bottom: 4px;
}

/* Events block flows from top in row 2 */
.rbc-month-view .rbc-date-cell .rbc-events-container,
.rbc-month-view .rbc-date-cell .rbc-row-content,
.rbc-month-view .rbc-date-cell .rbc-row-segment {
  grid-row: 2;
  display: block;
  height: auto;
  min-height: 0;
}

/* Events: compact chips */
.rbc-month-view .rbc-event {
  font-size: 10px;
  padding: 1px 3px;
  margin: 0 1px 1px 0;
  border-radius: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: #fff;
  cursor: pointer;
  min-height: 16px;
  max-height: 16px;
  line-height: 14px;
  display: block;
  position: relative;
  box-sizing: border-box;
}
.rbc-month-view .rbc-event:hover {
  transform: scale(1.02);
  z-index: 10;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
.rbc-month-view .rbc-event-content {
  font-size: 10px;
  line-height: 1.2;
  padding: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Show-more chip */
.rbc-show-more {
  background-color: #f3f4f6;
  color: #374151;
  font-size: 10px;
  padding: 1px 4px;
  border-radius: 2px;
  margin: 1px 0;
  cursor: pointer;
  border: 1px solid #d1d5db;
  display: inline-block;
}
.rbc-show-more:hover {
  background-color: #e5e7eb;
}

/* =========================================
   WEEK & DAY (Time views) — Styling only
   ========================================= */

.rbc-time-view {
  flex: 1;
  display: flex;
  flex-direction: column;
  border-color: #e0e0e0;
}
.rbc-time-header {
  border-bottom: 1px solid #e0e0e0;
  width: 100%;
}
.rbc-time-header-content {
  border-left: 1px solid #e0e0e0;
}
.rbc-time-header-cell {
  border-right: 1px solid #e0e0e0;
  padding: 8px 4px;
  text-align: center;
  font-weight: 600;
  background-color: #f8fafc;
  min-width: 0;
}
.rbc-time-content {
  flex: 1;
  overflow: hidden;
  border-left: 1px solid #e0e0e0;
  display: flex;
}
.rbc-time-gutter.rbc-time-column {
  font-size: 12px;
  min-width: 70px;
  max-width: 70px;
  width: 70px;
  flex-shrink: 0;
  border-right: 1px solid #e0e0e0;
}
.rbc-time-gutter.rbc-time-column .rbc-timeslot-group {
  padding: 4px 6px;
  font-size: 10px;
  width: 100%;
  min-height: 45px;
  border-bottom: 1px solid #f0f0f0;
  text-align: right;
}

.rbc-day-slot {
  font-size: 13px;
  border-left: 1px solid #e0e0e0;
  border-right: 1px solid #e0e0e0;
  min-width: 0;
  flex: 1;
  padding: 0 2px;
  position: relative;
}

.rbc-timeslot-group {
  background-color: #fefefe;
  width: 100%;
  min-height: 50px;
}
.rbc-label {
  font-size: 12px;
  font-weight: 500;
  color: #374151;
}
.rbc-time-slot {
  min-height: 50px;
  border-bottom: 1px solid #f0f0f0;
}
.rbc-time-slot:last-child {
  border-bottom: none;
}

/* Time-view events */
.rbc-day-slot .rbc-event {
  position: absolute;   /* RBC positions these */
  margin: 0;            /* let RBC place them */
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  line-height: 1.2;
  padding: 3px 6px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.rbc-event {
  border: none;
  color: #fff;
  padding: 4px 6px;
  margin: 1px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
  line-height: 1.3;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.rbc-event:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}
.rbc-event-label {
  color: rgba(255, 255, 255, 0.95) !important;
  margin-bottom: 1px;
  font-size: 11px;
  font-weight: 600;
  line-height: 1.2;
}

/* =========================================
   DAY VIEW ONLY — Max width cap for events
   (Uses :has() to detect Day (single day-slot) vs Week)
   ========================================= */

/* Set your desired cap once */
:root { --rbc-day-event-max-width: 92%; }

/* Apply ONLY when the time-content has a single .rbc-day-slot (Day view) */
.rbc-time-view .rbc-time-content:not(:has(.rbc-day-slot + .rbc-day-slot)) .rbc-day-slot .rbc-event {
  max-width: var(--rbc-day-event-max-width);
  box-sizing: border-box;
}

/* Optional: small right gutter for neat edges in Day view */
.rbc-time-view .rbc-time-content:not(:has(.rbc-day-slot + .rbc-day-slot)) .rbc-day-slot {
  padding-right: 6px;
}

/* =========================================
   Responsiveness
   ========================================= */
@media (max-width: 768px) {
  .rbc-toolbar-label {
    font-size: 16px;
    padding: 0 10px;
  }
  .rbc-month-view .rbc-event {
    font-size: 9px;
    min-height: 14px;
    max-height: 14px;
  }
  .rbc-date-cell {
    font-size: 12px;
  }
}

/* =========================================
   Small fixes & cleanups
   ========================================= */

/* Fix invalid flex declaration from earlier version */
.rbc-date-cell .rbc-events-container {
  /* if another rule sets flex here, ensure it's valid */
  flex: 0 0 auto;
}

/* Popup (show-more) styles */
.rbc-overlay {
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  border-radius: 8px;
  border: 1px solid #e0e0e0;
}
.rbc-overlay-header {
  background-color: #f8fafc;
  padding: 8px 12px;
  border-bottom: 1px solid #e0e0e0;
  font-weight: 600;
}

/* =========================
   1) NO OVERFLOW OUTSIDE
   ========================= */
.rbc-calendar {
  overflow: hidden !important;            /* prevent outer scrollbars */
}
.rbc-time-view {
  overflow: hidden !important;            /* keep header fixed; inner grid scrolls */
}
.rbc-time-content {
  overflow-y: auto !important;            /* only the time grid scrolls */
  overflow-x: hidden !important;
  min-height: 0 !important;               /* allow flex child to shrink */
}

/* =========================
   2) FIX DAYS POSITION (STICKY)
   - Week/Day headers stick to top while grid scrolls
   ========================= */
.rbc-time-header {
  position: sticky !important;
  top: 0 !important;
  z-index: 3;                              /* above events */
  background: #f8fafc !important;          /* your header background */
}

/* make the inner header cells stay on the same sticky layer */
.rbc-time-header-content,
.rbc-time-header-gutter {
  position: sticky !important;
  top: 0 !important;
  z-index: 4;
  background: #f8fafc !important;
}

/* Month view: keep weekday row fixed if the month grid ever scrolls */
.rbc-month-view {
  overflow: hidden !important;
}
.rbc-month-header {
  position: sticky !important;
  top: 0 !important;
  z-index: 2;
  background: #f8fafc !important;
}

/* =========================================
   3) REMOVE THE ROW BELOW THE DAYS (ALL-DAY)
   ========================================= */
/* Hide All-Day header cell and its event row entirely */
.rbc-allday-header,
.rbc-allday-cell,
.rbc-row.rbc-allday-cell,
.rbc-allday-events {
  display: none !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  border: 0 !important;
}

/* Ensure removing all-day row doesn’t leave extra space/borders */
.rbc-time-header {
  border-bottom: 1px solid #e0e0e0 !important;
}
.rbc-time-content > .rbc-time-gutter,
.rbc-time-content > .rbc-day-slot {
  min-height: 100% !important; /* keep columns full height */
}

/* Safety: prevent any nested containers from reintroducing scrollbars */
.rbc-month-view .rbc-row,
.rbc-month-view .rbc-month-row,
.rbc-month-view .rbc-row-content,
.rbc-month-view .rbc-date-cell,
.rbc-overlay {
  overflow: hidden !important;
}

/* If you have popovers (show more), let them escape without creating scrollbars */
.rbc-overlay {
  contain: layout paint !important; /* keeps main grid from scrolling */
}

/* === Fit calendar exactly in its parent === */
.rbc-calendar,
.rbc-time-view,
.rbc-time-content {
  height: 100% !important;
  max-height: 100% !important;
}

.rbc-calendar {
  display: flex !important;
  flex-direction: column !important;
  box-sizing: border-box !important;
  overflow: hidden !important; /* no outer scrollbars */
}

.rbc-time-view {
  flex: 1 1 auto !important;
  min-height: 0 !important;    /* allow shrinking within flex parent */
  overflow: hidden !important; /* header stays fixed */
}

.rbc-time-content {
  flex: 1 1 auto !important;
  min-height: 0 !important;
  overflow-y: auto !important;  /* only the grid scrolls */
  overflow-x: hidden !important;
}

/* Remove borders that add stray pixels */
.rbc-time-header,
.rbc-time-content,
.rbc-time-gutter,
.rbc-day-slot {
  box-sizing: border-box !important;
}

/* === Control hour + slot height with CSS variables === */
/* Tweak these two numbers to make the grid shorter/taller. */
:root {
  --rbc-hour-height: 34px;        /* total height of 1 hour in the time grid */
  --rbc-slots-per-hour: 2;        /* must match your Calendar `timeslots` prop */
}

/* Each hour group (e.g., 9:00–10:00) */
.rbc-timeslot-group {
  min-height: var(--rbc-hour-height) !important;
}

/* Each slot inside the hour (depends on your `timeslots` prop) */
.rbc-time-slot {
  min-height: calc(var(--rbc-hour-height) / var(--rbc-slots-per-hour)) !important;
  border-bottom: 1px solid #f0f0f0 !important;
}
.rbc-time-slot:last-child {
  border-bottom: none !important;
}

/* Slightly tighter gutter so it all fits */
.rbc-time-gutter.rbc-time-column {
  width: 64px !important;
  min-width: 64px !important;
  max-width: 64px !important;
}

/* Keep header fixed while grid scrolls */
.rbc-time-header,
.rbc-time-header-content,
.rbc-time-header-gutter {
  position: sticky !important;
  top: 0 !important;
  z-index: 3;
  background: #f8fafc !important;
}

/* (From earlier) Remove the all-day row entirely (row below day names) */
.rbc-allday-header,
.rbc-allday-cell,
.rbc-allday-events {
  display: none !important;
  height: 0 !important;
  padding: 0 !important;
  margin: 0 !important;
  border: 0 !important;
}

/* Responsive base styles */
* {
  box-sizing: border-box;
}

html {
  -webkit-text-size-adjust: 100%;
  -moz-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

body {
  overflow-x: hidden;
}

/* Responsive containers */
.container {
  width: 100%;
  margin: 0 auto;
  padding: 0 1rem;
}

@media (min-width: 640px) {
  .container {
    max-width: 640px;
    padding: 0 1.5rem;
  }
}

@media (min-width: 768px) {
  .container {
    max-width: 768px;
    padding: 0 2rem;
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: 1024px;
  }
}

@media (min-width: 1280px) {
  .container {
    max-width: 1280px;
  }
}

/* Responsive text sizes */
.text-responsive {
  font-size: clamp(0.875rem, 2.5vw, 1rem);
}

.heading-responsive {
  font-size: clamp(1.5rem, 4vw, 2.5rem);
}

/* Touch-friendly interactive elements */
@media (max-width: 767px) {
  button, .btn, a[role="button"] {
    min-height: 44px;
    min-width: 44px;
  }
}

/* =========================
   DRAG AND DROP STYLES
   ========================= */

/* Make draggable events show move cursor */
.rbc-addons-dnd-draggable {
  cursor: move !important;
}

/* Show grabbing cursor while dragging */
.rbc-addons-dnd-dragging {
  cursor: grabbing !important;
  opacity: 0.7 !important;
}

/* Highlight drop target */
.rbc-addons-dnd-over {
  background-color: rgba(59, 130, 246, 0.1) !important;
}

/* Resize handle visibility */
.rbc-addons-dnd-resizable {
  position: relative;
}

/* Resize handles for events */
.rbc-addons-dnd-resize-ns-anchor,
.rbc-addons-dnd-resize-ew-anchor {
  position: absolute;
  width: 100%;
  height: 10px;
  cursor: ns-resize;
  z-index: 10;
}

.rbc-addons-dnd-resize-ns-anchor:first-child {
  top: 0;
}

.rbc-addons-dnd-resize-ns-anchor:last-child {
  bottom: 0;
}

/* Visual feedback during resize */
.rbc-addons-dnd-resizing {
  opacity: 0.8 !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
}

/* Improve resize handle visibility on hover */
.rbc-event:hover .rbc-addons-dnd-resize-ns-anchor::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 30px;
  height: 3px;
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: 2px;
}

.rbc-event:hover .rbc-addons-dnd-resize-ns-anchor:first-child::after {
  top: 2px;
}

.rbc-event:hover .rbc-addons-dnd-resize-ns-anchor:last-child::after {
  bottom: 2px;
}

/* Prevent text selection during drag */
.rbc-addons-dnd-dragging,
.rbc-addons-dnd-resizing {
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
}

/* Month view drag and drop */
.rbc-month-view .rbc-addons-dnd-draggable {
  cursor: move !important;
}

.rbc-month-view .rbc-addons-dnd-dragging {
  opacity: 0.6 !important;
  transform: scale(0.98);
}

/* Week/Day view drag and drop */
.rbc-time-view .rbc-addons-dnd-draggable {
  cursor: move !important;
}

.rbc-time-view .rbc-addons-dnd-dragging {
  opacity: 0.7 !important;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3) !important;
}

/* Drop zone highlighting in time views */
.rbc-time-slot.rbc-addons-dnd-over {
  background-color: rgba(59, 130, 246, 0.05) !important;
  border-left: 3px solid #3b82f6 !important;
}

/* Drop zone highlighting in month view */
.rbc-day-bg.rbc-addons-dnd-over {
  background-color: rgba(59, 130, 246, 0.08) !important;
  border: 2px dashed #3b82f6 !important;
}

/* Smooth transitions for drag operations */
.rbc-event {
  transition: transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease;
}

/* Disable transitions during active drag */
.rbc-addons-dnd-dragging,
.rbc-addons-dnd-resizing {
  transition: none !important;
}

/* Custom drag preview styling */
.rbc-addons-dnd-drag-preview {
  opacity: 0.8;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  border-radius: 6px;
  pointer-events: none;
}

/* Improve visibility of draggable events */
.rbc-addons-dnd-draggable:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 5;
}

/* DRAG AND DROP: ensure visible handles + proper cursors */
.rbc-addons-dnd-resizable {
  position: relative;
}

/* Vertical resize handles (time views) */
.rbc-addons-dnd-resize-ns-anchor {
  position: absolute;
  left: 0;
  right: 0;
  height: 10px;
  cursor: ns-resize;
  z-index: 10;
}
.rbc-addons-dnd-resize-ns-anchor:first-child { top: 0; }
.rbc-addons-dnd-resize-ns-anchor:last-child { bottom: 0; }

/* Horizontal resize handles (month view, multi-day) */
.rbc-addons-dnd-resize-ew-anchor {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 10px;
  cursor: ew-resize;
  z-index: 10;
}
.rbc-addons-dnd-resize-ew-anchor:first-child { left: 0; }
.rbc-addons-dnd-resize-ew-anchor:last-child { right: 0; }

/* Better visibility while dragging/resizing */
.rbc-addons-dnd-dragging,
.rbc-addons-dnd-resizing {
  opacity: 0.8 !important;
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
}

/* Optional: highlight drop targets if class applied by addon */
.rbc-addons-dnd-over {
  background-color: rgba(59, 130, 246, 0.08) !important;
}

/* Improve label contrast on colored events */
.rbc-event-label {
  color: rgba(255, 255, 255, 0.95) !important;
}

/* Restore black color for event time labels */
.rbc-event-label {
  color: #111 !important; /* was rgba(255,255,255,0.95) */
}
