"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/react-big-calendar";
exports.ids = ["vendor-chunks/react-big-calendar"];
exports.modules = {

/***/ "(ssr)/./node_modules/react-big-calendar/dist/react-big-calendar.esm.js":
/*!************************************************************************!*\
  !*** ./node_modules/react-big-calendar/dist/react-big-calendar.esm.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Calendar: () => (/* binding */ Calendar$1),\n/* harmony export */   DateLocalizer: () => (/* binding */ DateLocalizer),\n/* harmony export */   Navigate: () => (/* binding */ navigate),\n/* harmony export */   Views: () => (/* binding */ views),\n/* harmony export */   components: () => (/* binding */ components),\n/* harmony export */   dateFnsLocalizer: () => (/* binding */ dateFnsLocalizer),\n/* harmony export */   dayjsLocalizer: () => (/* binding */ dayjs),\n/* harmony export */   globalizeLocalizer: () => (/* binding */ globalize),\n/* harmony export */   luxonLocalizer: () => (/* binding */ luxon),\n/* harmony export */   momentLocalizer: () => (/* binding */ moment),\n/* harmony export */   move: () => (/* binding */ moveDate)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/objectSpread2.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/typeof.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/createClass.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/callSuper */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/callSuper.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/inherits.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var uncontrollable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! uncontrollable */ \"(ssr)/./node_modules/uncontrollable/lib/esm/index.js\");\n/* harmony import */ var clsx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! clsx */ \"(ssr)/./node_modules/react-big-calendar/node_modules/clsx/dist/clsx.m.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! prop-types */ \"(ssr)/./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_44___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_44__);\n/* harmony import */ var invariant__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! invariant */ \"(ssr)/./node_modules/invariant/invariant.js\");\n/* harmony import */ var invariant__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(invariant__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var date_arithmetic__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! date-arithmetic */ \"(ssr)/./node_modules/date-arithmetic/index.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\");\n/* harmony import */ var lodash_chunk__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! lodash/chunk */ \"(ssr)/./node_modules/lodash/chunk.js\");\n/* harmony import */ var lodash_chunk__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(lodash_chunk__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var dom_helpers_position__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! dom-helpers/position */ \"(ssr)/./node_modules/dom-helpers/esm/position.js\");\n/* harmony import */ var dom_helpers_animationFrame__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! dom-helpers/animationFrame */ \"(ssr)/./node_modules/dom-helpers/esm/animationFrame.js\");\n/* harmony import */ var react_overlays__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! react-overlays */ \"(ssr)/./node_modules/react-overlays/esm/Overlay.js\");\n/* harmony import */ var dom_helpers_offset__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! dom-helpers/offset */ \"(ssr)/./node_modules/dom-helpers/esm/offset.js\");\n/* harmony import */ var lodash_isEqual__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! lodash/isEqual */ \"(ssr)/./node_modules/lodash/isEqual.js\");\n/* harmony import */ var lodash_isEqual__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(lodash_isEqual__WEBPACK_IMPORTED_MODULE_19__);\n/* harmony import */ var dom_helpers_height__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! dom-helpers/height */ \"(ssr)/./node_modules/dom-helpers/esm/height.js\");\n/* harmony import */ var dom_helpers_querySelectorAll__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! dom-helpers/querySelectorAll */ \"(ssr)/./node_modules/dom-helpers/esm/querySelectorAll.js\");\n/* harmony import */ var dom_helpers_contains__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! dom-helpers/contains */ \"(ssr)/./node_modules/dom-helpers/esm/contains.js\");\n/* harmony import */ var dom_helpers_closest__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! dom-helpers/closest */ \"(ssr)/./node_modules/dom-helpers/esm/closest.js\");\n/* harmony import */ var dom_helpers_listen__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! dom-helpers/listen */ \"(ssr)/./node_modules/dom-helpers/esm/listen.js\");\n/* harmony import */ var lodash_findIndex__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! lodash/findIndex */ \"(ssr)/./node_modules/lodash/findIndex.js\");\n/* harmony import */ var lodash_findIndex__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(lodash_findIndex__WEBPACK_IMPORTED_MODULE_25__);\n/* harmony import */ var lodash_range__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! lodash/range */ \"(ssr)/./node_modules/lodash/range.js\");\n/* harmony import */ var lodash_range__WEBPACK_IMPORTED_MODULE_26___default = /*#__PURE__*/__webpack_require__.n(lodash_range__WEBPACK_IMPORTED_MODULE_26__);\n/* harmony import */ var memoize_one__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! memoize-one */ \"(ssr)/./node_modules/memoize-one/dist/memoize-one.esm.js\");\n/* harmony import */ var lodash_sortBy__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! lodash/sortBy */ \"(ssr)/./node_modules/lodash/sortBy.js\");\n/* harmony import */ var lodash_sortBy__WEBPACK_IMPORTED_MODULE_27___default = /*#__PURE__*/__webpack_require__.n(lodash_sortBy__WEBPACK_IMPORTED_MODULE_27__);\n/* harmony import */ var dom_helpers_scrollbarSize__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! dom-helpers/scrollbarSize */ \"(ssr)/./node_modules/dom-helpers/esm/scrollbarSize.js\");\n/* harmony import */ var dom_helpers_width__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! dom-helpers/width */ \"(ssr)/./node_modules/dom-helpers/esm/width.js\");\n/* harmony import */ var _babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toArray */ \"(ssr)/./node_modules/@babel/runtime/helpers/esm/toArray.js\");\n/* harmony import */ var dom_helpers_addClass__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! dom-helpers/addClass */ \"(ssr)/./node_modules/dom-helpers/esm/addClass.js\");\n/* harmony import */ var dom_helpers_removeClass__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! dom-helpers/removeClass */ \"(ssr)/./node_modules/dom-helpers/esm/removeClass.js\");\n/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! lodash/omit */ \"(ssr)/./node_modules/lodash/omit.js\");\n/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(lodash_omit__WEBPACK_IMPORTED_MODULE_33__);\n/* harmony import */ var lodash_defaults__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! lodash/defaults */ \"(ssr)/./node_modules/lodash/defaults.js\");\n/* harmony import */ var lodash_defaults__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(lodash_defaults__WEBPACK_IMPORTED_MODULE_34__);\n/* harmony import */ var lodash_transform__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! lodash/transform */ \"(ssr)/./node_modules/lodash/transform.js\");\n/* harmony import */ var lodash_transform__WEBPACK_IMPORTED_MODULE_35___default = /*#__PURE__*/__webpack_require__.n(lodash_transform__WEBPACK_IMPORTED_MODULE_35__);\n/* harmony import */ var lodash_mapValues__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! lodash/mapValues */ \"(ssr)/./node_modules/lodash/mapValues.js\");\n/* harmony import */ var lodash_mapValues__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(lodash_mapValues__WEBPACK_IMPORTED_MODULE_36__);\n/* harmony import */ var dayjs_plugin_isBetween__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! dayjs/plugin/isBetween */ \"(ssr)/./node_modules/dayjs/plugin/isBetween.js\");\n/* harmony import */ var dayjs_plugin_isBetween__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_isBetween__WEBPACK_IMPORTED_MODULE_37__);\n/* harmony import */ var dayjs_plugin_isSameOrAfter__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! dayjs/plugin/isSameOrAfter */ \"(ssr)/./node_modules/dayjs/plugin/isSameOrAfter.js\");\n/* harmony import */ var dayjs_plugin_isSameOrAfter__WEBPACK_IMPORTED_MODULE_38___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_isSameOrAfter__WEBPACK_IMPORTED_MODULE_38__);\n/* harmony import */ var dayjs_plugin_isSameOrBefore__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! dayjs/plugin/isSameOrBefore */ \"(ssr)/./node_modules/dayjs/plugin/isSameOrBefore.js\");\n/* harmony import */ var dayjs_plugin_isSameOrBefore__WEBPACK_IMPORTED_MODULE_39___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_isSameOrBefore__WEBPACK_IMPORTED_MODULE_39__);\n/* harmony import */ var dayjs_plugin_localeData__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! dayjs/plugin/localeData */ \"(ssr)/./node_modules/dayjs/plugin/localeData.js\");\n/* harmony import */ var dayjs_plugin_localeData__WEBPACK_IMPORTED_MODULE_40___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_localeData__WEBPACK_IMPORTED_MODULE_40__);\n/* harmony import */ var dayjs_plugin_localizedFormat__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! dayjs/plugin/localizedFormat */ \"(ssr)/./node_modules/dayjs/plugin/localizedFormat.js\");\n/* harmony import */ var dayjs_plugin_localizedFormat__WEBPACK_IMPORTED_MODULE_41___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_localizedFormat__WEBPACK_IMPORTED_MODULE_41__);\n/* harmony import */ var dayjs_plugin_minMax__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! dayjs/plugin/minMax */ \"(ssr)/./node_modules/dayjs/plugin/minMax.js\");\n/* harmony import */ var dayjs_plugin_minMax__WEBPACK_IMPORTED_MODULE_42___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_minMax__WEBPACK_IMPORTED_MODULE_42__);\n/* harmony import */ var dayjs_plugin_utc__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! dayjs/plugin/utc */ \"(ssr)/./node_modules/dayjs/plugin/utc.js\");\n/* harmony import */ var dayjs_plugin_utc__WEBPACK_IMPORTED_MODULE_43___default = /*#__PURE__*/__webpack_require__.n(dayjs_plugin_utc__WEBPACK_IMPORTED_MODULE_43__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction NoopWrapper(props) {\n  return props.children;\n}\n\nvar navigate = {\n  PREVIOUS: 'PREV',\n  NEXT: 'NEXT',\n  TODAY: 'TODAY',\n  DATE: 'DATE'\n};\nvar views = {\n  MONTH: 'month',\n  WEEK: 'week',\n  WORK_WEEK: 'work_week',\n  DAY: 'day',\n  AGENDA: 'agenda'\n};\n\nvar viewNames$1 = Object.keys(views).map(function (k) {\n  return views[k];\n});\nprop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_44___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func)]);\n(prop_types__WEBPACK_IMPORTED_MODULE_44___default().any);\n(prop_types__WEBPACK_IMPORTED_MODULE_44___default().func);\n\n/**\n * accepts either an array of builtin view names:\n *\n * ```\n * views={['month', 'day', 'agenda']}\n * ```\n *\n * or an object hash of the view name and the component (or boolean for builtin)\n *\n * ```\n * views={{\n *   month: true,\n *   week: false,\n *   workweek: WorkWeekViewComponent,\n * }}\n * ```\n */\n\nprop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_44___default().arrayOf(prop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOf(viewNames$1)), prop_types__WEBPACK_IMPORTED_MODULE_44___default().objectOf(function (prop, key) {\n  var isBuiltinView = viewNames$1.indexOf(key) !== -1 && typeof prop[key] === 'boolean';\n  if (isBuiltinView) {\n    return null;\n  } else {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n    return prop_types__WEBPACK_IMPORTED_MODULE_44___default().elementType.apply((prop_types__WEBPACK_IMPORTED_MODULE_44___default()), [prop, key].concat(args));\n  }\n})]);\nprop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOf(['overlap', 'no-overlap']), (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func)]);\n\nfunction notify(handler, args) {\n  handler && handler.apply(null, [].concat(args));\n}\n\n/* eslint no-fallthrough: off */\nvar MILLI = {\n  seconds: 1000,\n  minutes: 1000 * 60,\n  hours: 1000 * 60 * 60,\n  day: 1000 * 60 * 60 * 24\n};\nfunction firstVisibleDay(date, localizer) {\n  var firstOfMonth = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(date, 'month');\n  return date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(firstOfMonth, 'week', localizer.startOfWeek());\n}\nfunction lastVisibleDay(date, localizer) {\n  var endOfMonth = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.endOf(date, 'month');\n  return date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.endOf(endOfMonth, 'week', localizer.startOfWeek());\n}\nfunction visibleDays(date, localizer) {\n  var current = firstVisibleDay(date, localizer),\n    last = lastVisibleDay(date, localizer),\n    days = [];\n  while (date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lte(current, last, 'day')) {\n    days.push(current);\n    current = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.add(current, 1, 'day');\n  }\n  return days;\n}\nfunction ceil(date, unit) {\n  var floor = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(date, unit);\n  return date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq(floor, date) ? floor : date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.add(floor, 1, unit);\n}\nfunction range(start, end) {\n  var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n  var current = start,\n    days = [];\n  while (date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lte(current, end, unit)) {\n    days.push(current);\n    current = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.add(current, 1, unit);\n  }\n  return days;\n}\nfunction merge(date, time) {\n  if (time == null && date == null) return null;\n  if (time == null) time = new Date();\n  if (date == null) date = new Date();\n  date = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(date, 'day');\n  date = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.hours(date, date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.hours(time));\n  date = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.minutes(date, date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.minutes(time));\n  date = date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.seconds(date, date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.seconds(time));\n  return date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.milliseconds(date, date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.milliseconds(time));\n}\nfunction isJustDate(date) {\n  return date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.hours(date) === 0 && date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.minutes(date) === 0 && date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.seconds(date) === 0 && date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.milliseconds(date) === 0;\n}\nfunction duration(start, end, unit, firstOfWeek) {\n  if (unit === 'day') unit = 'date';\n  return Math.abs(\n  // eslint-disable-next-line import/namespace\n  date_arithmetic__WEBPACK_IMPORTED_MODULE_12__[unit](start, undefined, firstOfWeek) -\n  // eslint-disable-next-line import/namespace\n  date_arithmetic__WEBPACK_IMPORTED_MODULE_12__[unit](end, undefined, firstOfWeek));\n}\nfunction diff(dateA, dateB, unit) {\n  if (!unit || unit === 'milliseconds') return Math.abs(+dateA - +dateB);\n\n  // the .round() handles an edge case\n  // with DST where the total won't be exact\n  // since one day in the range may be shorter/longer by an hour\n  return Math.round(Math.abs(+date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(dateA, unit) / MILLI[unit] - +date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf(dateB, unit) / MILLI[unit]));\n}\n\nvar localePropType = prop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_44___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func)]);\nfunction _format(localizer, formatter, value, format, culture) {\n  var result = typeof format === 'function' ? format(value, culture, localizer) : formatter.call(localizer, value, format, culture);\n  invariant__WEBPACK_IMPORTED_MODULE_11___default()(result == null || typeof result === 'string', '`localizer format(..)` must return a string, null, or undefined');\n  return result;\n}\n\n/**\n * This date conversion was moved out of TimeSlots.js, to\n * allow for localizer override\n * @param {Date} dt - The date to start from\n * @param {Number} minutesFromMidnight\n * @param {Number} offset\n * @returns {Date}\n */\nfunction getSlotDate(dt, minutesFromMidnight, offset) {\n  return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate(), 0, minutesFromMidnight + offset, 0, 0);\n}\nfunction getDstOffset(start, end) {\n  return start.getTimezoneOffset() - end.getTimezoneOffset();\n}\n\n// if the start is on a DST-changing day but *after* the moment of DST\n// transition we need to add those extra minutes to our minutesFromMidnight\nfunction getTotalMin(start, end) {\n  return diff(start, end, 'minutes') + getDstOffset(start, end);\n}\nfunction getMinutesFromMidnight(start) {\n  var daystart = (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf)(start, 'day');\n  return diff(daystart, start, 'minutes') + getDstOffset(daystart, start);\n}\n\n// These two are used by DateSlotMetrics\nfunction continuesPrior(start, first) {\n  return (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lt)(start, first, 'day');\n}\nfunction continuesAfter(start, end, last) {\n  var singleDayDuration = (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq)(start, end, 'minutes');\n  return singleDayDuration ? (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gte)(end, last, 'minutes') : (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gt)(end, last, 'minutes');\n}\nfunction daySpan(start, end) {\n  return duration(start, end, 'day');\n}\n\n// These two are used by eventLevels\nfunction sortEvents$1(_ref) {\n  var _ref$evtA = _ref.evtA,\n    aStart = _ref$evtA.start,\n    aEnd = _ref$evtA.end,\n    aAllDay = _ref$evtA.allDay,\n    _ref$evtB = _ref.evtB,\n    bStart = _ref$evtB.start,\n    bEnd = _ref$evtB.end,\n    bAllDay = _ref$evtB.allDay;\n  var startSort = +(0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf)(aStart, 'day') - +(0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf)(bStart, 'day');\n  var durA = daySpan(aStart, aEnd);\n  var durB = daySpan(bStart, bEnd);\n  return startSort ||\n  // sort by start Day first\n  durB - durA ||\n  // events spanning multiple days go first\n  !!bAllDay - !!aAllDay ||\n  // then allDay single day events\n  +aStart - +bStart ||\n  // then sort by start time\n  +aEnd - +bEnd // then sort by end time\n  ;\n}\nfunction inEventRange(_ref2) {\n  var _ref2$event = _ref2.event,\n    start = _ref2$event.start,\n    end = _ref2$event.end,\n    _ref2$range = _ref2.range,\n    rangeStart = _ref2$range.start,\n    rangeEnd = _ref2$range.end;\n  var eStart = (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf)(start, 'day');\n  var startsBeforeEnd = (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lte)(eStart, rangeEnd, 'day');\n  // when the event is zero duration we need to handle a bit differently\n  var sameMin = (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.neq)(eStart, end, 'minutes');\n  var endsAfterStart = sameMin ? (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gt)(end, rangeStart, 'minutes') : (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gte)(end, rangeStart, 'minutes');\n  return startsBeforeEnd && endsAfterStart;\n}\n\n// other localizers treats 'day' and 'date' equality very differently, so we\n// abstract the change the 'localizer.eq(date1, date2, 'day') into this\n// new method, where they can be treated correctly by the localizer overrides\nfunction isSameDate(date1, date2) {\n  return (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq)(date1, date2, 'day');\n}\nfunction startAndEndAreDateOnly(start, end) {\n  return isJustDate(start) && isJustDate(end);\n}\nvar DateLocalizer = /*#__PURE__*/(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(function DateLocalizer(spec) {\n  var _this = this;\n  (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, DateLocalizer);\n  invariant__WEBPACK_IMPORTED_MODULE_11___default()(typeof spec.format === 'function', 'date localizer `format(..)` must be a function');\n  invariant__WEBPACK_IMPORTED_MODULE_11___default()(typeof spec.firstOfWeek === 'function', 'date localizer `firstOfWeek(..)` must be a function');\n  this.propType = spec.propType || localePropType;\n  this.formats = spec.formats;\n  this.format = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return _format.apply(void 0, [_this, spec.format].concat(args));\n  };\n  // These date arithmetic methods can be overriden by the localizer\n  this.startOfWeek = spec.firstOfWeek;\n  this.merge = spec.merge || merge;\n  this.inRange = spec.inRange || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.inRange;\n  this.lt = spec.lt || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lt;\n  this.lte = spec.lte || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.lte;\n  this.gt = spec.gt || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gt;\n  this.gte = spec.gte || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.gte;\n  this.eq = spec.eq || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq;\n  this.neq = spec.neq || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.neq;\n  this.startOf = spec.startOf || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.startOf;\n  this.endOf = spec.endOf || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.endOf;\n  this.add = spec.add || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.add;\n  this.range = spec.range || range;\n  this.diff = spec.diff || diff;\n  this.ceil = spec.ceil || ceil;\n  this.min = spec.min || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.min;\n  this.max = spec.max || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.max;\n  this.minutes = spec.minutes || date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.minutes;\n  this.daySpan = spec.daySpan || daySpan;\n  this.firstVisibleDay = spec.firstVisibleDay || firstVisibleDay;\n  this.lastVisibleDay = spec.lastVisibleDay || lastVisibleDay;\n  this.visibleDays = spec.visibleDays || visibleDays;\n  this.getSlotDate = spec.getSlotDate || getSlotDate;\n  this.getTimezoneOffset = spec.getTimezoneOffset || function (value) {\n    return value.getTimezoneOffset();\n  };\n  this.getDstOffset = spec.getDstOffset || getDstOffset;\n  this.getTotalMin = spec.getTotalMin || getTotalMin;\n  this.getMinutesFromMidnight = spec.getMinutesFromMidnight || getMinutesFromMidnight;\n  this.continuesPrior = spec.continuesPrior || continuesPrior;\n  this.continuesAfter = spec.continuesAfter || continuesAfter;\n  this.sortEvents = spec.sortEvents || sortEvents$1;\n  this.inEventRange = spec.inEventRange || inEventRange;\n  this.isSameDate = spec.isSameDate || isSameDate;\n  this.startAndEndAreDateOnly = spec.startAndEndAreDateOnly || startAndEndAreDateOnly;\n  this.segmentOffset = spec.browserTZOffset ? spec.browserTZOffset() : 0;\n});\nfunction mergeWithDefaults(localizer, culture, formatOverrides, messages) {\n  var formats = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, localizer.formats), formatOverrides);\n  return (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, localizer), {}, {\n    messages: messages,\n    startOfWeek: function startOfWeek() {\n      return localizer.startOfWeek(culture);\n    },\n    format: function format(value, _format2) {\n      return localizer.format(value, formats[_format2] || _format2, culture);\n    }\n  });\n}\n\nvar defaultMessages = {\n  date: 'Date',\n  time: 'Time',\n  event: 'Event',\n  allDay: 'All Day',\n  week: 'Week',\n  work_week: 'Work Week',\n  day: 'Day',\n  month: 'Month',\n  previous: 'Back',\n  next: 'Next',\n  yesterday: 'Yesterday',\n  tomorrow: 'Tomorrow',\n  today: 'Today',\n  agenda: 'Agenda',\n  noEventsInRange: 'There are no events in this range.',\n  showMore: function showMore(total) {\n    return \"+\".concat(total, \" more\");\n  }\n};\nfunction messages(msgs) {\n  return (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, defaultMessages), msgs);\n}\n\nfunction useClickOutside(_ref) {\n  var ref = _ref.ref,\n    callback = _ref.callback;\n  (0,react__WEBPACK_IMPORTED_MODULE_8__.useEffect)(function () {\n    var handleClickOutside = function handleClickOutside(e) {\n      if (ref.current && !ref.current.contains(e.target)) {\n        callback();\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return function () {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [ref, callback]);\n}\n\nvar _excluded$7 = [\"style\", \"className\", \"event\", \"selected\", \"isAllDay\", \"onSelect\", \"onDoubleClick\", \"onKeyPress\", \"localizer\", \"continuesPrior\", \"continuesAfter\", \"accessors\", \"getters\", \"children\", \"components\", \"slotStart\", \"slotEnd\"];\nvar EventCell = /*#__PURE__*/function (_React$Component) {\n  function EventCell() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, EventCell);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, EventCell, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(EventCell, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(EventCell, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        style = _this$props.style,\n        className = _this$props.className,\n        event = _this$props.event,\n        selected = _this$props.selected,\n        isAllDay = _this$props.isAllDay,\n        onSelect = _this$props.onSelect,\n        _onDoubleClick = _this$props.onDoubleClick,\n        onKeyPress = _this$props.onKeyPress,\n        localizer = _this$props.localizer,\n        continuesPrior = _this$props.continuesPrior,\n        continuesAfter = _this$props.continuesAfter,\n        accessors = _this$props.accessors,\n        getters = _this$props.getters,\n        children = _this$props.children,\n        _this$props$component = _this$props.components,\n        Event = _this$props$component.event,\n        EventWrapper = _this$props$component.eventWrapper,\n        slotStart = _this$props.slotStart,\n        slotEnd = _this$props.slotEnd,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props, _excluded$7);\n      delete props.resizable;\n      var title = accessors.title(event);\n      var tooltip = accessors.tooltip(event);\n      var end = accessors.end(event);\n      var start = accessors.start(event);\n      var allDay = accessors.allDay(event);\n      var showAsAllDay = isAllDay || allDay || localizer.diff(start, localizer.ceil(end, 'day'), 'day') > 1;\n      var userProps = getters.eventProp(event, start, end, selected);\n      var content = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-event-content\",\n        title: tooltip || undefined\n      }, Event ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Event, {\n        event: event,\n        continuesPrior: continuesPrior,\n        continuesAfter: continuesAfter,\n        title: title,\n        isAllDay: allDay,\n        localizer: localizer,\n        slotStart: slotStart,\n        slotEnd: slotEnd\n      }) : title);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventWrapper, Object.assign({}, this.props, {\n        type: \"date\"\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", Object.assign({}, props, {\n        style: (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, userProps.style), style),\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-event', className, userProps.className, {\n          'rbc-selected': selected,\n          'rbc-event-allday': showAsAllDay,\n          'rbc-event-continues-prior': continuesPrior,\n          'rbc-event-continues-after': continuesAfter\n        }),\n        onClick: function onClick(e) {\n          return onSelect && onSelect(event, e);\n        },\n        onDoubleClick: function onDoubleClick(e) {\n          return _onDoubleClick && _onDoubleClick(event, e);\n        },\n        onKeyDown: function onKeyDown(e) {\n          return onKeyPress && onKeyPress(event, e);\n        }\n      }), typeof children === 'function' ? children(content) : content));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\n\nfunction isSelected(event, selected) {\n  if (!event || selected == null) return false;\n  return lodash_isEqual__WEBPACK_IMPORTED_MODULE_19___default()(event, selected);\n}\nfunction slotWidth(rowBox, slots) {\n  var rowWidth = rowBox.right - rowBox.left;\n  var cellWidth = rowWidth / slots;\n  return cellWidth;\n}\nfunction getSlotAtX(rowBox, x, rtl, slots) {\n  var cellWidth = slotWidth(rowBox, slots);\n  return rtl ? slots - 1 - Math.floor((x - rowBox.left) / cellWidth) : Math.floor((x - rowBox.left) / cellWidth);\n}\nfunction pointInBox(box, _ref) {\n  var x = _ref.x,\n    y = _ref.y;\n  return y >= box.top && y <= box.bottom && x >= box.left && x <= box.right;\n}\nfunction dateCellSelection(start, rowBox, box, slots, rtl) {\n  var startIdx = -1;\n  var endIdx = -1;\n  var lastSlotIdx = slots - 1;\n  var cellWidth = slotWidth(rowBox, slots);\n\n  // cell under the mouse\n  var currentSlot = getSlotAtX(rowBox, box.x, rtl, slots);\n\n  // Identify row as either the initial row\n  // or the row under the current mouse point\n  var isCurrentRow = rowBox.top < box.y && rowBox.bottom > box.y;\n  var isStartRow = rowBox.top < start.y && rowBox.bottom > start.y;\n\n  // this row's position relative to the start point\n  var isAboveStart = start.y > rowBox.bottom;\n  var isBelowStart = rowBox.top > start.y;\n  var isBetween = box.top < rowBox.top && box.bottom > rowBox.bottom;\n\n  // this row is between the current and start rows, so entirely selected\n  if (isBetween) {\n    startIdx = 0;\n    endIdx = lastSlotIdx;\n  }\n  if (isCurrentRow) {\n    if (isBelowStart) {\n      startIdx = 0;\n      endIdx = currentSlot;\n    } else if (isAboveStart) {\n      startIdx = currentSlot;\n      endIdx = lastSlotIdx;\n    }\n  }\n  if (isStartRow) {\n    // select the cell under the initial point\n    startIdx = endIdx = rtl ? lastSlotIdx - Math.floor((start.x - rowBox.left) / cellWidth) : Math.floor((start.x - rowBox.left) / cellWidth);\n    if (isCurrentRow) {\n      if (currentSlot < startIdx) startIdx = currentSlot;else endIdx = currentSlot; //select current range\n    } else if (start.y < box.y) {\n      // the current row is below start row\n      // select cells to the right of the start cell\n      endIdx = lastSlotIdx;\n    } else {\n      // select cells to the left of the start cell\n      startIdx = 0;\n    }\n  }\n  return {\n    startIdx: startIdx,\n    endIdx: endIdx\n  };\n}\n\n/**\n * Changes to react-overlays cause issue with auto positioning,\n * so we need to manually calculate the position of the popper,\n * and constrain it to the Month container.\n */\nfunction getPosition(_ref) {\n  var target = _ref.target,\n    offset = _ref.offset,\n    container = _ref.container,\n    box = _ref.box;\n  var _getOffset = (0,dom_helpers_offset__WEBPACK_IMPORTED_MODULE_18__[\"default\"])(target),\n    top = _getOffset.top,\n    left = _getOffset.left,\n    width = _getOffset.width,\n    height = _getOffset.height;\n  var _getOffset2 = (0,dom_helpers_offset__WEBPACK_IMPORTED_MODULE_18__[\"default\"])(container),\n    cTop = _getOffset2.top,\n    cLeft = _getOffset2.left,\n    cWidth = _getOffset2.width,\n    cHeight = _getOffset2.height;\n  var _getOffset3 = (0,dom_helpers_offset__WEBPACK_IMPORTED_MODULE_18__[\"default\"])(box),\n    bWidth = _getOffset3.width,\n    bHeight = _getOffset3.height;\n  var viewBottom = cTop + cHeight;\n  var viewRight = cLeft + cWidth;\n  var bottom = top + bHeight;\n  var right = left + bWidth;\n  var x = offset.x,\n    y = offset.y;\n  var topOffset = bottom > viewBottom ? top - bHeight - y : top + y + height;\n  var leftOffset = right > viewRight ? left + x - bWidth + width : left + x;\n  return {\n    topOffset: topOffset,\n    leftOffset: leftOffset\n  };\n}\nfunction Pop(_ref2) {\n  var containerRef = _ref2.containerRef,\n    accessors = _ref2.accessors,\n    getters = _ref2.getters,\n    selected = _ref2.selected,\n    components = _ref2.components,\n    localizer = _ref2.localizer,\n    position = _ref2.position,\n    show = _ref2.show,\n    events = _ref2.events,\n    slotStart = _ref2.slotStart,\n    slotEnd = _ref2.slotEnd,\n    onSelect = _ref2.onSelect,\n    onDoubleClick = _ref2.onDoubleClick,\n    onKeyPress = _ref2.onKeyPress,\n    handleDragStart = _ref2.handleDragStart,\n    popperRef = _ref2.popperRef,\n    target = _ref2.target,\n    offset = _ref2.offset;\n  useClickOutside({\n    ref: popperRef,\n    callback: show\n  });\n  (0,react__WEBPACK_IMPORTED_MODULE_8__.useLayoutEffect)(function () {\n    var _getPosition = getPosition({\n        target: target,\n        offset: offset,\n        container: containerRef.current,\n        box: popperRef.current\n      }),\n      topOffset = _getPosition.topOffset,\n      leftOffset = _getPosition.leftOffset;\n    popperRef.current.style.top = \"\".concat(topOffset, \"px\");\n    popperRef.current.style.left = \"\".concat(leftOffset, \"px\");\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [offset.x, offset.y, target]);\n  var width = position.width;\n  var style = {\n    minWidth: width + width / 2\n  };\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    style: style,\n    className: \"rbc-overlay\",\n    ref: popperRef\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: \"rbc-overlay-header\"\n  }, localizer.format(slotStart, 'dayHeaderFormat')), events.map(function (event, idx) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventCell, {\n      key: idx,\n      type: \"popup\",\n      localizer: localizer,\n      event: event,\n      getters: getters,\n      onSelect: onSelect,\n      accessors: accessors,\n      components: components,\n      onDoubleClick: onDoubleClick,\n      onKeyPress: onKeyPress,\n      continuesPrior: localizer.lt(accessors.end(event), slotStart, 'day'),\n      continuesAfter: localizer.gte(accessors.start(event), slotEnd, 'day'),\n      slotStart: slotStart,\n      slotEnd: slotEnd,\n      selected: isSelected(event, selected),\n      draggable: true,\n      onDragStart: function onDragStart() {\n        return handleDragStart(event);\n      },\n      onDragEnd: function onDragEnd() {\n        return show();\n      }\n    });\n  }));\n}\nvar Popup = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().forwardRef(function (props, ref) {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Pop, Object.assign({}, props, {\n    popperRef: ref\n  }));\n});\nPopup.propTypes = {\n  accessors: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  getters: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  selected: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object),\n  components: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  localizer: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  position: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  show: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func).isRequired,\n  events: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().array).isRequired,\n  slotStart: prop_types__WEBPACK_IMPORTED_MODULE_44___default().instanceOf(Date).isRequired,\n  slotEnd: prop_types__WEBPACK_IMPORTED_MODULE_44___default().instanceOf(Date),\n  onSelect: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  onDoubleClick: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  onKeyPress: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  handleDragStart: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  style: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object),\n  offset: prop_types__WEBPACK_IMPORTED_MODULE_44___default().shape({\n    x: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().number),\n    y: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().number)\n  })\n};\n\nfunction CalOverlay(_ref) {\n  var containerRef = _ref.containerRef,\n    _ref$popupOffset = _ref.popupOffset,\n    popupOffset = _ref$popupOffset === void 0 ? 5 : _ref$popupOffset,\n    overlay = _ref.overlay,\n    accessors = _ref.accessors,\n    localizer = _ref.localizer,\n    components = _ref.components,\n    getters = _ref.getters,\n    selected = _ref.selected,\n    handleSelectEvent = _ref.handleSelectEvent,\n    handleDoubleClickEvent = _ref.handleDoubleClickEvent,\n    handleKeyPressEvent = _ref.handleKeyPressEvent,\n    handleDragStart = _ref.handleDragStart,\n    onHide = _ref.onHide,\n    overlayDisplay = _ref.overlayDisplay;\n  var popperRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  if (!overlay.position) return null;\n  var offset = popupOffset;\n  if (!isNaN(popupOffset)) {\n    offset = {\n      x: popupOffset,\n      y: popupOffset\n    };\n  }\n  var position = overlay.position,\n    events = overlay.events,\n    date = overlay.date,\n    end = overlay.end;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(react_overlays__WEBPACK_IMPORTED_MODULE_45__[\"default\"], {\n    rootClose: true,\n    flip: true,\n    show: true,\n    placement: \"bottom\",\n    onHide: onHide,\n    target: overlay.target\n  }, function (_ref2) {\n    var props = _ref2.props;\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Popup, Object.assign({}, props, {\n      containerRef: containerRef,\n      ref: popperRef,\n      target: overlay.target,\n      offset: offset,\n      accessors: accessors,\n      getters: getters,\n      selected: selected,\n      components: components,\n      localizer: localizer,\n      position: position,\n      show: overlayDisplay,\n      events: events,\n      slotStart: date,\n      slotEnd: end,\n      onSelect: handleSelectEvent,\n      onDoubleClick: handleDoubleClickEvent,\n      onKeyPress: handleKeyPressEvent,\n      handleDragStart: handleDragStart\n    }));\n  });\n}\nvar PopOverlay = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().forwardRef(function (props, ref) {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(CalOverlay, Object.assign({}, props, {\n    containerRef: ref\n  }));\n});\nPopOverlay.propTypes = {\n  popupOffset: prop_types__WEBPACK_IMPORTED_MODULE_44___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_44___default().number), prop_types__WEBPACK_IMPORTED_MODULE_44___default().shape({\n    x: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().number),\n    y: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().number)\n  })]),\n  overlay: prop_types__WEBPACK_IMPORTED_MODULE_44___default().shape({\n    position: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object),\n    events: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().array),\n    date: prop_types__WEBPACK_IMPORTED_MODULE_44___default().instanceOf(Date),\n    end: prop_types__WEBPACK_IMPORTED_MODULE_44___default().instanceOf(Date)\n  }),\n  accessors: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  localizer: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  components: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  getters: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n  selected: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object),\n  handleSelectEvent: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  handleDoubleClickEvent: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  handleKeyPressEvent: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  handleDragStart: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  onHide: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n  overlayDisplay: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func)\n};\n\nfunction addEventListener(type, handler) {\n  var target = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : document;\n  return (0,dom_helpers_listen__WEBPACK_IMPORTED_MODULE_24__[\"default\"])(target, type, handler, {\n    passive: false\n  });\n}\nfunction isOverContainer(container, x, y) {\n  return !container || (0,dom_helpers_contains__WEBPACK_IMPORTED_MODULE_22__[\"default\"])(container, document.elementFromPoint(x, y));\n}\nfunction getEventNodeFromPoint(node, _ref) {\n  var clientX = _ref.clientX,\n    clientY = _ref.clientY;\n  var target = document.elementFromPoint(clientX, clientY);\n  return (0,dom_helpers_closest__WEBPACK_IMPORTED_MODULE_23__[\"default\"])(target, '.rbc-event', node);\n}\nfunction getShowMoreNodeFromPoint(node, _ref2) {\n  var clientX = _ref2.clientX,\n    clientY = _ref2.clientY;\n  var target = document.elementFromPoint(clientX, clientY);\n  return (0,dom_helpers_closest__WEBPACK_IMPORTED_MODULE_23__[\"default\"])(target, '.rbc-show-more', node);\n}\nfunction isEvent(node, bounds) {\n  return !!getEventNodeFromPoint(node, bounds);\n}\nfunction isShowMore(node, bounds) {\n  return !!getShowMoreNodeFromPoint(node, bounds);\n}\nfunction getEventCoordinates(e) {\n  var target = e;\n  if (e.touches && e.touches.length) {\n    target = e.touches[0];\n  }\n  return {\n    clientX: target.clientX,\n    clientY: target.clientY,\n    pageX: target.pageX,\n    pageY: target.pageY\n  };\n}\nvar clickTolerance = 5;\nvar clickInterval = 250;\nvar Selection = /*#__PURE__*/function () {\n  function Selection(node) {\n    var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref3$global = _ref3.global,\n      global = _ref3$global === void 0 ? false : _ref3$global,\n      _ref3$longPressThresh = _ref3.longPressThreshold,\n      longPressThreshold = _ref3$longPressThresh === void 0 ? 250 : _ref3$longPressThresh,\n      _ref3$validContainers = _ref3.validContainers,\n      validContainers = _ref3$validContainers === void 0 ? [] : _ref3$validContainers;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Selection);\n    this._initialEvent = null;\n    this.selecting = false;\n    this.isDetached = false;\n    this.container = node;\n    this.globalMouse = !node || global;\n    this.longPressThreshold = longPressThreshold;\n    this.validContainers = validContainers;\n    this._listeners = Object.create(null);\n    this._handleInitialEvent = this._handleInitialEvent.bind(this);\n    this._handleMoveEvent = this._handleMoveEvent.bind(this);\n    this._handleTerminatingEvent = this._handleTerminatingEvent.bind(this);\n    this._keyListener = this._keyListener.bind(this);\n    this._dropFromOutsideListener = this._dropFromOutsideListener.bind(this);\n    this._dragOverFromOutsideListener = this._dragOverFromOutsideListener.bind(this);\n\n    // Fixes an iOS 10 bug where scrolling could not be prevented on the window.\n    // https://github.com/metafizzy/flickity/issues/457#issuecomment-254501356\n    this._removeTouchMoveWindowListener = addEventListener('touchmove', function () {}, window);\n    this._removeKeyDownListener = addEventListener('keydown', this._keyListener);\n    this._removeKeyUpListener = addEventListener('keyup', this._keyListener);\n    this._removeDropFromOutsideListener = addEventListener('drop', this._dropFromOutsideListener);\n    this._removeDragOverFromOutsideListener = addEventListener('dragover', this._dragOverFromOutsideListener);\n    this._addInitialEventListener();\n  }\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Selection, [{\n    key: \"on\",\n    value: function on(type, handler) {\n      var handlers = this._listeners[type] || (this._listeners[type] = []);\n      handlers.push(handler);\n      return {\n        remove: function remove() {\n          var idx = handlers.indexOf(handler);\n          if (idx !== -1) handlers.splice(idx, 1);\n        }\n      };\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(type) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n      var result;\n      var handlers = this._listeners[type] || [];\n      handlers.forEach(function (fn) {\n        if (result === undefined) result = fn.apply(void 0, args);\n      });\n      return result;\n    }\n  }, {\n    key: \"teardown\",\n    value: function teardown() {\n      this._initialEvent = null;\n      this._initialEventData = null;\n      this._selectRect = null;\n      this.selecting = false;\n      this._lastClickData = null;\n      this.isDetached = true;\n      this._listeners = Object.create(null);\n      this._removeTouchMoveWindowListener && this._removeTouchMoveWindowListener();\n      this._removeInitialEventListener && this._removeInitialEventListener();\n      this._removeEndListener && this._removeEndListener();\n      this._onEscListener && this._onEscListener();\n      this._removeMoveListener && this._removeMoveListener();\n      this._removeKeyUpListener && this._removeKeyUpListener();\n      this._removeKeyDownListener && this._removeKeyDownListener();\n      this._removeDropFromOutsideListener && this._removeDropFromOutsideListener();\n      this._removeDragOverFromOutsideListener && this._removeDragOverFromOutsideListener();\n    }\n  }, {\n    key: \"isSelected\",\n    value: function isSelected(node) {\n      var box = this._selectRect;\n      if (!box || !this.selecting) return false;\n      return objectsCollide(box, getBoundsForNode(node));\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(items) {\n      var box = this._selectRect;\n\n      //not selecting\n      if (!box || !this.selecting) return [];\n      return items.filter(this.isSelected, this);\n    }\n\n    // Adds a listener that will call the handler only after the user has pressed on the screen\n    // without moving their finger for 250ms.\n  }, {\n    key: \"_addLongPressListener\",\n    value: function _addLongPressListener(handler, initialEvent) {\n      var _this = this;\n      var timer = null;\n      var removeTouchMoveListener = null;\n      var removeTouchEndListener = null;\n      var handleTouchStart = function handleTouchStart(initialEvent) {\n        timer = setTimeout(function () {\n          cleanup();\n          handler(initialEvent);\n        }, _this.longPressThreshold);\n        removeTouchMoveListener = addEventListener('touchmove', function () {\n          return cleanup();\n        });\n        removeTouchEndListener = addEventListener('touchend', function () {\n          return cleanup();\n        });\n      };\n      var removeTouchStartListener = addEventListener('touchstart', handleTouchStart);\n      var cleanup = function cleanup() {\n        if (timer) {\n          clearTimeout(timer);\n        }\n        if (removeTouchMoveListener) {\n          removeTouchMoveListener();\n        }\n        if (removeTouchEndListener) {\n          removeTouchEndListener();\n        }\n        timer = null;\n        removeTouchMoveListener = null;\n        removeTouchEndListener = null;\n      };\n      if (initialEvent) {\n        handleTouchStart(initialEvent);\n      }\n      return function () {\n        cleanup();\n        removeTouchStartListener();\n      };\n    }\n\n    // Listen for mousedown and touchstart events. When one is received, disable the other and setup\n    // future event handling based on the type of event.\n  }, {\n    key: \"_addInitialEventListener\",\n    value: function _addInitialEventListener() {\n      var _this2 = this;\n      var removeMouseDownListener = addEventListener('mousedown', function (e) {\n        _this2._removeInitialEventListener();\n        _this2._handleInitialEvent(e);\n        _this2._removeInitialEventListener = addEventListener('mousedown', _this2._handleInitialEvent);\n      });\n      var removeTouchStartListener = addEventListener('touchstart', function (e) {\n        _this2._removeInitialEventListener();\n        _this2._removeInitialEventListener = _this2._addLongPressListener(_this2._handleInitialEvent, e);\n      });\n      this._removeInitialEventListener = function () {\n        removeMouseDownListener();\n        removeTouchStartListener();\n      };\n    }\n  }, {\n    key: \"_dropFromOutsideListener\",\n    value: function _dropFromOutsideListener(e) {\n      var _getEventCoordinates = getEventCoordinates(e),\n        pageX = _getEventCoordinates.pageX,\n        pageY = _getEventCoordinates.pageY,\n        clientX = _getEventCoordinates.clientX,\n        clientY = _getEventCoordinates.clientY;\n      this.emit('dropFromOutside', {\n        x: pageX,\n        y: pageY,\n        clientX: clientX,\n        clientY: clientY\n      });\n      e.preventDefault();\n    }\n  }, {\n    key: \"_dragOverFromOutsideListener\",\n    value: function _dragOverFromOutsideListener(e) {\n      var _getEventCoordinates2 = getEventCoordinates(e),\n        pageX = _getEventCoordinates2.pageX,\n        pageY = _getEventCoordinates2.pageY,\n        clientX = _getEventCoordinates2.clientX,\n        clientY = _getEventCoordinates2.clientY;\n      this.emit('dragOverFromOutside', {\n        x: pageX,\n        y: pageY,\n        clientX: clientX,\n        clientY: clientY\n      });\n      e.preventDefault();\n    }\n  }, {\n    key: \"_handleInitialEvent\",\n    value: function _handleInitialEvent(e) {\n      this._initialEvent = e;\n      if (this.isDetached) {\n        return;\n      }\n      var _getEventCoordinates3 = getEventCoordinates(e),\n        clientX = _getEventCoordinates3.clientX,\n        clientY = _getEventCoordinates3.clientY,\n        pageX = _getEventCoordinates3.pageX,\n        pageY = _getEventCoordinates3.pageY;\n      var node = this.container(),\n        collides,\n        offsetData;\n\n      // Right clicks\n      if (e.which === 3 || e.button === 2 || !isOverContainer(node, clientX, clientY)) return;\n      if (!this.globalMouse && node && !(0,dom_helpers_contains__WEBPACK_IMPORTED_MODULE_22__[\"default\"])(node, e.target)) {\n        var _normalizeDistance = normalizeDistance(0),\n          top = _normalizeDistance.top,\n          left = _normalizeDistance.left,\n          bottom = _normalizeDistance.bottom,\n          right = _normalizeDistance.right;\n        offsetData = getBoundsForNode(node);\n        collides = objectsCollide({\n          top: offsetData.top - top,\n          left: offsetData.left - left,\n          bottom: offsetData.bottom + bottom,\n          right: offsetData.right + right\n        }, {\n          top: pageY,\n          left: pageX\n        });\n        if (!collides) return;\n      }\n      var result = this.emit('beforeSelect', this._initialEventData = {\n        isTouch: /^touch/.test(e.type),\n        x: pageX,\n        y: pageY,\n        clientX: clientX,\n        clientY: clientY\n      });\n      if (result === false) return;\n      switch (e.type) {\n        case 'mousedown':\n          this._removeEndListener = addEventListener('mouseup', this._handleTerminatingEvent);\n          this._onEscListener = addEventListener('keydown', this._handleTerminatingEvent);\n          this._removeMoveListener = addEventListener('mousemove', this._handleMoveEvent);\n          break;\n        case 'touchstart':\n          this._handleMoveEvent(e);\n          this._removeEndListener = addEventListener('touchend', this._handleTerminatingEvent);\n          this._removeMoveListener = addEventListener('touchmove', this._handleMoveEvent);\n          break;\n      }\n    }\n\n    // Check whether provided event target element\n    // - is contained within a valid container\n  }, {\n    key: \"_isWithinValidContainer\",\n    value: function _isWithinValidContainer(e) {\n      var eventTarget = e.target;\n      var containers = this.validContainers;\n      if (!containers || !containers.length || !eventTarget) {\n        return true;\n      }\n      return containers.some(function (target) {\n        return !!eventTarget.closest(target);\n      });\n    }\n  }, {\n    key: \"_handleTerminatingEvent\",\n    value: function _handleTerminatingEvent(e) {\n      var selecting = this.selecting;\n      var bounds = this._selectRect;\n      // If it's not in selecting state, it's a click event\n      if (!selecting && e.type.includes('key')) {\n        e = this._initialEvent;\n      }\n      this.selecting = false;\n      this._removeEndListener && this._removeEndListener();\n      this._removeMoveListener && this._removeMoveListener();\n      this._selectRect = null;\n      this._initialEvent = null;\n      this._initialEventData = null;\n      if (!e) return;\n      var inRoot = !this.container || (0,dom_helpers_contains__WEBPACK_IMPORTED_MODULE_22__[\"default\"])(this.container(), e.target);\n      var isWithinValidContainer = this._isWithinValidContainer(e);\n      if (e.key === 'Escape' || !isWithinValidContainer) {\n        return this.emit('reset');\n      }\n      if (!selecting && inRoot) {\n        return this._handleClickEvent(e);\n      }\n\n      // User drag-clicked in the Selectable area\n      if (selecting) return this.emit('select', bounds);\n      return this.emit('reset');\n    }\n  }, {\n    key: \"_handleClickEvent\",\n    value: function _handleClickEvent(e) {\n      var _getEventCoordinates4 = getEventCoordinates(e),\n        pageX = _getEventCoordinates4.pageX,\n        pageY = _getEventCoordinates4.pageY,\n        clientX = _getEventCoordinates4.clientX,\n        clientY = _getEventCoordinates4.clientY;\n      var now = new Date().getTime();\n      if (this._lastClickData && now - this._lastClickData.timestamp < clickInterval) {\n        // Double click event\n        this._lastClickData = null;\n        return this.emit('doubleClick', {\n          x: pageX,\n          y: pageY,\n          clientX: clientX,\n          clientY: clientY\n        });\n      }\n\n      // Click event\n      this._lastClickData = {\n        timestamp: now\n      };\n      return this.emit('click', {\n        x: pageX,\n        y: pageY,\n        clientX: clientX,\n        clientY: clientY\n      });\n    }\n  }, {\n    key: \"_handleMoveEvent\",\n    value: function _handleMoveEvent(e) {\n      if (this._initialEventData === null || this.isDetached) {\n        return;\n      }\n      var _this$_initialEventDa = this._initialEventData,\n        x = _this$_initialEventDa.x,\n        y = _this$_initialEventDa.y;\n      var _getEventCoordinates5 = getEventCoordinates(e),\n        pageX = _getEventCoordinates5.pageX,\n        pageY = _getEventCoordinates5.pageY;\n      var w = Math.abs(x - pageX);\n      var h = Math.abs(y - pageY);\n      var left = Math.min(pageX, x),\n        top = Math.min(pageY, y),\n        old = this.selecting;\n      var click = this.isClick(pageX, pageY);\n      // Prevent emitting selectStart event until mouse is moved.\n      // in Chrome on Windows, mouseMove event may be fired just after mouseDown event.\n      if (click && !old && !(w || h)) {\n        return;\n      }\n      if (!old && !click) {\n        this.emit('selectStart', this._initialEventData);\n      }\n      if (!click) {\n        this.selecting = true;\n        this._selectRect = {\n          top: top,\n          left: left,\n          x: pageX,\n          y: pageY,\n          right: left + w,\n          bottom: top + h\n        };\n        this.emit('selecting', this._selectRect);\n      }\n      e.preventDefault();\n    }\n  }, {\n    key: \"_keyListener\",\n    value: function _keyListener(e) {\n      this.ctrl = e.metaKey || e.ctrlKey;\n    }\n  }, {\n    key: \"isClick\",\n    value: function isClick(pageX, pageY) {\n      var _this$_initialEventDa2 = this._initialEventData,\n        x = _this$_initialEventDa2.x,\n        y = _this$_initialEventDa2.y,\n        isTouch = _this$_initialEventDa2.isTouch;\n      return !isTouch && Math.abs(pageX - x) <= clickTolerance && Math.abs(pageY - y) <= clickTolerance;\n    }\n  }]);\n}();\n/**\n * Resolve the disance prop from either an Int or an Object\n * @return {Object}\n */\nfunction normalizeDistance() {\n  var distance = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  if ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(distance) !== 'object') distance = {\n    top: distance,\n    left: distance,\n    right: distance,\n    bottom: distance\n  };\n  return distance;\n}\n\n/**\n * Given two objects containing \"top\", \"left\", \"offsetWidth\" and \"offsetHeight\"\n * properties, determine if they collide.\n * @param  {Object|HTMLElement} a\n * @param  {Object|HTMLElement} b\n * @return {bool}\n */\nfunction objectsCollide(nodeA, nodeB) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var _getBoundsForNode = getBoundsForNode(nodeA),\n    aTop = _getBoundsForNode.top,\n    aLeft = _getBoundsForNode.left,\n    _getBoundsForNode$rig = _getBoundsForNode.right,\n    aRight = _getBoundsForNode$rig === void 0 ? aLeft : _getBoundsForNode$rig,\n    _getBoundsForNode$bot = _getBoundsForNode.bottom,\n    aBottom = _getBoundsForNode$bot === void 0 ? aTop : _getBoundsForNode$bot;\n  var _getBoundsForNode2 = getBoundsForNode(nodeB),\n    bTop = _getBoundsForNode2.top,\n    bLeft = _getBoundsForNode2.left,\n    _getBoundsForNode2$ri = _getBoundsForNode2.right,\n    bRight = _getBoundsForNode2$ri === void 0 ? bLeft : _getBoundsForNode2$ri,\n    _getBoundsForNode2$bo = _getBoundsForNode2.bottom,\n    bBottom = _getBoundsForNode2$bo === void 0 ? bTop : _getBoundsForNode2$bo;\n  return !(\n  // 'a' bottom doesn't touch 'b' top\n\n  aBottom - tolerance < bTop ||\n  // 'a' top doesn't touch 'b' bottom\n  aTop + tolerance > bBottom ||\n  // 'a' right doesn't touch 'b' left\n  aRight - tolerance < bLeft ||\n  // 'a' left doesn't touch 'b' right\n  aLeft + tolerance > bRight);\n}\n\n/**\n * Given a node, get everything needed to calculate its boundaries\n * @param  {HTMLElement} node\n * @return {Object}\n */\nfunction getBoundsForNode(node) {\n  if (!node.getBoundingClientRect) return node;\n  var rect = node.getBoundingClientRect(),\n    left = rect.left + pageOffset('left'),\n    top = rect.top + pageOffset('top');\n  return {\n    top: top,\n    left: left,\n    right: (node.offsetWidth || 0) + left,\n    bottom: (node.offsetHeight || 0) + top\n  };\n}\nfunction pageOffset(dir) {\n  if (dir === 'left') return window.pageXOffset || document.body.scrollLeft || 0;\n  if (dir === 'top') return window.pageYOffset || document.body.scrollTop || 0;\n}\n\nvar BackgroundCells = /*#__PURE__*/function (_React$Component) {\n  function BackgroundCells(props, context) {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, BackgroundCells);\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, BackgroundCells, [props, context]);\n    _this.state = {\n      selecting: false\n    };\n    _this.containerRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(BackgroundCells, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(BackgroundCells, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.selectable && this._selectable();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._teardownSelectable();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (!prevProps.selectable && this.props.selectable) this._selectable();\n      if (prevProps.selectable && !this.props.selectable) this._teardownSelectable();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        range = _this$props.range,\n        getNow = _this$props.getNow,\n        getters = _this$props.getters,\n        currentDate = _this$props.date,\n        Wrapper = _this$props.components.dateCellWrapper,\n        localizer = _this$props.localizer;\n      var _this$state = this.state,\n        selecting = _this$state.selecting,\n        startIdx = _this$state.startIdx,\n        endIdx = _this$state.endIdx;\n      var current = getNow();\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row-bg\",\n        ref: this.containerRef\n      }, range.map(function (date, index) {\n        var selected = selecting && index >= startIdx && index <= endIdx;\n        var _getters$dayProp = getters.dayProp(date),\n          className = _getters$dayProp.className,\n          style = _getters$dayProp.style;\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Wrapper, {\n          key: index,\n          value: date,\n          range: range\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          style: style,\n          className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-day-bg', className, selected && 'rbc-selected-cell', localizer.isSameDate(date, current) && 'rbc-today', currentDate && localizer.neq(currentDate, date, 'month') && 'rbc-off-range-bg')\n        }));\n      }));\n    }\n  }, {\n    key: \"_selectable\",\n    value: function _selectable() {\n      var _this2 = this;\n      var node = this.containerRef.current;\n      var selector = this._selector = new Selection(this.props.container, {\n        longPressThreshold: this.props.longPressThreshold\n      });\n      var selectorClicksHandler = function selectorClicksHandler(point, actionType) {\n        if (!isEvent(node, point) && !isShowMore(node, point)) {\n          var rowBox = getBoundsForNode(node);\n          var _this2$props = _this2.props,\n            range = _this2$props.range,\n            rtl = _this2$props.rtl;\n          if (pointInBox(rowBox, point)) {\n            var currentCell = getSlotAtX(rowBox, point.x, rtl, range.length);\n            _this2._selectSlot({\n              startIdx: currentCell,\n              endIdx: currentCell,\n              action: actionType,\n              box: point\n            });\n          }\n        }\n        _this2._initial = {};\n        _this2.setState({\n          selecting: false\n        });\n      };\n      selector.on('selecting', function (box) {\n        var _this2$props2 = _this2.props,\n          range = _this2$props2.range,\n          rtl = _this2$props2.rtl;\n        var startIdx = -1;\n        var endIdx = -1;\n        if (!_this2.state.selecting) {\n          notify(_this2.props.onSelectStart, [box]);\n          _this2._initial = {\n            x: box.x,\n            y: box.y\n          };\n        }\n        if (selector.isSelected(node)) {\n          var nodeBox = getBoundsForNode(node);\n          var _dateCellSelection = dateCellSelection(_this2._initial, nodeBox, box, range.length, rtl);\n          startIdx = _dateCellSelection.startIdx;\n          endIdx = _dateCellSelection.endIdx;\n        }\n        _this2.setState({\n          selecting: true,\n          startIdx: startIdx,\n          endIdx: endIdx\n        });\n      });\n      selector.on('beforeSelect', function (box) {\n        if (_this2.props.selectable !== 'ignoreEvents') return;\n        return !isEvent(_this2.containerRef.current, box);\n      });\n      selector.on('click', function (point) {\n        return selectorClicksHandler(point, 'click');\n      });\n      selector.on('doubleClick', function (point) {\n        return selectorClicksHandler(point, 'doubleClick');\n      });\n      selector.on('select', function (bounds) {\n        _this2._selectSlot((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, _this2.state), {}, {\n          action: 'select',\n          bounds: bounds\n        }));\n        _this2._initial = {};\n        _this2.setState({\n          selecting: false\n        });\n        notify(_this2.props.onSelectEnd, [_this2.state]);\n      });\n    }\n  }, {\n    key: \"_teardownSelectable\",\n    value: function _teardownSelectable() {\n      if (!this._selector) return;\n      this._selector.teardown();\n      this._selector = null;\n    }\n  }, {\n    key: \"_selectSlot\",\n    value: function _selectSlot(_ref) {\n      var endIdx = _ref.endIdx,\n        startIdx = _ref.startIdx,\n        action = _ref.action,\n        bounds = _ref.bounds,\n        box = _ref.box;\n      if (endIdx !== -1 && startIdx !== -1) this.props.onSelectSlot && this.props.onSelectSlot({\n        start: startIdx,\n        end: endIdx,\n        action: action,\n        bounds: bounds,\n        box: box,\n        resourceId: this.props.resourceId\n      });\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\n\n/* eslint-disable react/prop-types */\nvar EventRowMixin = {\n  propTypes: {\n    slotMetrics: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n    selected: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object),\n    isAllDay: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().bool),\n    accessors: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n    localizer: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n    components: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n    getters: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().object).isRequired,\n    onSelect: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n    onDoubleClick: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func),\n    onKeyPress: (prop_types__WEBPACK_IMPORTED_MODULE_44___default().func)\n  },\n  defaultProps: {\n    segments: [],\n    selected: {}\n  },\n  renderEvent: function renderEvent(props, event) {\n    var selected = props.selected;\n      props.isAllDay;\n      var accessors = props.accessors,\n      getters = props.getters,\n      onSelect = props.onSelect,\n      onDoubleClick = props.onDoubleClick,\n      onKeyPress = props.onKeyPress,\n      localizer = props.localizer,\n      slotMetrics = props.slotMetrics,\n      components = props.components,\n      resizable = props.resizable;\n    var continuesPrior = slotMetrics.continuesPrior(event);\n    var continuesAfter = slotMetrics.continuesAfter(event);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventCell, {\n      event: event,\n      getters: getters,\n      localizer: localizer,\n      accessors: accessors,\n      components: components,\n      onSelect: onSelect,\n      onDoubleClick: onDoubleClick,\n      onKeyPress: onKeyPress,\n      continuesPrior: continuesPrior,\n      continuesAfter: continuesAfter,\n      slotStart: slotMetrics.first,\n      slotEnd: slotMetrics.last,\n      selected: isSelected(event, selected),\n      resizable: resizable\n    });\n  },\n  renderSpan: function renderSpan(slots, len, key) {\n    var content = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ' ';\n    var per = Math.abs(len) / slots * 100 + '%';\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n      key: key,\n      className: \"rbc-row-segment\"\n      // IE10/11 need max-width. flex-basis doesn't respect box-sizing\n      ,\n      style: {\n        WebkitFlexBasis: per,\n        flexBasis: per,\n        maxWidth: per\n      }\n    }, content);\n  }\n};\n\nvar EventRow = /*#__PURE__*/function (_React$Component) {\n  function EventRow() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, EventRow);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, EventRow, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(EventRow, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(EventRow, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n      var _this$props = this.props,\n        segments = _this$props.segments,\n        slots = _this$props.slotMetrics.slots,\n        className = _this$props.className;\n      var lastEnd = 1;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(className, 'rbc-row')\n      }, segments.reduce(function (row, _ref, li) {\n        var event = _ref.event,\n          left = _ref.left,\n          right = _ref.right,\n          span = _ref.span;\n        var key = '_lvl_' + li;\n        var gap = left - lastEnd;\n        var content = EventRowMixin.renderEvent(_this.props, event);\n        if (gap) row.push(EventRowMixin.renderSpan(slots, gap, \"\".concat(key, \"_gap\")));\n        row.push(EventRowMixin.renderSpan(slots, span, key, content));\n        lastEnd = right + 1;\n        return row;\n      }, []));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nEventRow.defaultProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, EventRowMixin.defaultProps);\n\nfunction endOfRange(_ref) {\n  var dateRange = _ref.dateRange,\n    _ref$unit = _ref.unit,\n    unit = _ref$unit === void 0 ? 'day' : _ref$unit,\n    localizer = _ref.localizer;\n  return {\n    first: dateRange[0],\n    last: localizer.add(dateRange[dateRange.length - 1], 1, unit)\n  };\n}\n\n// properly calculating segments requires working with dates in\n// the timezone we're working with, so we use the localizer\nfunction eventSegments(event, range, accessors, localizer) {\n  var _endOfRange = endOfRange({\n      dateRange: range,\n      localizer: localizer\n    }),\n    first = _endOfRange.first,\n    last = _endOfRange.last;\n  var slots = localizer.diff(first, last, 'day');\n  var start = localizer.max(localizer.startOf(accessors.start(event), 'day'), first);\n  var end = localizer.min(localizer.ceil(accessors.end(event), 'day'), last);\n  var padding = lodash_findIndex__WEBPACK_IMPORTED_MODULE_25___default()(range, function (x) {\n    return localizer.isSameDate(x, start);\n  });\n  var span = localizer.diff(start, end, 'day');\n  span = Math.min(span, slots);\n  // The segmentOffset is necessary when adjusting for timezones\n  // ahead of the browser timezone\n  span = Math.max(span - localizer.segmentOffset, 1);\n  return {\n    event: event,\n    span: span,\n    left: padding + 1,\n    right: Math.max(padding + span, 1)\n  };\n}\nfunction eventLevels(rowSegments) {\n  var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Infinity;\n  var i,\n    j,\n    seg,\n    levels = [],\n    extra = [];\n  for (i = 0; i < rowSegments.length; i++) {\n    seg = rowSegments[i];\n    for (j = 0; j < levels.length; j++) if (!segsOverlap(seg, levels[j])) break;\n    if (j >= limit) {\n      extra.push(seg);\n    } else {\n      (levels[j] || (levels[j] = [])).push(seg);\n    }\n  }\n  for (i = 0; i < levels.length; i++) {\n    levels[i].sort(function (a, b) {\n      return a.left - b.left;\n    }); //eslint-disable-line\n  }\n  return {\n    levels: levels,\n    extra: extra\n  };\n}\nfunction inRange(e, start, end, accessors, localizer) {\n  var event = {\n    start: accessors.start(e),\n    end: accessors.end(e)\n  };\n  var range = {\n    start: start,\n    end: end\n  };\n  return localizer.inEventRange({\n    event: event,\n    range: range\n  });\n}\nfunction segsOverlap(seg, otherSegs) {\n  return otherSegs.some(function (otherSeg) {\n    return otherSeg.left <= seg.right && otherSeg.right >= seg.left;\n  });\n}\nfunction sortWeekEvents(events, accessors, localizer) {\n  var base = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_14__[\"default\"])(events);\n  var multiDayEvents = [];\n  var standardEvents = [];\n  base.forEach(function (event) {\n    var startCheck = accessors.start(event);\n    var endCheck = accessors.end(event);\n    if (localizer.daySpan(startCheck, endCheck) > 1) {\n      multiDayEvents.push(event);\n    } else {\n      standardEvents.push(event);\n    }\n  });\n  var multiSorted = multiDayEvents.sort(function (a, b) {\n    return sortEvents(a, b, accessors, localizer);\n  });\n  var standardSorted = standardEvents.sort(function (a, b) {\n    return sortEvents(a, b, accessors, localizer);\n  });\n  return [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_14__[\"default\"])(multiSorted), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_14__[\"default\"])(standardSorted));\n}\nfunction sortEvents(eventA, eventB, accessors, localizer) {\n  var evtA = {\n    start: accessors.start(eventA),\n    end: accessors.end(eventA),\n    allDay: accessors.allDay(eventA)\n  };\n  var evtB = {\n    start: accessors.start(eventB),\n    end: accessors.end(eventB),\n    allDay: accessors.allDay(eventB)\n  };\n  return localizer.sortEvents({\n    evtA: evtA,\n    evtB: evtB\n  });\n}\n\nvar isSegmentInSlot$1 = function isSegmentInSlot(seg, slot) {\n  return seg.left <= slot && seg.right >= slot;\n};\nvar eventsInSlot = function eventsInSlot(segments, slot) {\n  return segments.filter(function (seg) {\n    return isSegmentInSlot$1(seg, slot);\n  }).map(function (seg) {\n    return seg.event;\n  });\n};\nvar EventEndingRow = /*#__PURE__*/function (_React$Component) {\n  function EventEndingRow() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, EventEndingRow);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, EventEndingRow, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(EventEndingRow, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(EventEndingRow, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        segments = _this$props.segments,\n        slots = _this$props.slotMetrics.slots;\n      var rowSegments = eventLevels(segments).levels[0];\n      var current = 1,\n        lastEnd = 1,\n        row = [];\n      while (current <= slots) {\n        var key = '_lvl_' + current;\n        var _ref = rowSegments.filter(function (seg) {\n            return isSegmentInSlot$1(seg, current);\n          })[0] || {},\n          event = _ref.event,\n          left = _ref.left,\n          right = _ref.right,\n          span = _ref.span; //eslint-disable-line\n\n        if (!event) {\n          current++;\n          continue;\n        }\n        var gap = Math.max(0, left - lastEnd);\n        if (this.canRenderSlotEvent(left, span)) {\n          var content = EventRowMixin.renderEvent(this.props, event);\n          if (gap) {\n            row.push(EventRowMixin.renderSpan(slots, gap, key + '_gap'));\n          }\n          row.push(EventRowMixin.renderSpan(slots, span, key, content));\n          lastEnd = current = right + 1;\n        } else {\n          if (gap) {\n            row.push(EventRowMixin.renderSpan(slots, gap, key + '_gap'));\n          }\n          row.push(EventRowMixin.renderSpan(slots, 1, key, this.renderShowMore(segments, current)));\n          lastEnd = current = current + 1;\n        }\n      }\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row\"\n      }, row);\n    }\n  }, {\n    key: \"canRenderSlotEvent\",\n    value: function canRenderSlotEvent(slot, span) {\n      var segments = this.props.segments;\n      return lodash_range__WEBPACK_IMPORTED_MODULE_26___default()(slot, slot + span).every(function (s) {\n        var count = eventsInSlot(segments, s).length;\n        return count === 1;\n      });\n    }\n  }, {\n    key: \"renderShowMore\",\n    value: function renderShowMore(segments, slot) {\n      var _this = this;\n      var _this$props2 = this.props,\n        localizer = _this$props2.localizer,\n        slotMetrics = _this$props2.slotMetrics;\n      var events = slotMetrics.getEventsForSlot(slot);\n      var remainingEvents = eventsInSlot(segments, slot);\n      var count = remainingEvents.length;\n      return count ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n        type: \"button\",\n        key: 'sm_' + slot,\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-button-link', 'rbc-show-more'),\n        onClick: function onClick(e) {\n          return _this.showMore(slot, e);\n        }\n      }, localizer.messages.showMore(count, remainingEvents, events)) : false;\n    }\n  }, {\n    key: \"showMore\",\n    value: function showMore(slot, e) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.props.onShowMore(slot, e.target);\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nEventEndingRow.defaultProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, EventRowMixin.defaultProps);\n\nvar ScrollableWeekWrapper = function ScrollableWeekWrapper(_ref) {\n  var children = _ref.children;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: \"rbc-row-content-scroll-container\"\n  }, children);\n};\n\nvar isSegmentInSlot = function isSegmentInSlot(seg, slot) {\n  return seg.left <= slot && seg.right >= slot;\n};\nvar isEqual = function isEqual(a, b) {\n  return a[0].range === b[0].range && a[0].events === b[0].events;\n};\nfunction getSlotMetrics$1() {\n  return (0,memoize_one__WEBPACK_IMPORTED_MODULE_46__[\"default\"])(function (options) {\n    var range = options.range,\n      events = options.events,\n      maxRows = options.maxRows,\n      minRows = options.minRows,\n      accessors = options.accessors,\n      localizer = options.localizer;\n    var _endOfRange = endOfRange({\n        dateRange: range,\n        localizer: localizer\n      }),\n      first = _endOfRange.first,\n      last = _endOfRange.last;\n    var segments = events.map(function (evt) {\n      return eventSegments(evt, range, accessors, localizer);\n    });\n    var _eventLevels = eventLevels(segments, Math.max(maxRows - 1, 1)),\n      levels = _eventLevels.levels,\n      extra = _eventLevels.extra;\n    // Subtract 1 from minRows to not include showMore button row when\n    // it would be rendered\n    var minEventRows = extra.length > 0 ? minRows - 1 : minRows;\n    while (levels.length < minEventRows) levels.push([]);\n    return {\n      first: first,\n      last: last,\n      levels: levels,\n      extra: extra,\n      range: range,\n      slots: range.length,\n      clone: function clone(args) {\n        var metrics = getSlotMetrics$1();\n        return metrics((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, options), args));\n      },\n      getDateForSlot: function getDateForSlot(slotNumber) {\n        return range[slotNumber];\n      },\n      getSlotForDate: function getSlotForDate(date) {\n        return range.find(function (r) {\n          return localizer.isSameDate(r, date);\n        });\n      },\n      getEventsForSlot: function getEventsForSlot(slot) {\n        return segments.filter(function (seg) {\n          return isSegmentInSlot(seg, slot);\n        }).map(function (seg) {\n          return seg.event;\n        });\n      },\n      continuesPrior: function continuesPrior(event) {\n        return localizer.continuesPrior(accessors.start(event), first);\n      },\n      continuesAfter: function continuesAfter(event) {\n        var start = accessors.start(event);\n        var end = accessors.end(event);\n        return localizer.continuesAfter(start, end, last);\n      }\n    };\n  }, isEqual);\n}\n\nvar DateContentRow = /*#__PURE__*/function (_React$Component) {\n  function DateContentRow() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, DateContentRow);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, DateContentRow, [].concat(args));\n    _this.handleSelectSlot = function (slot) {\n      var _this$props = _this.props,\n        range = _this$props.range,\n        onSelectSlot = _this$props.onSelectSlot;\n      onSelectSlot(range.slice(slot.start, slot.end + 1), slot);\n    };\n    _this.handleShowMore = function (slot, target) {\n      var _this$props2 = _this.props,\n        range = _this$props2.range,\n        onShowMore = _this$props2.onShowMore;\n      var metrics = _this.slotMetrics(_this.props);\n      var row = (0,dom_helpers_querySelectorAll__WEBPACK_IMPORTED_MODULE_21__[\"default\"])(_this.containerRef.current, '.rbc-row-bg')[0];\n      var cell;\n      if (row) cell = row.children[slot - 1];\n      var events = metrics.getEventsForSlot(slot);\n      onShowMore(events, range[slot - 1], cell, slot, target);\n    };\n    _this.getContainer = function () {\n      var container = _this.props.container;\n      return container ? container() : _this.containerRef.current;\n    };\n    _this.renderHeadingCell = function (date, index) {\n      var _this$props3 = _this.props,\n        renderHeader = _this$props3.renderHeader,\n        getNow = _this$props3.getNow,\n        localizer = _this$props3.localizer;\n      return renderHeader({\n        date: date,\n        key: \"header_\".concat(index),\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-date-cell', localizer.isSameDate(date, getNow()) && 'rbc-now')\n      });\n    };\n    _this.renderDummy = function () {\n      var _this$props4 = _this.props,\n        className = _this$props4.className,\n        range = _this$props4.range,\n        renderHeader = _this$props4.renderHeader,\n        showAllEvents = _this$props4.showAllEvents;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: className,\n        ref: _this.containerRef\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-row-content', showAllEvents && 'rbc-row-content-scrollable')\n      }, renderHeader && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row\",\n        ref: _this.headingRowRef\n      }, range.map(_this.renderHeadingCell)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row\",\n        ref: _this.eventRowRef\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row-segment\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-event\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-event-content\"\n      }, \"\\xA0\"))))));\n    };\n    _this.containerRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    _this.headingRowRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    _this.eventRowRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    _this.slotMetrics = getSlotMetrics$1();\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(DateContentRow, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(DateContentRow, [{\n    key: \"getRowLimit\",\n    value: function getRowLimit() {\n      var _this$headingRowRef;\n      /* Guessing this only gets called on the dummyRow */\n      var eventHeight = (0,dom_helpers_height__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(this.eventRowRef.current);\n      var headingHeight = (_this$headingRowRef = this.headingRowRef) !== null && _this$headingRowRef !== void 0 && _this$headingRowRef.current ? (0,dom_helpers_height__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(this.headingRowRef.current) : 0;\n      var eventSpace = (0,dom_helpers_height__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(this.containerRef.current) - headingHeight;\n      return Math.max(Math.floor(eventSpace / eventHeight), 1);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props5 = this.props,\n        date = _this$props5.date,\n        rtl = _this$props5.rtl,\n        range = _this$props5.range,\n        className = _this$props5.className,\n        selected = _this$props5.selected,\n        selectable = _this$props5.selectable,\n        renderForMeasure = _this$props5.renderForMeasure,\n        accessors = _this$props5.accessors,\n        getters = _this$props5.getters,\n        components = _this$props5.components,\n        getNow = _this$props5.getNow,\n        renderHeader = _this$props5.renderHeader,\n        onSelect = _this$props5.onSelect,\n        localizer = _this$props5.localizer,\n        onSelectStart = _this$props5.onSelectStart,\n        onSelectEnd = _this$props5.onSelectEnd,\n        onDoubleClick = _this$props5.onDoubleClick,\n        onKeyPress = _this$props5.onKeyPress,\n        resourceId = _this$props5.resourceId,\n        longPressThreshold = _this$props5.longPressThreshold,\n        isAllDay = _this$props5.isAllDay,\n        resizable = _this$props5.resizable,\n        showAllEvents = _this$props5.showAllEvents;\n      if (renderForMeasure) return this.renderDummy();\n      var metrics = this.slotMetrics(this.props);\n      var levels = metrics.levels,\n        extra = metrics.extra;\n      var ScrollableWeekComponent = showAllEvents ? ScrollableWeekWrapper : NoopWrapper;\n      var WeekWrapper = components.weekWrapper;\n      var eventRowProps = {\n        selected: selected,\n        accessors: accessors,\n        getters: getters,\n        localizer: localizer,\n        components: components,\n        onSelect: onSelect,\n        onDoubleClick: onDoubleClick,\n        onKeyPress: onKeyPress,\n        resourceId: resourceId,\n        slotMetrics: metrics,\n        resizable: resizable\n      };\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: className,\n        role: \"rowgroup\",\n        ref: this.containerRef\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(BackgroundCells, {\n        localizer: localizer,\n        date: date,\n        getNow: getNow,\n        rtl: rtl,\n        range: range,\n        selectable: selectable,\n        container: this.getContainer,\n        getters: getters,\n        onSelectStart: onSelectStart,\n        onSelectEnd: onSelectEnd,\n        onSelectSlot: this.handleSelectSlot,\n        components: components,\n        longPressThreshold: longPressThreshold,\n        resourceId: resourceId\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-row-content', showAllEvents && 'rbc-row-content-scrollable'),\n        role: \"row\"\n      }, renderHeader && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row \",\n        ref: this.headingRowRef\n      }, range.map(this.renderHeadingCell)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(ScrollableWeekComponent, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(WeekWrapper, Object.assign({\n        isAllDay: isAllDay\n      }, eventRowProps, {\n        rtl: this.props.rtl\n      }), levels.map(function (segs, idx) {\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventRow, Object.assign({\n          key: idx,\n          segments: segs\n        }, eventRowProps));\n      }), !!extra.length && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventEndingRow, Object.assign({\n        segments: extra,\n        onShowMore: this.handleShowMore\n      }, eventRowProps))))));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nDateContentRow.defaultProps = {\n  minRows: 0,\n  maxRows: Infinity\n};\n\nvar Header = function Header(_ref) {\n  var label = _ref.label;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n    role: \"columnheader\",\n    \"aria-sort\": \"none\"\n  }, label);\n};\n\nvar DateHeader = function DateHeader(_ref) {\n  var label = _ref.label,\n    drilldownView = _ref.drilldownView,\n    onDrillDown = _ref.onDrillDown;\n  if (!drilldownView) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", null, label);\n  }\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n    type: \"button\",\n    className: \"rbc-button-link\",\n    onClick: onDrillDown,\n    role: \"cell\"\n  }, label);\n};\n\nvar _excluded$6 = [\"date\", \"className\"];\nvar eventsForWeek = function eventsForWeek(evts, start, end, accessors, localizer) {\n  return evts.filter(function (e) {\n    return inRange(e, start, end, accessors, localizer);\n  });\n};\nvar MonthView = /*#__PURE__*/function (_React$Component) {\n  function MonthView() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, MonthView);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, MonthView, [].concat(_args));\n    _this.getContainer = function () {\n      return _this.containerRef.current;\n    };\n    _this.renderWeek = function (week, weekIdx) {\n      var _this$props = _this.props,\n        events = _this$props.events,\n        components = _this$props.components,\n        selectable = _this$props.selectable,\n        getNow = _this$props.getNow,\n        selected = _this$props.selected,\n        date = _this$props.date,\n        localizer = _this$props.localizer,\n        longPressThreshold = _this$props.longPressThreshold,\n        accessors = _this$props.accessors,\n        getters = _this$props.getters,\n        showAllEvents = _this$props.showAllEvents;\n      var _this$state = _this.state,\n        needLimitMeasure = _this$state.needLimitMeasure,\n        rowLimit = _this$state.rowLimit;\n\n      // let's not mutate props\n      var weeksEvents = eventsForWeek((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_14__[\"default\"])(events), week[0], week[week.length - 1], accessors, localizer);\n      var sorted = sortWeekEvents(weeksEvents, accessors, localizer);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DateContentRow, {\n        key: weekIdx,\n        ref: weekIdx === 0 ? _this.slotRowRef : undefined,\n        container: _this.getContainer,\n        className: \"rbc-month-row\",\n        getNow: getNow,\n        date: date,\n        range: week,\n        events: sorted,\n        maxRows: showAllEvents ? Infinity : rowLimit,\n        selected: selected,\n        selectable: selectable,\n        components: components,\n        accessors: accessors,\n        getters: getters,\n        localizer: localizer,\n        renderHeader: _this.readerDateHeading,\n        renderForMeasure: needLimitMeasure,\n        onShowMore: _this.handleShowMore,\n        onSelect: _this.handleSelectEvent,\n        onDoubleClick: _this.handleDoubleClickEvent,\n        onKeyPress: _this.handleKeyPressEvent,\n        onSelectSlot: _this.handleSelectSlot,\n        longPressThreshold: longPressThreshold,\n        rtl: _this.props.rtl,\n        resizable: _this.props.resizable,\n        showAllEvents: showAllEvents\n      });\n    };\n    _this.readerDateHeading = function (_ref) {\n      var date = _ref.date,\n        className = _ref.className,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_ref, _excluded$6);\n      var _this$props2 = _this.props,\n        currentDate = _this$props2.date,\n        getDrilldownView = _this$props2.getDrilldownView,\n        localizer = _this$props2.localizer;\n      var isOffRange = localizer.neq(date, currentDate, 'month');\n      var isCurrent = localizer.isSameDate(date, currentDate);\n      var drilldownView = getDrilldownView(date);\n      var label = localizer.format(date, 'dateFormat');\n      var DateHeaderComponent = _this.props.components.dateHeader || DateHeader;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", Object.assign({}, props, {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(className, isOffRange && 'rbc-off-range', isCurrent && 'rbc-current'),\n        role: \"cell\"\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DateHeaderComponent, {\n        label: label,\n        date: date,\n        drilldownView: drilldownView,\n        isOffRange: isOffRange,\n        onDrillDown: function onDrillDown(e) {\n          return _this.handleHeadingClick(date, drilldownView, e);\n        }\n      }));\n    };\n    _this.handleSelectSlot = function (range, slotInfo) {\n      _this._pendingSelection = _this._pendingSelection.concat(range);\n      clearTimeout(_this._selectTimer);\n      _this._selectTimer = setTimeout(function () {\n        return _this.selectDates(slotInfo);\n      });\n    };\n    _this.handleHeadingClick = function (date, view, e) {\n      e.preventDefault();\n      _this.clearSelection();\n      notify(_this.props.onDrillDown, [date, view]);\n    };\n    _this.handleSelectEvent = function () {\n      _this.clearSelection();\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      notify(_this.props.onSelectEvent, args);\n    };\n    _this.handleDoubleClickEvent = function () {\n      _this.clearSelection();\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      notify(_this.props.onDoubleClickEvent, args);\n    };\n    _this.handleKeyPressEvent = function () {\n      _this.clearSelection();\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      notify(_this.props.onKeyPressEvent, args);\n    };\n    _this.handleShowMore = function (events, date, cell, slot, target) {\n      var _this$props3 = _this.props,\n        popup = _this$props3.popup,\n        onDrillDown = _this$props3.onDrillDown,\n        onShowMore = _this$props3.onShowMore,\n        getDrilldownView = _this$props3.getDrilldownView,\n        doShowMoreDrillDown = _this$props3.doShowMoreDrillDown;\n      //cancel any pending selections so only the event click goes through.\n      _this.clearSelection();\n      if (popup) {\n        var position = (0,dom_helpers_position__WEBPACK_IMPORTED_MODULE_16__[\"default\"])(cell, _this.containerRef.current);\n        _this.setState({\n          overlay: {\n            date: date,\n            events: events,\n            position: position,\n            target: target\n          }\n        });\n      } else if (doShowMoreDrillDown) {\n        notify(onDrillDown, [date, getDrilldownView(date) || views.DAY]);\n      }\n      notify(onShowMore, [events, date, slot]);\n    };\n    _this.overlayDisplay = function () {\n      _this.setState({\n        overlay: null\n      });\n    };\n    _this.state = {\n      rowLimit: 5,\n      needLimitMeasure: true,\n      date: null\n    };\n    _this.containerRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    _this.slotRowRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    _this._bgRows = [];\n    _this._pendingSelection = [];\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(MonthView, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(MonthView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      var running;\n      if (this.state.needLimitMeasure) this.measureRowLimit(this.props);\n      window.addEventListener('resize', this._resizeListener = function () {\n        if (!running) {\n          dom_helpers_animationFrame__WEBPACK_IMPORTED_MODULE_17__.request(function () {\n            running = false;\n            _this2.setState({\n              needLimitMeasure: true\n            }); //eslint-disable-line\n          });\n        }\n      }, false);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.state.needLimitMeasure) this.measureRowLimit(this.props);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this._resizeListener, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n        date = _this$props4.date,\n        localizer = _this$props4.localizer,\n        className = _this$props4.className,\n        month = localizer.visibleDays(date, localizer),\n        weeks = lodash_chunk__WEBPACK_IMPORTED_MODULE_15___default()(month, 7);\n      this._weekCount = weeks.length;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-month-view', className),\n        role: \"table\",\n        \"aria-label\": \"Month View\",\n        ref: this.containerRef\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-row rbc-month-header\",\n        role: \"row\"\n      }, this.renderHeaders(weeks[0])), weeks.map(this.renderWeek), this.props.popup && this.renderOverlay());\n    }\n  }, {\n    key: \"renderHeaders\",\n    value: function renderHeaders(row) {\n      var _this$props5 = this.props,\n        localizer = _this$props5.localizer,\n        components = _this$props5.components;\n      var first = row[0];\n      var last = row[row.length - 1];\n      var HeaderComponent = components.header || Header;\n      return localizer.range(first, last, 'day').map(function (day, idx) {\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          key: 'header_' + idx,\n          className: \"rbc-header\"\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(HeaderComponent, {\n          date: day,\n          localizer: localizer,\n          label: localizer.format(day, 'weekdayFormat')\n        }));\n      });\n    }\n  }, {\n    key: \"renderOverlay\",\n    value: function renderOverlay() {\n      var _this$state$overlay,\n        _this$state2,\n        _this3 = this;\n      var overlay = (_this$state$overlay = (_this$state2 = this.state) === null || _this$state2 === void 0 ? void 0 : _this$state2.overlay) !== null && _this$state$overlay !== void 0 ? _this$state$overlay : {};\n      var _this$props6 = this.props,\n        accessors = _this$props6.accessors,\n        localizer = _this$props6.localizer,\n        components = _this$props6.components,\n        getters = _this$props6.getters,\n        selected = _this$props6.selected,\n        popupOffset = _this$props6.popupOffset,\n        handleDragStart = _this$props6.handleDragStart;\n      var onHide = function onHide() {\n        return _this3.setState({\n          overlay: null\n        });\n      };\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(PopOverlay, {\n        overlay: overlay,\n        accessors: accessors,\n        localizer: localizer,\n        components: components,\n        getters: getters,\n        selected: selected,\n        popupOffset: popupOffset,\n        ref: this.containerRef,\n        handleKeyPressEvent: this.handleKeyPressEvent,\n        handleSelectEvent: this.handleSelectEvent,\n        handleDoubleClickEvent: this.handleDoubleClickEvent,\n        handleDragStart: handleDragStart,\n        show: !!overlay.position,\n        overlayDisplay: this.overlayDisplay,\n        onHide: onHide\n      });\n\n      /* return (\n        <Overlay\n          rootClose\n          placement=\"bottom\"\n          show={!!overlay.position}\n          onHide={() => this.setState({ overlay: null })}\n          target={() => overlay.target}\n        >\n          {({ props }) => (\n            <Popup\n              {...props}\n              popupOffset={popupOffset}\n              accessors={accessors}\n              getters={getters}\n              selected={selected}\n              components={components}\n              localizer={localizer}\n              position={overlay.position}\n              show={this.overlayDisplay}\n              events={overlay.events}\n              slotStart={overlay.date}\n              slotEnd={overlay.end}\n              onSelect={this.handleSelectEvent}\n              onDoubleClick={this.handleDoubleClickEvent}\n              onKeyPress={this.handleKeyPressEvent}\n              handleDragStart={this.props.handleDragStart}\n            />\n          )}\n        </Overlay>\n      ) */\n    }\n  }, {\n    key: \"measureRowLimit\",\n    value: function measureRowLimit() {\n      this.setState({\n        needLimitMeasure: false,\n        rowLimit: this.slotRowRef.current.getRowLimit()\n      });\n    }\n  }, {\n    key: \"selectDates\",\n    value: function selectDates(slotInfo) {\n      var slots = this._pendingSelection.slice();\n      this._pendingSelection = [];\n      slots.sort(function (a, b) {\n        return +a - +b;\n      });\n      var start = new Date(slots[0]);\n      var end = new Date(slots[slots.length - 1]);\n      end.setDate(slots[slots.length - 1].getDate() + 1);\n      notify(this.props.onSelectSlot, {\n        slots: slots,\n        start: start,\n        end: end,\n        action: slotInfo.action,\n        bounds: slotInfo.bounds,\n        box: slotInfo.box\n      });\n    }\n  }, {\n    key: \"clearSelection\",\n    value: function clearSelection() {\n      clearTimeout(this._selectTimer);\n      this._pendingSelection = [];\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(_ref2, state) {\n      var date = _ref2.date,\n        localizer = _ref2.localizer;\n      return {\n        date: date,\n        needLimitMeasure: localizer.neq(date, state.date, 'month')\n      };\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nMonthView.range = function (date, _ref3) {\n  var localizer = _ref3.localizer;\n  var start = localizer.firstVisibleDay(date, localizer);\n  var end = localizer.lastVisibleDay(date, localizer);\n  return {\n    start: start,\n    end: end\n  };\n};\nMonthView.navigate = function (date, action, _ref4) {\n  var localizer = _ref4.localizer;\n  switch (action) {\n    case navigate.PREVIOUS:\n      return localizer.add(date, -1, 'month');\n    case navigate.NEXT:\n      return localizer.add(date, 1, 'month');\n    default:\n      return date;\n  }\n};\nMonthView.title = function (date, _ref5) {\n  var localizer = _ref5.localizer;\n  return localizer.format(date, 'monthHeaderFormat');\n};\n\nvar getKey = function getKey(_ref) {\n  var min = _ref.min,\n    max = _ref.max,\n    step = _ref.step,\n    slots = _ref.slots,\n    localizer = _ref.localizer;\n  return \"\".concat(+localizer.startOf(min, 'minutes')) + \"\".concat(+localizer.startOf(max, 'minutes')) + \"\".concat(step, \"-\").concat(slots);\n};\nfunction getSlotMetrics(_ref2) {\n  var start = _ref2.min,\n    end = _ref2.max,\n    step = _ref2.step,\n    timeslots = _ref2.timeslots,\n    localizer = _ref2.localizer;\n  var key = getKey({\n    start: start,\n    end: end,\n    step: step,\n    timeslots: timeslots,\n    localizer: localizer\n  });\n\n  // DST differences are handled inside the localizer\n  var totalMin = 1 + localizer.getTotalMin(start, end);\n  var minutesFromMidnight = localizer.getMinutesFromMidnight(start);\n  var numGroups = Math.ceil((totalMin - 1) / (step * timeslots));\n  var numSlots = numGroups * timeslots;\n  var groups = new Array(numGroups);\n  var slots = new Array(numSlots);\n  // Each slot date is created from \"zero\", instead of adding `step` to\n  // the previous one, in order to avoid DST oddities\n  for (var grp = 0; grp < numGroups; grp++) {\n    groups[grp] = new Array(timeslots);\n    for (var slot = 0; slot < timeslots; slot++) {\n      var slotIdx = grp * timeslots + slot;\n      var minFromStart = slotIdx * step;\n      // A date with total minutes calculated from the start of the day\n      slots[slotIdx] = groups[grp][slot] = localizer.getSlotDate(start, minutesFromMidnight, minFromStart);\n    }\n  }\n\n  // Necessary to be able to select up until the last timeslot in a day\n  var lastSlotMinFromStart = slots.length * step;\n  slots.push(localizer.getSlotDate(start, minutesFromMidnight, lastSlotMinFromStart));\n  function positionFromDate(date) {\n    var diff = localizer.diff(start, date, 'minutes') + localizer.getDstOffset(start, date);\n    return Math.min(diff, totalMin);\n  }\n  return {\n    groups: groups,\n    update: function update(args) {\n      if (getKey(args) !== key) return getSlotMetrics(args);\n      return this;\n    },\n    dateIsInGroup: function dateIsInGroup(date, groupIndex) {\n      var nextGroup = groups[groupIndex + 1];\n      return localizer.inRange(date, groups[groupIndex][0], nextGroup ? nextGroup[0] : end, 'minutes');\n    },\n    nextSlot: function nextSlot(slot) {\n      // We cannot guarantee that the slot object must be in slots,\n      // because after each update, a new slots array will be created.\n      var next = slots[Math.min(slots.findIndex(function (s) {\n        return s === slot || localizer.eq(s, slot);\n      }) + 1, slots.length - 1)];\n      // in the case of the last slot we won't a long enough range so manually get it\n      if (localizer.eq(next, slot)) next = localizer.add(slot, step, 'minutes');\n      return next;\n    },\n    closestSlotToPosition: function closestSlotToPosition(percent) {\n      var slot = Math.min(slots.length - 1, Math.max(0, Math.floor(percent * numSlots)));\n      return slots[slot];\n    },\n    closestSlotFromPoint: function closestSlotFromPoint(point, boundaryRect) {\n      var range = Math.abs(boundaryRect.top - boundaryRect.bottom);\n      return this.closestSlotToPosition((point.y - boundaryRect.top) / range);\n    },\n    closestSlotFromDate: function closestSlotFromDate(date) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      if (localizer.lt(date, start, 'minutes')) return slots[0];\n      if (localizer.gt(date, end, 'minutes')) return slots[slots.length - 1];\n      var diffMins = localizer.diff(start, date, 'minutes');\n      return slots[(diffMins - diffMins % step) / step + offset];\n    },\n    startsBeforeDay: function startsBeforeDay(date) {\n      return localizer.lt(date, start, 'day');\n    },\n    startsAfterDay: function startsAfterDay(date) {\n      return localizer.gt(date, end, 'day');\n    },\n    startsBefore: function startsBefore(date) {\n      return localizer.lt(localizer.merge(start, date), start, 'minutes');\n    },\n    startsAfter: function startsAfter(date) {\n      return localizer.gt(localizer.merge(end, date), end, 'minutes');\n    },\n    getRange: function getRange(rangeStart, rangeEnd, ignoreMin, ignoreMax) {\n      if (!ignoreMin) rangeStart = localizer.min(end, localizer.max(start, rangeStart));\n      if (!ignoreMax) rangeEnd = localizer.min(end, localizer.max(start, rangeEnd));\n      var rangeStartMin = positionFromDate(rangeStart);\n      var rangeEndMin = positionFromDate(rangeEnd);\n      var top = rangeEndMin > step * numSlots && !localizer.eq(end, rangeEnd) ? (rangeStartMin - step) / (step * numSlots) * 100 : rangeStartMin / (step * numSlots) * 100;\n      return {\n        top: top,\n        height: rangeEndMin / (step * numSlots) * 100 - top,\n        start: positionFromDate(rangeStart),\n        startDate: rangeStart,\n        end: positionFromDate(rangeEnd),\n        endDate: rangeEnd\n      };\n    },\n    getCurrentTimePosition: function getCurrentTimePosition(rangeStart) {\n      var rangeStartMin = positionFromDate(rangeStart);\n      var top = rangeStartMin / (step * numSlots) * 100;\n      return top;\n    }\n  };\n}\n\nvar Event = /*#__PURE__*/function () {\n  function Event(data, _ref) {\n    var accessors = _ref.accessors,\n      slotMetrics = _ref.slotMetrics;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Event);\n    var _slotMetrics$getRange = slotMetrics.getRange(accessors.start(data), accessors.end(data)),\n      start = _slotMetrics$getRange.start,\n      startDate = _slotMetrics$getRange.startDate,\n      end = _slotMetrics$getRange.end,\n      endDate = _slotMetrics$getRange.endDate,\n      top = _slotMetrics$getRange.top,\n      height = _slotMetrics$getRange.height;\n    this.start = start;\n    this.end = end;\n    this.startMs = +startDate;\n    this.endMs = +endDate;\n    this.top = top;\n    this.height = height;\n    this.data = data;\n  }\n\n  /**\n   * The event's width without any overlap.\n   */\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Event, [{\n    key: \"_width\",\n    get: function get() {\n      // The container event's width is determined by the maximum number of\n      // events in any of its rows.\n      if (this.rows) {\n        var columns = this.rows.reduce(function (max, row) {\n          return Math.max(max, row.leaves.length + 1);\n        },\n        // add itself\n        0) + 1; // add the container\n\n        return 100 / columns;\n      }\n\n      // The row event's width is the space left by the container, divided\n      // among itself and its leaves.\n      if (this.leaves) {\n        var availableWidth = 100 - this.container._width;\n        return availableWidth / (this.leaves.length + 1);\n      }\n\n      // The leaf event's width is determined by its row's width\n      return this.row._width;\n    }\n\n    /**\n     * The event's calculated width, possibly with extra width added for\n     * overlapping effect.\n     */\n  }, {\n    key: \"width\",\n    get: function get() {\n      var noOverlap = this._width;\n      var overlap = Math.min(100, this._width * 1.7);\n\n      // Containers can always grow.\n      if (this.rows) {\n        return overlap;\n      }\n\n      // Rows can grow if they have leaves.\n      if (this.leaves) {\n        return this.leaves.length > 0 ? overlap : noOverlap;\n      }\n\n      // Leaves can grow unless they're the last item in a row.\n      var leaves = this.row.leaves;\n      var index = leaves.indexOf(this);\n      return index === leaves.length - 1 ? noOverlap : overlap;\n    }\n  }, {\n    key: \"xOffset\",\n    get: function get() {\n      // Containers have no offset.\n      if (this.rows) return 0;\n\n      // Rows always start where their container ends.\n      if (this.leaves) return this.container._width;\n\n      // Leaves are spread out evenly on the space left by its row.\n      var _this$row = this.row,\n        leaves = _this$row.leaves,\n        xOffset = _this$row.xOffset,\n        _width = _this$row._width;\n      var index = leaves.indexOf(this) + 1;\n      return xOffset + index * _width;\n    }\n  }]);\n}();\n/**\n * Return true if event a and b is considered to be on the same row.\n */\nfunction onSameRow(a, b, minimumStartDifference) {\n  return (\n    // Occupies the same start slot.\n    Math.abs(b.start - a.start) < minimumStartDifference ||\n    // A's start slot overlaps with b's end slot.\n    b.start > a.start && b.start < a.end\n  );\n}\nfunction sortByRender(events) {\n  var sortedByTime = lodash_sortBy__WEBPACK_IMPORTED_MODULE_27___default()(events, ['startMs', function (e) {\n    return -e.endMs;\n  }]);\n  var sorted = [];\n  while (sortedByTime.length > 0) {\n    var event = sortedByTime.shift();\n    sorted.push(event);\n    for (var i = 0; i < sortedByTime.length; i++) {\n      var test = sortedByTime[i];\n\n      // Still inside this event, look for next.\n      if (event.endMs > test.startMs) continue;\n\n      // We've found the first event of the next event group.\n      // If that event is not right next to our current event, we have to\n      // move it here.\n      if (i > 0) {\n        var _event = sortedByTime.splice(i, 1)[0];\n        sorted.push(_event);\n      }\n\n      // We've already found the next event group, so stop looking.\n      break;\n    }\n  }\n  return sorted;\n}\nfunction getStyledEvents$1(_ref2) {\n  var events = _ref2.events,\n    minimumStartDifference = _ref2.minimumStartDifference,\n    slotMetrics = _ref2.slotMetrics,\n    accessors = _ref2.accessors;\n  // Create proxy events and order them so that we don't have\n  // to fiddle with z-indexes.\n  var proxies = events.map(function (event) {\n    return new Event(event, {\n      slotMetrics: slotMetrics,\n      accessors: accessors\n    });\n  });\n  var eventsInRenderOrder = sortByRender(proxies);\n\n  // Group overlapping events, while keeping order.\n  // Every event is always one of: container, row or leaf.\n  // Containers can contain rows, and rows can contain leaves.\n  var containerEvents = [];\n  var _loop = function _loop() {\n    var event = eventsInRenderOrder[i];\n\n    // Check if this event can go into a container event.\n    var container = containerEvents.find(function (c) {\n      return c.end > event.start || Math.abs(event.start - c.start) < minimumStartDifference;\n    });\n\n    // Couldn't find a container  that means this event is a container.\n    if (!container) {\n      event.rows = [];\n      containerEvents.push(event);\n      return 1; // continue\n    }\n\n    // Found a container for the event.\n    event.container = container;\n\n    // Check if the event can be placed in an existing row.\n    // Start looking from behind.\n    var row = null;\n    for (var j = container.rows.length - 1; !row && j >= 0; j--) {\n      if (onSameRow(container.rows[j], event, minimumStartDifference)) {\n        row = container.rows[j];\n      }\n    }\n    if (row) {\n      // Found a row, so add it.\n      row.leaves.push(event);\n      event.row = row;\n    } else {\n      // Couldn't find a row  that means this event is a row.\n      event.leaves = [];\n      container.rows.push(event);\n    }\n  };\n  for (var i = 0; i < eventsInRenderOrder.length; i++) {\n    if (_loop()) continue;\n  }\n\n  // Return the original events, along with their styles.\n  return eventsInRenderOrder.map(function (event) {\n    return {\n      event: event.data,\n      style: {\n        top: event.top,\n        height: event.height,\n        width: event.width,\n        xOffset: Math.max(0, event.xOffset)\n      }\n    };\n  });\n}\n\nfunction getMaxIdxDFS(node, maxIdx, visited) {\n  for (var i = 0; i < node.friends.length; ++i) {\n    if (visited.indexOf(node.friends[i]) > -1) continue;\n    maxIdx = maxIdx > node.friends[i].idx ? maxIdx : node.friends[i].idx;\n    // TODO : trace it by not object but kinda index or something for performance\n    visited.push(node.friends[i]);\n    var newIdx = getMaxIdxDFS(node.friends[i], maxIdx, visited);\n    maxIdx = maxIdx > newIdx ? maxIdx : newIdx;\n  }\n  return maxIdx;\n}\nfunction noOverlap (_ref) {\n  var events = _ref.events,\n    minimumStartDifference = _ref.minimumStartDifference,\n    slotMetrics = _ref.slotMetrics,\n    accessors = _ref.accessors;\n  var styledEvents = getStyledEvents$1({\n    events: events,\n    minimumStartDifference: minimumStartDifference,\n    slotMetrics: slotMetrics,\n    accessors: accessors\n  });\n  styledEvents.sort(function (a, b) {\n    a = a.style;\n    b = b.style;\n    if (a.top !== b.top) return a.top > b.top ? 1 : -1;else if (a.height !== b.height) return a.top + a.height < b.top + b.height ? 1 : -1;else return 0;\n  });\n  for (var i = 0; i < styledEvents.length; ++i) {\n    styledEvents[i].friends = [];\n    delete styledEvents[i].style.left;\n    delete styledEvents[i].style.left;\n    delete styledEvents[i].idx;\n    delete styledEvents[i].size;\n  }\n  for (var _i2 = 0; _i2 < styledEvents.length - 1; ++_i2) {\n    var se1 = styledEvents[_i2];\n    var y1 = se1.style.top;\n    var y2 = se1.style.top + se1.style.height;\n    for (var j = _i2 + 1; j < styledEvents.length; ++j) {\n      var se2 = styledEvents[j];\n      var y3 = se2.style.top;\n      var y4 = se2.style.top + se2.style.height;\n      if (y3 >= y1 && y4 <= y2 || y4 > y1 && y4 <= y2 || y3 >= y1 && y3 < y2) {\n        // TODO : hashmap would be effective for performance\n        se1.friends.push(se2);\n        se2.friends.push(se1);\n      }\n    }\n  }\n  for (var _i4 = 0; _i4 < styledEvents.length; ++_i4) {\n    var se = styledEvents[_i4];\n    var bitmap = [];\n    for (var _j2 = 0; _j2 < 100; ++_j2) bitmap.push(1); // 1 means available\n\n    for (var _j4 = 0; _j4 < se.friends.length; ++_j4) if (se.friends[_j4].idx !== undefined) bitmap[se.friends[_j4].idx] = 0; // 0 means reserved\n\n    se.idx = bitmap.indexOf(1);\n  }\n  for (var _i6 = 0; _i6 < styledEvents.length; ++_i6) {\n    var size = 0;\n    if (styledEvents[_i6].size) continue;\n    var allFriends = [];\n    var maxIdx = getMaxIdxDFS(styledEvents[_i6], 0, allFriends);\n    size = 100 / (maxIdx + 1);\n    styledEvents[_i6].size = size;\n    for (var _j6 = 0; _j6 < allFriends.length; ++_j6) allFriends[_j6].size = size;\n  }\n  for (var _i8 = 0; _i8 < styledEvents.length; ++_i8) {\n    var e = styledEvents[_i8];\n    e.style.left = e.idx * e.size;\n\n    // stretch to maximum\n    var _maxIdx = 0;\n    for (var _j8 = 0; _j8 < e.friends.length; ++_j8) {\n      var idx = e.friends[_j8].idx;\n      _maxIdx = _maxIdx > idx ? _maxIdx : idx;\n    }\n    if (_maxIdx <= e.idx) e.size = 100 - e.idx * e.size;\n\n    // padding between events\n    // for this feature, `width` is not percentage based unit anymore\n    // it will be used with calc()\n    var padding = e.idx === 0 ? 0 : 3;\n    e.style.width = \"calc(\".concat(e.size, \"% - \").concat(padding, \"px)\");\n    e.style.height = \"calc(\".concat(e.style.height, \"% - 2px)\");\n    e.style.xOffset = \"calc(\".concat(e.style.left, \"% + \").concat(padding, \"px)\");\n  }\n  return styledEvents;\n}\n\n/*eslint no-unused-vars: \"off\"*/\n\nvar DefaultAlgorithms = {\n  overlap: getStyledEvents$1,\n  'no-overlap': noOverlap\n};\nfunction isFunction(a) {\n  return !!(a && a.constructor && a.call && a.apply);\n}\n\n//\nfunction getStyledEvents(_ref) {\n  _ref.events;\n    _ref.minimumStartDifference;\n    _ref.slotMetrics;\n    _ref.accessors;\n    var dayLayoutAlgorithm = _ref.dayLayoutAlgorithm;\n  var algorithm = dayLayoutAlgorithm;\n  if (dayLayoutAlgorithm in DefaultAlgorithms) algorithm = DefaultAlgorithms[dayLayoutAlgorithm];\n  if (!isFunction(algorithm)) {\n    // invalid algorithm\n    return [];\n  }\n  return algorithm.apply(this, arguments);\n}\n\nvar TimeSlotGroup = /*#__PURE__*/function (_Component) {\n  function TimeSlotGroup() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, TimeSlotGroup);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, TimeSlotGroup, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(TimeSlotGroup, _Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(TimeSlotGroup, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        renderSlot = _this$props.renderSlot,\n        resource = _this$props.resource,\n        group = _this$props.group,\n        getters = _this$props.getters,\n        _this$props$component = _this$props.components,\n        _this$props$component2 = _this$props$component === void 0 ? {} : _this$props$component,\n        _this$props$component3 = _this$props$component2.timeSlotWrapper,\n        Wrapper = _this$props$component3 === void 0 ? NoopWrapper : _this$props$component3;\n      var groupProps = getters ? getters.slotGroupProp(group) : {};\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", Object.assign({\n        className: \"rbc-timeslot-group\"\n      }, groupProps), group.map(function (value, idx) {\n        var slotProps = getters ? getters.slotProp(value, resource) : {};\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Wrapper, {\n          key: idx,\n          value: value,\n          resource: resource\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", Object.assign({}, slotProps, {\n          className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-time-slot', slotProps.className)\n        }), renderSlot && renderSlot(value, idx)));\n      }));\n    }\n  }]);\n}(react__WEBPACK_IMPORTED_MODULE_8__.Component);\n\nfunction stringifyPercent(v) {\n  return typeof v === 'string' ? v : v + '%';\n}\n\n/* eslint-disable react/prop-types */\nfunction TimeGridEvent(props) {\n  var style = props.style,\n    className = props.className,\n    event = props.event,\n    accessors = props.accessors,\n    rtl = props.rtl,\n    selected = props.selected,\n    label = props.label,\n    continuesPrior = props.continuesPrior,\n    continuesAfter = props.continuesAfter,\n    getters = props.getters,\n    onClick = props.onClick,\n    onDoubleClick = props.onDoubleClick,\n    isBackgroundEvent = props.isBackgroundEvent,\n    onKeyPress = props.onKeyPress,\n    _props$components = props.components,\n    Event = _props$components.event,\n    EventWrapper = _props$components.eventWrapper;\n  var title = accessors.title(event);\n  var tooltip = accessors.tooltip(event);\n  var end = accessors.end(event);\n  var start = accessors.start(event);\n  var userProps = getters.eventProp(event, start, end, selected);\n  var inner = [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    key: \"1\",\n    className: \"rbc-event-label\"\n  }, label), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    key: \"2\",\n    className: \"rbc-event-content\"\n  }, Event ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Event, {\n    event: event,\n    title: title\n  }) : title)];\n  var height = style.height,\n    top = style.top,\n    width = style.width,\n    xOffset = style.xOffset;\n  var eventStyle = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, userProps.style), {}, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])({\n    top: stringifyPercent(top),\n    height: stringifyPercent(height),\n    width: stringifyPercent(width)\n  }, rtl ? 'right' : 'left', stringifyPercent(xOffset)));\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventWrapper, Object.assign({\n    type: \"time\"\n  }, props), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    role: \"button\",\n    tabIndex: 0,\n    onClick: onClick,\n    onDoubleClick: onDoubleClick,\n    style: eventStyle,\n    onKeyDown: onKeyPress,\n    title: tooltip ? (typeof label === 'string' ? label + ': ' : '') + tooltip : undefined,\n    className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(isBackgroundEvent ? 'rbc-background-event' : 'rbc-event', className, userProps.className, {\n      'rbc-selected': selected,\n      'rbc-event-continues-earlier': continuesPrior,\n      'rbc-event-continues-later': continuesAfter\n    })\n  }, inner));\n}\n\nvar DayColumnWrapper = function DayColumnWrapper(_ref) {\n  var children = _ref.children,\n    className = _ref.className,\n    style = _ref.style,\n    innerRef = _ref.innerRef;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: innerRef\n  }, children);\n};\nvar DayColumnWrapper$1 = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().forwardRef(function (props, ref) {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DayColumnWrapper, Object.assign({}, props, {\n    innerRef: ref\n  }));\n});\n\nvar _excluded$5 = [\"dayProp\"],\n  _excluded2$1 = [\"eventContainerWrapper\"];\nvar DayColumn = /*#__PURE__*/function (_React$Component) {\n  function DayColumn() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, DayColumn);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, DayColumn, [].concat(_args));\n    _this.state = {\n      selecting: false,\n      timeIndicatorPosition: null\n    };\n    _this.intervalTriggered = false;\n    _this.renderEvents = function (_ref) {\n      var events = _ref.events,\n        isBackgroundEvent = _ref.isBackgroundEvent;\n      var _this$props = _this.props,\n        rtl = _this$props.rtl,\n        selected = _this$props.selected,\n        accessors = _this$props.accessors,\n        localizer = _this$props.localizer,\n        getters = _this$props.getters,\n        components = _this$props.components,\n        step = _this$props.step,\n        timeslots = _this$props.timeslots,\n        dayLayoutAlgorithm = _this$props.dayLayoutAlgorithm,\n        resizable = _this$props.resizable;\n      var _this2 = _this,\n        slotMetrics = _this2.slotMetrics;\n      var messages = localizer.messages;\n      var styledEvents = getStyledEvents({\n        events: events,\n        accessors: accessors,\n        slotMetrics: slotMetrics,\n        minimumStartDifference: Math.ceil(step * timeslots / 2),\n        dayLayoutAlgorithm: dayLayoutAlgorithm\n      });\n      return styledEvents.map(function (_ref2, idx) {\n        var event = _ref2.event,\n          style = _ref2.style;\n        var end = accessors.end(event);\n        var start = accessors.start(event);\n        var format = 'eventTimeRangeFormat';\n        var label;\n        var startsBeforeDay = slotMetrics.startsBeforeDay(start);\n        var startsAfterDay = slotMetrics.startsAfterDay(end);\n        if (startsBeforeDay) format = 'eventTimeRangeEndFormat';else if (startsAfterDay) format = 'eventTimeRangeStartFormat';\n        if (startsBeforeDay && startsAfterDay) label = messages.allDay;else label = localizer.format({\n          start: start,\n          end: end\n        }, format);\n        var continuesPrior = startsBeforeDay || slotMetrics.startsBefore(start);\n        var continuesAfter = startsAfterDay || slotMetrics.startsAfter(end);\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGridEvent, {\n          style: style,\n          event: event,\n          label: label,\n          key: 'evt_' + idx,\n          getters: getters,\n          rtl: rtl,\n          components: components,\n          continuesPrior: continuesPrior,\n          continuesAfter: continuesAfter,\n          accessors: accessors,\n          resource: _this.props.resource,\n          selected: isSelected(event, selected),\n          onClick: function onClick(e) {\n            return _this._select((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, event), _this.props.resource && {\n              sourceResource: _this.props.resource\n            }), isBackgroundEvent && {\n              isBackgroundEvent: true\n            }), e);\n          },\n          onDoubleClick: function onDoubleClick(e) {\n            return _this._doubleClick(event, e);\n          },\n          isBackgroundEvent: isBackgroundEvent,\n          onKeyPress: function onKeyPress(e) {\n            return _this._keyPress(event, e);\n          },\n          resizable: resizable\n        });\n      });\n    };\n    _this._selectable = function () {\n      var node = _this.containerRef.current;\n      var _this$props2 = _this.props,\n        longPressThreshold = _this$props2.longPressThreshold,\n        localizer = _this$props2.localizer;\n      var selector = _this._selector = new Selection(function () {\n        return node;\n      }, {\n        longPressThreshold: longPressThreshold\n      });\n      var maybeSelect = function maybeSelect(box) {\n        var onSelecting = _this.props.onSelecting;\n        var current = _this.state || {};\n        var state = selectionState(box);\n        var start = state.startDate,\n          end = state.endDate;\n        if (onSelecting) {\n          if (localizer.eq(current.startDate, start, 'minutes') && localizer.eq(current.endDate, end, 'minutes') || onSelecting({\n            start: start,\n            end: end,\n            resourceId: _this.props.resource\n          }) === false) return;\n        }\n        if (_this.state.start !== state.start || _this.state.end !== state.end || _this.state.selecting !== state.selecting) {\n          _this.setState(state);\n        }\n      };\n      var selectionState = function selectionState(point) {\n        var currentSlot = _this.slotMetrics.closestSlotFromPoint(point, getBoundsForNode(node));\n        if (!_this.state.selecting) {\n          _this._initialSlot = currentSlot;\n        }\n        var initialSlot = _this._initialSlot;\n        if (localizer.lte(initialSlot, currentSlot)) {\n          currentSlot = _this.slotMetrics.nextSlot(currentSlot);\n        } else if (localizer.gt(initialSlot, currentSlot)) {\n          initialSlot = _this.slotMetrics.nextSlot(initialSlot);\n        }\n        var selectRange = _this.slotMetrics.getRange(localizer.min(initialSlot, currentSlot), localizer.max(initialSlot, currentSlot));\n        return (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, selectRange), {}, {\n          selecting: true,\n          top: \"\".concat(selectRange.top, \"%\"),\n          height: \"\".concat(selectRange.height, \"%\")\n        });\n      };\n      var selectorClicksHandler = function selectorClicksHandler(box, actionType) {\n        if (!isEvent(_this.containerRef.current, box)) {\n          var _selectionState = selectionState(box),\n            startDate = _selectionState.startDate,\n            endDate = _selectionState.endDate;\n          _this._selectSlot({\n            startDate: startDate,\n            endDate: endDate,\n            action: actionType,\n            box: box\n          });\n        }\n        _this.setState({\n          selecting: false\n        });\n      };\n      selector.on('selecting', maybeSelect);\n      selector.on('selectStart', maybeSelect);\n      selector.on('beforeSelect', function (box) {\n        if (_this.props.selectable !== 'ignoreEvents') return;\n        return !isEvent(_this.containerRef.current, box);\n      });\n      selector.on('click', function (box) {\n        return selectorClicksHandler(box, 'click');\n      });\n      selector.on('doubleClick', function (box) {\n        return selectorClicksHandler(box, 'doubleClick');\n      });\n      selector.on('select', function (bounds) {\n        if (_this.state.selecting) {\n          _this._selectSlot((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, _this.state), {}, {\n            action: 'select',\n            bounds: bounds\n          }));\n          _this.setState({\n            selecting: false\n          });\n        }\n      });\n      selector.on('reset', function () {\n        if (_this.state.selecting) {\n          _this.setState({\n            selecting: false\n          });\n        }\n      });\n    };\n    _this._teardownSelectable = function () {\n      if (!_this._selector) return;\n      _this._selector.teardown();\n      _this._selector = null;\n    };\n    _this._selectSlot = function (_ref3) {\n      var startDate = _ref3.startDate,\n        endDate = _ref3.endDate,\n        action = _ref3.action,\n        bounds = _ref3.bounds,\n        box = _ref3.box;\n      var current = startDate,\n        slots = [];\n      while (_this.props.localizer.lte(current, endDate)) {\n        slots.push(current);\n        current = new Date(+current + _this.props.step * 60 * 1000); // using Date ensures not to create an endless loop the day DST begins\n      }\n      notify(_this.props.onSelectSlot, {\n        slots: slots,\n        start: startDate,\n        end: endDate,\n        resourceId: _this.props.resource,\n        action: action,\n        bounds: bounds,\n        box: box\n      });\n    };\n    _this._select = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      notify(_this.props.onSelectEvent, args);\n    };\n    _this._doubleClick = function () {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      notify(_this.props.onDoubleClickEvent, args);\n    };\n    _this._keyPress = function () {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      notify(_this.props.onKeyPressEvent, args);\n    };\n    _this.slotMetrics = getSlotMetrics(_this.props);\n    _this.containerRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(DayColumn, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(DayColumn, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.selectable && this._selectable();\n      if (this.props.isNow) {\n        this.setTimeIndicatorPositionUpdateInterval();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._teardownSelectable();\n      this.clearTimeIndicatorInterval();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.selectable && !prevProps.selectable) this._selectable();\n      if (!this.props.selectable && prevProps.selectable) this._teardownSelectable();\n      var _this$props3 = this.props,\n        getNow = _this$props3.getNow,\n        isNow = _this$props3.isNow,\n        localizer = _this$props3.localizer,\n        date = _this$props3.date,\n        min = _this$props3.min,\n        max = _this$props3.max;\n      var getNowChanged = localizer.neq(prevProps.getNow(), getNow(), 'minutes');\n      if (prevProps.isNow !== isNow || getNowChanged) {\n        this.clearTimeIndicatorInterval();\n        if (isNow) {\n          var tail = !getNowChanged && localizer.eq(prevProps.date, date, 'minutes') && prevState.timeIndicatorPosition === this.state.timeIndicatorPosition;\n          this.setTimeIndicatorPositionUpdateInterval(tail);\n        }\n      } else if (isNow && (localizer.neq(prevProps.min, min, 'minutes') || localizer.neq(prevProps.max, max, 'minutes'))) {\n        this.positionTimeIndicator();\n      }\n    }\n\n    /**\n     * @param tail {Boolean} - whether `positionTimeIndicator` call should be\n     *   deferred or called upon setting interval (`true` - if deferred);\n     */\n  }, {\n    key: \"setTimeIndicatorPositionUpdateInterval\",\n    value: function setTimeIndicatorPositionUpdateInterval() {\n      var _this3 = this;\n      var tail = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!this.intervalTriggered && !tail) {\n        this.positionTimeIndicator();\n      }\n      this._timeIndicatorTimeout = window.setTimeout(function () {\n        _this3.intervalTriggered = true;\n        _this3.positionTimeIndicator();\n        _this3.setTimeIndicatorPositionUpdateInterval();\n      }, 60000);\n    }\n  }, {\n    key: \"clearTimeIndicatorInterval\",\n    value: function clearTimeIndicatorInterval() {\n      this.intervalTriggered = false;\n      window.clearTimeout(this._timeIndicatorTimeout);\n    }\n  }, {\n    key: \"positionTimeIndicator\",\n    value: function positionTimeIndicator() {\n      var _this$props4 = this.props,\n        min = _this$props4.min,\n        max = _this$props4.max,\n        getNow = _this$props4.getNow;\n      var current = getNow();\n      if (current >= min && current <= max) {\n        var top = this.slotMetrics.getCurrentTimePosition(current);\n        this.intervalTriggered = true;\n        this.setState({\n          timeIndicatorPosition: top\n        });\n      } else {\n        this.clearTimeIndicatorInterval();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props5 = this.props,\n        date = _this$props5.date,\n        max = _this$props5.max,\n        rtl = _this$props5.rtl,\n        isNow = _this$props5.isNow,\n        resource = _this$props5.resource,\n        accessors = _this$props5.accessors,\n        localizer = _this$props5.localizer,\n        _this$props5$getters = _this$props5.getters,\n        dayProp = _this$props5$getters.dayProp,\n        getters = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props5$getters, _excluded$5),\n        _this$props5$componen = _this$props5.components,\n        EventContainer = _this$props5$componen.eventContainerWrapper,\n        components = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props5$componen, _excluded2$1);\n      this.slotMetrics = this.slotMetrics.update(this.props);\n      var slotMetrics = this.slotMetrics;\n      var _this$state = this.state,\n        selecting = _this$state.selecting,\n        top = _this$state.top,\n        height = _this$state.height,\n        startDate = _this$state.startDate,\n        endDate = _this$state.endDate;\n      var selectDates = {\n        start: startDate,\n        end: endDate\n      };\n      var _dayProp = dayProp(max),\n        className = _dayProp.className,\n        style = _dayProp.style;\n      var DayColumnWrapperComponent = components.dayColumnWrapper || DayColumnWrapper$1;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DayColumnWrapperComponent, {\n        ref: this.containerRef,\n        date: date,\n        style: style,\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(className, 'rbc-day-slot', 'rbc-time-column', isNow && 'rbc-now', isNow && 'rbc-today',\n        // WHY\n        selecting && 'rbc-slot-selecting'),\n        slotMetrics: slotMetrics,\n        resource: resource\n      }, slotMetrics.groups.map(function (grp, idx) {\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeSlotGroup, {\n          key: idx,\n          group: grp,\n          resource: resource,\n          getters: getters,\n          components: components\n        });\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(EventContainer, {\n        localizer: localizer,\n        resource: resource,\n        accessors: accessors,\n        getters: getters,\n        components: components,\n        slotMetrics: slotMetrics\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-events-container', rtl && 'rtl')\n      }, this.renderEvents({\n        events: this.props.backgroundEvents,\n        isBackgroundEvent: true\n      }), this.renderEvents({\n        events: this.props.events\n      }))), selecting && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-slot-selection\",\n        style: {\n          top: top,\n          height: height\n        }\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", null, localizer.format(selectDates, 'selectRangeFormat'))), isNow && this.intervalTriggered && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-current-time-indicator\",\n        style: {\n          top: \"\".concat(this.state.timeIndicatorPosition, \"%\")\n        }\n      }));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nDayColumn.defaultProps = {\n  dragThroughEvents: true,\n  timeslots: 2\n};\n\n/**\n * Since the TimeGutter only displays the 'times' of slots in a day, and is separate\n * from the Day Columns themselves, we check to see if the range contains an offset difference\n * and, if so, change the beginning and end 'date' by a day to properly display the slots times\n * used.\n */\nfunction adjustForDST(_ref) {\n  var min = _ref.min,\n    max = _ref.max,\n    localizer = _ref.localizer;\n  if (localizer.getTimezoneOffset(min) !== localizer.getTimezoneOffset(max)) {\n    return {\n      start: localizer.add(min, -1, 'day'),\n      end: localizer.add(max, -1, 'day')\n    };\n  }\n  return {\n    start: min,\n    end: max\n  };\n}\nvar TimeGutter = function TimeGutter(_ref2) {\n  var min = _ref2.min,\n    max = _ref2.max,\n    timeslots = _ref2.timeslots,\n    step = _ref2.step,\n    localizer = _ref2.localizer,\n    getNow = _ref2.getNow,\n    resource = _ref2.resource,\n    components = _ref2.components,\n    getters = _ref2.getters,\n    gutterRef = _ref2.gutterRef;\n  var TimeGutterWrapper = components.timeGutterWrapper;\n  var _useMemo = (0,react__WEBPACK_IMPORTED_MODULE_8__.useMemo)(function () {\n      return adjustForDST({\n        min: min,\n        max: max,\n        localizer: localizer\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [min === null || min === void 0 ? void 0 : min.toISOString(), max === null || max === void 0 ? void 0 : max.toISOString(), localizer]),\n    start = _useMemo.start,\n    end = _useMemo.end;\n  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_8__.useState)(getSlotMetrics({\n      min: start,\n      max: end,\n      timeslots: timeslots,\n      step: step,\n      localizer: localizer\n    })),\n    _useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_useState, 2),\n    slotMetrics = _useState2[0],\n    setSlotMetrics = _useState2[1];\n  (0,react__WEBPACK_IMPORTED_MODULE_8__.useEffect)(function () {\n    if (slotMetrics) {\n      setSlotMetrics(slotMetrics.update({\n        min: start,\n        max: end,\n        timeslots: timeslots,\n        step: step,\n        localizer: localizer\n      }));\n    }\n    /**\n     * We don't want this to fire when slotMetrics is updated as it would recursively bomb\n     */\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [start === null || start === void 0 ? void 0 : start.toISOString(), end === null || end === void 0 ? void 0 : end.toISOString(), timeslots, step]);\n  var renderSlot = (0,react__WEBPACK_IMPORTED_MODULE_8__.useCallback)(function (value, idx) {\n    if (idx) return null; // don't return the first (0) idx\n\n    var isNow = slotMetrics.dateIsInGroup(getNow(), idx);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n      className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-label', isNow && 'rbc-now')\n    }, localizer.format(value, 'timeGutterFormat'));\n  }, [slotMetrics, localizer, getNow]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGutterWrapper, {\n    slotMetrics: slotMetrics\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: \"rbc-time-gutter rbc-time-column\",\n    ref: gutterRef\n  }, slotMetrics.groups.map(function (grp, idx) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeSlotGroup, {\n      key: idx,\n      group: grp,\n      resource: resource,\n      components: components,\n      renderSlot: renderSlot,\n      getters: getters\n    });\n  })));\n};\nvar TimeGutter$1 = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().forwardRef(function (props, ref) {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGutter, Object.assign({\n    gutterRef: ref\n  }, props));\n});\n\nvar ResourceHeader = function ResourceHeader(_ref) {\n  var label = _ref.label;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement((react__WEBPACK_IMPORTED_MODULE_8___default().Fragment), null, label);\n};\n\nvar TimeGridHeader = /*#__PURE__*/function (_React$Component) {\n  function TimeGridHeader() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, TimeGridHeader);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, TimeGridHeader, [].concat(args));\n    _this.handleHeaderClick = function (date, view, e) {\n      e.preventDefault();\n      notify(_this.props.onDrillDown, [date, view]);\n    };\n    _this.renderRow = function (resource) {\n      var _this$props = _this.props,\n        events = _this$props.events,\n        rtl = _this$props.rtl,\n        selectable = _this$props.selectable,\n        getNow = _this$props.getNow,\n        range = _this$props.range,\n        getters = _this$props.getters,\n        localizer = _this$props.localizer,\n        accessors = _this$props.accessors,\n        components = _this$props.components,\n        resizable = _this$props.resizable;\n      var resourceId = accessors.resourceId(resource);\n      var eventsToDisplay = resource ? events.filter(function (event) {\n        return accessors.resource(event) === resourceId;\n      }) : events;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DateContentRow, {\n        isAllDay: true,\n        rtl: rtl,\n        getNow: getNow,\n        minRows: 2\n        // Add +1 to include showMore button row in the row limit\n        ,\n        maxRows: _this.props.allDayMaxRows + 1,\n        range: range,\n        events: eventsToDisplay,\n        resourceId: resourceId,\n        className: \"rbc-allday-cell\",\n        selectable: selectable,\n        selected: _this.props.selected,\n        components: components,\n        accessors: accessors,\n        getters: getters,\n        localizer: localizer,\n        onSelect: _this.props.onSelectEvent,\n        onShowMore: _this.props.onShowMore,\n        onDoubleClick: _this.props.onDoubleClickEvent,\n        onKeyPress: _this.props.onKeyPressEvent,\n        onSelectSlot: _this.props.onSelectSlot,\n        longPressThreshold: _this.props.longPressThreshold,\n        resizable: resizable\n      });\n    };\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(TimeGridHeader, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(TimeGridHeader, [{\n    key: \"renderHeaderCells\",\n    value: function renderHeaderCells(range) {\n      var _this2 = this;\n      var _this$props2 = this.props,\n        localizer = _this$props2.localizer,\n        getDrilldownView = _this$props2.getDrilldownView,\n        getNow = _this$props2.getNow,\n        dayProp = _this$props2.getters.dayProp,\n        _this$props2$componen = _this$props2.components.header,\n        HeaderComponent = _this$props2$componen === void 0 ? Header : _this$props2$componen;\n      var today = getNow();\n      return range.map(function (date, i) {\n        var drilldownView = getDrilldownView(date);\n        var label = localizer.format(date, 'dayFormat');\n        var _dayProp = dayProp(date),\n          className = _dayProp.className,\n          style = _dayProp.style;\n        var header = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(HeaderComponent, {\n          date: date,\n          label: label,\n          localizer: localizer\n        });\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          key: i,\n          style: style,\n          className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-header', className, localizer.isSameDate(date, today) && 'rbc-today')\n        }, drilldownView ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n          type: \"button\",\n          className: \"rbc-button-link\",\n          onClick: function onClick(e) {\n            return _this2.handleHeaderClick(date, drilldownView, e);\n          }\n        }, header) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", null, header));\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      var _this$props3 = this.props,\n        width = _this$props3.width,\n        rtl = _this$props3.rtl,\n        resources = _this$props3.resources,\n        range = _this$props3.range,\n        events = _this$props3.events,\n        getNow = _this$props3.getNow,\n        accessors = _this$props3.accessors,\n        selectable = _this$props3.selectable,\n        components = _this$props3.components,\n        getters = _this$props3.getters,\n        scrollRef = _this$props3.scrollRef,\n        localizer = _this$props3.localizer,\n        isOverflowing = _this$props3.isOverflowing,\n        _this$props3$componen = _this$props3.components,\n        TimeGutterHeader = _this$props3$componen.timeGutterHeader,\n        _this$props3$componen2 = _this$props3$componen.resourceHeader,\n        ResourceHeaderComponent = _this$props3$componen2 === void 0 ? ResourceHeader : _this$props3$componen2,\n        resizable = _this$props3.resizable;\n      var style = {};\n      if (isOverflowing) {\n        style[rtl ? 'marginLeft' : 'marginRight'] = \"\".concat((0,dom_helpers_scrollbarSize__WEBPACK_IMPORTED_MODULE_28__[\"default\"])() - 1, \"px\");\n      }\n      var groupedEvents = resources.groupEvents(events);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        style: style,\n        ref: scrollRef,\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-time-header', isOverflowing && 'rbc-overflowing')\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-label rbc-time-header-gutter\",\n        style: {\n          width: width,\n          minWidth: width,\n          maxWidth: width\n        }\n      }, TimeGutterHeader && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGutterHeader, null)), resources.map(function (_ref, idx) {\n        var _ref2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_ref, 2),\n          id = _ref2[0],\n          resource = _ref2[1];\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          className: \"rbc-time-header-content\",\n          key: id || idx\n        }, resource && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          className: \"rbc-row rbc-row-resource\",\n          key: \"resource_\".concat(idx)\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          className: \"rbc-header\"\n        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(ResourceHeaderComponent, {\n          index: idx,\n          label: accessors.resourceTitle(resource),\n          resource: resource\n        }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n          className: \"rbc-row rbc-time-header-cell\".concat(range.length <= 1 ? ' rbc-time-header-cell-single-day' : '')\n        }, _this3.renderHeaderCells(range)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DateContentRow, {\n          isAllDay: true,\n          rtl: rtl,\n          getNow: getNow,\n          minRows: 2\n          // Add +1 to include showMore button row in the row limit\n          ,\n          maxRows: _this3.props.allDayMaxRows + 1,\n          range: range,\n          events: groupedEvents.get(id) || [],\n          resourceId: resource && id,\n          className: \"rbc-allday-cell\",\n          selectable: selectable,\n          selected: _this3.props.selected,\n          components: components,\n          accessors: accessors,\n          getters: getters,\n          localizer: localizer,\n          onSelect: _this3.props.onSelectEvent,\n          onShowMore: _this3.props.onShowMore,\n          onDoubleClick: _this3.props.onDoubleClickEvent,\n          onKeyDown: _this3.props.onKeyPressEvent,\n          onSelectSlot: _this3.props.onSelectSlot,\n          longPressThreshold: _this3.props.longPressThreshold,\n          resizable: resizable\n        }));\n      }));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\n\nvar NONE = {};\nfunction Resources(resources, accessors) {\n  return {\n    map: function map(fn) {\n      if (!resources) return [fn([NONE, null], 0)];\n      return resources.map(function (resource, idx) {\n        return fn([accessors.resourceId(resource), resource], idx);\n      });\n    },\n    groupEvents: function groupEvents(events) {\n      var eventsByResource = new Map();\n      if (!resources) {\n        // Return all events if resources are not provided\n        eventsByResource.set(NONE, events);\n        return eventsByResource;\n      }\n      events.forEach(function (event) {\n        var id = accessors.resource(event) || NONE;\n        if (Array.isArray(id)) {\n          id.forEach(function (item) {\n            var resourceEvents = eventsByResource.get(item) || [];\n            resourceEvents.push(event);\n            eventsByResource.set(item, resourceEvents);\n          });\n        } else {\n          var resourceEvents = eventsByResource.get(id) || [];\n          resourceEvents.push(event);\n          eventsByResource.set(id, resourceEvents);\n        }\n      });\n      return eventsByResource;\n    }\n  };\n}\n\nvar TimeGrid = /*#__PURE__*/function (_Component) {\n  function TimeGrid(props) {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, TimeGrid);\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, TimeGrid, [props]);\n    _this.handleScroll = function (e) {\n      if (_this.scrollRef.current) {\n        _this.scrollRef.current.scrollLeft = e.target.scrollLeft;\n      }\n    };\n    _this.handleResize = function () {\n      dom_helpers_animationFrame__WEBPACK_IMPORTED_MODULE_17__.cancel(_this.rafHandle);\n      _this.rafHandle = dom_helpers_animationFrame__WEBPACK_IMPORTED_MODULE_17__.request(_this.checkOverflow);\n    };\n    _this.handleKeyPressEvent = function () {\n      _this.clearSelection();\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      notify(_this.props.onKeyPressEvent, args);\n    };\n    _this.handleSelectEvent = function () {\n      //cancel any pending selections so only the event click goes through.\n      _this.clearSelection();\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      notify(_this.props.onSelectEvent, args);\n    };\n    _this.handleDoubleClickEvent = function () {\n      _this.clearSelection();\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      notify(_this.props.onDoubleClickEvent, args);\n    };\n    _this.handleShowMore = function (events, date, cell, slot, target) {\n      var _this$props = _this.props,\n        popup = _this$props.popup,\n        onDrillDown = _this$props.onDrillDown,\n        onShowMore = _this$props.onShowMore,\n        getDrilldownView = _this$props.getDrilldownView,\n        doShowMoreDrillDown = _this$props.doShowMoreDrillDown;\n      _this.clearSelection();\n      if (popup) {\n        var position = (0,dom_helpers_position__WEBPACK_IMPORTED_MODULE_16__[\"default\"])(cell, _this.containerRef.current);\n        _this.setState({\n          overlay: {\n            date: date,\n            events: events,\n            position: (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, position), {}, {\n              width: '200px'\n            }),\n            target: target\n          }\n        });\n      } else if (doShowMoreDrillDown) {\n        notify(onDrillDown, [date, getDrilldownView(date) || views.DAY]);\n      }\n      notify(onShowMore, [events, date, slot]);\n    };\n    _this.handleSelectAllDaySlot = function (slots, slotInfo) {\n      var onSelectSlot = _this.props.onSelectSlot;\n      var start = new Date(slots[0]);\n      var end = new Date(slots[slots.length - 1]);\n      end.setDate(slots[slots.length - 1].getDate() + 1);\n      notify(onSelectSlot, {\n        slots: slots,\n        start: start,\n        end: end,\n        action: slotInfo.action,\n        resourceId: slotInfo.resourceId\n      });\n    };\n    _this.overlayDisplay = function () {\n      _this.setState({\n        overlay: null\n      });\n    };\n    _this.checkOverflow = function () {\n      if (_this._updatingOverflow) return;\n      var content = _this.contentRef.current;\n      if (!(content !== null && content !== void 0 && content.scrollHeight)) return;\n      var isOverflowing = content.scrollHeight > content.clientHeight;\n      if (_this.state.isOverflowing !== isOverflowing) {\n        _this._updatingOverflow = true;\n        _this.setState({\n          isOverflowing: isOverflowing\n        }, function () {\n          _this._updatingOverflow = false;\n        });\n      }\n    };\n    _this.memoizedResources = (0,memoize_one__WEBPACK_IMPORTED_MODULE_46__[\"default\"])(function (resources, accessors) {\n      return Resources(resources, accessors);\n    });\n    _this.state = {\n      gutterWidth: undefined,\n      isOverflowing: null\n    };\n    _this.scrollRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createRef();\n    _this.contentRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createRef();\n    _this.containerRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createRef();\n    _this._scrollRatio = null;\n    _this.gutterRef = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_8__.createRef)();\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(TimeGrid, _Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(TimeGrid, [{\n    key: \"getSnapshotBeforeUpdate\",\n    value: function getSnapshotBeforeUpdate() {\n      this.checkOverflow();\n      return null;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.width == null) {\n        this.measureGutter();\n      }\n      this.calculateScroll();\n      this.applyScroll();\n      window.addEventListener('resize', this.handleResize);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.handleResize);\n      dom_helpers_animationFrame__WEBPACK_IMPORTED_MODULE_17__.cancel(this.rafHandle);\n      if (this.measureGutterAnimationFrameRequest) {\n        window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.applyScroll();\n    }\n  }, {\n    key: \"renderEvents\",\n    value: function renderEvents(range, events, backgroundEvents, now) {\n      var _this2 = this;\n      var _this$props2 = this.props,\n        min = _this$props2.min,\n        max = _this$props2.max,\n        components = _this$props2.components,\n        accessors = _this$props2.accessors,\n        localizer = _this$props2.localizer,\n        dayLayoutAlgorithm = _this$props2.dayLayoutAlgorithm;\n      var resources = this.memoizedResources(this.props.resources, accessors);\n      var groupedEvents = resources.groupEvents(events);\n      var groupedBackgroundEvents = resources.groupEvents(backgroundEvents);\n      return resources.map(function (_ref, i) {\n        var _ref2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_ref, 2),\n          id = _ref2[0],\n          resource = _ref2[1];\n        return range.map(function (date, jj) {\n          var daysEvents = (groupedEvents.get(id) || []).filter(function (event) {\n            return localizer.inRange(date, accessors.start(event), accessors.end(event), 'day');\n          });\n          var daysBackgroundEvents = (groupedBackgroundEvents.get(id) || []).filter(function (event) {\n            return localizer.inRange(date, accessors.start(event), accessors.end(event), 'day');\n          });\n          return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(DayColumn, Object.assign({}, _this2.props, {\n            localizer: localizer,\n            min: localizer.merge(date, min),\n            max: localizer.merge(date, max),\n            resource: resource && id,\n            components: components,\n            isNow: localizer.isSameDate(date, now),\n            key: i + '-' + jj,\n            date: date,\n            events: daysEvents,\n            backgroundEvents: daysBackgroundEvents,\n            dayLayoutAlgorithm: dayLayoutAlgorithm\n          }));\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props$allDayMax;\n      var _this$props3 = this.props,\n        events = _this$props3.events,\n        backgroundEvents = _this$props3.backgroundEvents,\n        range = _this$props3.range,\n        width = _this$props3.width,\n        rtl = _this$props3.rtl,\n        selected = _this$props3.selected,\n        getNow = _this$props3.getNow,\n        resources = _this$props3.resources,\n        components = _this$props3.components,\n        accessors = _this$props3.accessors,\n        getters = _this$props3.getters,\n        localizer = _this$props3.localizer,\n        min = _this$props3.min,\n        max = _this$props3.max,\n        showMultiDayTimes = _this$props3.showMultiDayTimes,\n        longPressThreshold = _this$props3.longPressThreshold,\n        resizable = _this$props3.resizable;\n      width = width || this.state.gutterWidth;\n      var start = range[0],\n        end = range[range.length - 1];\n      this.slots = range.length;\n      var allDayEvents = [],\n        rangeEvents = [],\n        rangeBackgroundEvents = [];\n      events.forEach(function (event) {\n        if (inRange(event, start, end, accessors, localizer)) {\n          var eStart = accessors.start(event),\n            eEnd = accessors.end(event);\n          if (accessors.allDay(event) || localizer.startAndEndAreDateOnly(eStart, eEnd) || !showMultiDayTimes && !localizer.isSameDate(eStart, eEnd)) {\n            allDayEvents.push(event);\n          } else {\n            rangeEvents.push(event);\n          }\n        }\n      });\n      backgroundEvents.forEach(function (event) {\n        if (inRange(event, start, end, accessors, localizer)) {\n          rangeBackgroundEvents.push(event);\n        }\n      });\n      allDayEvents.sort(function (a, b) {\n        return sortEvents(a, b, accessors, localizer);\n      });\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])('rbc-time-view', resources && 'rbc-time-view-resources'),\n        ref: this.containerRef\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGridHeader, {\n        range: range,\n        events: allDayEvents,\n        width: width,\n        rtl: rtl,\n        getNow: getNow,\n        localizer: localizer,\n        selected: selected,\n        allDayMaxRows: this.props.showAllEvents ? Infinity : (_this$props$allDayMax = this.props.allDayMaxRows) !== null && _this$props$allDayMax !== void 0 ? _this$props$allDayMax : Infinity,\n        resources: this.memoizedResources(resources, accessors),\n        selectable: this.props.selectable,\n        accessors: accessors,\n        getters: getters,\n        components: components,\n        scrollRef: this.scrollRef,\n        isOverflowing: this.state.isOverflowing,\n        longPressThreshold: longPressThreshold,\n        onSelectSlot: this.handleSelectAllDaySlot,\n        onSelectEvent: this.handleSelectEvent,\n        onShowMore: this.handleShowMore,\n        onDoubleClickEvent: this.props.onDoubleClickEvent,\n        onKeyPressEvent: this.props.onKeyPressEvent,\n        onDrillDown: this.props.onDrillDown,\n        getDrilldownView: this.props.getDrilldownView,\n        resizable: resizable\n      }), this.props.popup && this.renderOverlay(), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        ref: this.contentRef,\n        className: \"rbc-time-content\",\n        onScroll: this.handleScroll\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGutter$1, {\n        date: start,\n        ref: this.gutterRef,\n        localizer: localizer,\n        min: localizer.merge(start, min),\n        max: localizer.merge(start, max),\n        step: this.props.step,\n        getNow: this.props.getNow,\n        timeslots: this.props.timeslots,\n        components: components,\n        className: \"rbc-time-gutter\",\n        getters: getters\n      }), this.renderEvents(range, rangeEvents, rangeBackgroundEvents, getNow())));\n    }\n  }, {\n    key: \"renderOverlay\",\n    value: function renderOverlay() {\n      var _this$state$overlay,\n        _this$state,\n        _this3 = this;\n      var overlay = (_this$state$overlay = (_this$state = this.state) === null || _this$state === void 0 ? void 0 : _this$state.overlay) !== null && _this$state$overlay !== void 0 ? _this$state$overlay : {};\n      var _this$props4 = this.props,\n        accessors = _this$props4.accessors,\n        localizer = _this$props4.localizer,\n        components = _this$props4.components,\n        getters = _this$props4.getters,\n        selected = _this$props4.selected,\n        popupOffset = _this$props4.popupOffset,\n        handleDragStart = _this$props4.handleDragStart;\n      var onHide = function onHide() {\n        return _this3.setState({\n          overlay: null\n        });\n      };\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(PopOverlay, {\n        overlay: overlay,\n        accessors: accessors,\n        localizer: localizer,\n        components: components,\n        getters: getters,\n        selected: selected,\n        popupOffset: popupOffset,\n        ref: this.containerRef,\n        handleKeyPressEvent: this.handleKeyPressEvent,\n        handleSelectEvent: this.handleSelectEvent,\n        handleDoubleClickEvent: this.handleDoubleClickEvent,\n        handleDragStart: handleDragStart,\n        show: !!overlay.position,\n        overlayDisplay: this.overlayDisplay,\n        onHide: onHide\n      });\n    }\n  }, {\n    key: \"clearSelection\",\n    value: function clearSelection() {\n      clearTimeout(this._selectTimer);\n      this._pendingSelection = [];\n    }\n  }, {\n    key: \"measureGutter\",\n    value: function measureGutter() {\n      var _this4 = this;\n      if (this.measureGutterAnimationFrameRequest) {\n        window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest);\n      }\n      this.measureGutterAnimationFrameRequest = window.requestAnimationFrame(function () {\n        var _this4$gutterRef;\n        var width = (_this4$gutterRef = _this4.gutterRef) !== null && _this4$gutterRef !== void 0 && _this4$gutterRef.current ? (0,dom_helpers_width__WEBPACK_IMPORTED_MODULE_29__[\"default\"])(_this4.gutterRef.current) : undefined;\n        if (width && _this4.state.gutterWidth !== width) {\n          _this4.setState({\n            gutterWidth: width\n          });\n        }\n      });\n    }\n  }, {\n    key: \"applyScroll\",\n    value: function applyScroll() {\n      // If auto-scroll is disabled, we don't actually apply the scroll\n      if (this._scrollRatio != null && this.props.enableAutoScroll === true) {\n        var content = this.contentRef.current;\n        content.scrollTop = content.scrollHeight * this._scrollRatio;\n        // Only do this once\n        this._scrollRatio = null;\n      }\n    }\n  }, {\n    key: \"calculateScroll\",\n    value: function calculateScroll() {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n      var min = props.min,\n        max = props.max,\n        scrollToTime = props.scrollToTime,\n        localizer = props.localizer;\n      var diffMillis = localizer.diff(localizer.merge(scrollToTime, min), scrollToTime, 'milliseconds');\n      var totalMillis = localizer.diff(min, max, 'milliseconds');\n      this._scrollRatio = diffMillis / totalMillis;\n    }\n  }]);\n}(react__WEBPACK_IMPORTED_MODULE_8__.Component);\nTimeGrid.defaultProps = {\n  step: 30,\n  timeslots: 2\n};\n\nvar _excluded$4 = [\"date\", \"localizer\", \"min\", \"max\", \"scrollToTime\", \"enableAutoScroll\"];\nvar Day = /*#__PURE__*/function (_React$Component) {\n  function Day() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Day);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, Day, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(Day, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Day, [{\n    key: \"render\",\n    value: function render() {\n      /**\n       * This allows us to default min, max, and scrollToTime\n       * using our localizer. This is necessary until such time\n       * as TODO: TimeGrid is converted to a functional component.\n       */\n      var _this$props = this.props,\n        date = _this$props.date,\n        localizer = _this$props.localizer,\n        _this$props$min = _this$props.min,\n        min = _this$props$min === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$min,\n        _this$props$max = _this$props.max,\n        max = _this$props$max === void 0 ? localizer.endOf(new Date(), 'day') : _this$props$max,\n        _this$props$scrollToT = _this$props.scrollToTime,\n        scrollToTime = _this$props$scrollToT === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$scrollToT,\n        _this$props$enableAut = _this$props.enableAutoScroll,\n        enableAutoScroll = _this$props$enableAut === void 0 ? true : _this$props$enableAut,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props, _excluded$4);\n      var range = Day.range(date, {\n        localizer: localizer\n      });\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGrid, Object.assign({}, props, {\n        range: range,\n        eventOffset: 10,\n        localizer: localizer,\n        min: min,\n        max: max,\n        scrollToTime: scrollToTime,\n        enableAutoScroll: enableAutoScroll\n      }));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nDay.range = function (date, _ref) {\n  var localizer = _ref.localizer;\n  return [localizer.startOf(date, 'day')];\n};\nDay.navigate = function (date, action, _ref2) {\n  var localizer = _ref2.localizer;\n  switch (action) {\n    case navigate.PREVIOUS:\n      return localizer.add(date, -1, 'day');\n    case navigate.NEXT:\n      return localizer.add(date, 1, 'day');\n    default:\n      return date;\n  }\n};\nDay.title = function (date, _ref3) {\n  var localizer = _ref3.localizer;\n  return localizer.format(date, 'dayHeaderFormat');\n};\n\nvar _excluded$3 = [\"date\", \"localizer\", \"min\", \"max\", \"scrollToTime\", \"enableAutoScroll\"];\nvar Week = /*#__PURE__*/function (_React$Component) {\n  function Week() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Week);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, Week, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(Week, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Week, [{\n    key: \"render\",\n    value: function render() {\n      /**\n       * This allows us to default min, max, and scrollToTime\n       * using our localizer. This is necessary until such time\n       * as TimeGrid is converted to a functional component.\n       */\n      var _this$props = this.props,\n        date = _this$props.date,\n        localizer = _this$props.localizer,\n        _this$props$min = _this$props.min,\n        min = _this$props$min === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$min,\n        _this$props$max = _this$props.max,\n        max = _this$props$max === void 0 ? localizer.endOf(new Date(), 'day') : _this$props$max,\n        _this$props$scrollToT = _this$props.scrollToTime,\n        scrollToTime = _this$props$scrollToT === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$scrollToT,\n        _this$props$enableAut = _this$props.enableAutoScroll,\n        enableAutoScroll = _this$props$enableAut === void 0 ? true : _this$props$enableAut,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props, _excluded$3);\n      var range = Week.range(date, this.props);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGrid, Object.assign({}, props, {\n        range: range,\n        eventOffset: 15,\n        localizer: localizer,\n        min: min,\n        max: max,\n        scrollToTime: scrollToTime,\n        enableAutoScroll: enableAutoScroll\n      }));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nWeek.defaultProps = TimeGrid.defaultProps;\nWeek.navigate = function (date, action, _ref) {\n  var localizer = _ref.localizer;\n  switch (action) {\n    case navigate.PREVIOUS:\n      return localizer.add(date, -1, 'week');\n    case navigate.NEXT:\n      return localizer.add(date, 1, 'week');\n    default:\n      return date;\n  }\n};\nWeek.range = function (date, _ref2) {\n  var localizer = _ref2.localizer;\n  var firstOfWeek = localizer.startOfWeek();\n  var start = localizer.startOf(date, 'week', firstOfWeek);\n  var end = localizer.endOf(date, 'week', firstOfWeek);\n  return localizer.range(start, end);\n};\nWeek.title = function (date, _ref3) {\n  var localizer = _ref3.localizer;\n  var _Week$range = Week.range(date, {\n      localizer: localizer\n    }),\n    _Week$range2 = (0,_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_30__[\"default\"])(_Week$range),\n    start = _Week$range2[0],\n    rest = _Week$range2.slice(1);\n  return localizer.format({\n    start: start,\n    end: rest.pop()\n  }, 'dayRangeHeaderFormat');\n};\n\nvar _excluded$2 = [\"date\", \"localizer\", \"min\", \"max\", \"scrollToTime\", \"enableAutoScroll\"];\nfunction workWeekRange(date, options) {\n  return Week.range(date, options).filter(function (d) {\n    return [6, 0].indexOf(d.getDay()) === -1;\n  });\n}\nvar WorkWeek = /*#__PURE__*/function (_React$Component) {\n  function WorkWeek() {\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, WorkWeek);\n    return (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, WorkWeek, arguments);\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(WorkWeek, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(WorkWeek, [{\n    key: \"render\",\n    value: function render() {\n      /**\n       * This allows us to default min, max, and scrollToTime\n       * using our localizer. This is necessary until such time\n       * as TimeGrid is converted to a functional component.\n       */\n      var _this$props = this.props,\n        date = _this$props.date,\n        localizer = _this$props.localizer,\n        _this$props$min = _this$props.min,\n        min = _this$props$min === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$min,\n        _this$props$max = _this$props.max,\n        max = _this$props$max === void 0 ? localizer.endOf(new Date(), 'day') : _this$props$max,\n        _this$props$scrollToT = _this$props.scrollToTime,\n        scrollToTime = _this$props$scrollToT === void 0 ? localizer.startOf(new Date(), 'day') : _this$props$scrollToT,\n        _this$props$enableAut = _this$props.enableAutoScroll,\n        enableAutoScroll = _this$props$enableAut === void 0 ? true : _this$props$enableAut,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props, _excluded$2);\n      var range = workWeekRange(date, this.props);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeGrid, Object.assign({}, props, {\n        range: range,\n        eventOffset: 15,\n        localizer: localizer,\n        min: min,\n        max: max,\n        scrollToTime: scrollToTime,\n        enableAutoScroll: enableAutoScroll\n      }));\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nWorkWeek.defaultProps = TimeGrid.defaultProps;\nWorkWeek.range = workWeekRange;\nWorkWeek.navigate = Week.navigate;\nWorkWeek.title = function (date, _ref) {\n  var localizer = _ref.localizer;\n  var _workWeekRange = workWeekRange(date, {\n      localizer: localizer\n    }),\n    _workWeekRange2 = (0,_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_30__[\"default\"])(_workWeekRange),\n    start = _workWeekRange2[0],\n    rest = _workWeekRange2.slice(1);\n  return localizer.format({\n    start: start,\n    end: rest.pop()\n  }, 'dayRangeHeaderFormat');\n};\n\nvar DEFAULT_LENGTH = 30;\nfunction Agenda(_ref) {\n  var accessors = _ref.accessors,\n    components = _ref.components,\n    date = _ref.date,\n    events = _ref.events,\n    getters = _ref.getters,\n    _ref$length = _ref.length,\n    length = _ref$length === void 0 ? DEFAULT_LENGTH : _ref$length,\n    localizer = _ref.localizer,\n    onDoubleClickEvent = _ref.onDoubleClickEvent,\n    onSelectEvent = _ref.onSelectEvent,\n    selected = _ref.selected;\n  var headerRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  var dateColRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  var timeColRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  var contentRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  var tbodyRef = (0,react__WEBPACK_IMPORTED_MODULE_8__.useRef)(null);\n  (0,react__WEBPACK_IMPORTED_MODULE_8__.useEffect)(function () {\n    _adjustHeader();\n  });\n  var renderDay = function renderDay(day, events, dayKey) {\n    var Event = components.event,\n      AgendaDate = components.date;\n    events = events.filter(function (e) {\n      return inRange(e, localizer.startOf(day, 'day'), localizer.endOf(day, 'day'), accessors, localizer);\n    });\n    return events.map(function (event, idx) {\n      var title = accessors.title(event);\n      var end = accessors.end(event);\n      var start = accessors.start(event);\n      var userProps = getters.eventProp(event, start, end, isSelected(event, selected));\n      var dateLabel = idx === 0 && localizer.format(day, 'agendaDateFormat');\n      var first = idx === 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"td\", {\n        rowSpan: events.length,\n        className: \"rbc-agenda-date-cell\"\n      }, AgendaDate ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(AgendaDate, {\n        day: day,\n        label: dateLabel\n      }) : dateLabel) : false;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"tr\", {\n        key: dayKey + '_' + idx,\n        className: userProps.className,\n        style: userProps.style\n      }, first, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"td\", {\n        className: \"rbc-agenda-time-cell\"\n      }, timeRangeLabel(day, event)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"td\", {\n        className: \"rbc-agenda-event-cell\",\n        onClick: function onClick(e) {\n          return onSelectEvent && onSelectEvent(event, e);\n        },\n        onDoubleClick: function onDoubleClick(e) {\n          return onDoubleClickEvent && onDoubleClickEvent(event, e);\n        }\n      }, Event ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(Event, {\n        event: event,\n        title: title\n      }) : title));\n    }, []);\n  };\n  var timeRangeLabel = function timeRangeLabel(day, event) {\n    var labelClass = '',\n      TimeComponent = components.time,\n      label = localizer.messages.allDay;\n    var end = accessors.end(event);\n    var start = accessors.start(event);\n    if (!accessors.allDay(event)) {\n      if (localizer.eq(start, end)) {\n        label = localizer.format(start, 'agendaTimeFormat');\n      } else if (localizer.isSameDate(start, end)) {\n        label = localizer.format({\n          start: start,\n          end: end\n        }, 'agendaTimeRangeFormat');\n      } else if (localizer.isSameDate(day, start)) {\n        label = localizer.format(start, 'agendaTimeFormat');\n      } else if (localizer.isSameDate(day, end)) {\n        label = localizer.format(end, 'agendaTimeFormat');\n      }\n    }\n    if (localizer.gt(day, start, 'day')) labelClass = 'rbc-continues-prior';\n    if (localizer.lt(day, end, 'day')) labelClass += ' rbc-continues-after';\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n      className: labelClass.trim()\n    }, TimeComponent ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(TimeComponent, {\n      event: event,\n      day: day,\n      label: label\n    }) : label);\n  };\n  var _adjustHeader = function _adjustHeader() {\n    if (!tbodyRef.current) return;\n    var header = headerRef.current;\n    var firstRow = tbodyRef.current.firstChild;\n    if (!firstRow) return;\n    var isOverflowing = contentRef.current.scrollHeight > contentRef.current.clientHeight;\n    var _widths = [];\n    var widths = _widths;\n    _widths = [(0,dom_helpers_width__WEBPACK_IMPORTED_MODULE_29__[\"default\"])(firstRow.children[0]), (0,dom_helpers_width__WEBPACK_IMPORTED_MODULE_29__[\"default\"])(firstRow.children[1])];\n    if (widths[0] !== _widths[0] || widths[1] !== _widths[1]) {\n      dateColRef.current.style.width = _widths[0] + 'px';\n      timeColRef.current.style.width = _widths[1] + 'px';\n    }\n    if (isOverflowing) {\n      (0,dom_helpers_addClass__WEBPACK_IMPORTED_MODULE_31__[\"default\"])(header, 'rbc-header-overflowing');\n      header.style.marginRight = (0,dom_helpers_scrollbarSize__WEBPACK_IMPORTED_MODULE_28__[\"default\"])() + 'px';\n    } else {\n      (0,dom_helpers_removeClass__WEBPACK_IMPORTED_MODULE_32__[\"default\"])(header, 'rbc-header-overflowing');\n    }\n  };\n  var messages = localizer.messages;\n  var end = localizer.add(date, length, 'day');\n  var range = localizer.range(date, end, 'day');\n  events = events.filter(function (event) {\n    return inRange(event, localizer.startOf(date, 'day'), localizer.endOf(end, 'day'), accessors, localizer);\n  });\n  events.sort(function (a, b) {\n    return +accessors.start(a) - +accessors.start(b);\n  });\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: \"rbc-agenda-view\"\n  }, events.length !== 0 ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement((react__WEBPACK_IMPORTED_MODULE_8___default().Fragment), null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"table\", {\n    ref: headerRef,\n    className: \"rbc-agenda-table\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"thead\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"tr\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"th\", {\n    className: \"rbc-header\",\n    ref: dateColRef\n  }, messages.date), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"th\", {\n    className: \"rbc-header\",\n    ref: timeColRef\n  }, messages.time), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"th\", {\n    className: \"rbc-header\"\n  }, messages.event)))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n    className: \"rbc-agenda-content\",\n    ref: contentRef\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"table\", {\n    className: \"rbc-agenda-table\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"tbody\", {\n    ref: tbodyRef\n  }, range.map(function (day, idx) {\n    return renderDay(day, events, idx);\n  }))))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n    className: \"rbc-agenda-empty\"\n  }, messages.noEventsInRange));\n}\nAgenda.range = function (start, _ref2) {\n  var _ref2$length = _ref2.length,\n    length = _ref2$length === void 0 ? DEFAULT_LENGTH : _ref2$length,\n    localizer = _ref2.localizer;\n  var end = localizer.add(start, length, 'day');\n  return {\n    start: start,\n    end: end\n  };\n};\nAgenda.navigate = function (date, action, _ref3) {\n  var _ref3$length = _ref3.length,\n    length = _ref3$length === void 0 ? DEFAULT_LENGTH : _ref3$length,\n    localizer = _ref3.localizer;\n  switch (action) {\n    case navigate.PREVIOUS:\n      return localizer.add(date, -length, 'day');\n    case navigate.NEXT:\n      return localizer.add(date, length, 'day');\n    default:\n      return date;\n  }\n};\nAgenda.title = function (start, _ref4) {\n  var _ref4$length = _ref4.length,\n    length = _ref4$length === void 0 ? DEFAULT_LENGTH : _ref4$length,\n    localizer = _ref4.localizer;\n  var end = localizer.add(start, length, 'day');\n  return localizer.format({\n    start: start,\n    end: end\n  }, 'agendaHeaderFormat');\n};\n\nvar VIEWS = (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])({}, views.MONTH, MonthView), views.WEEK, Week), views.WORK_WEEK, WorkWeek), views.DAY, Day), views.AGENDA, Agenda);\n\nvar _excluded$1 = [\"action\", \"date\", \"today\"];\nfunction moveDate(View, _ref) {\n  var action = _ref.action,\n    date = _ref.date,\n    today = _ref.today,\n    props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_ref, _excluded$1);\n  View = typeof View === 'string' ? VIEWS[View] : View;\n  switch (action) {\n    case navigate.TODAY:\n      date = today || new Date();\n      break;\n    case navigate.DATE:\n      break;\n    default:\n      invariant__WEBPACK_IMPORTED_MODULE_11___default()(View && typeof View.navigate === 'function', 'Calendar View components must implement a static `.navigate(date, action)` method.s');\n      date = View.navigate(date, action, props);\n  }\n  return date;\n}\n\nvar Toolbar = /*#__PURE__*/function (_React$Component) {\n  function Toolbar() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Toolbar);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, Toolbar, [].concat(args));\n    _this.navigate = function (action) {\n      _this.props.onNavigate(action);\n    };\n    _this.view = function (view) {\n      _this.props.onView(view);\n    };\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(Toolbar, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Toolbar, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        messages = _this$props.localizer.messages,\n        label = _this$props.label;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", {\n        className: \"rbc-toolbar\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n        className: \"rbc-btn-group\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n        type: \"button\",\n        onClick: this.navigate.bind(null, navigate.TODAY)\n      }, messages.today), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n        type: \"button\",\n        onClick: this.navigate.bind(null, navigate.PREVIOUS)\n      }, messages.previous), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n        type: \"button\",\n        onClick: this.navigate.bind(null, navigate.NEXT)\n      }, messages.next)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n        className: \"rbc-toolbar-label\"\n      }, label), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"span\", {\n        className: \"rbc-btn-group\"\n      }, this.viewNamesGroup(messages)));\n    }\n  }, {\n    key: \"viewNamesGroup\",\n    value: function viewNamesGroup(messages) {\n      var _this2 = this;\n      var viewNames = this.props.views;\n      var view = this.props.view;\n      if (viewNames.length > 1) {\n        return viewNames.map(function (name) {\n          return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"button\", {\n            type: \"button\",\n            key: name,\n            className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])({\n              'rbc-active': view === name\n            }),\n            onClick: _this2.view.bind(null, name)\n          }, messages[name]);\n        });\n      }\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\n\n/**\n * Retrieve via an accessor-like property\n *\n *    accessor(obj, 'name')   // => retrieves obj['name']\n *    accessor(data, func)    // => retrieves func(data)\n *    ... otherwise null\n */\nfunction accessor(data, field) {\n  var value = null;\n  if (typeof field === 'function') value = field(data);else if (typeof field === 'string' && (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(data) === 'object' && data != null && field in data) value = data[field];\n  return value;\n}\nvar wrapAccessor = function wrapAccessor(acc) {\n  return function (data) {\n    return accessor(data, acc);\n  };\n};\n\nvar _excluded = [\"view\", \"date\", \"getNow\", \"onNavigate\"],\n  _excluded2 = [\"view\", \"toolbar\", \"events\", \"backgroundEvents\", \"style\", \"className\", \"elementProps\", \"date\", \"getNow\", \"length\", \"showMultiDayTimes\", \"onShowMore\", \"doShowMoreDrillDown\", \"components\", \"formats\", \"messages\", \"culture\"];\nfunction viewNames(_views) {\n  if (Array.isArray(_views)) {\n    return _views;\n  }\n  var views = [];\n  for (var _i = 0, _Object$entries = Object.entries(_views); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_Object$entries[_i], 2),\n      key = _Object$entries$_i[0],\n      value = _Object$entries$_i[1];\n    if (value) {\n      views.push(key);\n    }\n  }\n  return views;\n}\nfunction isValidView(view, _ref) {\n  var _views = _ref.views;\n  var names = viewNames(_views);\n  return names.indexOf(view) !== -1;\n}\nvar Calendar = /*#__PURE__*/function (_React$Component) {\n  function Calendar() {\n    var _this;\n    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(this, Calendar);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = (0,_babel_runtime_helpers_esm_callSuper__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, Calendar, [].concat(_args));\n    _this.getViews = function () {\n      var views = _this.props.views;\n      if (Array.isArray(views)) {\n        return lodash_transform__WEBPACK_IMPORTED_MODULE_35___default()(views, function (obj, name) {\n          return obj[name] = VIEWS[name];\n        }, {});\n      }\n      if ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(views) === 'object') {\n        return lodash_mapValues__WEBPACK_IMPORTED_MODULE_36___default()(views, function (value, key) {\n          if (value === true) {\n            return VIEWS[key];\n          }\n          return value;\n        });\n      }\n      return VIEWS;\n    };\n    _this.getView = function () {\n      var views = _this.getViews();\n      return views[_this.props.view];\n    };\n    _this.getDrilldownView = function (date) {\n      var _this$props = _this.props,\n        view = _this$props.view,\n        drilldownView = _this$props.drilldownView,\n        getDrilldownView = _this$props.getDrilldownView;\n      if (!getDrilldownView) return drilldownView;\n      return getDrilldownView(date, view, Object.keys(_this.getViews()));\n    };\n    /**\n     *\n     * @param date\n     * @param viewComponent\n     * @param {'month'|'week'|'work_week'|'day'|'agenda'} [view] - optional\n     * parameter. It appears when range change on view changing. It could be handy\n     * when you need to have both: range and view type at once, i.e. for manage rbc\n     * state via url\n     */\n    _this.handleRangeChange = function (date, viewComponent, view) {\n      var _this$props2 = _this.props,\n        onRangeChange = _this$props2.onRangeChange,\n        localizer = _this$props2.localizer;\n      if (onRangeChange) {\n        if (viewComponent.range) {\n          onRangeChange(viewComponent.range(date, {\n            localizer: localizer\n          }), view);\n        } else {\n          if (true) {\n            console.error('onRangeChange prop not supported for this view');\n          }\n        }\n      }\n    };\n    _this.handleNavigate = function (action, newDate) {\n      var _this$props3 = _this.props,\n        view = _this$props3.view,\n        date = _this$props3.date,\n        getNow = _this$props3.getNow,\n        onNavigate = _this$props3.onNavigate,\n        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props3, _excluded);\n      var ViewComponent = _this.getView();\n      var today = getNow();\n      date = moveDate(ViewComponent, (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({}, props), {}, {\n        action: action,\n        date: newDate || date || today,\n        today: today\n      }));\n      onNavigate(date, view, action);\n      _this.handleRangeChange(date, ViewComponent);\n    };\n    _this.handleViewChange = function (view) {\n      if (view !== _this.props.view && isValidView(view, _this.props)) {\n        _this.props.onView(view);\n      }\n      var views = _this.getViews();\n      _this.handleRangeChange(_this.props.date || _this.props.getNow(), views[view], view);\n    };\n    _this.handleSelectEvent = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      notify(_this.props.onSelectEvent, args);\n    };\n    _this.handleDoubleClickEvent = function () {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      notify(_this.props.onDoubleClickEvent, args);\n    };\n    _this.handleKeyPressEvent = function () {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n      notify(_this.props.onKeyPressEvent, args);\n    };\n    _this.handleSelectSlot = function (slotInfo) {\n      notify(_this.props.onSelectSlot, slotInfo);\n    };\n    _this.handleDrillDown = function (date, view) {\n      var onDrillDown = _this.props.onDrillDown;\n      if (onDrillDown) {\n        onDrillDown(date, view, _this.drilldownView);\n        return;\n      }\n      if (view) _this.handleViewChange(view);\n      _this.handleNavigate(navigate.DATE, date);\n    };\n    _this.state = {\n      context: Calendar.getContext(_this.props)\n    };\n    return _this;\n  }\n  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(Calendar, _React$Component);\n  return (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(Calendar, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n        view = _this$props4.view,\n        toolbar = _this$props4.toolbar,\n        events = _this$props4.events,\n        backgroundEvents = _this$props4.backgroundEvents,\n        style = _this$props4.style,\n        className = _this$props4.className,\n        elementProps = _this$props4.elementProps,\n        current = _this$props4.date,\n        getNow = _this$props4.getNow,\n        length = _this$props4.length,\n        showMultiDayTimes = _this$props4.showMultiDayTimes,\n        onShowMore = _this$props4.onShowMore,\n        doShowMoreDrillDown = _this$props4.doShowMoreDrillDown;\n        _this$props4.components;\n        _this$props4.formats;\n        _this$props4.messages;\n        _this$props4.culture;\n        var props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(_this$props4, _excluded2);\n      current = current || getNow();\n      var View = this.getView();\n      var _this$state$context = this.state.context,\n        accessors = _this$state$context.accessors,\n        components = _this$state$context.components,\n        getters = _this$state$context.getters,\n        localizer = _this$state$context.localizer,\n        viewNames = _this$state$context.viewNames;\n      var CalToolbar = components.toolbar || Toolbar;\n      var label = View.title(current, {\n        localizer: localizer,\n        length: length\n      });\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(\"div\", Object.assign({}, elementProps, {\n        className: (0,clsx__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(className, 'rbc-calendar', props.rtl && 'rbc-rtl'),\n        style: style\n      }), toolbar && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(CalToolbar, {\n        date: current,\n        view: view,\n        views: viewNames,\n        label: label,\n        onView: this.handleViewChange,\n        onNavigate: this.handleNavigate,\n        localizer: localizer\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_8___default().createElement(View, Object.assign({}, props, {\n        events: events,\n        backgroundEvents: backgroundEvents,\n        date: current,\n        getNow: getNow,\n        length: length,\n        localizer: localizer,\n        getters: getters,\n        components: components,\n        accessors: accessors,\n        showMultiDayTimes: showMultiDayTimes,\n        getDrilldownView: this.getDrilldownView,\n        onNavigate: this.handleNavigate,\n        onDrillDown: this.handleDrillDown,\n        onSelectEvent: this.handleSelectEvent,\n        onDoubleClickEvent: this.handleDoubleClickEvent,\n        onKeyPressEvent: this.handleKeyPressEvent,\n        onSelectSlot: this.handleSelectSlot,\n        onShowMore: onShowMore,\n        doShowMoreDrillDown: doShowMoreDrillDown\n      })));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps) {\n      return {\n        context: Calendar.getContext(nextProps)\n      };\n    }\n  }, {\n    key: \"getContext\",\n    value: function getContext(_ref2) {\n      var startAccessor = _ref2.startAccessor,\n        endAccessor = _ref2.endAccessor,\n        allDayAccessor = _ref2.allDayAccessor,\n        tooltipAccessor = _ref2.tooltipAccessor,\n        titleAccessor = _ref2.titleAccessor,\n        resourceAccessor = _ref2.resourceAccessor,\n        resourceIdAccessor = _ref2.resourceIdAccessor,\n        resourceTitleAccessor = _ref2.resourceTitleAccessor,\n        eventPropGetter = _ref2.eventPropGetter,\n        backgroundEventPropGetter = _ref2.backgroundEventPropGetter,\n        slotPropGetter = _ref2.slotPropGetter,\n        slotGroupPropGetter = _ref2.slotGroupPropGetter,\n        dayPropGetter = _ref2.dayPropGetter,\n        view = _ref2.view,\n        views = _ref2.views,\n        localizer = _ref2.localizer,\n        culture = _ref2.culture,\n        _ref2$messages = _ref2.messages,\n        messages$1 = _ref2$messages === void 0 ? {} : _ref2$messages,\n        _ref2$components = _ref2.components,\n        components = _ref2$components === void 0 ? {} : _ref2$components,\n        _ref2$formats = _ref2.formats,\n        formats = _ref2$formats === void 0 ? {} : _ref2$formats;\n      var names = viewNames(views);\n      var msgs = messages(messages$1);\n      return {\n        viewNames: names,\n        localizer: mergeWithDefaults(localizer, culture, formats, msgs),\n        getters: {\n          eventProp: function eventProp() {\n            return eventPropGetter && eventPropGetter.apply(void 0, arguments) || {};\n          },\n          backgroundEventProp: function backgroundEventProp() {\n            return backgroundEventPropGetter && backgroundEventPropGetter.apply(void 0, arguments) || {};\n          },\n          slotProp: function slotProp() {\n            return slotPropGetter && slotPropGetter.apply(void 0, arguments) || {};\n          },\n          slotGroupProp: function slotGroupProp() {\n            return slotGroupPropGetter && slotGroupPropGetter.apply(void 0, arguments) || {};\n          },\n          dayProp: function dayProp() {\n            return dayPropGetter && dayPropGetter.apply(void 0, arguments) || {};\n          }\n        },\n        components: lodash_defaults__WEBPACK_IMPORTED_MODULE_34___default()(components[view] || {}, lodash_omit__WEBPACK_IMPORTED_MODULE_33___default()(components, names), {\n          eventWrapper: NoopWrapper,\n          backgroundEventWrapper: NoopWrapper,\n          eventContainerWrapper: NoopWrapper,\n          dateCellWrapper: NoopWrapper,\n          weekWrapper: NoopWrapper,\n          timeSlotWrapper: NoopWrapper,\n          timeGutterWrapper: NoopWrapper\n        }),\n        accessors: {\n          start: wrapAccessor(startAccessor),\n          end: wrapAccessor(endAccessor),\n          allDay: wrapAccessor(allDayAccessor),\n          tooltip: wrapAccessor(tooltipAccessor),\n          title: wrapAccessor(titleAccessor),\n          resource: wrapAccessor(resourceAccessor),\n          resourceId: wrapAccessor(resourceIdAccessor),\n          resourceTitle: wrapAccessor(resourceTitleAccessor)\n        }\n      };\n    }\n  }]);\n}((react__WEBPACK_IMPORTED_MODULE_8___default().Component));\nCalendar.defaultProps = {\n  events: [],\n  backgroundEvents: [],\n  elementProps: {},\n  popup: false,\n  toolbar: true,\n  view: views.MONTH,\n  views: [views.MONTH, views.WEEK, views.DAY, views.AGENDA],\n  step: 30,\n  length: 30,\n  allDayMaxRows: Infinity,\n  doShowMoreDrillDown: true,\n  drilldownView: views.DAY,\n  titleAccessor: 'title',\n  tooltipAccessor: 'title',\n  allDayAccessor: 'allDay',\n  startAccessor: 'start',\n  endAccessor: 'end',\n  resourceAccessor: 'resourceId',\n  resourceIdAccessor: 'id',\n  resourceTitleAccessor: 'title',\n  longPressThreshold: 250,\n  getNow: function getNow() {\n    return new Date();\n  },\n  dayLayoutAlgorithm: 'overlap'\n};\nvar Calendar$1 = (0,uncontrollable__WEBPACK_IMPORTED_MODULE_9__.uncontrollable)(Calendar, {\n  view: 'onView',\n  date: 'onNavigate',\n  selected: 'onSelectEvent'\n});\n\nvar weekRangeFormat$5 = function weekRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return local.format(start, 'MMMM DD', culture) + '  ' +\n  // updated to use this localizer 'eq()' method\n  local.format(end, local.eq(start, end, 'month') ? 'DD' : 'MMMM DD', culture);\n};\nvar dateRangeFormat$5 = function dateRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return local.format(start, 'L', culture) + '  ' + local.format(end, 'L', culture);\n};\nvar timeRangeFormat$5 = function timeRangeFormat(_ref3, culture, local) {\n  var start = _ref3.start,\n    end = _ref3.end;\n  return local.format(start, 'LT', culture) + '  ' + local.format(end, 'LT', culture);\n};\nvar timeRangeStartFormat$5 = function timeRangeStartFormat(_ref4, culture, local) {\n  var start = _ref4.start;\n  return local.format(start, 'LT', culture) + '  ';\n};\nvar timeRangeEndFormat$5 = function timeRangeEndFormat(_ref5, culture, local) {\n  var end = _ref5.end;\n  return '  ' + local.format(end, 'LT', culture);\n};\nvar formats$5 = {\n  dateFormat: 'DD',\n  dayFormat: 'DD ddd',\n  weekdayFormat: 'ddd',\n  selectRangeFormat: timeRangeFormat$5,\n  eventTimeRangeFormat: timeRangeFormat$5,\n  eventTimeRangeStartFormat: timeRangeStartFormat$5,\n  eventTimeRangeEndFormat: timeRangeEndFormat$5,\n  timeGutterFormat: 'LT',\n  monthHeaderFormat: 'MMMM YYYY',\n  dayHeaderFormat: 'dddd MMM DD',\n  dayRangeHeaderFormat: weekRangeFormat$5,\n  agendaHeaderFormat: dateRangeFormat$5,\n  agendaDateFormat: 'ddd MMM DD',\n  agendaTimeFormat: 'LT',\n  agendaTimeRangeFormat: timeRangeFormat$5\n};\nfunction fixUnit$2(unit) {\n  var datePart = unit ? unit.toLowerCase() : unit;\n  if (datePart === 'FullYear') {\n    datePart = 'year';\n  } else if (!datePart) {\n    datePart = undefined;\n  }\n  return datePart;\n}\nfunction moment (moment) {\n  var locale = function locale(m, c) {\n    return c ? m.locale(c) : m;\n  };\n  function getTimezoneOffset(date) {\n    // ensures this gets cast to timezone\n    return moment(date).toDate().getTimezoneOffset();\n  }\n  function getDstOffset(start, end) {\n    var _st$_z$name, _st$_z;\n    // convert to moment, in case\n    // Calculate the offset in the timezone of the Events (local)\n    // not in the timezone of the calendar (moment.tz)\n    var st = moment(start).local();\n    var ed = moment(end).local();\n    // if not using moment timezone\n    if (!moment.tz) {\n      return st.toDate().getTimezoneOffset() - ed.toDate().getTimezoneOffset();\n    }\n    /**\n     * If using moment-timezone, and a timezone has been applied, then\n     * use this to get the proper timezone offset, otherwise default\n     * the timezone to the browser local\n     */\n    var tzName = (_st$_z$name = st === null || st === void 0 ? void 0 : (_st$_z = st._z) === null || _st$_z === void 0 ? void 0 : _st$_z.name) !== null && _st$_z$name !== void 0 ? _st$_z$name : moment.tz.guess();\n    var startOffset = moment.tz.zone(tzName).utcOffset(+st);\n    var endOffset = moment.tz.zone(tzName).utcOffset(+ed);\n    return startOffset - endOffset;\n  }\n  function getDayStartDstOffset(start) {\n    var dayStart = moment(start).startOf('day');\n    return getDstOffset(dayStart, start);\n  }\n\n  /*** BEGIN localized date arithmetic methods with moment ***/\n  function defineComparators(a, b, unit) {\n    var datePart = fixUnit$2(unit);\n    var dtA = datePart ? moment(a).startOf(datePart) : moment(a);\n    var dtB = datePart ? moment(b).startOf(datePart) : moment(b);\n    return [dtA, dtB, datePart];\n  }\n  function startOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit$2(unit);\n    if (datePart) {\n      return moment(date).startOf(datePart).toDate();\n    }\n    return moment(date).toDate();\n  }\n  function endOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit$2(unit);\n    if (datePart) {\n      return moment(date).endOf(datePart).toDate();\n    }\n    return moment(date).toDate();\n  }\n\n  // moment comparison operations *always* convert both sides to moment objects\n  // prior to running the comparisons\n  function eq(a, b, unit) {\n    var _defineComparators = defineComparators(a, b, unit),\n      _defineComparators2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators, 3),\n      dtA = _defineComparators2[0],\n      dtB = _defineComparators2[1],\n      datePart = _defineComparators2[2];\n    return dtA.isSame(dtB, datePart);\n  }\n  function neq(a, b, unit) {\n    return !eq(a, b, unit);\n  }\n  function gt(a, b, unit) {\n    var _defineComparators3 = defineComparators(a, b, unit),\n      _defineComparators4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators3, 3),\n      dtA = _defineComparators4[0],\n      dtB = _defineComparators4[1],\n      datePart = _defineComparators4[2];\n    return dtA.isAfter(dtB, datePart);\n  }\n  function lt(a, b, unit) {\n    var _defineComparators5 = defineComparators(a, b, unit),\n      _defineComparators6 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators5, 3),\n      dtA = _defineComparators6[0],\n      dtB = _defineComparators6[1],\n      datePart = _defineComparators6[2];\n    return dtA.isBefore(dtB, datePart);\n  }\n  function gte(a, b, unit) {\n    var _defineComparators7 = defineComparators(a, b, unit),\n      _defineComparators8 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators7, 3),\n      dtA = _defineComparators8[0],\n      dtB = _defineComparators8[1],\n      datePart = _defineComparators8[2];\n    return dtA.isSameOrBefore(dtB, datePart);\n  }\n  function lte(a, b, unit) {\n    var _defineComparators9 = defineComparators(a, b, unit),\n      _defineComparators10 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators9, 3),\n      dtA = _defineComparators10[0],\n      dtB = _defineComparators10[1],\n      datePart = _defineComparators10[2];\n    return dtA.isSameOrBefore(dtB, datePart);\n  }\n  function inRange(day, min, max) {\n    var unit = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'day';\n    var datePart = fixUnit$2(unit);\n    var mDay = moment(day);\n    var mMin = moment(min);\n    var mMax = moment(max);\n    return mDay.isBetween(mMin, mMax, datePart, '[]');\n  }\n  function min(dateA, dateB) {\n    var dtA = moment(dateA);\n    var dtB = moment(dateB);\n    var minDt = moment.min(dtA, dtB);\n    return minDt.toDate();\n  }\n  function max(dateA, dateB) {\n    var dtA = moment(dateA);\n    var dtB = moment(dateB);\n    var maxDt = moment.max(dtA, dtB);\n    return maxDt.toDate();\n  }\n  function merge(date, time) {\n    if (!date && !time) return null;\n    var tm = moment(time).format('HH:mm:ss');\n    var dt = moment(date).startOf('day').format('MM/DD/YYYY');\n    // We do it this way to avoid issues when timezone switching\n    return moment(\"\".concat(dt, \" \").concat(tm), 'MM/DD/YYYY HH:mm:ss').toDate();\n  }\n  function add(date, adder, unit) {\n    var datePart = fixUnit$2(unit);\n    return moment(date).add(adder, datePart).toDate();\n  }\n  function range(start, end) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit$2(unit);\n    // because the add method will put these in tz, we have to start that way\n    var current = moment(start).toDate();\n    var days = [];\n    while (lte(current, end)) {\n      days.push(current);\n      current = add(current, 1, datePart);\n    }\n    return days;\n  }\n  function ceil(date, unit) {\n    var datePart = fixUnit$2(unit);\n    var floor = startOf(date, datePart);\n    return eq(floor, date) ? floor : add(floor, 1, datePart);\n  }\n  function diff(a, b) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit$2(unit);\n    // don't use 'defineComparators' here, as we don't want to mutate the values\n    var dtA = moment(a);\n    var dtB = moment(b);\n    return dtB.diff(dtA, datePart);\n  }\n  function minutes(date) {\n    var dt = moment(date);\n    return dt.minutes();\n  }\n  function firstOfWeek(culture) {\n    var data = culture ? moment.localeData(culture) : moment.localeData();\n    return data ? data.firstDayOfWeek() : 0;\n  }\n  function firstVisibleDay(date) {\n    return moment(date).startOf('month').startOf('week').toDate();\n  }\n  function lastVisibleDay(date) {\n    return moment(date).endOf('month').endOf('week').toDate();\n  }\n  function visibleDays(date) {\n    var current = firstVisibleDay(date);\n    var last = lastVisibleDay(date);\n    var days = [];\n    while (lte(current, last)) {\n      days.push(current);\n      current = add(current, 1, 'd');\n    }\n    return days;\n  }\n  /*** END localized date arithmetic methods with moment ***/\n\n  /**\n   * Moved from TimeSlots.js, this method overrides the method of the same name\n   * in the localizer.js, using moment to construct the js Date\n   * @param {Date} dt - date to start with\n   * @param {Number} minutesFromMidnight\n   * @param {Number} offset\n   * @returns {Date}\n   */\n  function getSlotDate(dt, minutesFromMidnight, offset) {\n    return moment(dt).startOf('day').minute(minutesFromMidnight + offset).toDate();\n  }\n\n  // moment will automatically handle DST differences in it's calculations\n  function getTotalMin(start, end) {\n    return diff(start, end, 'minutes');\n  }\n  function getMinutesFromMidnight(start) {\n    var dayStart = moment(start).startOf('day');\n    var day = moment(start);\n    return day.diff(dayStart, 'minutes') + getDayStartDstOffset(start);\n  }\n\n  // These two are used by DateSlotMetrics\n  function continuesPrior(start, first) {\n    var mStart = moment(start);\n    var mFirst = moment(first);\n    return mStart.isBefore(mFirst, 'day');\n  }\n  function continuesAfter(start, end, last) {\n    var mEnd = moment(end);\n    var mLast = moment(last);\n    return mEnd.isSameOrAfter(mLast, 'minutes');\n  }\n  function daySpan(start, end) {\n    var mStart = moment(start);\n    var mEnd = moment(end);\n    var dur = moment.duration(mEnd.diff(mStart));\n    return dur.days();\n  }\n\n  // These two are used by eventLevels\n  function sortEvents(_ref6) {\n    var _ref6$evtA = _ref6.evtA,\n      aStart = _ref6$evtA.start,\n      aEnd = _ref6$evtA.end,\n      aAllDay = _ref6$evtA.allDay,\n      _ref6$evtB = _ref6.evtB,\n      bStart = _ref6$evtB.start,\n      bEnd = _ref6$evtB.end,\n      bAllDay = _ref6$evtB.allDay;\n    var startSort = +startOf(aStart, 'day') - +startOf(bStart, 'day');\n    var durA = daySpan(aStart, aEnd);\n    var durB = daySpan(bStart, bEnd);\n    return startSort ||\n    // sort by start Day first\n    durB - durA ||\n    // events spanning multiple days go first\n    !!bAllDay - !!aAllDay ||\n    // then allDay single day events\n    +aStart - +bStart ||\n    // then sort by start time *don't need moment conversion here\n    +aEnd - +bEnd // then sort by end time *don't need moment conversion here either\n    ;\n  }\n  function inEventRange(_ref7) {\n    var _ref7$event = _ref7.event,\n      start = _ref7$event.start,\n      end = _ref7$event.end,\n      _ref7$range = _ref7.range,\n      rangeStart = _ref7$range.start,\n      rangeEnd = _ref7$range.end;\n    var startOfDay = moment(start).startOf('day');\n    var eEnd = moment(end);\n    var rStart = moment(rangeStart);\n    var rEnd = moment(rangeEnd);\n    var startsBeforeEnd = startOfDay.isSameOrBefore(rEnd, 'day');\n    // when the event is zero duration we need to handle a bit differently\n    var sameMin = !startOfDay.isSame(eEnd, 'minutes');\n    var endsAfterStart = sameMin ? eEnd.isAfter(rStart, 'minutes') : eEnd.isSameOrAfter(rStart, 'minutes');\n    return startsBeforeEnd && endsAfterStart;\n  }\n  function isSameDate(date1, date2) {\n    var dt = moment(date1);\n    var dt2 = moment(date2);\n    return dt.isSame(dt2, 'day');\n  }\n\n  /**\n   * This method, called once in the localizer constructor, is used by eventLevels\n   * 'eventSegments()' to assist in determining the 'span' of the event in the display,\n   * specifically when using a timezone that is greater than the browser native timezone.\n   * @returns number\n   */\n  function browserTZOffset() {\n    /**\n     * Date.prototype.getTimezoneOffset horrifically flips the positive/negative from\n     * what you see in it's string, so we have to jump through some hoops to get a value\n     * we can actually compare.\n     */\n    var dt = new Date();\n    var neg = /-/.test(dt.toString()) ? '-' : '';\n    var dtOffset = dt.getTimezoneOffset();\n    var comparator = Number(\"\".concat(neg).concat(Math.abs(dtOffset)));\n    // moment correctly provides positive/negative offset, as expected\n    var mtOffset = moment().utcOffset();\n    return mtOffset > comparator ? 1 : 0;\n  }\n  return new DateLocalizer({\n    formats: formats$5,\n    firstOfWeek: firstOfWeek,\n    firstVisibleDay: firstVisibleDay,\n    lastVisibleDay: lastVisibleDay,\n    visibleDays: visibleDays,\n    format: function format(value, _format, culture) {\n      return locale(moment(value), culture).format(_format);\n    },\n    lt: lt,\n    lte: lte,\n    gt: gt,\n    gte: gte,\n    eq: eq,\n    neq: neq,\n    merge: merge,\n    inRange: inRange,\n    startOf: startOf,\n    endOf: endOf,\n    range: range,\n    add: add,\n    diff: diff,\n    ceil: ceil,\n    min: min,\n    max: max,\n    minutes: minutes,\n    getSlotDate: getSlotDate,\n    getTimezoneOffset: getTimezoneOffset,\n    getDstOffset: getDstOffset,\n    getTotalMin: getTotalMin,\n    getMinutesFromMidnight: getMinutesFromMidnight,\n    continuesPrior: continuesPrior,\n    continuesAfter: continuesAfter,\n    sortEvents: sortEvents,\n    inEventRange: inEventRange,\n    isSameDate: isSameDate,\n    daySpan: daySpan,\n    browserTZOffset: browserTZOffset\n  });\n}\n\nfunction pluralizeUnit(unit) {\n  return /s$/.test(unit) ? unit : unit + 's';\n}\nvar weekRangeFormat$4 = function weekRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return local.format(start, 'MMMM dd', culture) + '  ' +\n  // updated to use this localizer 'eq()' method\n  local.format(end, local.eq(start, end, 'month') ? 'dd' : 'MMMM dd', culture);\n};\nvar dateRangeFormat$4 = function dateRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return local.format(start, 'D', culture) + '  ' + local.format(end, 'D', culture);\n};\nvar timeRangeFormat$4 = function timeRangeFormat(_ref3, culture, local) {\n  var start = _ref3.start,\n    end = _ref3.end;\n  return local.format(start, 't', culture) + '  ' + local.format(end, 't', culture);\n};\nvar timeRangeStartFormat$4 = function timeRangeStartFormat(_ref4, culture, local) {\n  var start = _ref4.start;\n  return local.format(start, 't', culture) + '  ';\n};\nvar timeRangeEndFormat$4 = function timeRangeEndFormat(_ref5, culture, local) {\n  var end = _ref5.end;\n  return '  ' + local.format(end, 't', culture);\n};\nvar formats$4 = {\n  dateFormat: 'dd',\n  dayFormat: 'dd EEE',\n  weekdayFormat: 'EEE',\n  selectRangeFormat: timeRangeFormat$4,\n  eventTimeRangeFormat: timeRangeFormat$4,\n  eventTimeRangeStartFormat: timeRangeStartFormat$4,\n  eventTimeRangeEndFormat: timeRangeEndFormat$4,\n  timeGutterFormat: 't',\n  monthHeaderFormat: 'MMMM yyyy',\n  dayHeaderFormat: 'EEEE MMM dd',\n  dayRangeHeaderFormat: weekRangeFormat$4,\n  agendaHeaderFormat: dateRangeFormat$4,\n  agendaDateFormat: 'EEE MMM dd',\n  agendaTimeFormat: 't',\n  agendaTimeRangeFormat: timeRangeFormat$4\n};\nfunction fixUnit$1(unit) {\n  var datePart = unit ? pluralizeUnit(unit.toLowerCase()) : unit;\n  if (datePart === 'FullYear') {\n    datePart = 'year';\n  } else if (!datePart) {\n    datePart = undefined;\n  }\n  return datePart;\n}\n\n// Luxon does not currently have weekInfo by culture\n// Luxon uses 1 based values for month and weekday\n// So we default to Sunday (7)\nfunction luxon (DateTime) {\n  var _ref6 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n    _ref6$firstDayOfWeek = _ref6.firstDayOfWeek,\n    firstDayOfWeek = _ref6$firstDayOfWeek === void 0 ? 7 : _ref6$firstDayOfWeek;\n  function formatDate(value, format) {\n    return DateTime.fromJSDate(value).toFormat(format);\n  }\n  function formatDateWithCulture(value, culture, format) {\n    return DateTime.fromJSDate(value).setLocale(culture).toFormat(format);\n  }\n\n  /*** BEGIN localized date arithmetic methods with Luxon ***/\n  function defineComparators(a, b, unit) {\n    var datePart = fixUnit$1(unit);\n    var dtA = datePart ? DateTime.fromJSDate(a).startOf(datePart) : DateTime.fromJSDate(a);\n    var dtB = datePart ? DateTime.fromJSDate(b).startOf(datePart) : DateTime.fromJSDate(b);\n    return [dtA, dtB, datePart];\n  }\n\n  // Since Luxon (and current Intl API) has no support\n  // for culture based weekInfo, we need to handle\n  // the start of the week differently\n  // depending on locale, the firstDayOfWeek could also be Saturday, Sunday or Monday\n  function startOfDTWeek(dtObj) {\n    var weekday = dtObj.weekday;\n    if (weekday === firstDayOfWeek) {\n      return dtObj.startOf('day'); // already beginning of week\n    } else if (firstDayOfWeek === 1) {\n      return dtObj.startOf('week'); // fow is Monday, which is Luxon default\n    }\n    var diff = firstDayOfWeek === 7 ? weekday : weekday + (7 - firstDayOfWeek);\n    return dtObj.minus({\n      day: diff\n    }).startOf('day');\n  }\n  function endOfDTWeek(dtObj) {\n    var weekday = dtObj.weekday;\n    var eow = firstDayOfWeek === 1 ? 7 : firstDayOfWeek - 1;\n    if (weekday === eow) {\n      return dtObj.endOf('day'); // already last day of the week\n    } else if (firstDayOfWeek === 1) {\n      return dtObj.endOf('week'); // use Luxon default (Sunday)\n    }\n    var fromDate = firstDayOfWeek > eow ? dtObj.plus({\n      day: firstDayOfWeek - eow\n    }) : dtObj;\n    return fromDate.set({\n      weekday: eow\n    }).endOf('day');\n  }\n\n  // This returns a DateTime instance\n  function startOfDT() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit$1(unit);\n    if (datePart) {\n      var dt = DateTime.fromJSDate(date);\n      return datePart.includes('week') ? startOfDTWeek(dt) : dt.startOf(datePart);\n    }\n    return DateTime.fromJSDate(date);\n  }\n  function firstOfWeek() {\n    return firstDayOfWeek;\n  }\n\n  // This returns a JS Date from a DateTime instance\n  function startOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    return startOfDT(date, unit).toJSDate();\n  }\n\n  // This returns a DateTime instance\n  function endOfDT() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit$1(unit);\n    if (datePart) {\n      var dt = DateTime.fromJSDate(date);\n      return datePart.includes('week') ? endOfDTWeek(dt) : dt.endOf(datePart);\n    }\n    return DateTime.fromJSDate(date);\n  }\n  function endOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    return endOfDT(date, unit).toJSDate();\n  }\n  function eq(a, b, unit) {\n    var _defineComparators = defineComparators(a, b, unit),\n      _defineComparators2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators, 2),\n      dtA = _defineComparators2[0],\n      dtB = _defineComparators2[1];\n    return +dtA == +dtB;\n  }\n  function neq(a, b, unit) {\n    return !eq(a, b, unit);\n  }\n  function gt(a, b, unit) {\n    var _defineComparators3 = defineComparators(a, b, unit),\n      _defineComparators4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators3, 2),\n      dtA = _defineComparators4[0],\n      dtB = _defineComparators4[1];\n    return +dtA > +dtB;\n  }\n  function lt(a, b, unit) {\n    var _defineComparators5 = defineComparators(a, b, unit),\n      _defineComparators6 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators5, 2),\n      dtA = _defineComparators6[0],\n      dtB = _defineComparators6[1];\n    return +dtA < +dtB;\n  }\n  function gte(a, b, unit) {\n    var _defineComparators7 = defineComparators(a, b, unit),\n      _defineComparators8 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators7, 2),\n      dtA = _defineComparators8[0],\n      dtB = _defineComparators8[1];\n    return +dtA >= +dtB;\n  }\n  function lte(a, b, unit) {\n    var _defineComparators9 = defineComparators(a, b, unit),\n      _defineComparators10 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators9, 2),\n      dtA = _defineComparators10[0],\n      dtB = _defineComparators10[1];\n    return +dtA <= +dtB;\n  }\n  function inRange(day, min, max) {\n    var unit = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'day';\n    var datePart = fixUnit$1(unit);\n    var mDay = startOfDT(day, datePart);\n    var mMin = startOfDT(min, datePart);\n    var mMax = startOfDT(max, datePart);\n    return +mDay >= +mMin && +mDay <= +mMax;\n  }\n  function min(dateA, dateB) {\n    var dtA = DateTime.fromJSDate(dateA);\n    var dtB = DateTime.fromJSDate(dateB);\n    var minDt = DateTime.min(dtA, dtB);\n    return minDt.toJSDate();\n  }\n  function max(dateA, dateB) {\n    var dtA = DateTime.fromJSDate(dateA);\n    var dtB = DateTime.fromJSDate(dateB);\n    var maxDt = DateTime.max(dtA, dtB);\n    return maxDt.toJSDate();\n  }\n  function merge(date, time) {\n    if (!date && !time) return null;\n    var tm = DateTime.fromJSDate(time);\n    var dt = startOfDT(date, 'day');\n    return dt.set({\n      hour: tm.hour,\n      minute: tm.minute,\n      second: tm.second,\n      millisecond: tm.millisecond\n    }).toJSDate();\n  }\n  function add(date, adder, unit) {\n    var datePart = fixUnit$1(unit);\n    return DateTime.fromJSDate(date).plus((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_13__[\"default\"])({}, datePart, adder)).toJSDate();\n  }\n  function range(start, end) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit$1(unit);\n    var current = DateTime.fromJSDate(start).toJSDate(); // this is to get it to tz\n    var days = [];\n    while (lte(current, end)) {\n      days.push(current);\n      current = add(current, 1, datePart);\n    }\n    return days;\n  }\n  function ceil(date, unit) {\n    var datePart = fixUnit$1(unit);\n    var floor = startOf(date, datePart);\n    return eq(floor, date) ? floor : add(floor, 1, datePart);\n  }\n  function diff(a, b) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit$1(unit);\n    // don't use 'defineComparators' here, as we don't want to mutate the values\n    var dtA = DateTime.fromJSDate(a);\n    var dtB = DateTime.fromJSDate(b);\n    return Math.floor(dtB.diff(dtA, datePart, {\n      conversionAccuracy: 'longterm'\n    }).toObject()[datePart]);\n  }\n  function firstVisibleDay(date) {\n    var startOfMonth = startOfDT(date, 'month');\n    return startOfDTWeek(startOfMonth).toJSDate();\n  }\n  function lastVisibleDay(date) {\n    var endOfMonth = endOfDT(date, 'month');\n    return endOfDTWeek(endOfMonth).toJSDate();\n  }\n  function visibleDays(date) {\n    var current = firstVisibleDay(date);\n    var last = lastVisibleDay(date);\n    var days = [];\n    while (lte(current, last)) {\n      days.push(current);\n      current = add(current, 1, 'day');\n    }\n    return days;\n  }\n  /*** END localized date arithmetic methods with moment ***/\n\n  /**\n   * Moved from TimeSlots.js, this method overrides the method of the same name\n   * in the localizer.js, using moment to construct the js Date\n   * @param {Date} dt - date to start with\n   * @param {Number} minutesFromMidnight\n   * @param {Number} offset\n   * @returns {Date}\n   */\n  function getSlotDate(dt, minutesFromMidnight, offset) {\n    return startOfDT(dt, 'day').set({\n      minutes: minutesFromMidnight + offset\n    }).toJSDate();\n  }\n\n  // Luxon will automatically handle DST differences in it's calculations\n  function getTotalMin(start, end) {\n    return diff(start, end, 'minutes');\n  }\n  function getMinutesFromMidnight(start) {\n    var dayStart = startOfDT(start, 'day');\n    var day = DateTime.fromJSDate(start);\n    return Math.round(day.diff(dayStart, 'minutes', {\n      conversionAccuracy: 'longterm'\n    }).toObject().minutes);\n  }\n\n  // These two are used by DateSlotMetrics\n  function continuesPrior(start, first) {\n    return lt(start, first);\n  }\n  function continuesAfter(start, end, last) {\n    return gte(end, last);\n  }\n  function daySpan(start, end) {\n    var dtStart = DateTime.fromJSDate(start);\n    var dtEnd = DateTime.fromJSDate(end);\n    return dtEnd.diff(dtStart).as('days');\n  }\n\n  // These two are used by eventLevels\n  function sortEvents(_ref7) {\n    var _ref7$evtA = _ref7.evtA,\n      aStart = _ref7$evtA.start,\n      aEnd = _ref7$evtA.end,\n      aAllDay = _ref7$evtA.allDay,\n      _ref7$evtB = _ref7.evtB,\n      bStart = _ref7$evtB.start,\n      bEnd = _ref7$evtB.end,\n      bAllDay = _ref7$evtB.allDay;\n    var startSort = +startOf(aStart, 'day') - +startOf(bStart, 'day');\n    var durA = daySpan(aStart, aEnd);\n    var durB = daySpan(bStart, bEnd);\n    return startSort ||\n    // sort by start Day first\n    durB - durA ||\n    // events spanning multiple days go first\n    !!bAllDay - !!aAllDay ||\n    // then allDay single day events\n    +aStart - +bStart ||\n    // then sort by start time *don't need moment conversion here\n    +aEnd - +bEnd // then sort by end time *don't need moment conversion here either\n    ;\n  }\n  function inEventRange(_ref8) {\n    var _ref8$event = _ref8.event,\n      start = _ref8$event.start,\n      end = _ref8$event.end,\n      _ref8$range = _ref8.range,\n      rangeStart = _ref8$range.start,\n      rangeEnd = _ref8$range.end;\n    var eStart = startOf(start, 'day');\n    var startsBeforeEnd = lte(eStart, rangeEnd, 'day');\n    // when the event is zero duration we need to handle a bit differently\n    var sameMin = neq(eStart, end, 'minutes');\n    var endsAfterStart = sameMin ? gt(end, rangeStart, 'minutes') : gte(end, rangeStart, 'minutes');\n    return startsBeforeEnd && endsAfterStart;\n  }\n\n  // moment treats 'day' and 'date' equality very different\n  // moment(date1).isSame(date2, 'day') would test that they were both the same day of the week\n  // moment(date1).isSame(date2, 'date') would test that they were both the same date of the month of the year\n  function isSameDate(date1, date2) {\n    var dt = DateTime.fromJSDate(date1);\n    var dt2 = DateTime.fromJSDate(date2);\n    return dt.hasSame(dt2, 'day');\n  }\n\n  /**\n   * This method, called once in the localizer constructor, is used by eventLevels\n   * 'eventSegments()' to assist in determining the 'span' of the event in the display,\n   * specifically when using a timezone that is greater than the browser native timezone.\n   * @returns number\n   */\n  function browserTZOffset() {\n    /**\n     * Date.prototype.getTimezoneOffset horrifically flips the positive/negative from\n     * what you see in it's string, so we have to jump through some hoops to get a value\n     * we can actually compare.\n     */\n    var dt = new Date();\n    var neg = /-/.test(dt.toString()) ? '-' : '';\n    var dtOffset = dt.getTimezoneOffset();\n    var comparator = Number(\"\".concat(neg).concat(Math.abs(dtOffset)));\n    // moment correctly provides positive/negative offset, as expected\n    var mtOffset = DateTime.local().offset;\n    return mtOffset > comparator ? 1 : 0;\n  }\n  return new DateLocalizer({\n    format: function format(value, _format, culture) {\n      if (culture) {\n        return formatDateWithCulture(value, culture, _format);\n      }\n      return formatDate(value, _format);\n    },\n    formats: formats$4,\n    firstOfWeek: firstOfWeek,\n    firstVisibleDay: firstVisibleDay,\n    lastVisibleDay: lastVisibleDay,\n    visibleDays: visibleDays,\n    lt: lt,\n    lte: lte,\n    gt: gt,\n    gte: gte,\n    eq: eq,\n    neq: neq,\n    merge: merge,\n    inRange: inRange,\n    startOf: startOf,\n    endOf: endOf,\n    range: range,\n    add: add,\n    diff: diff,\n    ceil: ceil,\n    min: min,\n    max: max,\n    getSlotDate: getSlotDate,\n    getTotalMin: getTotalMin,\n    getMinutesFromMidnight: getMinutesFromMidnight,\n    continuesPrior: continuesPrior,\n    continuesAfter: continuesAfter,\n    sortEvents: sortEvents,\n    inEventRange: inEventRange,\n    isSameDate: isSameDate,\n    daySpan: daySpan,\n    browserTZOffset: browserTZOffset\n  });\n}\n\nvar dateRangeFormat$3 = function dateRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return local.format(start, 'd', culture) + '  ' + local.format(end, 'd', culture);\n};\nvar timeRangeFormat$3 = function timeRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return local.format(start, 't', culture) + '  ' + local.format(end, 't', culture);\n};\nvar timeRangeStartFormat$3 = function timeRangeStartFormat(_ref3, culture, local) {\n  var start = _ref3.start;\n  return local.format(start, 't', culture) + '  ';\n};\nvar timeRangeEndFormat$3 = function timeRangeEndFormat(_ref4, culture, local) {\n  var end = _ref4.end;\n  return '  ' + local.format(end, 't', culture);\n};\nvar weekRangeFormat$3 = function weekRangeFormat(_ref5, culture, local) {\n  var start = _ref5.start,\n    end = _ref5.end;\n  return local.format(start, 'MMM dd', culture) + '  ' + local.format(end, (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq)(start, end, 'month') ? 'dd' : 'MMM dd', culture);\n};\nvar formats$3 = {\n  dateFormat: 'dd',\n  dayFormat: 'ddd dd/MM',\n  weekdayFormat: 'ddd',\n  selectRangeFormat: timeRangeFormat$3,\n  eventTimeRangeFormat: timeRangeFormat$3,\n  eventTimeRangeStartFormat: timeRangeStartFormat$3,\n  eventTimeRangeEndFormat: timeRangeEndFormat$3,\n  timeGutterFormat: 't',\n  monthHeaderFormat: 'Y',\n  dayHeaderFormat: 'dddd MMM dd',\n  dayRangeHeaderFormat: weekRangeFormat$3,\n  agendaHeaderFormat: dateRangeFormat$3,\n  agendaDateFormat: 'ddd MMM dd',\n  agendaTimeFormat: 't',\n  agendaTimeRangeFormat: timeRangeFormat$3\n};\nfunction oldGlobalize (globalize) {\n  function getCulture(culture) {\n    return culture ? globalize.findClosestCulture(culture) : globalize.culture();\n  }\n  function firstOfWeek(culture) {\n    culture = getCulture(culture);\n    return culture && culture.calendar.firstDay || 0;\n  }\n  return new DateLocalizer({\n    firstOfWeek: firstOfWeek,\n    formats: formats$3,\n    format: function format(value, _format, culture) {\n      return globalize.format(value, _format, culture);\n    }\n  });\n}\n\n// TODO: fix the globalizeLocalizer to work with globalize 1.x\n\nvar dateRangeFormat$2 = function dateRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return local.format(start, {\n    date: 'short'\n  }, culture) + '  ' + local.format(end, {\n    date: 'short'\n  }, culture);\n};\nvar timeRangeFormat$2 = function timeRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return local.format(start, {\n    time: 'short'\n  }, culture) + '  ' + local.format(end, {\n    time: 'short'\n  }, culture);\n};\nvar timeRangeStartFormat$2 = function timeRangeStartFormat(_ref3, culture, local) {\n  var start = _ref3.start;\n  return local.format(start, {\n    time: 'short'\n  }, culture) + '  ';\n};\nvar timeRangeEndFormat$2 = function timeRangeEndFormat(_ref4, culture, local) {\n  var end = _ref4.end;\n  return '  ' + local.format(end, {\n    time: 'short'\n  }, culture);\n};\nvar weekRangeFormat$2 = function weekRangeFormat(_ref5, culture, local) {\n  var start = _ref5.start,\n    end = _ref5.end;\n  return local.format(start, 'MMM dd', culture) + '  ' + local.format(end, (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq)(start, end, 'month') ? 'dd' : 'MMM dd', culture);\n};\nvar formats$2 = {\n  dateFormat: 'dd',\n  dayFormat: 'eee dd/MM',\n  weekdayFormat: 'eee',\n  selectRangeFormat: timeRangeFormat$2,\n  eventTimeRangeFormat: timeRangeFormat$2,\n  eventTimeRangeStartFormat: timeRangeStartFormat$2,\n  eventTimeRangeEndFormat: timeRangeEndFormat$2,\n  timeGutterFormat: {\n    time: 'short'\n  },\n  monthHeaderFormat: 'MMMM yyyy',\n  dayHeaderFormat: 'eeee MMM dd',\n  dayRangeHeaderFormat: weekRangeFormat$2,\n  agendaHeaderFormat: dateRangeFormat$2,\n  agendaDateFormat: 'eee MMM dd',\n  agendaTimeFormat: {\n    time: 'short'\n  },\n  agendaTimeRangeFormat: timeRangeFormat$2\n};\nfunction globalize (globalize) {\n  var locale = function locale(culture) {\n    return culture ? globalize(culture) : globalize;\n  };\n\n  // return the first day of the week from the locale data. Defaults to 'world'\n  // territory if no territory is derivable from CLDR.\n  // Failing to use CLDR supplemental (not loaded?), revert to the original\n  // method of getting first day of week.\n  function firstOfWeek(culture) {\n    try {\n      var days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n      var cldr = locale(culture).cldr;\n      var territory = cldr.attributes.territory;\n      var weekData = cldr.get('supplemental').weekData;\n      var firstDay = weekData.firstDay[territory || '001'];\n      return days.indexOf(firstDay);\n    } catch (e) {\n      if (true) {\n        console.error('Failed to accurately determine first day of the week.' + ' Is supplemental data loaded into CLDR?');\n      }\n      // maybe cldr supplemental is not loaded? revert to original method\n      var date = new Date();\n      //cldr-data doesn't seem to be zero based\n      var localeDay = Math.max(parseInt(locale(culture).formatDate(date, {\n        raw: 'e'\n      }), 10) - 1, 0);\n      return Math.abs(date.getDay() - localeDay);\n    }\n  }\n  if (!globalize.load) return oldGlobalize(globalize);\n  return new DateLocalizer({\n    firstOfWeek: firstOfWeek,\n    formats: formats$2,\n    format: function format(value, _format, culture) {\n      _format = typeof _format === 'string' ? {\n        raw: _format\n      } : _format;\n      return locale(culture).formatDate(value, _format);\n    }\n  });\n}\n\nvar dateRangeFormat$1 = function dateRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return \"\".concat(local.format(start, 'P', culture), \" \\u2013 \").concat(local.format(end, 'P', culture));\n};\nvar timeRangeFormat$1 = function timeRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return \"\".concat(local.format(start, 'p', culture), \" \\u2013 \").concat(local.format(end, 'p', culture));\n};\nvar timeRangeStartFormat$1 = function timeRangeStartFormat(_ref3, culture, local) {\n  var start = _ref3.start;\n  return \"\".concat(local.format(start, 'h:mma', culture), \" \\u2013 \");\n};\nvar timeRangeEndFormat$1 = function timeRangeEndFormat(_ref4, culture, local) {\n  var end = _ref4.end;\n  return \" \\u2013 \".concat(local.format(end, 'h:mma', culture));\n};\nvar weekRangeFormat$1 = function weekRangeFormat(_ref5, culture, local) {\n  var start = _ref5.start,\n    end = _ref5.end;\n  return \"\".concat(local.format(start, 'MMMM dd', culture), \" \\u2013 \").concat(local.format(end, (0,date_arithmetic__WEBPACK_IMPORTED_MODULE_12__.eq)(start, end, 'month') ? 'dd' : 'MMMM dd', culture));\n};\nvar formats$1 = {\n  dateFormat: 'dd',\n  dayFormat: 'dd eee',\n  weekdayFormat: 'cccc',\n  selectRangeFormat: timeRangeFormat$1,\n  eventTimeRangeFormat: timeRangeFormat$1,\n  eventTimeRangeStartFormat: timeRangeStartFormat$1,\n  eventTimeRangeEndFormat: timeRangeEndFormat$1,\n  timeGutterFormat: 'p',\n  monthHeaderFormat: 'MMMM yyyy',\n  dayHeaderFormat: 'cccc MMM dd',\n  dayRangeHeaderFormat: weekRangeFormat$1,\n  agendaHeaderFormat: dateRangeFormat$1,\n  agendaDateFormat: 'ccc MMM dd',\n  agendaTimeFormat: 'p',\n  agendaTimeRangeFormat: timeRangeFormat$1\n};\nvar dateFnsLocalizer = function dateFnsLocalizer(_ref6) {\n  var startOfWeek = _ref6.startOfWeek,\n    getDay = _ref6.getDay,\n    _format = _ref6.format,\n    locales = _ref6.locales;\n  return new DateLocalizer({\n    formats: formats$1,\n    firstOfWeek: function firstOfWeek(culture) {\n      return getDay(startOfWeek(new Date(), {\n        locale: locales[culture]\n      }));\n    },\n    format: function format(value, formatString, culture) {\n      return _format(new Date(value), formatString, {\n        locale: locales[culture]\n      });\n    }\n  });\n};\n\nvar weekRangeFormat = function weekRangeFormat(_ref, culture, local) {\n  var start = _ref.start,\n    end = _ref.end;\n  return local.format(start, 'MMMM DD', culture) + '  ' +\n  // updated to use this localizer 'eq()' method\n  local.format(end, local.eq(start, end, 'month') ? 'DD' : 'MMMM DD', culture);\n};\nvar dateRangeFormat = function dateRangeFormat(_ref2, culture, local) {\n  var start = _ref2.start,\n    end = _ref2.end;\n  return local.format(start, 'L', culture) + '  ' + local.format(end, 'L', culture);\n};\nvar timeRangeFormat = function timeRangeFormat(_ref3, culture, local) {\n  var start = _ref3.start,\n    end = _ref3.end;\n  return local.format(start, 'LT', culture) + '  ' + local.format(end, 'LT', culture);\n};\nvar timeRangeStartFormat = function timeRangeStartFormat(_ref4, culture, local) {\n  var start = _ref4.start;\n  return local.format(start, 'LT', culture) + '  ';\n};\nvar timeRangeEndFormat = function timeRangeEndFormat(_ref5, culture, local) {\n  var end = _ref5.end;\n  return '  ' + local.format(end, 'LT', culture);\n};\nvar formats = {\n  dateFormat: 'DD',\n  dayFormat: 'DD ddd',\n  weekdayFormat: 'ddd',\n  selectRangeFormat: timeRangeFormat,\n  eventTimeRangeFormat: timeRangeFormat,\n  eventTimeRangeStartFormat: timeRangeStartFormat,\n  eventTimeRangeEndFormat: timeRangeEndFormat,\n  timeGutterFormat: 'LT',\n  monthHeaderFormat: 'MMMM YYYY',\n  dayHeaderFormat: 'dddd MMM DD',\n  dayRangeHeaderFormat: weekRangeFormat,\n  agendaHeaderFormat: dateRangeFormat,\n  agendaDateFormat: 'ddd MMM DD',\n  agendaTimeFormat: 'LT',\n  agendaTimeRangeFormat: timeRangeFormat\n};\nfunction fixUnit(unit) {\n  var datePart = unit ? unit.toLowerCase() : unit;\n  if (datePart === 'FullYear') {\n    datePart = 'year';\n  } else if (!datePart) {\n    datePart = undefined;\n  }\n  return datePart;\n}\nfunction dayjs (dayjsLib) {\n  // load dayjs plugins\n  dayjsLib.extend((dayjs_plugin_isBetween__WEBPACK_IMPORTED_MODULE_37___default()));\n  dayjsLib.extend((dayjs_plugin_isSameOrAfter__WEBPACK_IMPORTED_MODULE_38___default()));\n  dayjsLib.extend((dayjs_plugin_isSameOrBefore__WEBPACK_IMPORTED_MODULE_39___default()));\n  dayjsLib.extend((dayjs_plugin_localeData__WEBPACK_IMPORTED_MODULE_40___default()));\n  dayjsLib.extend((dayjs_plugin_localizedFormat__WEBPACK_IMPORTED_MODULE_41___default()));\n  dayjsLib.extend((dayjs_plugin_minMax__WEBPACK_IMPORTED_MODULE_42___default()));\n  dayjsLib.extend((dayjs_plugin_utc__WEBPACK_IMPORTED_MODULE_43___default()));\n  var locale = function locale(dj, c) {\n    return c ? dj.locale(c) : dj;\n  };\n\n  // if the timezone plugin is loaded,\n  // then use the timezone aware version\n  var dayjs = dayjsLib.tz ? dayjsLib.tz : dayjsLib;\n  function getTimezoneOffset(date) {\n    // ensures this gets cast to timezone\n    return dayjs(date).toDate().getTimezoneOffset();\n  }\n  function getDstOffset(start, end) {\n    var _st$tz$$x$$timezone;\n    // convert to dayjs, in case\n    var st = dayjs(start);\n    var ed = dayjs(end);\n    // if not using the dayjs timezone plugin\n    if (!dayjs.tz) {\n      return st.toDate().getTimezoneOffset() - ed.toDate().getTimezoneOffset();\n    }\n    /**\n     * If a default timezone has been applied, then\n     * use this to get the proper timezone offset, otherwise default\n     * the timezone to the browser local\n     */\n    var tzName = (_st$tz$$x$$timezone = st.tz().$x.$timezone) !== null && _st$tz$$x$$timezone !== void 0 ? _st$tz$$x$$timezone : dayjsLib.tz.guess();\n    // invert offsets to be inline with moment.js\n    var startOffset = -dayjs.tz(+st, tzName).utcOffset();\n    var endOffset = -dayjs.tz(+ed, tzName).utcOffset();\n    return startOffset - endOffset;\n  }\n  function getDayStartDstOffset(start) {\n    var dayStart = dayjs(start).startOf('day');\n    return getDstOffset(dayStart, start);\n  }\n\n  /*** BEGIN localized date arithmetic methods with dayjs ***/\n  function defineComparators(a, b, unit) {\n    var datePart = fixUnit(unit);\n    var dtA = datePart ? dayjs(a).startOf(datePart) : dayjs(a);\n    var dtB = datePart ? dayjs(b).startOf(datePart) : dayjs(b);\n    return [dtA, dtB, datePart];\n  }\n  function startOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit(unit);\n    if (datePart) {\n      return dayjs(date).startOf(datePart).toDate();\n    }\n    return dayjs(date).toDate();\n  }\n  function endOf() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var unit = arguments.length > 1 ? arguments[1] : undefined;\n    var datePart = fixUnit(unit);\n    if (datePart) {\n      return dayjs(date).endOf(datePart).toDate();\n    }\n    return dayjs(date).toDate();\n  }\n\n  // dayjs comparison operations *always* convert both sides to dayjs objects\n  // prior to running the comparisons\n  function eq(a, b, unit) {\n    var _defineComparators = defineComparators(a, b, unit),\n      _defineComparators2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators, 3),\n      dtA = _defineComparators2[0],\n      dtB = _defineComparators2[1],\n      datePart = _defineComparators2[2];\n    return dtA.isSame(dtB, datePart);\n  }\n  function neq(a, b, unit) {\n    return !eq(a, b, unit);\n  }\n  function gt(a, b, unit) {\n    var _defineComparators3 = defineComparators(a, b, unit),\n      _defineComparators4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators3, 3),\n      dtA = _defineComparators4[0],\n      dtB = _defineComparators4[1],\n      datePart = _defineComparators4[2];\n    return dtA.isAfter(dtB, datePart);\n  }\n  function lt(a, b, unit) {\n    var _defineComparators5 = defineComparators(a, b, unit),\n      _defineComparators6 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators5, 3),\n      dtA = _defineComparators6[0],\n      dtB = _defineComparators6[1],\n      datePart = _defineComparators6[2];\n    return dtA.isBefore(dtB, datePart);\n  }\n  function gte(a, b, unit) {\n    var _defineComparators7 = defineComparators(a, b, unit),\n      _defineComparators8 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators7, 3),\n      dtA = _defineComparators8[0],\n      dtB = _defineComparators8[1],\n      datePart = _defineComparators8[2];\n    return dtA.isSameOrBefore(dtB, datePart);\n  }\n  function lte(a, b, unit) {\n    var _defineComparators9 = defineComparators(a, b, unit),\n      _defineComparators10 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(_defineComparators9, 3),\n      dtA = _defineComparators10[0],\n      dtB = _defineComparators10[1],\n      datePart = _defineComparators10[2];\n    return dtA.isSameOrBefore(dtB, datePart);\n  }\n  function inRange(day, min, max) {\n    var unit = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'day';\n    var datePart = fixUnit(unit);\n    var djDay = dayjs(day);\n    var djMin = dayjs(min);\n    var djMax = dayjs(max);\n    return djDay.isBetween(djMin, djMax, datePart, '[]');\n  }\n  function min(dateA, dateB) {\n    var dtA = dayjs(dateA);\n    var dtB = dayjs(dateB);\n    var minDt = dayjsLib.min(dtA, dtB);\n    return minDt.toDate();\n  }\n  function max(dateA, dateB) {\n    var dtA = dayjs(dateA);\n    var dtB = dayjs(dateB);\n    var maxDt = dayjsLib.max(dtA, dtB);\n    return maxDt.toDate();\n  }\n  function merge(date, time) {\n    if (!date && !time) return null;\n    var tm = dayjs(time).format('HH:mm:ss');\n    var dt = dayjs(date).startOf('day').format('MM/DD/YYYY');\n    // We do it this way to avoid issues when timezone switching\n    return dayjsLib(\"\".concat(dt, \" \").concat(tm), 'MM/DD/YYYY HH:mm:ss').toDate();\n  }\n  function add(date, adder, unit) {\n    var datePart = fixUnit(unit);\n    return dayjs(date).add(adder, datePart).toDate();\n  }\n  function range(start, end) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit(unit);\n    // because the add method will put these in tz, we have to start that way\n    var current = dayjs(start).toDate();\n    var days = [];\n    while (lte(current, end)) {\n      days.push(current);\n      current = add(current, 1, datePart);\n    }\n    return days;\n  }\n  function ceil(date, unit) {\n    var datePart = fixUnit(unit);\n    var floor = startOf(date, datePart);\n    return eq(floor, date) ? floor : add(floor, 1, datePart);\n  }\n  function diff(a, b) {\n    var unit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'day';\n    var datePart = fixUnit(unit);\n    // don't use 'defineComparators' here, as we don't want to mutate the values\n    var dtA = dayjs(a);\n    var dtB = dayjs(b);\n    return dtB.diff(dtA, datePart);\n  }\n  function minutes(date) {\n    var dt = dayjs(date);\n    return dt.minutes();\n  }\n  function firstOfWeek(culture) {\n    var data = culture ? dayjsLib.localeData(culture) : dayjsLib.localeData();\n    return data ? data.firstDayOfWeek() : 0;\n  }\n  function firstVisibleDay(date) {\n    return dayjs(date).startOf('month').startOf('week').toDate();\n  }\n  function lastVisibleDay(date) {\n    return dayjs(date).endOf('month').endOf('week').toDate();\n  }\n  function visibleDays(date) {\n    var current = firstVisibleDay(date);\n    var last = lastVisibleDay(date);\n    var days = [];\n    while (lte(current, last)) {\n      days.push(current);\n      current = add(current, 1, 'd');\n    }\n    return days;\n  }\n  /*** END localized date arithmetic methods with dayjs ***/\n\n  /**\n   * Moved from TimeSlots.js, this method overrides the method of the same name\n   * in the localizer.js, using dayjs to construct the js Date\n   * @param {Date} dt - date to start with\n   * @param {Number} minutesFromMidnight\n   * @param {Number} offset\n   * @returns {Date}\n   */\n  function getSlotDate(dt, minutesFromMidnight, offset) {\n    return dayjs(dt).startOf('day').minute(minutesFromMidnight + offset).toDate();\n  }\n\n  // dayjs will automatically handle DST differences in it's calculations\n  function getTotalMin(start, end) {\n    return diff(start, end, 'minutes');\n  }\n  function getMinutesFromMidnight(start) {\n    var dayStart = dayjs(start).startOf('day');\n    var day = dayjs(start);\n    return day.diff(dayStart, 'minutes') + getDayStartDstOffset(start);\n  }\n\n  // These two are used by DateSlotMetrics\n  function continuesPrior(start, first) {\n    var djStart = dayjs(start);\n    var djFirst = dayjs(first);\n    return djStart.isBefore(djFirst, 'day');\n  }\n  function continuesAfter(start, end, last) {\n    var djEnd = dayjs(end);\n    var djLast = dayjs(last);\n    return djEnd.isSameOrAfter(djLast, 'minutes');\n  }\n  function daySpan(start, end) {\n    var startDay = dayjs(start);\n    var endDay = dayjs(end);\n    return endDay.diff(startDay, 'day');\n  }\n\n  // These two are used by eventLevels\n  function sortEvents(_ref6) {\n    var _ref6$evtA = _ref6.evtA,\n      aStart = _ref6$evtA.start,\n      aEnd = _ref6$evtA.end,\n      aAllDay = _ref6$evtA.allDay,\n      _ref6$evtB = _ref6.evtB,\n      bStart = _ref6$evtB.start,\n      bEnd = _ref6$evtB.end,\n      bAllDay = _ref6$evtB.allDay;\n    var startSort = +startOf(aStart, 'day') - +startOf(bStart, 'day');\n    var durA = daySpan(aStart, aEnd);\n    var durB = daySpan(bStart, bEnd);\n    return startSort ||\n    // sort by start Day first\n    durB - durA ||\n    // events spanning multiple days go first\n    !!bAllDay - !!aAllDay ||\n    // then allDay single day events\n    +aStart - +bStart ||\n    // then sort by start time *don't need dayjs conversion here\n    +aEnd - +bEnd // then sort by end time *don't need dayjs conversion here either\n    ;\n  }\n  function inEventRange(_ref7) {\n    var _ref7$event = _ref7.event,\n      start = _ref7$event.start,\n      end = _ref7$event.end,\n      _ref7$range = _ref7.range,\n      rangeStart = _ref7$range.start,\n      rangeEnd = _ref7$range.end;\n    var startOfDay = dayjs(start).startOf('day');\n    var eEnd = dayjs(end);\n    var rStart = dayjs(rangeStart);\n    var rEnd = dayjs(rangeEnd);\n    var startsBeforeEnd = startOfDay.isSameOrBefore(rEnd, 'day');\n    // when the event is zero duration we need to handle a bit differently\n    var sameMin = !startOfDay.isSame(eEnd, 'minutes');\n    var endsAfterStart = sameMin ? eEnd.isAfter(rStart, 'minutes') : eEnd.isSameOrAfter(rStart, 'minutes');\n    return startsBeforeEnd && endsAfterStart;\n  }\n  function isSameDate(date1, date2) {\n    var dt = dayjs(date1);\n    var dt2 = dayjs(date2);\n    return dt.isSame(dt2, 'day');\n  }\n\n  /**\n   * This method, called once in the localizer constructor, is used by eventLevels\n   * 'eventSegments()' to assist in determining the 'span' of the event in the display,\n   * specifically when using a timezone that is greater than the browser native timezone.\n   * @returns number\n   */\n  function browserTZOffset() {\n    /**\n     * Date.prototype.getTimezoneOffset horrifically flips the positive/negative from\n     * what you see in it's string, so we have to jump through some hoops to get a value\n     * we can actually compare.\n     */\n    var dt = new Date();\n    var neg = /-/.test(dt.toString()) ? '-' : '';\n    var dtOffset = dt.getTimezoneOffset();\n    var comparator = Number(\"\".concat(neg).concat(Math.abs(dtOffset)));\n    // dayjs correctly provides positive/negative offset, as expected\n    var mtOffset = dayjs().utcOffset();\n    return mtOffset > comparator ? 1 : 0;\n  }\n  return new DateLocalizer({\n    formats: formats,\n    firstOfWeek: firstOfWeek,\n    firstVisibleDay: firstVisibleDay,\n    lastVisibleDay: lastVisibleDay,\n    visibleDays: visibleDays,\n    format: function format(value, _format, culture) {\n      return locale(dayjs(value), culture).format(_format);\n    },\n    lt: lt,\n    lte: lte,\n    gt: gt,\n    gte: gte,\n    eq: eq,\n    neq: neq,\n    merge: merge,\n    inRange: inRange,\n    startOf: startOf,\n    endOf: endOf,\n    range: range,\n    add: add,\n    diff: diff,\n    ceil: ceil,\n    min: min,\n    max: max,\n    minutes: minutes,\n    getSlotDate: getSlotDate,\n    getTimezoneOffset: getTimezoneOffset,\n    getDstOffset: getDstOffset,\n    getTotalMin: getTotalMin,\n    getMinutesFromMidnight: getMinutesFromMidnight,\n    continuesPrior: continuesPrior,\n    continuesAfter: continuesAfter,\n    sortEvents: sortEvents,\n    inEventRange: inEventRange,\n    isSameDate: isSameDate,\n    browserTZOffset: browserTZOffset\n  });\n}\n\nvar components = {\n  eventWrapper: NoopWrapper,\n  timeSlotWrapper: NoopWrapper,\n  dateCellWrapper: NoopWrapper\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcmVhY3QtYmlnLWNhbGVuZGFyL2Rpc3QvcmVhY3QtYmlnLWNhbGVuZGFyLmVzbS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRTtBQUNxQjtBQUNsQztBQUNnQjtBQUNOO0FBQ0o7QUFDRjtBQUNVO0FBQ2tEO0FBQ3hFO0FBQ3hCO0FBQ1c7QUFDRDtBQUNPO0FBQ2lGO0FBQ2xEO0FBQ007QUFDN0M7QUFDZ0I7QUFDWTtBQUNwQjtBQUNFO0FBQ0o7QUFDSTtBQUNJO0FBQ0g7QUFDRjtBQUNGO0FBQ0M7QUFDTjtBQUNEO0FBQ0M7QUFDbUI7QUFDYjtBQUNpQjtBQUNkO0FBQ007QUFDbkI7QUFDUTtBQUNFO0FBQ0E7QUFDTTtBQUNRO0FBQ0U7QUFDUjtBQUNVO0FBQ2xCO0FBQ047O0FBRW5DO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDREQUFtQixFQUFFLDJEQUFnQixFQUFFLHlEQUFjO0FBQ3JELHdEQUFhO0FBQ2IseURBQWM7O0FBRWQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDREQUFtQixFQUFFLDBEQUFpQixDQUFDLHdEQUFlLGdCQUFnQiwyREFBa0I7QUFDeEY7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLDJGQUEyRixhQUFhO0FBQ3hHO0FBQ0E7QUFDQSxXQUFXLDhEQUFxQixPQUFPLG9EQUFTO0FBQ2hEO0FBQ0EsQ0FBQztBQUNELDREQUFtQixFQUFFLHdEQUFlLDZCQUE2Qix5REFBYzs7QUFFL0U7QUFDQTtBQUNBOztBQUVB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QTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0NBQXdDLGlFQUFRO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGlFQUFRO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSxNQUFNLDZFQUFPO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvQkFBb0I7QUFDaEMsWUFBWSxvQkFBb0I7QUFDaEMsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVksYUFBYTtBQUN6QixZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHFGQUFlO0FBQ25CLFlBQVksZ0ZBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGdEQUFTO0FBQy9DO0FBQ0E7QUFDQSxFQUFFLCtFQUFTO0FBQ1gsU0FBUyxrRkFBWTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMERBQW1CO0FBQzdDO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMERBQW1CO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZUFBZSwwREFBbUI7QUFDM0M7QUFDQSxxQkFBcUIsaURBQUk7QUFDekIsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSwyQkFBMkIsb0ZBQWEsQ0FBQyxvRkFBYSxHQUFHLG1CQUFtQjtBQUM1RTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSCxDQUFDLENBQUMsd0RBQWU7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyREFBZ0I7QUFDakMsY0FBYywyREFBZ0I7QUFDOUIsY0FBYyx5REFBYztBQUM1QixlQUFlLDJEQUFnQjtBQUMvQixlQUFlLDJEQUFnQjtBQUMvQixnQkFBZ0IsMkRBQWdCO0FBQ2hDLGFBQWEsMkRBQWdCO0FBQzdCLGNBQWMseURBQWM7QUFDNUIsbUJBQW1CLHlEQUFjO0FBQ2pDLGdCQUFnQix5REFBYztBQUM5QixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMERBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwREFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUkscUZBQWU7QUFDbkIsV0FBVyxnRkFBVTtBQUNyQjtBQUNBLEVBQUUsK0VBQVM7QUFDWCxTQUFTLGtGQUFZO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMERBQW1CO0FBQzdDLG1CQUFtQixpREFBSTtBQUN2QixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSCxDQUFDLENBQUMsd0RBQWU7QUFDakIsd0JBQXdCLG9GQUFhLEdBQUc7O0FBRXhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdEQUFTO0FBQ3pCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx3QkFBd0I7QUFDdEM7QUFDQSxnQkFBZ0IsbUJBQW1CO0FBQ25DO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsY0FBYyxtQkFBbUI7QUFDakM7QUFDQTtBQUNBLEtBQUssR0FBRztBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsYUFBYSx5RkFBa0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsbUJBQW1CLHlGQUFrQixlQUFlLHlGQUFrQjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUkscUZBQWU7QUFDbkIsV0FBVyxnRkFBVTtBQUNyQjtBQUNBLEVBQUUsK0VBQVM7QUFDWCxTQUFTLGtGQUFZO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxVQUFVO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qjs7QUFFNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBEQUFtQjtBQUM3QztBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxhQUFhLG9EQUFPO0FBQ3BCO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDBEQUFtQjtBQUNyRDtBQUNBO0FBQ0EsbUJBQW1CLGlEQUFJO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQ0FBQyxDQUFDLHdEQUFlO0FBQ2pCLDhCQUE4QixvRkFBYSxHQUFHOztBQUU5QztBQUNBO0FBQ0Esc0JBQXNCLDBEQUFtQjtBQUN6QztBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsd0RBQU87QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG9GQUFhLENBQUMsb0ZBQWEsR0FBRztBQUNyRCxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSSxxRkFBZTtBQUNuQix3RUFBd0UsYUFBYTtBQUNyRjtBQUNBO0FBQ0EsWUFBWSxnRkFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlFQUFHO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsaURBQUk7QUFDdkIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBEQUFtQjtBQUM3QztBQUNBO0FBQ0EsT0FBTyxlQUFlLDBEQUFtQjtBQUN6QyxtQkFBbUIsaURBQUk7QUFDdkIsT0FBTywrQkFBK0IsMERBQW1CO0FBQ3pEO0FBQ0E7QUFDQSxPQUFPLG9EQUFvRCwwREFBbUI7QUFDOUU7QUFDQTtBQUNBLE9BQU8sZUFBZSwwREFBbUI7QUFDekM7QUFDQSxPQUFPLGVBQWUsMERBQW1CO0FBQ3pDO0FBQ0EsT0FBTyxlQUFlLDBEQUFtQjtBQUN6QztBQUNBLE9BQU87QUFDUDtBQUNBLHNDQUFzQyxnREFBUztBQUMvQyx1Q0FBdUMsZ0RBQVM7QUFDaEQscUNBQXFDLGdEQUFTO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLEVBQUUsK0VBQVM7QUFDWCxTQUFTLGtGQUFZO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtEQUFTO0FBQ2pDLGlKQUFpSiwrREFBUztBQUMxSix1QkFBdUIsK0RBQVM7QUFDaEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMERBQW1CO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLE9BQU8sZUFBZSwwREFBbUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sZ0JBQWdCLDBEQUFtQjtBQUMxQyxtQkFBbUIsaURBQUk7QUFDdkI7QUFDQSxPQUFPLCtCQUErQiwwREFBbUI7QUFDekQ7QUFDQTtBQUNBLE9BQU8sbURBQW1ELDBEQUFtQiw2Q0FBNkMsMERBQW1CO0FBQzdJO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLDRCQUE0QiwwREFBbUI7QUFDL0M7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPLGtDQUFrQywwREFBbUI7QUFDNUQ7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSCxDQUFDLENBQUMsd0RBQWU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHNCQUFzQiwwREFBbUI7QUFDekM7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBEQUFtQjtBQUMzQztBQUNBLHNCQUFzQiwwREFBbUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHFGQUFlO0FBQ25CLHlFQUF5RSxhQUFhO0FBQ3RGO0FBQ0E7QUFDQSxZQUFZLGdGQUFVO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0NBQXNDLHlGQUFrQjtBQUN4RDtBQUNBLDBCQUEwQiwwREFBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4RkFBd0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBEQUFtQix3QkFBd0I7QUFDckUsbUJBQW1CLGlEQUFJO0FBQ3ZCO0FBQ0EsT0FBTyxnQkFBZ0IsMERBQW1CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGVBQWU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGVBQWU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGVBQWU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpRUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGdEQUFTO0FBQy9DLG9DQUFvQyxnREFBUztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsK0VBQVM7QUFDWCxTQUFTLGtGQUFZO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxnRUFBc0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsYUFBYSxHQUFHO0FBQ2hCLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixvREFBSztBQUNyQjtBQUNBLDBCQUEwQiwwREFBbUI7QUFDN0MsbUJBQW1CLGlEQUFJO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLE9BQU8sZUFBZSwwREFBbUI7QUFDekM7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMERBQW1CO0FBQy9DO0FBQ0E7QUFDQSxTQUFTLGVBQWUsMERBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLDBCQUEwQiwwREFBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixrQkFBa0Isc0JBQXNCLGVBQWU7QUFDdkQsa0JBQWtCO0FBQ2xCO0FBQ0EsV0FBVyxHQUFHLE9BQU87QUFDckI7QUFDQSxlQUFlO0FBQ2YsMkJBQTJCO0FBQzNCLHlCQUF5QjtBQUN6Qix1QkFBdUI7QUFDdkIsd0JBQXdCO0FBQ3hCLDBCQUEwQjtBQUMxQix5QkFBeUI7QUFDekIsd0JBQXdCO0FBQ3hCLG9CQUFvQjtBQUNwQixzQkFBc0I7QUFDdEIseUJBQXlCO0FBQ3pCLHVCQUF1QjtBQUN2Qix3QkFBd0I7QUFDeEIsNkJBQTZCO0FBQzdCLDBCQUEwQjtBQUMxQiwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDLENBQUMsd0RBQWU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQSx1QkFBdUIsa0JBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUkscUZBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsa0ZBQVk7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxnQkFBZ0I7O0FBRWhCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxpQkFBaUIsOERBQWM7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBYztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBYztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBYztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBYztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvRkFBYztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLFFBQVE7QUFDckIsYUFBYSxRQUFRO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0ZBQW9GO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsTUFBTTtBQUNOLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLE1BQU07QUFDTixrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG9GQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixvRkFBYztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0ZBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG9GQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvRkFBYztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHNGQUFlLEdBQUc7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLFFBQVE7QUFDckIsYUFBYSxRQUFRO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RSxvREFBRTtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RSxvREFBRTtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sVUFBVSxJQUFxQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRyxvREFBRTtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnRUFBUztBQUMzQixrQkFBa0Isb0VBQWE7QUFDL0Isa0JBQWtCLHFFQUFjO0FBQ2hDLGtCQUFrQixpRUFBVTtBQUM1QixrQkFBa0Isc0VBQWU7QUFDakMsa0JBQWtCLDZEQUFNO0FBQ3hCLGtCQUFrQiwwREFBRztBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0ZBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0ZBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0ZBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0ZBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsb0ZBQWM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxRQUFRO0FBQ3JCLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFQIiwic291cmNlcyI6WyIvVXNlcnMvamFzb25raW0vRGVza3RvcC9TeW5hcHNlIERhc2hib2FyZC9ub2RlX21vZHVsZXMvcmVhY3QtYmlnLWNhbGVuZGFyL2Rpc3QvcmVhY3QtYmlnLWNhbGVuZGFyLmVzbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyJztcbmltcG9ydCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXMnO1xuaW1wb3J0IF90eXBlb2YgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mJztcbmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2snO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyc7XG5pbXBvcnQgX2NhbGxTdXBlciBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jYWxsU3VwZXInO1xuaW1wb3J0IF9pbmhlcml0cyBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyc7XG5pbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSc7XG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VMYXlvdXRFZmZlY3QsIHVzZVJlZiwgY3JlYXRlUmVmLCBDb21wb25lbnQsIHVzZU1lbW8sIHVzZVN0YXRlLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVuY29udHJvbGxhYmxlIH0gZnJvbSAndW5jb250cm9sbGFibGUnO1xuaW1wb3J0IGNsc3ggZnJvbSAnY2xzeCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IGludmFyaWFudCBmcm9tICdpbnZhcmlhbnQnO1xuaW1wb3J0ICogYXMgZGF0ZXMgZnJvbSAnZGF0ZS1hcml0aG1ldGljJztcbmltcG9ydCB7IGluUmFuZ2UgYXMgaW5SYW5nZSQxLCBsdCwgbHRlLCBndCwgZ3RlLCBlcSwgbmVxLCBzdGFydE9mLCBlbmRPZiwgYWRkLCBtaW4sIG1heCwgbWludXRlcyB9IGZyb20gJ2RhdGUtYXJpdGhtZXRpYyc7XG5pbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5JztcbmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXknO1xuaW1wb3J0IGNodW5rIGZyb20gJ2xvZGFzaC9jaHVuayc7XG5pbXBvcnQgZ2V0UG9zaXRpb24kMSBmcm9tICdkb20taGVscGVycy9wb3NpdGlvbic7XG5pbXBvcnQgKiBhcyBhbmltYXRpb25GcmFtZSBmcm9tICdkb20taGVscGVycy9hbmltYXRpb25GcmFtZSc7XG5pbXBvcnQgeyBPdmVybGF5IH0gZnJvbSAncmVhY3Qtb3ZlcmxheXMnO1xuaW1wb3J0IGdldE9mZnNldCBmcm9tICdkb20taGVscGVycy9vZmZzZXQnO1xuaW1wb3J0IGlzRXF1YWwkMSBmcm9tICdsb2Rhc2gvaXNFcXVhbCc7XG5pbXBvcnQgZ2V0SGVpZ2h0IGZyb20gJ2RvbS1oZWxwZXJzL2hlaWdodCc7XG5pbXBvcnQgcXNhIGZyb20gJ2RvbS1oZWxwZXJzL3F1ZXJ5U2VsZWN0b3JBbGwnO1xuaW1wb3J0IGNvbnRhaW5zIGZyb20gJ2RvbS1oZWxwZXJzL2NvbnRhaW5zJztcbmltcG9ydCBjbG9zZXN0IGZyb20gJ2RvbS1oZWxwZXJzL2Nsb3Nlc3QnO1xuaW1wb3J0IGxpc3RlbiBmcm9tICdkb20taGVscGVycy9saXN0ZW4nO1xuaW1wb3J0IGZpbmRJbmRleCBmcm9tICdsb2Rhc2gvZmluZEluZGV4JztcbmltcG9ydCByYW5nZSQxIGZyb20gJ2xvZGFzaC9yYW5nZSc7XG5pbXBvcnQgbWVtb2l6ZSBmcm9tICdtZW1vaXplLW9uZSc7XG5pbXBvcnQgc29ydEJ5IGZyb20gJ2xvZGFzaC9zb3J0QnknO1xuaW1wb3J0IHNjcm9sbGJhclNpemUgZnJvbSAnZG9tLWhlbHBlcnMvc2Nyb2xsYmFyU2l6ZSc7XG5pbXBvcnQgZ2V0V2lkdGggZnJvbSAnZG9tLWhlbHBlcnMvd2lkdGgnO1xuaW1wb3J0IF90b0FycmF5IGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQXJyYXknO1xuaW1wb3J0IGFkZENsYXNzIGZyb20gJ2RvbS1oZWxwZXJzL2FkZENsYXNzJztcbmltcG9ydCByZW1vdmVDbGFzcyBmcm9tICdkb20taGVscGVycy9yZW1vdmVDbGFzcyc7XG5pbXBvcnQgb21pdCBmcm9tICdsb2Rhc2gvb21pdCc7XG5pbXBvcnQgZGVmYXVsdHMgZnJvbSAnbG9kYXNoL2RlZmF1bHRzJztcbmltcG9ydCB0cmFuc2Zvcm0gZnJvbSAnbG9kYXNoL3RyYW5zZm9ybSc7XG5pbXBvcnQgbWFwVmFsdWVzIGZyb20gJ2xvZGFzaC9tYXBWYWx1ZXMnO1xuaW1wb3J0IGlzQmV0d2VlbiBmcm9tICdkYXlqcy9wbHVnaW4vaXNCZXR3ZWVuJztcbmltcG9ydCBpc1NhbWVPckFmdGVyIGZyb20gJ2RheWpzL3BsdWdpbi9pc1NhbWVPckFmdGVyJztcbmltcG9ydCBpc1NhbWVPckJlZm9yZSBmcm9tICdkYXlqcy9wbHVnaW4vaXNTYW1lT3JCZWZvcmUnO1xuaW1wb3J0IGxvY2FsZURhdGEgZnJvbSAnZGF5anMvcGx1Z2luL2xvY2FsZURhdGEnO1xuaW1wb3J0IGxvY2FsaXplZEZvcm1hdCBmcm9tICdkYXlqcy9wbHVnaW4vbG9jYWxpemVkRm9ybWF0JztcbmltcG9ydCBtaW5NYXggZnJvbSAnZGF5anMvcGx1Z2luL21pbk1heCc7XG5pbXBvcnQgdXRjIGZyb20gJ2RheWpzL3BsdWdpbi91dGMnO1xuXG5mdW5jdGlvbiBOb29wV3JhcHBlcihwcm9wcykge1xuICByZXR1cm4gcHJvcHMuY2hpbGRyZW47XG59XG5cbnZhciBuYXZpZ2F0ZSA9IHtcbiAgUFJFVklPVVM6ICdQUkVWJyxcbiAgTkVYVDogJ05FWFQnLFxuICBUT0RBWTogJ1RPREFZJyxcbiAgREFURTogJ0RBVEUnXG59O1xudmFyIHZpZXdzID0ge1xuICBNT05USDogJ21vbnRoJyxcbiAgV0VFSzogJ3dlZWsnLFxuICBXT1JLX1dFRUs6ICd3b3JrX3dlZWsnLFxuICBEQVk6ICdkYXknLFxuICBBR0VOREE6ICdhZ2VuZGEnXG59O1xuXG52YXIgdmlld05hbWVzJDEgPSBPYmplY3Qua2V5cyh2aWV3cykubWFwKGZ1bmN0aW9uIChrKSB7XG4gIHJldHVybiB2aWV3c1trXTtcbn0pO1xuUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmZ1bmNdKTtcblByb3BUeXBlcy5hbnk7XG5Qcm9wVHlwZXMuZnVuYztcblxuLyoqXG4gKiBhY2NlcHRzIGVpdGhlciBhbiBhcnJheSBvZiBidWlsdGluIHZpZXcgbmFtZXM6XG4gKlxuICogYGBgXG4gKiB2aWV3cz17Wydtb250aCcsICdkYXknLCAnYWdlbmRhJ119XG4gKiBgYGBcbiAqXG4gKiBvciBhbiBvYmplY3QgaGFzaCBvZiB0aGUgdmlldyBuYW1lIGFuZCB0aGUgY29tcG9uZW50IChvciBib29sZWFuIGZvciBidWlsdGluKVxuICpcbiAqIGBgYFxuICogdmlld3M9e3tcbiAqICAgbW9udGg6IHRydWUsXG4gKiAgIHdlZWs6IGZhbHNlLFxuICogICB3b3Jrd2VlazogV29ya1dlZWtWaWV3Q29tcG9uZW50LFxuICogfX1cbiAqIGBgYFxuICovXG5cblByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5vbmVPZih2aWV3TmFtZXMkMSkpLCBQcm9wVHlwZXMub2JqZWN0T2YoZnVuY3Rpb24gKHByb3AsIGtleSkge1xuICB2YXIgaXNCdWlsdGluVmlldyA9IHZpZXdOYW1lcyQxLmluZGV4T2Yoa2V5KSAhPT0gLTEgJiYgdHlwZW9mIHByb3Bba2V5XSA9PT0gJ2Jvb2xlYW4nO1xuICBpZiAoaXNCdWlsdGluVmlldykge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAyID8gX2xlbiAtIDIgOiAwKSwgX2tleSA9IDI7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDJdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cbiAgICByZXR1cm4gUHJvcFR5cGVzLmVsZW1lbnRUeXBlLmFwcGx5KFByb3BUeXBlcywgW3Byb3AsIGtleV0uY29uY2F0KGFyZ3MpKTtcbiAgfVxufSldKTtcblByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5vbmVPZihbJ292ZXJsYXAnLCAnbm8tb3ZlcmxhcCddKSwgUHJvcFR5cGVzLmZ1bmNdKTtcblxuZnVuY3Rpb24gbm90aWZ5KGhhbmRsZXIsIGFyZ3MpIHtcbiAgaGFuZGxlciAmJiBoYW5kbGVyLmFwcGx5KG51bGwsIFtdLmNvbmNhdChhcmdzKSk7XG59XG5cbi8qIGVzbGludCBuby1mYWxsdGhyb3VnaDogb2ZmICovXG52YXIgTUlMTEkgPSB7XG4gIHNlY29uZHM6IDEwMDAsXG4gIG1pbnV0ZXM6IDEwMDAgKiA2MCxcbiAgaG91cnM6IDEwMDAgKiA2MCAqIDYwLFxuICBkYXk6IDEwMDAgKiA2MCAqIDYwICogMjRcbn07XG5mdW5jdGlvbiBmaXJzdFZpc2libGVEYXkoZGF0ZSwgbG9jYWxpemVyKSB7XG4gIHZhciBmaXJzdE9mTW9udGggPSBkYXRlcy5zdGFydE9mKGRhdGUsICdtb250aCcpO1xuICByZXR1cm4gZGF0ZXMuc3RhcnRPZihmaXJzdE9mTW9udGgsICd3ZWVrJywgbG9jYWxpemVyLnN0YXJ0T2ZXZWVrKCkpO1xufVxuZnVuY3Rpb24gbGFzdFZpc2libGVEYXkoZGF0ZSwgbG9jYWxpemVyKSB7XG4gIHZhciBlbmRPZk1vbnRoID0gZGF0ZXMuZW5kT2YoZGF0ZSwgJ21vbnRoJyk7XG4gIHJldHVybiBkYXRlcy5lbmRPZihlbmRPZk1vbnRoLCAnd2VlaycsIGxvY2FsaXplci5zdGFydE9mV2VlaygpKTtcbn1cbmZ1bmN0aW9uIHZpc2libGVEYXlzKGRhdGUsIGxvY2FsaXplcikge1xuICB2YXIgY3VycmVudCA9IGZpcnN0VmlzaWJsZURheShkYXRlLCBsb2NhbGl6ZXIpLFxuICAgIGxhc3QgPSBsYXN0VmlzaWJsZURheShkYXRlLCBsb2NhbGl6ZXIpLFxuICAgIGRheXMgPSBbXTtcbiAgd2hpbGUgKGRhdGVzLmx0ZShjdXJyZW50LCBsYXN0LCAnZGF5JykpIHtcbiAgICBkYXlzLnB1c2goY3VycmVudCk7XG4gICAgY3VycmVudCA9IGRhdGVzLmFkZChjdXJyZW50LCAxLCAnZGF5Jyk7XG4gIH1cbiAgcmV0dXJuIGRheXM7XG59XG5mdW5jdGlvbiBjZWlsKGRhdGUsIHVuaXQpIHtcbiAgdmFyIGZsb29yID0gZGF0ZXMuc3RhcnRPZihkYXRlLCB1bml0KTtcbiAgcmV0dXJuIGRhdGVzLmVxKGZsb29yLCBkYXRlKSA/IGZsb29yIDogZGF0ZXMuYWRkKGZsb29yLCAxLCB1bml0KTtcbn1cbmZ1bmN0aW9uIHJhbmdlKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHVuaXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6ICdkYXknO1xuICB2YXIgY3VycmVudCA9IHN0YXJ0LFxuICAgIGRheXMgPSBbXTtcbiAgd2hpbGUgKGRhdGVzLmx0ZShjdXJyZW50LCBlbmQsIHVuaXQpKSB7XG4gICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgIGN1cnJlbnQgPSBkYXRlcy5hZGQoY3VycmVudCwgMSwgdW5pdCk7XG4gIH1cbiAgcmV0dXJuIGRheXM7XG59XG5mdW5jdGlvbiBtZXJnZShkYXRlLCB0aW1lKSB7XG4gIGlmICh0aW1lID09IG51bGwgJiYgZGF0ZSA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgaWYgKHRpbWUgPT0gbnVsbCkgdGltZSA9IG5ldyBEYXRlKCk7XG4gIGlmIChkYXRlID09IG51bGwpIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICBkYXRlID0gZGF0ZXMuc3RhcnRPZihkYXRlLCAnZGF5Jyk7XG4gIGRhdGUgPSBkYXRlcy5ob3VycyhkYXRlLCBkYXRlcy5ob3Vycyh0aW1lKSk7XG4gIGRhdGUgPSBkYXRlcy5taW51dGVzKGRhdGUsIGRhdGVzLm1pbnV0ZXModGltZSkpO1xuICBkYXRlID0gZGF0ZXMuc2Vjb25kcyhkYXRlLCBkYXRlcy5zZWNvbmRzKHRpbWUpKTtcbiAgcmV0dXJuIGRhdGVzLm1pbGxpc2Vjb25kcyhkYXRlLCBkYXRlcy5taWxsaXNlY29uZHModGltZSkpO1xufVxuZnVuY3Rpb24gaXNKdXN0RGF0ZShkYXRlKSB7XG4gIHJldHVybiBkYXRlcy5ob3VycyhkYXRlKSA9PT0gMCAmJiBkYXRlcy5taW51dGVzKGRhdGUpID09PSAwICYmIGRhdGVzLnNlY29uZHMoZGF0ZSkgPT09IDAgJiYgZGF0ZXMubWlsbGlzZWNvbmRzKGRhdGUpID09PSAwO1xufVxuZnVuY3Rpb24gZHVyYXRpb24oc3RhcnQsIGVuZCwgdW5pdCwgZmlyc3RPZldlZWspIHtcbiAgaWYgKHVuaXQgPT09ICdkYXknKSB1bml0ID0gJ2RhdGUnO1xuICByZXR1cm4gTWF0aC5hYnMoXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbmFtZXNwYWNlXG4gIGRhdGVzW3VuaXRdKHN0YXJ0LCB1bmRlZmluZWQsIGZpcnN0T2ZXZWVrKSAtXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbmFtZXNwYWNlXG4gIGRhdGVzW3VuaXRdKGVuZCwgdW5kZWZpbmVkLCBmaXJzdE9mV2VlaykpO1xufVxuZnVuY3Rpb24gZGlmZihkYXRlQSwgZGF0ZUIsIHVuaXQpIHtcbiAgaWYgKCF1bml0IHx8IHVuaXQgPT09ICdtaWxsaXNlY29uZHMnKSByZXR1cm4gTWF0aC5hYnMoK2RhdGVBIC0gK2RhdGVCKTtcblxuICAvLyB0aGUgLnJvdW5kKCkgaGFuZGxlcyBhbiBlZGdlIGNhc2VcbiAgLy8gd2l0aCBEU1Qgd2hlcmUgdGhlIHRvdGFsIHdvbid0IGJlIGV4YWN0XG4gIC8vIHNpbmNlIG9uZSBkYXkgaW4gdGhlIHJhbmdlIG1heSBiZSBzaG9ydGVyL2xvbmdlciBieSBhbiBob3VyXG4gIHJldHVybiBNYXRoLnJvdW5kKE1hdGguYWJzKCtkYXRlcy5zdGFydE9mKGRhdGVBLCB1bml0KSAvIE1JTExJW3VuaXRdIC0gK2RhdGVzLnN0YXJ0T2YoZGF0ZUIsIHVuaXQpIC8gTUlMTElbdW5pdF0pKTtcbn1cblxudmFyIGxvY2FsZVByb3BUeXBlID0gUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmZ1bmNdKTtcbmZ1bmN0aW9uIF9mb3JtYXQobG9jYWxpemVyLCBmb3JtYXR0ZXIsIHZhbHVlLCBmb3JtYXQsIGN1bHR1cmUpIHtcbiAgdmFyIHJlc3VsdCA9IHR5cGVvZiBmb3JtYXQgPT09ICdmdW5jdGlvbicgPyBmb3JtYXQodmFsdWUsIGN1bHR1cmUsIGxvY2FsaXplcikgOiBmb3JtYXR0ZXIuY2FsbChsb2NhbGl6ZXIsIHZhbHVlLCBmb3JtYXQsIGN1bHR1cmUpO1xuICBpbnZhcmlhbnQocmVzdWx0ID09IG51bGwgfHwgdHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycsICdgbG9jYWxpemVyIGZvcm1hdCguLilgIG11c3QgcmV0dXJuIGEgc3RyaW5nLCBudWxsLCBvciB1bmRlZmluZWQnKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBUaGlzIGRhdGUgY29udmVyc2lvbiB3YXMgbW92ZWQgb3V0IG9mIFRpbWVTbG90cy5qcywgdG9cbiAqIGFsbG93IGZvciBsb2NhbGl6ZXIgb3ZlcnJpZGVcbiAqIEBwYXJhbSB7RGF0ZX0gZHQgLSBUaGUgZGF0ZSB0byBzdGFydCBmcm9tXG4gKiBAcGFyYW0ge051bWJlcn0gbWludXRlc0Zyb21NaWRuaWdodFxuICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldFxuICogQHJldHVybnMge0RhdGV9XG4gKi9cbmZ1bmN0aW9uIGdldFNsb3REYXRlKGR0LCBtaW51dGVzRnJvbU1pZG5pZ2h0LCBvZmZzZXQpIHtcbiAgcmV0dXJuIG5ldyBEYXRlKGR0LmdldEZ1bGxZZWFyKCksIGR0LmdldE1vbnRoKCksIGR0LmdldERhdGUoKSwgMCwgbWludXRlc0Zyb21NaWRuaWdodCArIG9mZnNldCwgMCwgMCk7XG59XG5mdW5jdGlvbiBnZXREc3RPZmZzZXQoc3RhcnQsIGVuZCkge1xuICByZXR1cm4gc3RhcnQuZ2V0VGltZXpvbmVPZmZzZXQoKSAtIGVuZC5nZXRUaW1lem9uZU9mZnNldCgpO1xufVxuXG4vLyBpZiB0aGUgc3RhcnQgaXMgb24gYSBEU1QtY2hhbmdpbmcgZGF5IGJ1dCAqYWZ0ZXIqIHRoZSBtb21lbnQgb2YgRFNUXG4vLyB0cmFuc2l0aW9uIHdlIG5lZWQgdG8gYWRkIHRob3NlIGV4dHJhIG1pbnV0ZXMgdG8gb3VyIG1pbnV0ZXNGcm9tTWlkbmlnaHRcbmZ1bmN0aW9uIGdldFRvdGFsTWluKHN0YXJ0LCBlbmQpIHtcbiAgcmV0dXJuIGRpZmYoc3RhcnQsIGVuZCwgJ21pbnV0ZXMnKSArIGdldERzdE9mZnNldChzdGFydCwgZW5kKTtcbn1cbmZ1bmN0aW9uIGdldE1pbnV0ZXNGcm9tTWlkbmlnaHQoc3RhcnQpIHtcbiAgdmFyIGRheXN0YXJ0ID0gc3RhcnRPZihzdGFydCwgJ2RheScpO1xuICByZXR1cm4gZGlmZihkYXlzdGFydCwgc3RhcnQsICdtaW51dGVzJykgKyBnZXREc3RPZmZzZXQoZGF5c3RhcnQsIHN0YXJ0KTtcbn1cblxuLy8gVGhlc2UgdHdvIGFyZSB1c2VkIGJ5IERhdGVTbG90TWV0cmljc1xuZnVuY3Rpb24gY29udGludWVzUHJpb3Ioc3RhcnQsIGZpcnN0KSB7XG4gIHJldHVybiBsdChzdGFydCwgZmlyc3QsICdkYXknKTtcbn1cbmZ1bmN0aW9uIGNvbnRpbnVlc0FmdGVyKHN0YXJ0LCBlbmQsIGxhc3QpIHtcbiAgdmFyIHNpbmdsZURheUR1cmF0aW9uID0gZXEoc3RhcnQsIGVuZCwgJ21pbnV0ZXMnKTtcbiAgcmV0dXJuIHNpbmdsZURheUR1cmF0aW9uID8gZ3RlKGVuZCwgbGFzdCwgJ21pbnV0ZXMnKSA6IGd0KGVuZCwgbGFzdCwgJ21pbnV0ZXMnKTtcbn1cbmZ1bmN0aW9uIGRheVNwYW4oc3RhcnQsIGVuZCkge1xuICByZXR1cm4gZHVyYXRpb24oc3RhcnQsIGVuZCwgJ2RheScpO1xufVxuXG4vLyBUaGVzZSB0d28gYXJlIHVzZWQgYnkgZXZlbnRMZXZlbHNcbmZ1bmN0aW9uIHNvcnRFdmVudHMkMShfcmVmKSB7XG4gIHZhciBfcmVmJGV2dEEgPSBfcmVmLmV2dEEsXG4gICAgYVN0YXJ0ID0gX3JlZiRldnRBLnN0YXJ0LFxuICAgIGFFbmQgPSBfcmVmJGV2dEEuZW5kLFxuICAgIGFBbGxEYXkgPSBfcmVmJGV2dEEuYWxsRGF5LFxuICAgIF9yZWYkZXZ0QiA9IF9yZWYuZXZ0QixcbiAgICBiU3RhcnQgPSBfcmVmJGV2dEIuc3RhcnQsXG4gICAgYkVuZCA9IF9yZWYkZXZ0Qi5lbmQsXG4gICAgYkFsbERheSA9IF9yZWYkZXZ0Qi5hbGxEYXk7XG4gIHZhciBzdGFydFNvcnQgPSArc3RhcnRPZihhU3RhcnQsICdkYXknKSAtICtzdGFydE9mKGJTdGFydCwgJ2RheScpO1xuICB2YXIgZHVyQSA9IGRheVNwYW4oYVN0YXJ0LCBhRW5kKTtcbiAgdmFyIGR1ckIgPSBkYXlTcGFuKGJTdGFydCwgYkVuZCk7XG4gIHJldHVybiBzdGFydFNvcnQgfHxcbiAgLy8gc29ydCBieSBzdGFydCBEYXkgZmlyc3RcbiAgZHVyQiAtIGR1ckEgfHxcbiAgLy8gZXZlbnRzIHNwYW5uaW5nIG11bHRpcGxlIGRheXMgZ28gZmlyc3RcbiAgISFiQWxsRGF5IC0gISFhQWxsRGF5IHx8XG4gIC8vIHRoZW4gYWxsRGF5IHNpbmdsZSBkYXkgZXZlbnRzXG4gICthU3RhcnQgLSArYlN0YXJ0IHx8XG4gIC8vIHRoZW4gc29ydCBieSBzdGFydCB0aW1lXG4gICthRW5kIC0gK2JFbmQgLy8gdGhlbiBzb3J0IGJ5IGVuZCB0aW1lXG4gIDtcbn1cbmZ1bmN0aW9uIGluRXZlbnRSYW5nZShfcmVmMikge1xuICB2YXIgX3JlZjIkZXZlbnQgPSBfcmVmMi5ldmVudCxcbiAgICBzdGFydCA9IF9yZWYyJGV2ZW50LnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYyJGV2ZW50LmVuZCxcbiAgICBfcmVmMiRyYW5nZSA9IF9yZWYyLnJhbmdlLFxuICAgIHJhbmdlU3RhcnQgPSBfcmVmMiRyYW5nZS5zdGFydCxcbiAgICByYW5nZUVuZCA9IF9yZWYyJHJhbmdlLmVuZDtcbiAgdmFyIGVTdGFydCA9IHN0YXJ0T2Yoc3RhcnQsICdkYXknKTtcbiAgdmFyIHN0YXJ0c0JlZm9yZUVuZCA9IGx0ZShlU3RhcnQsIHJhbmdlRW5kLCAnZGF5Jyk7XG4gIC8vIHdoZW4gdGhlIGV2ZW50IGlzIHplcm8gZHVyYXRpb24gd2UgbmVlZCB0byBoYW5kbGUgYSBiaXQgZGlmZmVyZW50bHlcbiAgdmFyIHNhbWVNaW4gPSBuZXEoZVN0YXJ0LCBlbmQsICdtaW51dGVzJyk7XG4gIHZhciBlbmRzQWZ0ZXJTdGFydCA9IHNhbWVNaW4gPyBndChlbmQsIHJhbmdlU3RhcnQsICdtaW51dGVzJykgOiBndGUoZW5kLCByYW5nZVN0YXJ0LCAnbWludXRlcycpO1xuICByZXR1cm4gc3RhcnRzQmVmb3JlRW5kICYmIGVuZHNBZnRlclN0YXJ0O1xufVxuXG4vLyBvdGhlciBsb2NhbGl6ZXJzIHRyZWF0cyAnZGF5JyBhbmQgJ2RhdGUnIGVxdWFsaXR5IHZlcnkgZGlmZmVyZW50bHksIHNvIHdlXG4vLyBhYnN0cmFjdCB0aGUgY2hhbmdlIHRoZSAnbG9jYWxpemVyLmVxKGRhdGUxLCBkYXRlMiwgJ2RheScpIGludG8gdGhpc1xuLy8gbmV3IG1ldGhvZCwgd2hlcmUgdGhleSBjYW4gYmUgdHJlYXRlZCBjb3JyZWN0bHkgYnkgdGhlIGxvY2FsaXplciBvdmVycmlkZXNcbmZ1bmN0aW9uIGlzU2FtZURhdGUoZGF0ZTEsIGRhdGUyKSB7XG4gIHJldHVybiBlcShkYXRlMSwgZGF0ZTIsICdkYXknKTtcbn1cbmZ1bmN0aW9uIHN0YXJ0QW5kRW5kQXJlRGF0ZU9ubHkoc3RhcnQsIGVuZCkge1xuICByZXR1cm4gaXNKdXN0RGF0ZShzdGFydCkgJiYgaXNKdXN0RGF0ZShlbmQpO1xufVxudmFyIERhdGVMb2NhbGl6ZXIgPSAvKiNfX1BVUkVfXyovX2NyZWF0ZUNsYXNzKGZ1bmN0aW9uIERhdGVMb2NhbGl6ZXIoc3BlYykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0ZUxvY2FsaXplcik7XG4gIGludmFyaWFudCh0eXBlb2Ygc3BlYy5mb3JtYXQgPT09ICdmdW5jdGlvbicsICdkYXRlIGxvY2FsaXplciBgZm9ybWF0KC4uKWAgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gIGludmFyaWFudCh0eXBlb2Ygc3BlYy5maXJzdE9mV2VlayA9PT0gJ2Z1bmN0aW9uJywgJ2RhdGUgbG9jYWxpemVyIGBmaXJzdE9mV2VlayguLilgIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICB0aGlzLnByb3BUeXBlID0gc3BlYy5wcm9wVHlwZSB8fCBsb2NhbGVQcm9wVHlwZTtcbiAgdGhpcy5mb3JtYXRzID0gc3BlYy5mb3JtYXRzO1xuICB0aGlzLmZvcm1hdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuICAgIHJldHVybiBfZm9ybWF0LmFwcGx5KHZvaWQgMCwgW190aGlzLCBzcGVjLmZvcm1hdF0uY29uY2F0KGFyZ3MpKTtcbiAgfTtcbiAgLy8gVGhlc2UgZGF0ZSBhcml0aG1ldGljIG1ldGhvZHMgY2FuIGJlIG92ZXJyaWRlbiBieSB0aGUgbG9jYWxpemVyXG4gIHRoaXMuc3RhcnRPZldlZWsgPSBzcGVjLmZpcnN0T2ZXZWVrO1xuICB0aGlzLm1lcmdlID0gc3BlYy5tZXJnZSB8fCBtZXJnZTtcbiAgdGhpcy5pblJhbmdlID0gc3BlYy5pblJhbmdlIHx8IGluUmFuZ2UkMTtcbiAgdGhpcy5sdCA9IHNwZWMubHQgfHwgbHQ7XG4gIHRoaXMubHRlID0gc3BlYy5sdGUgfHwgbHRlO1xuICB0aGlzLmd0ID0gc3BlYy5ndCB8fCBndDtcbiAgdGhpcy5ndGUgPSBzcGVjLmd0ZSB8fCBndGU7XG4gIHRoaXMuZXEgPSBzcGVjLmVxIHx8IGVxO1xuICB0aGlzLm5lcSA9IHNwZWMubmVxIHx8IG5lcTtcbiAgdGhpcy5zdGFydE9mID0gc3BlYy5zdGFydE9mIHx8IHN0YXJ0T2Y7XG4gIHRoaXMuZW5kT2YgPSBzcGVjLmVuZE9mIHx8IGVuZE9mO1xuICB0aGlzLmFkZCA9IHNwZWMuYWRkIHx8IGFkZDtcbiAgdGhpcy5yYW5nZSA9IHNwZWMucmFuZ2UgfHwgcmFuZ2U7XG4gIHRoaXMuZGlmZiA9IHNwZWMuZGlmZiB8fCBkaWZmO1xuICB0aGlzLmNlaWwgPSBzcGVjLmNlaWwgfHwgY2VpbDtcbiAgdGhpcy5taW4gPSBzcGVjLm1pbiB8fCBtaW47XG4gIHRoaXMubWF4ID0gc3BlYy5tYXggfHwgbWF4O1xuICB0aGlzLm1pbnV0ZXMgPSBzcGVjLm1pbnV0ZXMgfHwgbWludXRlcztcbiAgdGhpcy5kYXlTcGFuID0gc3BlYy5kYXlTcGFuIHx8IGRheVNwYW47XG4gIHRoaXMuZmlyc3RWaXNpYmxlRGF5ID0gc3BlYy5maXJzdFZpc2libGVEYXkgfHwgZmlyc3RWaXNpYmxlRGF5O1xuICB0aGlzLmxhc3RWaXNpYmxlRGF5ID0gc3BlYy5sYXN0VmlzaWJsZURheSB8fCBsYXN0VmlzaWJsZURheTtcbiAgdGhpcy52aXNpYmxlRGF5cyA9IHNwZWMudmlzaWJsZURheXMgfHwgdmlzaWJsZURheXM7XG4gIHRoaXMuZ2V0U2xvdERhdGUgPSBzcGVjLmdldFNsb3REYXRlIHx8IGdldFNsb3REYXRlO1xuICB0aGlzLmdldFRpbWV6b25lT2Zmc2V0ID0gc3BlYy5nZXRUaW1lem9uZU9mZnNldCB8fCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUuZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgfTtcbiAgdGhpcy5nZXREc3RPZmZzZXQgPSBzcGVjLmdldERzdE9mZnNldCB8fCBnZXREc3RPZmZzZXQ7XG4gIHRoaXMuZ2V0VG90YWxNaW4gPSBzcGVjLmdldFRvdGFsTWluIHx8IGdldFRvdGFsTWluO1xuICB0aGlzLmdldE1pbnV0ZXNGcm9tTWlkbmlnaHQgPSBzcGVjLmdldE1pbnV0ZXNGcm9tTWlkbmlnaHQgfHwgZ2V0TWludXRlc0Zyb21NaWRuaWdodDtcbiAgdGhpcy5jb250aW51ZXNQcmlvciA9IHNwZWMuY29udGludWVzUHJpb3IgfHwgY29udGludWVzUHJpb3I7XG4gIHRoaXMuY29udGludWVzQWZ0ZXIgPSBzcGVjLmNvbnRpbnVlc0FmdGVyIHx8IGNvbnRpbnVlc0FmdGVyO1xuICB0aGlzLnNvcnRFdmVudHMgPSBzcGVjLnNvcnRFdmVudHMgfHwgc29ydEV2ZW50cyQxO1xuICB0aGlzLmluRXZlbnRSYW5nZSA9IHNwZWMuaW5FdmVudFJhbmdlIHx8IGluRXZlbnRSYW5nZTtcbiAgdGhpcy5pc1NhbWVEYXRlID0gc3BlYy5pc1NhbWVEYXRlIHx8IGlzU2FtZURhdGU7XG4gIHRoaXMuc3RhcnRBbmRFbmRBcmVEYXRlT25seSA9IHNwZWMuc3RhcnRBbmRFbmRBcmVEYXRlT25seSB8fCBzdGFydEFuZEVuZEFyZURhdGVPbmx5O1xuICB0aGlzLnNlZ21lbnRPZmZzZXQgPSBzcGVjLmJyb3dzZXJUWk9mZnNldCA/IHNwZWMuYnJvd3NlclRaT2Zmc2V0KCkgOiAwO1xufSk7XG5mdW5jdGlvbiBtZXJnZVdpdGhEZWZhdWx0cyhsb2NhbGl6ZXIsIGN1bHR1cmUsIGZvcm1hdE92ZXJyaWRlcywgbWVzc2FnZXMpIHtcbiAgdmFyIGZvcm1hdHMgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGxvY2FsaXplci5mb3JtYXRzKSwgZm9ybWF0T3ZlcnJpZGVzKTtcbiAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbG9jYWxpemVyKSwge30sIHtcbiAgICBtZXNzYWdlczogbWVzc2FnZXMsXG4gICAgc3RhcnRPZldlZWs6IGZ1bmN0aW9uIHN0YXJ0T2ZXZWVrKCkge1xuICAgICAgcmV0dXJuIGxvY2FsaXplci5zdGFydE9mV2VlayhjdWx0dXJlKTtcbiAgICB9LFxuICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHZhbHVlLCBfZm9ybWF0Mikge1xuICAgICAgcmV0dXJuIGxvY2FsaXplci5mb3JtYXQodmFsdWUsIGZvcm1hdHNbX2Zvcm1hdDJdIHx8IF9mb3JtYXQyLCBjdWx0dXJlKTtcbiAgICB9XG4gIH0pO1xufVxuXG52YXIgZGVmYXVsdE1lc3NhZ2VzID0ge1xuICBkYXRlOiAnRGF0ZScsXG4gIHRpbWU6ICdUaW1lJyxcbiAgZXZlbnQ6ICdFdmVudCcsXG4gIGFsbERheTogJ0FsbCBEYXknLFxuICB3ZWVrOiAnV2VlaycsXG4gIHdvcmtfd2VlazogJ1dvcmsgV2VlaycsXG4gIGRheTogJ0RheScsXG4gIG1vbnRoOiAnTW9udGgnLFxuICBwcmV2aW91czogJ0JhY2snLFxuICBuZXh0OiAnTmV4dCcsXG4gIHllc3RlcmRheTogJ1llc3RlcmRheScsXG4gIHRvbW9ycm93OiAnVG9tb3Jyb3cnLFxuICB0b2RheTogJ1RvZGF5JyxcbiAgYWdlbmRhOiAnQWdlbmRhJyxcbiAgbm9FdmVudHNJblJhbmdlOiAnVGhlcmUgYXJlIG5vIGV2ZW50cyBpbiB0aGlzIHJhbmdlLicsXG4gIHNob3dNb3JlOiBmdW5jdGlvbiBzaG93TW9yZSh0b3RhbCkge1xuICAgIHJldHVybiBcIitcIi5jb25jYXQodG90YWwsIFwiIG1vcmVcIik7XG4gIH1cbn07XG5mdW5jdGlvbiBtZXNzYWdlcyhtc2dzKSB7XG4gIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGRlZmF1bHRNZXNzYWdlcyksIG1zZ3MpO1xufVxuXG5mdW5jdGlvbiB1c2VDbGlja091dHNpZGUoX3JlZikge1xuICB2YXIgcmVmID0gX3JlZi5yZWYsXG4gICAgY2FsbGJhY2sgPSBfcmVmLmNhbGxiYWNrO1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBoYW5kbGVDbGlja091dHNpZGUgPSBmdW5jdGlvbiBoYW5kbGVDbGlja091dHNpZGUoZSkge1xuICAgICAgaWYgKHJlZi5jdXJyZW50ICYmICFyZWYuY3VycmVudC5jb250YWlucyhlLnRhcmdldCkpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XG4gICAgfTtcbiAgfSwgW3JlZiwgY2FsbGJhY2tdKTtcbn1cblxudmFyIF9leGNsdWRlZCQ3ID0gW1wic3R5bGVcIiwgXCJjbGFzc05hbWVcIiwgXCJldmVudFwiLCBcInNlbGVjdGVkXCIsIFwiaXNBbGxEYXlcIiwgXCJvblNlbGVjdFwiLCBcIm9uRG91YmxlQ2xpY2tcIiwgXCJvbktleVByZXNzXCIsIFwibG9jYWxpemVyXCIsIFwiY29udGludWVzUHJpb3JcIiwgXCJjb250aW51ZXNBZnRlclwiLCBcImFjY2Vzc29yc1wiLCBcImdldHRlcnNcIiwgXCJjaGlsZHJlblwiLCBcImNvbXBvbmVudHNcIiwgXCJzbG90U3RhcnRcIiwgXCJzbG90RW5kXCJdO1xudmFyIEV2ZW50Q2VsbCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBmdW5jdGlvbiBFdmVudENlbGwoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50Q2VsbCk7XG4gICAgcmV0dXJuIF9jYWxsU3VwZXIodGhpcywgRXZlbnRDZWxsLCBhcmd1bWVudHMpO1xuICB9XG4gIF9pbmhlcml0cyhFdmVudENlbGwsIF9SZWFjdCRDb21wb25lbnQpO1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKEV2ZW50Q2VsbCwgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsXG4gICAgICAgIHN0eWxlID0gX3RoaXMkcHJvcHMuc3R5bGUsXG4gICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzLmNsYXNzTmFtZSxcbiAgICAgICAgZXZlbnQgPSBfdGhpcyRwcm9wcy5ldmVudCxcbiAgICAgICAgc2VsZWN0ZWQgPSBfdGhpcyRwcm9wcy5zZWxlY3RlZCxcbiAgICAgICAgaXNBbGxEYXkgPSBfdGhpcyRwcm9wcy5pc0FsbERheSxcbiAgICAgICAgb25TZWxlY3QgPSBfdGhpcyRwcm9wcy5vblNlbGVjdCxcbiAgICAgICAgX29uRG91YmxlQ2xpY2sgPSBfdGhpcyRwcm9wcy5vbkRvdWJsZUNsaWNrLFxuICAgICAgICBvbktleVByZXNzID0gX3RoaXMkcHJvcHMub25LZXlQcmVzcyxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMubG9jYWxpemVyLFxuICAgICAgICBjb250aW51ZXNQcmlvciA9IF90aGlzJHByb3BzLmNvbnRpbnVlc1ByaW9yLFxuICAgICAgICBjb250aW51ZXNBZnRlciA9IF90aGlzJHByb3BzLmNvbnRpbnVlc0FmdGVyLFxuICAgICAgICBhY2Nlc3NvcnMgPSBfdGhpcyRwcm9wcy5hY2Nlc3NvcnMsXG4gICAgICAgIGdldHRlcnMgPSBfdGhpcyRwcm9wcy5nZXR0ZXJzLFxuICAgICAgICBjaGlsZHJlbiA9IF90aGlzJHByb3BzLmNoaWxkcmVuLFxuICAgICAgICBfdGhpcyRwcm9wcyRjb21wb25lbnQgPSBfdGhpcyRwcm9wcy5jb21wb25lbnRzLFxuICAgICAgICBFdmVudCA9IF90aGlzJHByb3BzJGNvbXBvbmVudC5ldmVudCxcbiAgICAgICAgRXZlbnRXcmFwcGVyID0gX3RoaXMkcHJvcHMkY29tcG9uZW50LmV2ZW50V3JhcHBlcixcbiAgICAgICAgc2xvdFN0YXJ0ID0gX3RoaXMkcHJvcHMuc2xvdFN0YXJ0LFxuICAgICAgICBzbG90RW5kID0gX3RoaXMkcHJvcHMuc2xvdEVuZCxcbiAgICAgICAgcHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3RoaXMkcHJvcHMsIF9leGNsdWRlZCQ3KTtcbiAgICAgIGRlbGV0ZSBwcm9wcy5yZXNpemFibGU7XG4gICAgICB2YXIgdGl0bGUgPSBhY2Nlc3NvcnMudGl0bGUoZXZlbnQpO1xuICAgICAgdmFyIHRvb2x0aXAgPSBhY2Nlc3NvcnMudG9vbHRpcChldmVudCk7XG4gICAgICB2YXIgZW5kID0gYWNjZXNzb3JzLmVuZChldmVudCk7XG4gICAgICB2YXIgc3RhcnQgPSBhY2Nlc3NvcnMuc3RhcnQoZXZlbnQpO1xuICAgICAgdmFyIGFsbERheSA9IGFjY2Vzc29ycy5hbGxEYXkoZXZlbnQpO1xuICAgICAgdmFyIHNob3dBc0FsbERheSA9IGlzQWxsRGF5IHx8IGFsbERheSB8fCBsb2NhbGl6ZXIuZGlmZihzdGFydCwgbG9jYWxpemVyLmNlaWwoZW5kLCAnZGF5JyksICdkYXknKSA+IDE7XG4gICAgICB2YXIgdXNlclByb3BzID0gZ2V0dGVycy5ldmVudFByb3AoZXZlbnQsIHN0YXJ0LCBlbmQsIHNlbGVjdGVkKTtcbiAgICAgIHZhciBjb250ZW50ID0gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLWV2ZW50LWNvbnRlbnRcIixcbiAgICAgICAgdGl0bGU6IHRvb2x0aXAgfHwgdW5kZWZpbmVkXG4gICAgICB9LCBFdmVudCA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50LCB7XG4gICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgY29udGludWVzUHJpb3I6IGNvbnRpbnVlc1ByaW9yLFxuICAgICAgICBjb250aW51ZXNBZnRlcjogY29udGludWVzQWZ0ZXIsXG4gICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgaXNBbGxEYXk6IGFsbERheSxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIHNsb3RTdGFydDogc2xvdFN0YXJ0LFxuICAgICAgICBzbG90RW5kOiBzbG90RW5kXG4gICAgICB9KSA6IHRpdGxlKTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFdmVudFdyYXBwZXIsIE9iamVjdC5hc3NpZ24oe30sIHRoaXMucHJvcHMsIHtcbiAgICAgICAgdHlwZTogXCJkYXRlXCJcbiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCBPYmplY3QuYXNzaWduKHt9LCBwcm9wcywge1xuICAgICAgICBzdHlsZTogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB1c2VyUHJvcHMuc3R5bGUpLCBzdHlsZSksXG4gICAgICAgIGNsYXNzTmFtZTogY2xzeCgncmJjLWV2ZW50JywgY2xhc3NOYW1lLCB1c2VyUHJvcHMuY2xhc3NOYW1lLCB7XG4gICAgICAgICAgJ3JiYy1zZWxlY3RlZCc6IHNlbGVjdGVkLFxuICAgICAgICAgICdyYmMtZXZlbnQtYWxsZGF5Jzogc2hvd0FzQWxsRGF5LFxuICAgICAgICAgICdyYmMtZXZlbnQtY29udGludWVzLXByaW9yJzogY29udGludWVzUHJpb3IsXG4gICAgICAgICAgJ3JiYy1ldmVudC1jb250aW51ZXMtYWZ0ZXInOiBjb250aW51ZXNBZnRlclxuICAgICAgICB9KSxcbiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICAgICAgcmV0dXJuIG9uU2VsZWN0ICYmIG9uU2VsZWN0KGV2ZW50LCBlKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25Eb3VibGVDbGljazogZnVuY3Rpb24gb25Eb3VibGVDbGljayhlKSB7XG4gICAgICAgICAgcmV0dXJuIF9vbkRvdWJsZUNsaWNrICYmIF9vbkRvdWJsZUNsaWNrKGV2ZW50LCBlKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25LZXlEb3duOiBmdW5jdGlvbiBvbktleURvd24oZSkge1xuICAgICAgICAgIHJldHVybiBvbktleVByZXNzICYmIG9uS2V5UHJlc3MoZXZlbnQsIGUpO1xuICAgICAgICB9XG4gICAgICB9KSwgdHlwZW9mIGNoaWxkcmVuID09PSAnZnVuY3Rpb24nID8gY2hpbGRyZW4oY29udGVudCkgOiBjb250ZW50KSk7XG4gICAgfVxuICB9XSk7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5cbmZ1bmN0aW9uIGlzU2VsZWN0ZWQoZXZlbnQsIHNlbGVjdGVkKSB7XG4gIGlmICghZXZlbnQgfHwgc2VsZWN0ZWQgPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gaXNFcXVhbCQxKGV2ZW50LCBzZWxlY3RlZCk7XG59XG5mdW5jdGlvbiBzbG90V2lkdGgocm93Qm94LCBzbG90cykge1xuICB2YXIgcm93V2lkdGggPSByb3dCb3gucmlnaHQgLSByb3dCb3gubGVmdDtcbiAgdmFyIGNlbGxXaWR0aCA9IHJvd1dpZHRoIC8gc2xvdHM7XG4gIHJldHVybiBjZWxsV2lkdGg7XG59XG5mdW5jdGlvbiBnZXRTbG90QXRYKHJvd0JveCwgeCwgcnRsLCBzbG90cykge1xuICB2YXIgY2VsbFdpZHRoID0gc2xvdFdpZHRoKHJvd0JveCwgc2xvdHMpO1xuICByZXR1cm4gcnRsID8gc2xvdHMgLSAxIC0gTWF0aC5mbG9vcigoeCAtIHJvd0JveC5sZWZ0KSAvIGNlbGxXaWR0aCkgOiBNYXRoLmZsb29yKCh4IC0gcm93Qm94LmxlZnQpIC8gY2VsbFdpZHRoKTtcbn1cbmZ1bmN0aW9uIHBvaW50SW5Cb3goYm94LCBfcmVmKSB7XG4gIHZhciB4ID0gX3JlZi54LFxuICAgIHkgPSBfcmVmLnk7XG4gIHJldHVybiB5ID49IGJveC50b3AgJiYgeSA8PSBib3guYm90dG9tICYmIHggPj0gYm94LmxlZnQgJiYgeCA8PSBib3gucmlnaHQ7XG59XG5mdW5jdGlvbiBkYXRlQ2VsbFNlbGVjdGlvbihzdGFydCwgcm93Qm94LCBib3gsIHNsb3RzLCBydGwpIHtcbiAgdmFyIHN0YXJ0SWR4ID0gLTE7XG4gIHZhciBlbmRJZHggPSAtMTtcbiAgdmFyIGxhc3RTbG90SWR4ID0gc2xvdHMgLSAxO1xuICB2YXIgY2VsbFdpZHRoID0gc2xvdFdpZHRoKHJvd0JveCwgc2xvdHMpO1xuXG4gIC8vIGNlbGwgdW5kZXIgdGhlIG1vdXNlXG4gIHZhciBjdXJyZW50U2xvdCA9IGdldFNsb3RBdFgocm93Qm94LCBib3gueCwgcnRsLCBzbG90cyk7XG5cbiAgLy8gSWRlbnRpZnkgcm93IGFzIGVpdGhlciB0aGUgaW5pdGlhbCByb3dcbiAgLy8gb3IgdGhlIHJvdyB1bmRlciB0aGUgY3VycmVudCBtb3VzZSBwb2ludFxuICB2YXIgaXNDdXJyZW50Um93ID0gcm93Qm94LnRvcCA8IGJveC55ICYmIHJvd0JveC5ib3R0b20gPiBib3gueTtcbiAgdmFyIGlzU3RhcnRSb3cgPSByb3dCb3gudG9wIDwgc3RhcnQueSAmJiByb3dCb3guYm90dG9tID4gc3RhcnQueTtcblxuICAvLyB0aGlzIHJvdydzIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHRoZSBzdGFydCBwb2ludFxuICB2YXIgaXNBYm92ZVN0YXJ0ID0gc3RhcnQueSA+IHJvd0JveC5ib3R0b207XG4gIHZhciBpc0JlbG93U3RhcnQgPSByb3dCb3gudG9wID4gc3RhcnQueTtcbiAgdmFyIGlzQmV0d2VlbiA9IGJveC50b3AgPCByb3dCb3gudG9wICYmIGJveC5ib3R0b20gPiByb3dCb3guYm90dG9tO1xuXG4gIC8vIHRoaXMgcm93IGlzIGJldHdlZW4gdGhlIGN1cnJlbnQgYW5kIHN0YXJ0IHJvd3MsIHNvIGVudGlyZWx5IHNlbGVjdGVkXG4gIGlmIChpc0JldHdlZW4pIHtcbiAgICBzdGFydElkeCA9IDA7XG4gICAgZW5kSWR4ID0gbGFzdFNsb3RJZHg7XG4gIH1cbiAgaWYgKGlzQ3VycmVudFJvdykge1xuICAgIGlmIChpc0JlbG93U3RhcnQpIHtcbiAgICAgIHN0YXJ0SWR4ID0gMDtcbiAgICAgIGVuZElkeCA9IGN1cnJlbnRTbG90O1xuICAgIH0gZWxzZSBpZiAoaXNBYm92ZVN0YXJ0KSB7XG4gICAgICBzdGFydElkeCA9IGN1cnJlbnRTbG90O1xuICAgICAgZW5kSWR4ID0gbGFzdFNsb3RJZHg7XG4gICAgfVxuICB9XG4gIGlmIChpc1N0YXJ0Um93KSB7XG4gICAgLy8gc2VsZWN0IHRoZSBjZWxsIHVuZGVyIHRoZSBpbml0aWFsIHBvaW50XG4gICAgc3RhcnRJZHggPSBlbmRJZHggPSBydGwgPyBsYXN0U2xvdElkeCAtIE1hdGguZmxvb3IoKHN0YXJ0LnggLSByb3dCb3gubGVmdCkgLyBjZWxsV2lkdGgpIDogTWF0aC5mbG9vcigoc3RhcnQueCAtIHJvd0JveC5sZWZ0KSAvIGNlbGxXaWR0aCk7XG4gICAgaWYgKGlzQ3VycmVudFJvdykge1xuICAgICAgaWYgKGN1cnJlbnRTbG90IDwgc3RhcnRJZHgpIHN0YXJ0SWR4ID0gY3VycmVudFNsb3Q7ZWxzZSBlbmRJZHggPSBjdXJyZW50U2xvdDsgLy9zZWxlY3QgY3VycmVudCByYW5nZVxuICAgIH0gZWxzZSBpZiAoc3RhcnQueSA8IGJveC55KSB7XG4gICAgICAvLyB0aGUgY3VycmVudCByb3cgaXMgYmVsb3cgc3RhcnQgcm93XG4gICAgICAvLyBzZWxlY3QgY2VsbHMgdG8gdGhlIHJpZ2h0IG9mIHRoZSBzdGFydCBjZWxsXG4gICAgICBlbmRJZHggPSBsYXN0U2xvdElkeDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc2VsZWN0IGNlbGxzIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBjZWxsXG4gICAgICBzdGFydElkeCA9IDA7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgc3RhcnRJZHg6IHN0YXJ0SWR4LFxuICAgIGVuZElkeDogZW5kSWR4XG4gIH07XG59XG5cbi8qKlxuICogQ2hhbmdlcyB0byByZWFjdC1vdmVybGF5cyBjYXVzZSBpc3N1ZSB3aXRoIGF1dG8gcG9zaXRpb25pbmcsXG4gKiBzbyB3ZSBuZWVkIHRvIG1hbnVhbGx5IGNhbGN1bGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIHBvcHBlcixcbiAqIGFuZCBjb25zdHJhaW4gaXQgdG8gdGhlIE1vbnRoIGNvbnRhaW5lci5cbiAqL1xuZnVuY3Rpb24gZ2V0UG9zaXRpb24oX3JlZikge1xuICB2YXIgdGFyZ2V0ID0gX3JlZi50YXJnZXQsXG4gICAgb2Zmc2V0ID0gX3JlZi5vZmZzZXQsXG4gICAgY29udGFpbmVyID0gX3JlZi5jb250YWluZXIsXG4gICAgYm94ID0gX3JlZi5ib3g7XG4gIHZhciBfZ2V0T2Zmc2V0ID0gZ2V0T2Zmc2V0KHRhcmdldCksXG4gICAgdG9wID0gX2dldE9mZnNldC50b3AsXG4gICAgbGVmdCA9IF9nZXRPZmZzZXQubGVmdCxcbiAgICB3aWR0aCA9IF9nZXRPZmZzZXQud2lkdGgsXG4gICAgaGVpZ2h0ID0gX2dldE9mZnNldC5oZWlnaHQ7XG4gIHZhciBfZ2V0T2Zmc2V0MiA9IGdldE9mZnNldChjb250YWluZXIpLFxuICAgIGNUb3AgPSBfZ2V0T2Zmc2V0Mi50b3AsXG4gICAgY0xlZnQgPSBfZ2V0T2Zmc2V0Mi5sZWZ0LFxuICAgIGNXaWR0aCA9IF9nZXRPZmZzZXQyLndpZHRoLFxuICAgIGNIZWlnaHQgPSBfZ2V0T2Zmc2V0Mi5oZWlnaHQ7XG4gIHZhciBfZ2V0T2Zmc2V0MyA9IGdldE9mZnNldChib3gpLFxuICAgIGJXaWR0aCA9IF9nZXRPZmZzZXQzLndpZHRoLFxuICAgIGJIZWlnaHQgPSBfZ2V0T2Zmc2V0My5oZWlnaHQ7XG4gIHZhciB2aWV3Qm90dG9tID0gY1RvcCArIGNIZWlnaHQ7XG4gIHZhciB2aWV3UmlnaHQgPSBjTGVmdCArIGNXaWR0aDtcbiAgdmFyIGJvdHRvbSA9IHRvcCArIGJIZWlnaHQ7XG4gIHZhciByaWdodCA9IGxlZnQgKyBiV2lkdGg7XG4gIHZhciB4ID0gb2Zmc2V0LngsXG4gICAgeSA9IG9mZnNldC55O1xuICB2YXIgdG9wT2Zmc2V0ID0gYm90dG9tID4gdmlld0JvdHRvbSA/IHRvcCAtIGJIZWlnaHQgLSB5IDogdG9wICsgeSArIGhlaWdodDtcbiAgdmFyIGxlZnRPZmZzZXQgPSByaWdodCA+IHZpZXdSaWdodCA/IGxlZnQgKyB4IC0gYldpZHRoICsgd2lkdGggOiBsZWZ0ICsgeDtcbiAgcmV0dXJuIHtcbiAgICB0b3BPZmZzZXQ6IHRvcE9mZnNldCxcbiAgICBsZWZ0T2Zmc2V0OiBsZWZ0T2Zmc2V0XG4gIH07XG59XG5mdW5jdGlvbiBQb3AoX3JlZjIpIHtcbiAgdmFyIGNvbnRhaW5lclJlZiA9IF9yZWYyLmNvbnRhaW5lclJlZixcbiAgICBhY2Nlc3NvcnMgPSBfcmVmMi5hY2Nlc3NvcnMsXG4gICAgZ2V0dGVycyA9IF9yZWYyLmdldHRlcnMsXG4gICAgc2VsZWN0ZWQgPSBfcmVmMi5zZWxlY3RlZCxcbiAgICBjb21wb25lbnRzID0gX3JlZjIuY29tcG9uZW50cyxcbiAgICBsb2NhbGl6ZXIgPSBfcmVmMi5sb2NhbGl6ZXIsXG4gICAgcG9zaXRpb24gPSBfcmVmMi5wb3NpdGlvbixcbiAgICBzaG93ID0gX3JlZjIuc2hvdyxcbiAgICBldmVudHMgPSBfcmVmMi5ldmVudHMsXG4gICAgc2xvdFN0YXJ0ID0gX3JlZjIuc2xvdFN0YXJ0LFxuICAgIHNsb3RFbmQgPSBfcmVmMi5zbG90RW5kLFxuICAgIG9uU2VsZWN0ID0gX3JlZjIub25TZWxlY3QsXG4gICAgb25Eb3VibGVDbGljayA9IF9yZWYyLm9uRG91YmxlQ2xpY2ssXG4gICAgb25LZXlQcmVzcyA9IF9yZWYyLm9uS2V5UHJlc3MsXG4gICAgaGFuZGxlRHJhZ1N0YXJ0ID0gX3JlZjIuaGFuZGxlRHJhZ1N0YXJ0LFxuICAgIHBvcHBlclJlZiA9IF9yZWYyLnBvcHBlclJlZixcbiAgICB0YXJnZXQgPSBfcmVmMi50YXJnZXQsXG4gICAgb2Zmc2V0ID0gX3JlZjIub2Zmc2V0O1xuICB1c2VDbGlja091dHNpZGUoe1xuICAgIHJlZjogcG9wcGVyUmVmLFxuICAgIGNhbGxiYWNrOiBzaG93XG4gIH0pO1xuICB1c2VMYXlvdXRFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBfZ2V0UG9zaXRpb24gPSBnZXRQb3NpdGlvbih7XG4gICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgY29udGFpbmVyOiBjb250YWluZXJSZWYuY3VycmVudCxcbiAgICAgICAgYm94OiBwb3BwZXJSZWYuY3VycmVudFxuICAgICAgfSksXG4gICAgICB0b3BPZmZzZXQgPSBfZ2V0UG9zaXRpb24udG9wT2Zmc2V0LFxuICAgICAgbGVmdE9mZnNldCA9IF9nZXRQb3NpdGlvbi5sZWZ0T2Zmc2V0O1xuICAgIHBvcHBlclJlZi5jdXJyZW50LnN0eWxlLnRvcCA9IFwiXCIuY29uY2F0KHRvcE9mZnNldCwgXCJweFwiKTtcbiAgICBwb3BwZXJSZWYuY3VycmVudC5zdHlsZS5sZWZ0ID0gXCJcIi5jb25jYXQobGVmdE9mZnNldCwgXCJweFwiKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtvZmZzZXQueCwgb2Zmc2V0LnksIHRhcmdldF0pO1xuICB2YXIgd2lkdGggPSBwb3NpdGlvbi53aWR0aDtcbiAgdmFyIHN0eWxlID0ge1xuICAgIG1pbldpZHRoOiB3aWR0aCArIHdpZHRoIC8gMlxuICB9O1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIHN0eWxlOiBzdHlsZSxcbiAgICBjbGFzc05hbWU6IFwicmJjLW92ZXJsYXlcIixcbiAgICByZWY6IHBvcHBlclJlZlxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgY2xhc3NOYW1lOiBcInJiYy1vdmVybGF5LWhlYWRlclwiXG4gIH0sIGxvY2FsaXplci5mb3JtYXQoc2xvdFN0YXJ0LCAnZGF5SGVhZGVyRm9ybWF0JykpLCBldmVudHMubWFwKGZ1bmN0aW9uIChldmVudCwgaWR4KSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50Q2VsbCwge1xuICAgICAga2V5OiBpZHgsXG4gICAgICB0eXBlOiBcInBvcHVwXCIsXG4gICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgIGdldHRlcnM6IGdldHRlcnMsXG4gICAgICBvblNlbGVjdDogb25TZWxlY3QsXG4gICAgICBhY2Nlc3NvcnM6IGFjY2Vzc29ycyxcbiAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudHMsXG4gICAgICBvbkRvdWJsZUNsaWNrOiBvbkRvdWJsZUNsaWNrLFxuICAgICAgb25LZXlQcmVzczogb25LZXlQcmVzcyxcbiAgICAgIGNvbnRpbnVlc1ByaW9yOiBsb2NhbGl6ZXIubHQoYWNjZXNzb3JzLmVuZChldmVudCksIHNsb3RTdGFydCwgJ2RheScpLFxuICAgICAgY29udGludWVzQWZ0ZXI6IGxvY2FsaXplci5ndGUoYWNjZXNzb3JzLnN0YXJ0KGV2ZW50KSwgc2xvdEVuZCwgJ2RheScpLFxuICAgICAgc2xvdFN0YXJ0OiBzbG90U3RhcnQsXG4gICAgICBzbG90RW5kOiBzbG90RW5kLFxuICAgICAgc2VsZWN0ZWQ6IGlzU2VsZWN0ZWQoZXZlbnQsIHNlbGVjdGVkKSxcbiAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgIG9uRHJhZ1N0YXJ0OiBmdW5jdGlvbiBvbkRyYWdTdGFydCgpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZURyYWdTdGFydChldmVudCk7XG4gICAgICB9LFxuICAgICAgb25EcmFnRW5kOiBmdW5jdGlvbiBvbkRyYWdFbmQoKSB7XG4gICAgICAgIHJldHVybiBzaG93KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pKTtcbn1cbnZhciBQb3B1cCA9IC8qI19fUFVSRV9fKi9SZWFjdC5mb3J3YXJkUmVmKGZ1bmN0aW9uIChwcm9wcywgcmVmKSB7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3AsIE9iamVjdC5hc3NpZ24oe30sIHByb3BzLCB7XG4gICAgcG9wcGVyUmVmOiByZWZcbiAgfSkpO1xufSk7XG5Qb3B1cC5wcm9wVHlwZXMgPSB7XG4gIGFjY2Vzc29yczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBnZXR0ZXJzOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIHNlbGVjdGVkOiBQcm9wVHlwZXMub2JqZWN0LFxuICBjb21wb25lbnRzOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIGxvY2FsaXplcjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBwb3NpdGlvbjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBzaG93OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBldmVudHM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBzbG90U3RhcnQ6IFByb3BUeXBlcy5pbnN0YW5jZU9mKERhdGUpLmlzUmVxdWlyZWQsXG4gIHNsb3RFbmQ6IFByb3BUeXBlcy5pbnN0YW5jZU9mKERhdGUpLFxuICBvblNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uRG91YmxlQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICBvbktleVByZXNzOiBQcm9wVHlwZXMuZnVuYyxcbiAgaGFuZGxlRHJhZ1N0YXJ0OiBQcm9wVHlwZXMuZnVuYyxcbiAgc3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG4gIG9mZnNldDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICB4OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIHk6IFByb3BUeXBlcy5udW1iZXJcbiAgfSlcbn07XG5cbmZ1bmN0aW9uIENhbE92ZXJsYXkoX3JlZikge1xuICB2YXIgY29udGFpbmVyUmVmID0gX3JlZi5jb250YWluZXJSZWYsXG4gICAgX3JlZiRwb3B1cE9mZnNldCA9IF9yZWYucG9wdXBPZmZzZXQsXG4gICAgcG9wdXBPZmZzZXQgPSBfcmVmJHBvcHVwT2Zmc2V0ID09PSB2b2lkIDAgPyA1IDogX3JlZiRwb3B1cE9mZnNldCxcbiAgICBvdmVybGF5ID0gX3JlZi5vdmVybGF5LFxuICAgIGFjY2Vzc29ycyA9IF9yZWYuYWNjZXNzb3JzLFxuICAgIGxvY2FsaXplciA9IF9yZWYubG9jYWxpemVyLFxuICAgIGNvbXBvbmVudHMgPSBfcmVmLmNvbXBvbmVudHMsXG4gICAgZ2V0dGVycyA9IF9yZWYuZ2V0dGVycyxcbiAgICBzZWxlY3RlZCA9IF9yZWYuc2VsZWN0ZWQsXG4gICAgaGFuZGxlU2VsZWN0RXZlbnQgPSBfcmVmLmhhbmRsZVNlbGVjdEV2ZW50LFxuICAgIGhhbmRsZURvdWJsZUNsaWNrRXZlbnQgPSBfcmVmLmhhbmRsZURvdWJsZUNsaWNrRXZlbnQsXG4gICAgaGFuZGxlS2V5UHJlc3NFdmVudCA9IF9yZWYuaGFuZGxlS2V5UHJlc3NFdmVudCxcbiAgICBoYW5kbGVEcmFnU3RhcnQgPSBfcmVmLmhhbmRsZURyYWdTdGFydCxcbiAgICBvbkhpZGUgPSBfcmVmLm9uSGlkZSxcbiAgICBvdmVybGF5RGlzcGxheSA9IF9yZWYub3ZlcmxheURpc3BsYXk7XG4gIHZhciBwb3BwZXJSZWYgPSB1c2VSZWYobnVsbCk7XG4gIGlmICghb3ZlcmxheS5wb3NpdGlvbikgcmV0dXJuIG51bGw7XG4gIHZhciBvZmZzZXQgPSBwb3B1cE9mZnNldDtcbiAgaWYgKCFpc05hTihwb3B1cE9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSB7XG4gICAgICB4OiBwb3B1cE9mZnNldCxcbiAgICAgIHk6IHBvcHVwT2Zmc2V0XG4gICAgfTtcbiAgfVxuICB2YXIgcG9zaXRpb24gPSBvdmVybGF5LnBvc2l0aW9uLFxuICAgIGV2ZW50cyA9IG92ZXJsYXkuZXZlbnRzLFxuICAgIGRhdGUgPSBvdmVybGF5LmRhdGUsXG4gICAgZW5kID0gb3ZlcmxheS5lbmQ7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChPdmVybGF5LCB7XG4gICAgcm9vdENsb3NlOiB0cnVlLFxuICAgIGZsaXA6IHRydWUsXG4gICAgc2hvdzogdHJ1ZSxcbiAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCIsXG4gICAgb25IaWRlOiBvbkhpZGUsXG4gICAgdGFyZ2V0OiBvdmVybGF5LnRhcmdldFxuICB9LCBmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICB2YXIgcHJvcHMgPSBfcmVmMi5wcm9wcztcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUG9wdXAsIE9iamVjdC5hc3NpZ24oe30sIHByb3BzLCB7XG4gICAgICBjb250YWluZXJSZWY6IGNvbnRhaW5lclJlZixcbiAgICAgIHJlZjogcG9wcGVyUmVmLFxuICAgICAgdGFyZ2V0OiBvdmVybGF5LnRhcmdldCxcbiAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgYWNjZXNzb3JzOiBhY2Nlc3NvcnMsXG4gICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgc2hvdzogb3ZlcmxheURpc3BsYXksXG4gICAgICBldmVudHM6IGV2ZW50cyxcbiAgICAgIHNsb3RTdGFydDogZGF0ZSxcbiAgICAgIHNsb3RFbmQ6IGVuZCxcbiAgICAgIG9uU2VsZWN0OiBoYW5kbGVTZWxlY3RFdmVudCxcbiAgICAgIG9uRG91YmxlQ2xpY2s6IGhhbmRsZURvdWJsZUNsaWNrRXZlbnQsXG4gICAgICBvbktleVByZXNzOiBoYW5kbGVLZXlQcmVzc0V2ZW50LFxuICAgICAgaGFuZGxlRHJhZ1N0YXJ0OiBoYW5kbGVEcmFnU3RhcnRcbiAgICB9KSk7XG4gIH0pO1xufVxudmFyIFBvcE92ZXJsYXkgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiAocHJvcHMsIHJlZikge1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ2FsT3ZlcmxheSwgT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMsIHtcbiAgICBjb250YWluZXJSZWY6IHJlZlxuICB9KSk7XG59KTtcblBvcE92ZXJsYXkucHJvcFR5cGVzID0ge1xuICBwb3B1cE9mZnNldDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm51bWJlciwgUHJvcFR5cGVzLnNoYXBlKHtcbiAgICB4OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIHk6IFByb3BUeXBlcy5udW1iZXJcbiAgfSldKSxcbiAgb3ZlcmxheTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBwb3NpdGlvbjogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBldmVudHM6IFByb3BUeXBlcy5hcnJheSxcbiAgICBkYXRlOiBQcm9wVHlwZXMuaW5zdGFuY2VPZihEYXRlKSxcbiAgICBlbmQ6IFByb3BUeXBlcy5pbnN0YW5jZU9mKERhdGUpXG4gIH0pLFxuICBhY2Nlc3NvcnM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgbG9jYWxpemVyOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gIGNvbXBvbmVudHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgZ2V0dGVyczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICBzZWxlY3RlZDogUHJvcFR5cGVzLm9iamVjdCxcbiAgaGFuZGxlU2VsZWN0RXZlbnQ6IFByb3BUeXBlcy5mdW5jLFxuICBoYW5kbGVEb3VibGVDbGlja0V2ZW50OiBQcm9wVHlwZXMuZnVuYyxcbiAgaGFuZGxlS2V5UHJlc3NFdmVudDogUHJvcFR5cGVzLmZ1bmMsXG4gIGhhbmRsZURyYWdTdGFydDogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uSGlkZTogUHJvcFR5cGVzLmZ1bmMsXG4gIG92ZXJsYXlEaXNwbGF5OiBQcm9wVHlwZXMuZnVuY1xufTtcblxuZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyKSB7XG4gIHZhciB0YXJnZXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGRvY3VtZW50O1xuICByZXR1cm4gbGlzdGVuKHRhcmdldCwgdHlwZSwgaGFuZGxlciwge1xuICAgIHBhc3NpdmU6IGZhbHNlXG4gIH0pO1xufVxuZnVuY3Rpb24gaXNPdmVyQ29udGFpbmVyKGNvbnRhaW5lciwgeCwgeSkge1xuICByZXR1cm4gIWNvbnRhaW5lciB8fCBjb250YWlucyhjb250YWluZXIsIGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSkpO1xufVxuZnVuY3Rpb24gZ2V0RXZlbnROb2RlRnJvbVBvaW50KG5vZGUsIF9yZWYpIHtcbiAgdmFyIGNsaWVudFggPSBfcmVmLmNsaWVudFgsXG4gICAgY2xpZW50WSA9IF9yZWYuY2xpZW50WTtcbiAgdmFyIHRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoY2xpZW50WCwgY2xpZW50WSk7XG4gIHJldHVybiBjbG9zZXN0KHRhcmdldCwgJy5yYmMtZXZlbnQnLCBub2RlKTtcbn1cbmZ1bmN0aW9uIGdldFNob3dNb3JlTm9kZUZyb21Qb2ludChub2RlLCBfcmVmMikge1xuICB2YXIgY2xpZW50WCA9IF9yZWYyLmNsaWVudFgsXG4gICAgY2xpZW50WSA9IF9yZWYyLmNsaWVudFk7XG4gIHZhciB0YXJnZXQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGNsaWVudFgsIGNsaWVudFkpO1xuICByZXR1cm4gY2xvc2VzdCh0YXJnZXQsICcucmJjLXNob3ctbW9yZScsIG5vZGUpO1xufVxuZnVuY3Rpb24gaXNFdmVudChub2RlLCBib3VuZHMpIHtcbiAgcmV0dXJuICEhZ2V0RXZlbnROb2RlRnJvbVBvaW50KG5vZGUsIGJvdW5kcyk7XG59XG5mdW5jdGlvbiBpc1Nob3dNb3JlKG5vZGUsIGJvdW5kcykge1xuICByZXR1cm4gISFnZXRTaG93TW9yZU5vZGVGcm9tUG9pbnQobm9kZSwgYm91bmRzKTtcbn1cbmZ1bmN0aW9uIGdldEV2ZW50Q29vcmRpbmF0ZXMoZSkge1xuICB2YXIgdGFyZ2V0ID0gZTtcbiAgaWYgKGUudG91Y2hlcyAmJiBlLnRvdWNoZXMubGVuZ3RoKSB7XG4gICAgdGFyZ2V0ID0gZS50b3VjaGVzWzBdO1xuICB9XG4gIHJldHVybiB7XG4gICAgY2xpZW50WDogdGFyZ2V0LmNsaWVudFgsXG4gICAgY2xpZW50WTogdGFyZ2V0LmNsaWVudFksXG4gICAgcGFnZVg6IHRhcmdldC5wYWdlWCxcbiAgICBwYWdlWTogdGFyZ2V0LnBhZ2VZXG4gIH07XG59XG52YXIgY2xpY2tUb2xlcmFuY2UgPSA1O1xudmFyIGNsaWNrSW50ZXJ2YWwgPSAyNTA7XG52YXIgU2VsZWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU2VsZWN0aW9uKG5vZGUpIHtcbiAgICB2YXIgX3JlZjMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LFxuICAgICAgX3JlZjMkZ2xvYmFsID0gX3JlZjMuZ2xvYmFsLFxuICAgICAgZ2xvYmFsID0gX3JlZjMkZ2xvYmFsID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYzJGdsb2JhbCxcbiAgICAgIF9yZWYzJGxvbmdQcmVzc1RocmVzaCA9IF9yZWYzLmxvbmdQcmVzc1RocmVzaG9sZCxcbiAgICAgIGxvbmdQcmVzc1RocmVzaG9sZCA9IF9yZWYzJGxvbmdQcmVzc1RocmVzaCA9PT0gdm9pZCAwID8gMjUwIDogX3JlZjMkbG9uZ1ByZXNzVGhyZXNoLFxuICAgICAgX3JlZjMkdmFsaWRDb250YWluZXJzID0gX3JlZjMudmFsaWRDb250YWluZXJzLFxuICAgICAgdmFsaWRDb250YWluZXJzID0gX3JlZjMkdmFsaWRDb250YWluZXJzID09PSB2b2lkIDAgPyBbXSA6IF9yZWYzJHZhbGlkQ29udGFpbmVycztcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VsZWN0aW9uKTtcbiAgICB0aGlzLl9pbml0aWFsRXZlbnQgPSBudWxsO1xuICAgIHRoaXMuc2VsZWN0aW5nID0gZmFsc2U7XG4gICAgdGhpcy5pc0RldGFjaGVkID0gZmFsc2U7XG4gICAgdGhpcy5jb250YWluZXIgPSBub2RlO1xuICAgIHRoaXMuZ2xvYmFsTW91c2UgPSAhbm9kZSB8fCBnbG9iYWw7XG4gICAgdGhpcy5sb25nUHJlc3NUaHJlc2hvbGQgPSBsb25nUHJlc3NUaHJlc2hvbGQ7XG4gICAgdGhpcy52YWxpZENvbnRhaW5lcnMgPSB2YWxpZENvbnRhaW5lcnM7XG4gICAgdGhpcy5fbGlzdGVuZXJzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLl9oYW5kbGVJbml0aWFsRXZlbnQgPSB0aGlzLl9oYW5kbGVJbml0aWFsRXZlbnQuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVNb3ZlRXZlbnQgPSB0aGlzLl9oYW5kbGVNb3ZlRXZlbnQuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVUZXJtaW5hdGluZ0V2ZW50ID0gdGhpcy5faGFuZGxlVGVybWluYXRpbmdFdmVudC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2tleUxpc3RlbmVyID0gdGhpcy5fa2V5TGlzdGVuZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9kcm9wRnJvbU91dHNpZGVMaXN0ZW5lciA9IHRoaXMuX2Ryb3BGcm9tT3V0c2lkZUxpc3RlbmVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fZHJhZ092ZXJGcm9tT3V0c2lkZUxpc3RlbmVyID0gdGhpcy5fZHJhZ092ZXJGcm9tT3V0c2lkZUxpc3RlbmVyLmJpbmQodGhpcyk7XG5cbiAgICAvLyBGaXhlcyBhbiBpT1MgMTAgYnVnIHdoZXJlIHNjcm9sbGluZyBjb3VsZCBub3QgYmUgcHJldmVudGVkIG9uIHRoZSB3aW5kb3cuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL21ldGFmaXp6eS9mbGlja2l0eS9pc3N1ZXMvNDU3I2lzc3VlY29tbWVudC0yNTQ1MDEzNTZcbiAgICB0aGlzLl9yZW1vdmVUb3VjaE1vdmVXaW5kb3dMaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGZ1bmN0aW9uICgpIHt9LCB3aW5kb3cpO1xuICAgIHRoaXMuX3JlbW92ZUtleURvd25MaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9rZXlMaXN0ZW5lcik7XG4gICAgdGhpcy5fcmVtb3ZlS2V5VXBMaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5fa2V5TGlzdGVuZXIpO1xuICAgIHRoaXMuX3JlbW92ZURyb3BGcm9tT3V0c2lkZUxpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuX2Ryb3BGcm9tT3V0c2lkZUxpc3RlbmVyKTtcbiAgICB0aGlzLl9yZW1vdmVEcmFnT3ZlckZyb21PdXRzaWRlTGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuX2RyYWdPdmVyRnJvbU91dHNpZGVMaXN0ZW5lcik7XG4gICAgdGhpcy5fYWRkSW5pdGlhbEV2ZW50TGlzdGVuZXIoKTtcbiAgfVxuICByZXR1cm4gX2NyZWF0ZUNsYXNzKFNlbGVjdGlvbiwgW3tcbiAgICBrZXk6IFwib25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gb24odHlwZSwgaGFuZGxlcikge1xuICAgICAgdmFyIGhhbmRsZXJzID0gdGhpcy5fbGlzdGVuZXJzW3R5cGVdIHx8ICh0aGlzLl9saXN0ZW5lcnNbdHlwZV0gPSBbXSk7XG4gICAgICBoYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgICAgdmFyIGlkeCA9IGhhbmRsZXJzLmluZGV4T2YoaGFuZGxlcik7XG4gICAgICAgICAgaWYgKGlkeCAhPT0gLTEpIGhhbmRsZXJzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJlbWl0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQodHlwZSkge1xuICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICB2YXIgaGFuZGxlcnMgPSB0aGlzLl9saXN0ZW5lcnNbdHlwZV0gfHwgW107XG4gICAgICBoYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHJlc3VsdCA9IGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRlYXJkb3duXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRlYXJkb3duKCkge1xuICAgICAgdGhpcy5faW5pdGlhbEV2ZW50ID0gbnVsbDtcbiAgICAgIHRoaXMuX2luaXRpYWxFdmVudERhdGEgPSBudWxsO1xuICAgICAgdGhpcy5fc2VsZWN0UmVjdCA9IG51bGw7XG4gICAgICB0aGlzLnNlbGVjdGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5fbGFzdENsaWNrRGF0YSA9IG51bGw7XG4gICAgICB0aGlzLmlzRGV0YWNoZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fbGlzdGVuZXJzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgIHRoaXMuX3JlbW92ZVRvdWNoTW92ZVdpbmRvd0xpc3RlbmVyICYmIHRoaXMuX3JlbW92ZVRvdWNoTW92ZVdpbmRvd0xpc3RlbmVyKCk7XG4gICAgICB0aGlzLl9yZW1vdmVJbml0aWFsRXZlbnRMaXN0ZW5lciAmJiB0aGlzLl9yZW1vdmVJbml0aWFsRXZlbnRMaXN0ZW5lcigpO1xuICAgICAgdGhpcy5fcmVtb3ZlRW5kTGlzdGVuZXIgJiYgdGhpcy5fcmVtb3ZlRW5kTGlzdGVuZXIoKTtcbiAgICAgIHRoaXMuX29uRXNjTGlzdGVuZXIgJiYgdGhpcy5fb25Fc2NMaXN0ZW5lcigpO1xuICAgICAgdGhpcy5fcmVtb3ZlTW92ZUxpc3RlbmVyICYmIHRoaXMuX3JlbW92ZU1vdmVMaXN0ZW5lcigpO1xuICAgICAgdGhpcy5fcmVtb3ZlS2V5VXBMaXN0ZW5lciAmJiB0aGlzLl9yZW1vdmVLZXlVcExpc3RlbmVyKCk7XG4gICAgICB0aGlzLl9yZW1vdmVLZXlEb3duTGlzdGVuZXIgJiYgdGhpcy5fcmVtb3ZlS2V5RG93bkxpc3RlbmVyKCk7XG4gICAgICB0aGlzLl9yZW1vdmVEcm9wRnJvbU91dHNpZGVMaXN0ZW5lciAmJiB0aGlzLl9yZW1vdmVEcm9wRnJvbU91dHNpZGVMaXN0ZW5lcigpO1xuICAgICAgdGhpcy5fcmVtb3ZlRHJhZ092ZXJGcm9tT3V0c2lkZUxpc3RlbmVyICYmIHRoaXMuX3JlbW92ZURyYWdPdmVyRnJvbU91dHNpZGVMaXN0ZW5lcigpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpc1NlbGVjdGVkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGlzU2VsZWN0ZWQobm9kZSkge1xuICAgICAgdmFyIGJveCA9IHRoaXMuX3NlbGVjdFJlY3Q7XG4gICAgICBpZiAoIWJveCB8fCAhdGhpcy5zZWxlY3RpbmcpIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiBvYmplY3RzQ29sbGlkZShib3gsIGdldEJvdW5kc0Zvck5vZGUobm9kZSkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmaWx0ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVyKGl0ZW1zKSB7XG4gICAgICB2YXIgYm94ID0gdGhpcy5fc2VsZWN0UmVjdDtcblxuICAgICAgLy9ub3Qgc2VsZWN0aW5nXG4gICAgICBpZiAoIWJveCB8fCAhdGhpcy5zZWxlY3RpbmcpIHJldHVybiBbXTtcbiAgICAgIHJldHVybiBpdGVtcy5maWx0ZXIodGhpcy5pc1NlbGVjdGVkLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBBZGRzIGEgbGlzdGVuZXIgdGhhdCB3aWxsIGNhbGwgdGhlIGhhbmRsZXIgb25seSBhZnRlciB0aGUgdXNlciBoYXMgcHJlc3NlZCBvbiB0aGUgc2NyZWVuXG4gICAgLy8gd2l0aG91dCBtb3ZpbmcgdGhlaXIgZmluZ2VyIGZvciAyNTBtcy5cbiAgfSwge1xuICAgIGtleTogXCJfYWRkTG9uZ1ByZXNzTGlzdGVuZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZExvbmdQcmVzc0xpc3RlbmVyKGhhbmRsZXIsIGluaXRpYWxFdmVudCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciB0aW1lciA9IG51bGw7XG4gICAgICB2YXIgcmVtb3ZlVG91Y2hNb3ZlTGlzdGVuZXIgPSBudWxsO1xuICAgICAgdmFyIHJlbW92ZVRvdWNoRW5kTGlzdGVuZXIgPSBudWxsO1xuICAgICAgdmFyIGhhbmRsZVRvdWNoU3RhcnQgPSBmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0KGluaXRpYWxFdmVudCkge1xuICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICBoYW5kbGVyKGluaXRpYWxFdmVudCk7XG4gICAgICAgIH0sIF90aGlzLmxvbmdQcmVzc1RocmVzaG9sZCk7XG4gICAgICAgIHJlbW92ZVRvdWNoTW92ZUxpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBjbGVhbnVwKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZW1vdmVUb3VjaEVuZExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGNsZWFudXAoKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdmFyIHJlbW92ZVRvdWNoU3RhcnRMaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBoYW5kbGVUb3VjaFN0YXJ0KTtcbiAgICAgIHZhciBjbGVhbnVwID0gZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgaWYgKHRpbWVyKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtb3ZlVG91Y2hNb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgICByZW1vdmVUb3VjaE1vdmVMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1vdmVUb3VjaEVuZExpc3RlbmVyKSB7XG4gICAgICAgICAgcmVtb3ZlVG91Y2hFbmRMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgICAgIHRpbWVyID0gbnVsbDtcbiAgICAgICAgcmVtb3ZlVG91Y2hNb3ZlTGlzdGVuZXIgPSBudWxsO1xuICAgICAgICByZW1vdmVUb3VjaEVuZExpc3RlbmVyID0gbnVsbDtcbiAgICAgIH07XG4gICAgICBpZiAoaW5pdGlhbEV2ZW50KSB7XG4gICAgICAgIGhhbmRsZVRvdWNoU3RhcnQoaW5pdGlhbEV2ZW50KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgcmVtb3ZlVG91Y2hTdGFydExpc3RlbmVyKCk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIExpc3RlbiBmb3IgbW91c2Vkb3duIGFuZCB0b3VjaHN0YXJ0IGV2ZW50cy4gV2hlbiBvbmUgaXMgcmVjZWl2ZWQsIGRpc2FibGUgdGhlIG90aGVyIGFuZCBzZXR1cFxuICAgIC8vIGZ1dHVyZSBldmVudCBoYW5kbGluZyBiYXNlZCBvbiB0aGUgdHlwZSBvZiBldmVudC5cbiAgfSwge1xuICAgIGtleTogXCJfYWRkSW5pdGlhbEV2ZW50TGlzdGVuZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZEluaXRpYWxFdmVudExpc3RlbmVyKCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG4gICAgICB2YXIgcmVtb3ZlTW91c2VEb3duTGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBfdGhpczIuX3JlbW92ZUluaXRpYWxFdmVudExpc3RlbmVyKCk7XG4gICAgICAgIF90aGlzMi5faGFuZGxlSW5pdGlhbEV2ZW50KGUpO1xuICAgICAgICBfdGhpczIuX3JlbW92ZUluaXRpYWxFdmVudExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgX3RoaXMyLl9oYW5kbGVJbml0aWFsRXZlbnQpO1xuICAgICAgfSk7XG4gICAgICB2YXIgcmVtb3ZlVG91Y2hTdGFydExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzMi5fcmVtb3ZlSW5pdGlhbEV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgX3RoaXMyLl9yZW1vdmVJbml0aWFsRXZlbnRMaXN0ZW5lciA9IF90aGlzMi5fYWRkTG9uZ1ByZXNzTGlzdGVuZXIoX3RoaXMyLl9oYW5kbGVJbml0aWFsRXZlbnQsIGUpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9yZW1vdmVJbml0aWFsRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVtb3ZlTW91c2VEb3duTGlzdGVuZXIoKTtcbiAgICAgICAgcmVtb3ZlVG91Y2hTdGFydExpc3RlbmVyKCk7XG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfZHJvcEZyb21PdXRzaWRlTGlzdGVuZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2Ryb3BGcm9tT3V0c2lkZUxpc3RlbmVyKGUpIHtcbiAgICAgIHZhciBfZ2V0RXZlbnRDb29yZGluYXRlcyA9IGdldEV2ZW50Q29vcmRpbmF0ZXMoZSksXG4gICAgICAgIHBhZ2VYID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMucGFnZVgsXG4gICAgICAgIHBhZ2VZID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMucGFnZVksXG4gICAgICAgIGNsaWVudFggPSBfZ2V0RXZlbnRDb29yZGluYXRlcy5jbGllbnRYLFxuICAgICAgICBjbGllbnRZID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMuY2xpZW50WTtcbiAgICAgIHRoaXMuZW1pdCgnZHJvcEZyb21PdXRzaWRlJywge1xuICAgICAgICB4OiBwYWdlWCxcbiAgICAgICAgeTogcGFnZVksXG4gICAgICAgIGNsaWVudFg6IGNsaWVudFgsXG4gICAgICAgIGNsaWVudFk6IGNsaWVudFlcbiAgICAgIH0pO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfZHJhZ092ZXJGcm9tT3V0c2lkZUxpc3RlbmVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9kcmFnT3ZlckZyb21PdXRzaWRlTGlzdGVuZXIoZSkge1xuICAgICAgdmFyIF9nZXRFdmVudENvb3JkaW5hdGVzMiA9IGdldEV2ZW50Q29vcmRpbmF0ZXMoZSksXG4gICAgICAgIHBhZ2VYID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMyLnBhZ2VYLFxuICAgICAgICBwYWdlWSA9IF9nZXRFdmVudENvb3JkaW5hdGVzMi5wYWdlWSxcbiAgICAgICAgY2xpZW50WCA9IF9nZXRFdmVudENvb3JkaW5hdGVzMi5jbGllbnRYLFxuICAgICAgICBjbGllbnRZID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMyLmNsaWVudFk7XG4gICAgICB0aGlzLmVtaXQoJ2RyYWdPdmVyRnJvbU91dHNpZGUnLCB7XG4gICAgICAgIHg6IHBhZ2VYLFxuICAgICAgICB5OiBwYWdlWSxcbiAgICAgICAgY2xpZW50WDogY2xpZW50WCxcbiAgICAgICAgY2xpZW50WTogY2xpZW50WVxuICAgICAgfSk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIl9oYW5kbGVJbml0aWFsRXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2hhbmRsZUluaXRpYWxFdmVudChlKSB7XG4gICAgICB0aGlzLl9pbml0aWFsRXZlbnQgPSBlO1xuICAgICAgaWYgKHRoaXMuaXNEZXRhY2hlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgX2dldEV2ZW50Q29vcmRpbmF0ZXMzID0gZ2V0RXZlbnRDb29yZGluYXRlcyhlKSxcbiAgICAgICAgY2xpZW50WCA9IF9nZXRFdmVudENvb3JkaW5hdGVzMy5jbGllbnRYLFxuICAgICAgICBjbGllbnRZID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMzLmNsaWVudFksXG4gICAgICAgIHBhZ2VYID0gX2dldEV2ZW50Q29vcmRpbmF0ZXMzLnBhZ2VYLFxuICAgICAgICBwYWdlWSA9IF9nZXRFdmVudENvb3JkaW5hdGVzMy5wYWdlWTtcbiAgICAgIHZhciBub2RlID0gdGhpcy5jb250YWluZXIoKSxcbiAgICAgICAgY29sbGlkZXMsXG4gICAgICAgIG9mZnNldERhdGE7XG5cbiAgICAgIC8vIFJpZ2h0IGNsaWNrc1xuICAgICAgaWYgKGUud2hpY2ggPT09IDMgfHwgZS5idXR0b24gPT09IDIgfHwgIWlzT3ZlckNvbnRhaW5lcihub2RlLCBjbGllbnRYLCBjbGllbnRZKSkgcmV0dXJuO1xuICAgICAgaWYgKCF0aGlzLmdsb2JhbE1vdXNlICYmIG5vZGUgJiYgIWNvbnRhaW5zKG5vZGUsIGUudGFyZ2V0KSkge1xuICAgICAgICB2YXIgX25vcm1hbGl6ZURpc3RhbmNlID0gbm9ybWFsaXplRGlzdGFuY2UoMCksXG4gICAgICAgICAgdG9wID0gX25vcm1hbGl6ZURpc3RhbmNlLnRvcCxcbiAgICAgICAgICBsZWZ0ID0gX25vcm1hbGl6ZURpc3RhbmNlLmxlZnQsXG4gICAgICAgICAgYm90dG9tID0gX25vcm1hbGl6ZURpc3RhbmNlLmJvdHRvbSxcbiAgICAgICAgICByaWdodCA9IF9ub3JtYWxpemVEaXN0YW5jZS5yaWdodDtcbiAgICAgICAgb2Zmc2V0RGF0YSA9IGdldEJvdW5kc0Zvck5vZGUobm9kZSk7XG4gICAgICAgIGNvbGxpZGVzID0gb2JqZWN0c0NvbGxpZGUoe1xuICAgICAgICAgIHRvcDogb2Zmc2V0RGF0YS50b3AgLSB0b3AsXG4gICAgICAgICAgbGVmdDogb2Zmc2V0RGF0YS5sZWZ0IC0gbGVmdCxcbiAgICAgICAgICBib3R0b206IG9mZnNldERhdGEuYm90dG9tICsgYm90dG9tLFxuICAgICAgICAgIHJpZ2h0OiBvZmZzZXREYXRhLnJpZ2h0ICsgcmlnaHRcbiAgICAgICAgfSwge1xuICAgICAgICAgIHRvcDogcGFnZVksXG4gICAgICAgICAgbGVmdDogcGFnZVhcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghY29sbGlkZXMpIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLmVtaXQoJ2JlZm9yZVNlbGVjdCcsIHRoaXMuX2luaXRpYWxFdmVudERhdGEgPSB7XG4gICAgICAgIGlzVG91Y2g6IC9edG91Y2gvLnRlc3QoZS50eXBlKSxcbiAgICAgICAgeDogcGFnZVgsXG4gICAgICAgIHk6IHBhZ2VZLFxuICAgICAgICBjbGllbnRYOiBjbGllbnRYLFxuICAgICAgICBjbGllbnRZOiBjbGllbnRZXG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICBzd2l0Y2ggKGUudHlwZSkge1xuICAgICAgICBjYXNlICdtb3VzZWRvd24nOlxuICAgICAgICAgIHRoaXMuX3JlbW92ZUVuZExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX2hhbmRsZVRlcm1pbmF0aW5nRXZlbnQpO1xuICAgICAgICAgIHRoaXMuX29uRXNjTGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlVGVybWluYXRpbmdFdmVudCk7XG4gICAgICAgICAgdGhpcy5fcmVtb3ZlTW92ZUxpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5faGFuZGxlTW92ZUV2ZW50KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndG91Y2hzdGFydCc6XG4gICAgICAgICAgdGhpcy5faGFuZGxlTW92ZUV2ZW50KGUpO1xuICAgICAgICAgIHRoaXMuX3JlbW92ZUVuZExpc3RlbmVyID0gYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLl9oYW5kbGVUZXJtaW5hdGluZ0V2ZW50KTtcbiAgICAgICAgICB0aGlzLl9yZW1vdmVNb3ZlTGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLl9oYW5kbGVNb3ZlRXZlbnQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIHdoZXRoZXIgcHJvdmlkZWQgZXZlbnQgdGFyZ2V0IGVsZW1lbnRcbiAgICAvLyAtIGlzIGNvbnRhaW5lZCB3aXRoaW4gYSB2YWxpZCBjb250YWluZXJcbiAgfSwge1xuICAgIGtleTogXCJfaXNXaXRoaW5WYWxpZENvbnRhaW5lclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNXaXRoaW5WYWxpZENvbnRhaW5lcihlKSB7XG4gICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlLnRhcmdldDtcbiAgICAgIHZhciBjb250YWluZXJzID0gdGhpcy52YWxpZENvbnRhaW5lcnM7XG4gICAgICBpZiAoIWNvbnRhaW5lcnMgfHwgIWNvbnRhaW5lcnMubGVuZ3RoIHx8ICFldmVudFRhcmdldCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb250YWluZXJzLnNvbWUoZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICByZXR1cm4gISFldmVudFRhcmdldC5jbG9zZXN0KHRhcmdldCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiX2hhbmRsZVRlcm1pbmF0aW5nRXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2hhbmRsZVRlcm1pbmF0aW5nRXZlbnQoZSkge1xuICAgICAgdmFyIHNlbGVjdGluZyA9IHRoaXMuc2VsZWN0aW5nO1xuICAgICAgdmFyIGJvdW5kcyA9IHRoaXMuX3NlbGVjdFJlY3Q7XG4gICAgICAvLyBJZiBpdCdzIG5vdCBpbiBzZWxlY3Rpbmcgc3RhdGUsIGl0J3MgYSBjbGljayBldmVudFxuICAgICAgaWYgKCFzZWxlY3RpbmcgJiYgZS50eXBlLmluY2x1ZGVzKCdrZXknKSkge1xuICAgICAgICBlID0gdGhpcy5faW5pdGlhbEV2ZW50O1xuICAgICAgfVxuICAgICAgdGhpcy5zZWxlY3RpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3JlbW92ZUVuZExpc3RlbmVyICYmIHRoaXMuX3JlbW92ZUVuZExpc3RlbmVyKCk7XG4gICAgICB0aGlzLl9yZW1vdmVNb3ZlTGlzdGVuZXIgJiYgdGhpcy5fcmVtb3ZlTW92ZUxpc3RlbmVyKCk7XG4gICAgICB0aGlzLl9zZWxlY3RSZWN0ID0gbnVsbDtcbiAgICAgIHRoaXMuX2luaXRpYWxFdmVudCA9IG51bGw7XG4gICAgICB0aGlzLl9pbml0aWFsRXZlbnREYXRhID0gbnVsbDtcbiAgICAgIGlmICghZSkgcmV0dXJuO1xuICAgICAgdmFyIGluUm9vdCA9ICF0aGlzLmNvbnRhaW5lciB8fCBjb250YWlucyh0aGlzLmNvbnRhaW5lcigpLCBlLnRhcmdldCk7XG4gICAgICB2YXIgaXNXaXRoaW5WYWxpZENvbnRhaW5lciA9IHRoaXMuX2lzV2l0aGluVmFsaWRDb250YWluZXIoZSk7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnIHx8ICFpc1dpdGhpblZhbGlkQ29udGFpbmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVtaXQoJ3Jlc2V0Jyk7XG4gICAgICB9XG4gICAgICBpZiAoIXNlbGVjdGluZyAmJiBpblJvb3QpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZUNsaWNrRXZlbnQoZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFVzZXIgZHJhZy1jbGlja2VkIGluIHRoZSBTZWxlY3RhYmxlIGFyZWFcbiAgICAgIGlmIChzZWxlY3RpbmcpIHJldHVybiB0aGlzLmVtaXQoJ3NlbGVjdCcsIGJvdW5kcyk7XG4gICAgICByZXR1cm4gdGhpcy5lbWl0KCdyZXNldCcpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfaGFuZGxlQ2xpY2tFdmVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfaGFuZGxlQ2xpY2tFdmVudChlKSB7XG4gICAgICB2YXIgX2dldEV2ZW50Q29vcmRpbmF0ZXM0ID0gZ2V0RXZlbnRDb29yZGluYXRlcyhlKSxcbiAgICAgICAgcGFnZVggPSBfZ2V0RXZlbnRDb29yZGluYXRlczQucGFnZVgsXG4gICAgICAgIHBhZ2VZID0gX2dldEV2ZW50Q29vcmRpbmF0ZXM0LnBhZ2VZLFxuICAgICAgICBjbGllbnRYID0gX2dldEV2ZW50Q29vcmRpbmF0ZXM0LmNsaWVudFgsXG4gICAgICAgIGNsaWVudFkgPSBfZ2V0RXZlbnRDb29yZGluYXRlczQuY2xpZW50WTtcbiAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgIGlmICh0aGlzLl9sYXN0Q2xpY2tEYXRhICYmIG5vdyAtIHRoaXMuX2xhc3RDbGlja0RhdGEudGltZXN0YW1wIDwgY2xpY2tJbnRlcnZhbCkge1xuICAgICAgICAvLyBEb3VibGUgY2xpY2sgZXZlbnRcbiAgICAgICAgdGhpcy5fbGFzdENsaWNrRGF0YSA9IG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLmVtaXQoJ2RvdWJsZUNsaWNrJywge1xuICAgICAgICAgIHg6IHBhZ2VYLFxuICAgICAgICAgIHk6IHBhZ2VZLFxuICAgICAgICAgIGNsaWVudFg6IGNsaWVudFgsXG4gICAgICAgICAgY2xpZW50WTogY2xpZW50WVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2xpY2sgZXZlbnRcbiAgICAgIHRoaXMuX2xhc3RDbGlja0RhdGEgPSB7XG4gICAgICAgIHRpbWVzdGFtcDogbm93XG4gICAgICB9O1xuICAgICAgcmV0dXJuIHRoaXMuZW1pdCgnY2xpY2snLCB7XG4gICAgICAgIHg6IHBhZ2VYLFxuICAgICAgICB5OiBwYWdlWSxcbiAgICAgICAgY2xpZW50WDogY2xpZW50WCxcbiAgICAgICAgY2xpZW50WTogY2xpZW50WVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIl9oYW5kbGVNb3ZlRXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2hhbmRsZU1vdmVFdmVudChlKSB7XG4gICAgICBpZiAodGhpcy5faW5pdGlhbEV2ZW50RGF0YSA9PT0gbnVsbCB8fCB0aGlzLmlzRGV0YWNoZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIF90aGlzJF9pbml0aWFsRXZlbnREYSA9IHRoaXMuX2luaXRpYWxFdmVudERhdGEsXG4gICAgICAgIHggPSBfdGhpcyRfaW5pdGlhbEV2ZW50RGEueCxcbiAgICAgICAgeSA9IF90aGlzJF9pbml0aWFsRXZlbnREYS55O1xuICAgICAgdmFyIF9nZXRFdmVudENvb3JkaW5hdGVzNSA9IGdldEV2ZW50Q29vcmRpbmF0ZXMoZSksXG4gICAgICAgIHBhZ2VYID0gX2dldEV2ZW50Q29vcmRpbmF0ZXM1LnBhZ2VYLFxuICAgICAgICBwYWdlWSA9IF9nZXRFdmVudENvb3JkaW5hdGVzNS5wYWdlWTtcbiAgICAgIHZhciB3ID0gTWF0aC5hYnMoeCAtIHBhZ2VYKTtcbiAgICAgIHZhciBoID0gTWF0aC5hYnMoeSAtIHBhZ2VZKTtcbiAgICAgIHZhciBsZWZ0ID0gTWF0aC5taW4ocGFnZVgsIHgpLFxuICAgICAgICB0b3AgPSBNYXRoLm1pbihwYWdlWSwgeSksXG4gICAgICAgIG9sZCA9IHRoaXMuc2VsZWN0aW5nO1xuICAgICAgdmFyIGNsaWNrID0gdGhpcy5pc0NsaWNrKHBhZ2VYLCBwYWdlWSk7XG4gICAgICAvLyBQcmV2ZW50IGVtaXR0aW5nIHNlbGVjdFN0YXJ0IGV2ZW50IHVudGlsIG1vdXNlIGlzIG1vdmVkLlxuICAgICAgLy8gaW4gQ2hyb21lIG9uIFdpbmRvd3MsIG1vdXNlTW92ZSBldmVudCBtYXkgYmUgZmlyZWQganVzdCBhZnRlciBtb3VzZURvd24gZXZlbnQuXG4gICAgICBpZiAoY2xpY2sgJiYgIW9sZCAmJiAhKHcgfHwgaCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCFvbGQgJiYgIWNsaWNrKSB7XG4gICAgICAgIHRoaXMuZW1pdCgnc2VsZWN0U3RhcnQnLCB0aGlzLl9pbml0aWFsRXZlbnREYXRhKTtcbiAgICAgIH1cbiAgICAgIGlmICghY2xpY2spIHtcbiAgICAgICAgdGhpcy5zZWxlY3RpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zZWxlY3RSZWN0ID0ge1xuICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgeDogcGFnZVgsXG4gICAgICAgICAgeTogcGFnZVksXG4gICAgICAgICAgcmlnaHQ6IGxlZnQgKyB3LFxuICAgICAgICAgIGJvdHRvbTogdG9wICsgaFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVtaXQoJ3NlbGVjdGluZycsIHRoaXMuX3NlbGVjdFJlY3QpO1xuICAgICAgfVxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfa2V5TGlzdGVuZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2tleUxpc3RlbmVyKGUpIHtcbiAgICAgIHRoaXMuY3RybCA9IGUubWV0YUtleSB8fCBlLmN0cmxLZXk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImlzQ2xpY2tcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNDbGljayhwYWdlWCwgcGFnZVkpIHtcbiAgICAgIHZhciBfdGhpcyRfaW5pdGlhbEV2ZW50RGEyID0gdGhpcy5faW5pdGlhbEV2ZW50RGF0YSxcbiAgICAgICAgeCA9IF90aGlzJF9pbml0aWFsRXZlbnREYTIueCxcbiAgICAgICAgeSA9IF90aGlzJF9pbml0aWFsRXZlbnREYTIueSxcbiAgICAgICAgaXNUb3VjaCA9IF90aGlzJF9pbml0aWFsRXZlbnREYTIuaXNUb3VjaDtcbiAgICAgIHJldHVybiAhaXNUb3VjaCAmJiBNYXRoLmFicyhwYWdlWCAtIHgpIDw9IGNsaWNrVG9sZXJhbmNlICYmIE1hdGguYWJzKHBhZ2VZIC0geSkgPD0gY2xpY2tUb2xlcmFuY2U7XG4gICAgfVxuICB9XSk7XG59KCk7XG4vKipcbiAqIFJlc29sdmUgdGhlIGRpc2FuY2UgcHJvcCBmcm9tIGVpdGhlciBhbiBJbnQgb3IgYW4gT2JqZWN0XG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZURpc3RhbmNlKCkge1xuICB2YXIgZGlzdGFuY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7XG4gIGlmIChfdHlwZW9mKGRpc3RhbmNlKSAhPT0gJ29iamVjdCcpIGRpc3RhbmNlID0ge1xuICAgIHRvcDogZGlzdGFuY2UsXG4gICAgbGVmdDogZGlzdGFuY2UsXG4gICAgcmlnaHQ6IGRpc3RhbmNlLFxuICAgIGJvdHRvbTogZGlzdGFuY2VcbiAgfTtcbiAgcmV0dXJuIGRpc3RhbmNlO1xufVxuXG4vKipcbiAqIEdpdmVuIHR3byBvYmplY3RzIGNvbnRhaW5pbmcgXCJ0b3BcIiwgXCJsZWZ0XCIsIFwib2Zmc2V0V2lkdGhcIiBhbmQgXCJvZmZzZXRIZWlnaHRcIlxuICogcHJvcGVydGllcywgZGV0ZXJtaW5lIGlmIHRoZXkgY29sbGlkZS5cbiAqIEBwYXJhbSAge09iamVjdHxIVE1MRWxlbWVudH0gYVxuICogQHBhcmFtICB7T2JqZWN0fEhUTUxFbGVtZW50fSBiXG4gKiBAcmV0dXJuIHtib29sfVxuICovXG5mdW5jdGlvbiBvYmplY3RzQ29sbGlkZShub2RlQSwgbm9kZUIpIHtcbiAgdmFyIHRvbGVyYW5jZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDtcbiAgdmFyIF9nZXRCb3VuZHNGb3JOb2RlID0gZ2V0Qm91bmRzRm9yTm9kZShub2RlQSksXG4gICAgYVRvcCA9IF9nZXRCb3VuZHNGb3JOb2RlLnRvcCxcbiAgICBhTGVmdCA9IF9nZXRCb3VuZHNGb3JOb2RlLmxlZnQsXG4gICAgX2dldEJvdW5kc0Zvck5vZGUkcmlnID0gX2dldEJvdW5kc0Zvck5vZGUucmlnaHQsXG4gICAgYVJpZ2h0ID0gX2dldEJvdW5kc0Zvck5vZGUkcmlnID09PSB2b2lkIDAgPyBhTGVmdCA6IF9nZXRCb3VuZHNGb3JOb2RlJHJpZyxcbiAgICBfZ2V0Qm91bmRzRm9yTm9kZSRib3QgPSBfZ2V0Qm91bmRzRm9yTm9kZS5ib3R0b20sXG4gICAgYUJvdHRvbSA9IF9nZXRCb3VuZHNGb3JOb2RlJGJvdCA9PT0gdm9pZCAwID8gYVRvcCA6IF9nZXRCb3VuZHNGb3JOb2RlJGJvdDtcbiAgdmFyIF9nZXRCb3VuZHNGb3JOb2RlMiA9IGdldEJvdW5kc0Zvck5vZGUobm9kZUIpLFxuICAgIGJUb3AgPSBfZ2V0Qm91bmRzRm9yTm9kZTIudG9wLFxuICAgIGJMZWZ0ID0gX2dldEJvdW5kc0Zvck5vZGUyLmxlZnQsXG4gICAgX2dldEJvdW5kc0Zvck5vZGUyJHJpID0gX2dldEJvdW5kc0Zvck5vZGUyLnJpZ2h0LFxuICAgIGJSaWdodCA9IF9nZXRCb3VuZHNGb3JOb2RlMiRyaSA9PT0gdm9pZCAwID8gYkxlZnQgOiBfZ2V0Qm91bmRzRm9yTm9kZTIkcmksXG4gICAgX2dldEJvdW5kc0Zvck5vZGUyJGJvID0gX2dldEJvdW5kc0Zvck5vZGUyLmJvdHRvbSxcbiAgICBiQm90dG9tID0gX2dldEJvdW5kc0Zvck5vZGUyJGJvID09PSB2b2lkIDAgPyBiVG9wIDogX2dldEJvdW5kc0Zvck5vZGUyJGJvO1xuICByZXR1cm4gIShcbiAgLy8gJ2EnIGJvdHRvbSBkb2Vzbid0IHRvdWNoICdiJyB0b3BcblxuICBhQm90dG9tIC0gdG9sZXJhbmNlIDwgYlRvcCB8fFxuICAvLyAnYScgdG9wIGRvZXNuJ3QgdG91Y2ggJ2InIGJvdHRvbVxuICBhVG9wICsgdG9sZXJhbmNlID4gYkJvdHRvbSB8fFxuICAvLyAnYScgcmlnaHQgZG9lc24ndCB0b3VjaCAnYicgbGVmdFxuICBhUmlnaHQgLSB0b2xlcmFuY2UgPCBiTGVmdCB8fFxuICAvLyAnYScgbGVmdCBkb2Vzbid0IHRvdWNoICdiJyByaWdodFxuICBhTGVmdCArIHRvbGVyYW5jZSA+IGJSaWdodCk7XG59XG5cbi8qKlxuICogR2l2ZW4gYSBub2RlLCBnZXQgZXZlcnl0aGluZyBuZWVkZWQgdG8gY2FsY3VsYXRlIGl0cyBib3VuZGFyaWVzXG4gKiBAcGFyYW0gIHtIVE1MRWxlbWVudH0gbm9kZVxuICogQHJldHVybiB7T2JqZWN0fVxuICovXG5mdW5jdGlvbiBnZXRCb3VuZHNGb3JOb2RlKG5vZGUpIHtcbiAgaWYgKCFub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCkgcmV0dXJuIG5vZGU7XG4gIHZhciByZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICBsZWZ0ID0gcmVjdC5sZWZ0ICsgcGFnZU9mZnNldCgnbGVmdCcpLFxuICAgIHRvcCA9IHJlY3QudG9wICsgcGFnZU9mZnNldCgndG9wJyk7XG4gIHJldHVybiB7XG4gICAgdG9wOiB0b3AsXG4gICAgbGVmdDogbGVmdCxcbiAgICByaWdodDogKG5vZGUub2Zmc2V0V2lkdGggfHwgMCkgKyBsZWZ0LFxuICAgIGJvdHRvbTogKG5vZGUub2Zmc2V0SGVpZ2h0IHx8IDApICsgdG9wXG4gIH07XG59XG5mdW5jdGlvbiBwYWdlT2Zmc2V0KGRpcikge1xuICBpZiAoZGlyID09PSAnbGVmdCcpIHJldHVybiB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0IHx8IDA7XG4gIGlmIChkaXIgPT09ICd0b3AnKSByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IDA7XG59XG5cbnZhciBCYWNrZ3JvdW5kQ2VsbHMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgZnVuY3Rpb24gQmFja2dyb3VuZENlbGxzKHByb3BzLCBjb250ZXh0KSB7XG4gICAgdmFyIF90aGlzO1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYWNrZ3JvdW5kQ2VsbHMpO1xuICAgIF90aGlzID0gX2NhbGxTdXBlcih0aGlzLCBCYWNrZ3JvdW5kQ2VsbHMsIFtwcm9wcywgY29udGV4dF0pO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgc2VsZWN0aW5nOiBmYWxzZVxuICAgIH07XG4gICAgX3RoaXMuY29udGFpbmVyUmVmID0gLyojX19QVVJFX18qL2NyZWF0ZVJlZigpO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuICBfaW5oZXJpdHMoQmFja2dyb3VuZENlbGxzLCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhCYWNrZ3JvdW5kQ2VsbHMsIFt7XG4gICAga2V5OiBcImNvbXBvbmVudERpZE1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5wcm9wcy5zZWxlY3RhYmxlICYmIHRoaXMuX3NlbGVjdGFibGUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50V2lsbFVubW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLl90ZWFyZG93blNlbGVjdGFibGUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50RGlkVXBkYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMpIHtcbiAgICAgIGlmICghcHJldlByb3BzLnNlbGVjdGFibGUgJiYgdGhpcy5wcm9wcy5zZWxlY3RhYmxlKSB0aGlzLl9zZWxlY3RhYmxlKCk7XG4gICAgICBpZiAocHJldlByb3BzLnNlbGVjdGFibGUgJiYgIXRoaXMucHJvcHMuc2VsZWN0YWJsZSkgdGhpcy5fdGVhcmRvd25TZWxlY3RhYmxlKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLFxuICAgICAgICByYW5nZSA9IF90aGlzJHByb3BzLnJhbmdlLFxuICAgICAgICBnZXROb3cgPSBfdGhpcyRwcm9wcy5nZXROb3csXG4gICAgICAgIGdldHRlcnMgPSBfdGhpcyRwcm9wcy5nZXR0ZXJzLFxuICAgICAgICBjdXJyZW50RGF0ZSA9IF90aGlzJHByb3BzLmRhdGUsXG4gICAgICAgIFdyYXBwZXIgPSBfdGhpcyRwcm9wcy5jb21wb25lbnRzLmRhdGVDZWxsV3JhcHBlcixcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMubG9jYWxpemVyO1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gdGhpcy5zdGF0ZSxcbiAgICAgICAgc2VsZWN0aW5nID0gX3RoaXMkc3RhdGUuc2VsZWN0aW5nLFxuICAgICAgICBzdGFydElkeCA9IF90aGlzJHN0YXRlLnN0YXJ0SWR4LFxuICAgICAgICBlbmRJZHggPSBfdGhpcyRzdGF0ZS5lbmRJZHg7XG4gICAgICB2YXIgY3VycmVudCA9IGdldE5vdygpO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1yb3ctYmdcIixcbiAgICAgICAgcmVmOiB0aGlzLmNvbnRhaW5lclJlZlxuICAgICAgfSwgcmFuZ2UubWFwKGZ1bmN0aW9uIChkYXRlLCBpbmRleCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWQgPSBzZWxlY3RpbmcgJiYgaW5kZXggPj0gc3RhcnRJZHggJiYgaW5kZXggPD0gZW5kSWR4O1xuICAgICAgICB2YXIgX2dldHRlcnMkZGF5UHJvcCA9IGdldHRlcnMuZGF5UHJvcChkYXRlKSxcbiAgICAgICAgICBjbGFzc05hbWUgPSBfZ2V0dGVycyRkYXlQcm9wLmNsYXNzTmFtZSxcbiAgICAgICAgICBzdHlsZSA9IF9nZXR0ZXJzJGRheVByb3Auc3R5bGU7XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChXcmFwcGVyLCB7XG4gICAgICAgICAga2V5OiBpbmRleCxcbiAgICAgICAgICB2YWx1ZTogZGF0ZSxcbiAgICAgICAgICByYW5nZTogcmFuZ2VcbiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICAgIHN0eWxlOiBzdHlsZSxcbiAgICAgICAgICBjbGFzc05hbWU6IGNsc3goJ3JiYy1kYXktYmcnLCBjbGFzc05hbWUsIHNlbGVjdGVkICYmICdyYmMtc2VsZWN0ZWQtY2VsbCcsIGxvY2FsaXplci5pc1NhbWVEYXRlKGRhdGUsIGN1cnJlbnQpICYmICdyYmMtdG9kYXknLCBjdXJyZW50RGF0ZSAmJiBsb2NhbGl6ZXIubmVxKGN1cnJlbnREYXRlLCBkYXRlLCAnbW9udGgnKSAmJiAncmJjLW9mZi1yYW5nZS1iZycpXG4gICAgICAgIH0pKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiX3NlbGVjdGFibGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbGVjdGFibGUoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcbiAgICAgIHZhciBub2RlID0gdGhpcy5jb250YWluZXJSZWYuY3VycmVudDtcbiAgICAgIHZhciBzZWxlY3RvciA9IHRoaXMuX3NlbGVjdG9yID0gbmV3IFNlbGVjdGlvbih0aGlzLnByb3BzLmNvbnRhaW5lciwge1xuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQ6IHRoaXMucHJvcHMubG9uZ1ByZXNzVGhyZXNob2xkXG4gICAgICB9KTtcbiAgICAgIHZhciBzZWxlY3RvckNsaWNrc0hhbmRsZXIgPSBmdW5jdGlvbiBzZWxlY3RvckNsaWNrc0hhbmRsZXIocG9pbnQsIGFjdGlvblR5cGUpIHtcbiAgICAgICAgaWYgKCFpc0V2ZW50KG5vZGUsIHBvaW50KSAmJiAhaXNTaG93TW9yZShub2RlLCBwb2ludCkpIHtcbiAgICAgICAgICB2YXIgcm93Qm94ID0gZ2V0Qm91bmRzRm9yTm9kZShub2RlKTtcbiAgICAgICAgICB2YXIgX3RoaXMyJHByb3BzID0gX3RoaXMyLnByb3BzLFxuICAgICAgICAgICAgcmFuZ2UgPSBfdGhpczIkcHJvcHMucmFuZ2UsXG4gICAgICAgICAgICBydGwgPSBfdGhpczIkcHJvcHMucnRsO1xuICAgICAgICAgIGlmIChwb2ludEluQm94KHJvd0JveCwgcG9pbnQpKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudENlbGwgPSBnZXRTbG90QXRYKHJvd0JveCwgcG9pbnQueCwgcnRsLCByYW5nZS5sZW5ndGgpO1xuICAgICAgICAgICAgX3RoaXMyLl9zZWxlY3RTbG90KHtcbiAgICAgICAgICAgICAgc3RhcnRJZHg6IGN1cnJlbnRDZWxsLFxuICAgICAgICAgICAgICBlbmRJZHg6IGN1cnJlbnRDZWxsLFxuICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvblR5cGUsXG4gICAgICAgICAgICAgIGJveDogcG9pbnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBfdGhpczIuX2luaXRpYWwgPSB7fTtcbiAgICAgICAgX3RoaXMyLnNldFN0YXRlKHtcbiAgICAgICAgICBzZWxlY3Rpbmc6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHNlbGVjdG9yLm9uKCdzZWxlY3RpbmcnLCBmdW5jdGlvbiAoYm94KSB7XG4gICAgICAgIHZhciBfdGhpczIkcHJvcHMyID0gX3RoaXMyLnByb3BzLFxuICAgICAgICAgIHJhbmdlID0gX3RoaXMyJHByb3BzMi5yYW5nZSxcbiAgICAgICAgICBydGwgPSBfdGhpczIkcHJvcHMyLnJ0bDtcbiAgICAgICAgdmFyIHN0YXJ0SWR4ID0gLTE7XG4gICAgICAgIHZhciBlbmRJZHggPSAtMTtcbiAgICAgICAgaWYgKCFfdGhpczIuc3RhdGUuc2VsZWN0aW5nKSB7XG4gICAgICAgICAgbm90aWZ5KF90aGlzMi5wcm9wcy5vblNlbGVjdFN0YXJ0LCBbYm94XSk7XG4gICAgICAgICAgX3RoaXMyLl9pbml0aWFsID0ge1xuICAgICAgICAgICAgeDogYm94LngsXG4gICAgICAgICAgICB5OiBib3gueVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdG9yLmlzU2VsZWN0ZWQobm9kZSkpIHtcbiAgICAgICAgICB2YXIgbm9kZUJveCA9IGdldEJvdW5kc0Zvck5vZGUobm9kZSk7XG4gICAgICAgICAgdmFyIF9kYXRlQ2VsbFNlbGVjdGlvbiA9IGRhdGVDZWxsU2VsZWN0aW9uKF90aGlzMi5faW5pdGlhbCwgbm9kZUJveCwgYm94LCByYW5nZS5sZW5ndGgsIHJ0bCk7XG4gICAgICAgICAgc3RhcnRJZHggPSBfZGF0ZUNlbGxTZWxlY3Rpb24uc3RhcnRJZHg7XG4gICAgICAgICAgZW5kSWR4ID0gX2RhdGVDZWxsU2VsZWN0aW9uLmVuZElkeDtcbiAgICAgICAgfVxuICAgICAgICBfdGhpczIuc2V0U3RhdGUoe1xuICAgICAgICAgIHNlbGVjdGluZzogdHJ1ZSxcbiAgICAgICAgICBzdGFydElkeDogc3RhcnRJZHgsXG4gICAgICAgICAgZW5kSWR4OiBlbmRJZHhcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHNlbGVjdG9yLm9uKCdiZWZvcmVTZWxlY3QnLCBmdW5jdGlvbiAoYm94KSB7XG4gICAgICAgIGlmIChfdGhpczIucHJvcHMuc2VsZWN0YWJsZSAhPT0gJ2lnbm9yZUV2ZW50cycpIHJldHVybjtcbiAgICAgICAgcmV0dXJuICFpc0V2ZW50KF90aGlzMi5jb250YWluZXJSZWYuY3VycmVudCwgYm94KTtcbiAgICAgIH0pO1xuICAgICAgc2VsZWN0b3Iub24oJ2NsaWNrJywgZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgIHJldHVybiBzZWxlY3RvckNsaWNrc0hhbmRsZXIocG9pbnQsICdjbGljaycpO1xuICAgICAgfSk7XG4gICAgICBzZWxlY3Rvci5vbignZG91YmxlQ2xpY2snLCBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yQ2xpY2tzSGFuZGxlcihwb2ludCwgJ2RvdWJsZUNsaWNrJyk7XG4gICAgICB9KTtcbiAgICAgIHNlbGVjdG9yLm9uKCdzZWxlY3QnLCBmdW5jdGlvbiAoYm91bmRzKSB7XG4gICAgICAgIF90aGlzMi5fc2VsZWN0U2xvdChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIF90aGlzMi5zdGF0ZSksIHt9LCB7XG4gICAgICAgICAgYWN0aW9uOiAnc2VsZWN0JyxcbiAgICAgICAgICBib3VuZHM6IGJvdW5kc1xuICAgICAgICB9KSk7XG4gICAgICAgIF90aGlzMi5faW5pdGlhbCA9IHt9O1xuICAgICAgICBfdGhpczIuc2V0U3RhdGUoe1xuICAgICAgICAgIHNlbGVjdGluZzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIG5vdGlmeShfdGhpczIucHJvcHMub25TZWxlY3RFbmQsIFtfdGhpczIuc3RhdGVdKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfdGVhcmRvd25TZWxlY3RhYmxlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF90ZWFyZG93blNlbGVjdGFibGUoKSB7XG4gICAgICBpZiAoIXRoaXMuX3NlbGVjdG9yKSByZXR1cm47XG4gICAgICB0aGlzLl9zZWxlY3Rvci50ZWFyZG93bigpO1xuICAgICAgdGhpcy5fc2VsZWN0b3IgPSBudWxsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfc2VsZWN0U2xvdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VsZWN0U2xvdChfcmVmKSB7XG4gICAgICB2YXIgZW5kSWR4ID0gX3JlZi5lbmRJZHgsXG4gICAgICAgIHN0YXJ0SWR4ID0gX3JlZi5zdGFydElkeCxcbiAgICAgICAgYWN0aW9uID0gX3JlZi5hY3Rpb24sXG4gICAgICAgIGJvdW5kcyA9IF9yZWYuYm91bmRzLFxuICAgICAgICBib3ggPSBfcmVmLmJveDtcbiAgICAgIGlmIChlbmRJZHggIT09IC0xICYmIHN0YXJ0SWR4ICE9PSAtMSkgdGhpcy5wcm9wcy5vblNlbGVjdFNsb3QgJiYgdGhpcy5wcm9wcy5vblNlbGVjdFNsb3Qoe1xuICAgICAgICBzdGFydDogc3RhcnRJZHgsXG4gICAgICAgIGVuZDogZW5kSWR4LFxuICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgYm91bmRzOiBib3VuZHMsXG4gICAgICAgIGJveDogYm94LFxuICAgICAgICByZXNvdXJjZUlkOiB0aGlzLnByb3BzLnJlc291cmNlSWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfV0pO1xufShSZWFjdC5Db21wb25lbnQpO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9wcm9wLXR5cGVzICovXG52YXIgRXZlbnRSb3dNaXhpbiA9IHtcbiAgcHJvcFR5cGVzOiB7XG4gICAgc2xvdE1ldHJpY3M6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBzZWxlY3RlZDogUHJvcFR5cGVzLm9iamVjdCxcbiAgICBpc0FsbERheTogUHJvcFR5cGVzLmJvb2wsXG4gICAgYWNjZXNzb3JzOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgbG9jYWxpemVyOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgY29tcG9uZW50czogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGdldHRlcnM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBvblNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25Eb3VibGVDbGljazogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25LZXlQcmVzczogUHJvcFR5cGVzLmZ1bmNcbiAgfSxcbiAgZGVmYXVsdFByb3BzOiB7XG4gICAgc2VnbWVudHM6IFtdLFxuICAgIHNlbGVjdGVkOiB7fVxuICB9LFxuICByZW5kZXJFdmVudDogZnVuY3Rpb24gcmVuZGVyRXZlbnQocHJvcHMsIGV2ZW50KSB7XG4gICAgdmFyIHNlbGVjdGVkID0gcHJvcHMuc2VsZWN0ZWQ7XG4gICAgICBwcm9wcy5pc0FsbERheTtcbiAgICAgIHZhciBhY2Nlc3NvcnMgPSBwcm9wcy5hY2Nlc3NvcnMsXG4gICAgICBnZXR0ZXJzID0gcHJvcHMuZ2V0dGVycyxcbiAgICAgIG9uU2VsZWN0ID0gcHJvcHMub25TZWxlY3QsXG4gICAgICBvbkRvdWJsZUNsaWNrID0gcHJvcHMub25Eb3VibGVDbGljayxcbiAgICAgIG9uS2V5UHJlc3MgPSBwcm9wcy5vbktleVByZXNzLFxuICAgICAgbG9jYWxpemVyID0gcHJvcHMubG9jYWxpemVyLFxuICAgICAgc2xvdE1ldHJpY3MgPSBwcm9wcy5zbG90TWV0cmljcyxcbiAgICAgIGNvbXBvbmVudHMgPSBwcm9wcy5jb21wb25lbnRzLFxuICAgICAgcmVzaXphYmxlID0gcHJvcHMucmVzaXphYmxlO1xuICAgIHZhciBjb250aW51ZXNQcmlvciA9IHNsb3RNZXRyaWNzLmNvbnRpbnVlc1ByaW9yKGV2ZW50KTtcbiAgICB2YXIgY29udGludWVzQWZ0ZXIgPSBzbG90TWV0cmljcy5jb250aW51ZXNBZnRlcihldmVudCk7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50Q2VsbCwge1xuICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgZ2V0dGVyczogZ2V0dGVycyxcbiAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgYWNjZXNzb3JzOiBhY2Nlc3NvcnMsXG4gICAgICBjb21wb25lbnRzOiBjb21wb25lbnRzLFxuICAgICAgb25TZWxlY3Q6IG9uU2VsZWN0LFxuICAgICAgb25Eb3VibGVDbGljazogb25Eb3VibGVDbGljayxcbiAgICAgIG9uS2V5UHJlc3M6IG9uS2V5UHJlc3MsXG4gICAgICBjb250aW51ZXNQcmlvcjogY29udGludWVzUHJpb3IsXG4gICAgICBjb250aW51ZXNBZnRlcjogY29udGludWVzQWZ0ZXIsXG4gICAgICBzbG90U3RhcnQ6IHNsb3RNZXRyaWNzLmZpcnN0LFxuICAgICAgc2xvdEVuZDogc2xvdE1ldHJpY3MubGFzdCxcbiAgICAgIHNlbGVjdGVkOiBpc1NlbGVjdGVkKGV2ZW50LCBzZWxlY3RlZCksXG4gICAgICByZXNpemFibGU6IHJlc2l6YWJsZVxuICAgIH0pO1xuICB9LFxuICByZW5kZXJTcGFuOiBmdW5jdGlvbiByZW5kZXJTcGFuKHNsb3RzLCBsZW4sIGtleSkge1xuICAgIHZhciBjb250ZW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAnICc7XG4gICAgdmFyIHBlciA9IE1hdGguYWJzKGxlbikgLyBzbG90cyAqIDEwMCArICclJztcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAga2V5OiBrZXksXG4gICAgICBjbGFzc05hbWU6IFwicmJjLXJvdy1zZWdtZW50XCJcbiAgICAgIC8vIElFMTAvMTEgbmVlZCBtYXgtd2lkdGguIGZsZXgtYmFzaXMgZG9lc24ndCByZXNwZWN0IGJveC1zaXppbmdcbiAgICAgICxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIFdlYmtpdEZsZXhCYXNpczogcGVyLFxuICAgICAgICBmbGV4QmFzaXM6IHBlcixcbiAgICAgICAgbWF4V2lkdGg6IHBlclxuICAgICAgfVxuICAgIH0sIGNvbnRlbnQpO1xuICB9XG59O1xuXG52YXIgRXZlbnRSb3cgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgZnVuY3Rpb24gRXZlbnRSb3coKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50Um93KTtcbiAgICByZXR1cm4gX2NhbGxTdXBlcih0aGlzLCBFdmVudFJvdywgYXJndW1lbnRzKTtcbiAgfVxuICBfaW5oZXJpdHMoRXZlbnRSb3csIF9SZWFjdCRDb21wb25lbnQpO1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKEV2ZW50Um93LCBbe1xuICAgIGtleTogXCJyZW5kZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsXG4gICAgICAgIHNlZ21lbnRzID0gX3RoaXMkcHJvcHMuc2VnbWVudHMsXG4gICAgICAgIHNsb3RzID0gX3RoaXMkcHJvcHMuc2xvdE1ldHJpY3Muc2xvdHMsXG4gICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzLmNsYXNzTmFtZTtcbiAgICAgIHZhciBsYXN0RW5kID0gMTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xzeChjbGFzc05hbWUsICdyYmMtcm93JylcbiAgICAgIH0sIHNlZ21lbnRzLnJlZHVjZShmdW5jdGlvbiAocm93LCBfcmVmLCBsaSkge1xuICAgICAgICB2YXIgZXZlbnQgPSBfcmVmLmV2ZW50LFxuICAgICAgICAgIGxlZnQgPSBfcmVmLmxlZnQsXG4gICAgICAgICAgcmlnaHQgPSBfcmVmLnJpZ2h0LFxuICAgICAgICAgIHNwYW4gPSBfcmVmLnNwYW47XG4gICAgICAgIHZhciBrZXkgPSAnX2x2bF8nICsgbGk7XG4gICAgICAgIHZhciBnYXAgPSBsZWZ0IC0gbGFzdEVuZDtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBFdmVudFJvd01peGluLnJlbmRlckV2ZW50KF90aGlzLnByb3BzLCBldmVudCk7XG4gICAgICAgIGlmIChnYXApIHJvdy5wdXNoKEV2ZW50Um93TWl4aW4ucmVuZGVyU3BhbihzbG90cywgZ2FwLCBcIlwiLmNvbmNhdChrZXksIFwiX2dhcFwiKSkpO1xuICAgICAgICByb3cucHVzaChFdmVudFJvd01peGluLnJlbmRlclNwYW4oc2xvdHMsIHNwYW4sIGtleSwgY29udGVudCkpO1xuICAgICAgICBsYXN0RW5kID0gcmlnaHQgKyAxO1xuICAgICAgICByZXR1cm4gcm93O1xuICAgICAgfSwgW10pKTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcbkV2ZW50Um93LmRlZmF1bHRQcm9wcyA9IF9vYmplY3RTcHJlYWQoe30sIEV2ZW50Um93TWl4aW4uZGVmYXVsdFByb3BzKTtcblxuZnVuY3Rpb24gZW5kT2ZSYW5nZShfcmVmKSB7XG4gIHZhciBkYXRlUmFuZ2UgPSBfcmVmLmRhdGVSYW5nZSxcbiAgICBfcmVmJHVuaXQgPSBfcmVmLnVuaXQsXG4gICAgdW5pdCA9IF9yZWYkdW5pdCA9PT0gdm9pZCAwID8gJ2RheScgOiBfcmVmJHVuaXQsXG4gICAgbG9jYWxpemVyID0gX3JlZi5sb2NhbGl6ZXI7XG4gIHJldHVybiB7XG4gICAgZmlyc3Q6IGRhdGVSYW5nZVswXSxcbiAgICBsYXN0OiBsb2NhbGl6ZXIuYWRkKGRhdGVSYW5nZVtkYXRlUmFuZ2UubGVuZ3RoIC0gMV0sIDEsIHVuaXQpXG4gIH07XG59XG5cbi8vIHByb3Blcmx5IGNhbGN1bGF0aW5nIHNlZ21lbnRzIHJlcXVpcmVzIHdvcmtpbmcgd2l0aCBkYXRlcyBpblxuLy8gdGhlIHRpbWV6b25lIHdlJ3JlIHdvcmtpbmcgd2l0aCwgc28gd2UgdXNlIHRoZSBsb2NhbGl6ZXJcbmZ1bmN0aW9uIGV2ZW50U2VnbWVudHMoZXZlbnQsIHJhbmdlLCBhY2Nlc3NvcnMsIGxvY2FsaXplcikge1xuICB2YXIgX2VuZE9mUmFuZ2UgPSBlbmRPZlJhbmdlKHtcbiAgICAgIGRhdGVSYW5nZTogcmFuZ2UsXG4gICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplclxuICAgIH0pLFxuICAgIGZpcnN0ID0gX2VuZE9mUmFuZ2UuZmlyc3QsXG4gICAgbGFzdCA9IF9lbmRPZlJhbmdlLmxhc3Q7XG4gIHZhciBzbG90cyA9IGxvY2FsaXplci5kaWZmKGZpcnN0LCBsYXN0LCAnZGF5Jyk7XG4gIHZhciBzdGFydCA9IGxvY2FsaXplci5tYXgobG9jYWxpemVyLnN0YXJ0T2YoYWNjZXNzb3JzLnN0YXJ0KGV2ZW50KSwgJ2RheScpLCBmaXJzdCk7XG4gIHZhciBlbmQgPSBsb2NhbGl6ZXIubWluKGxvY2FsaXplci5jZWlsKGFjY2Vzc29ycy5lbmQoZXZlbnQpLCAnZGF5JyksIGxhc3QpO1xuICB2YXIgcGFkZGluZyA9IGZpbmRJbmRleChyYW5nZSwgZnVuY3Rpb24gKHgpIHtcbiAgICByZXR1cm4gbG9jYWxpemVyLmlzU2FtZURhdGUoeCwgc3RhcnQpO1xuICB9KTtcbiAgdmFyIHNwYW4gPSBsb2NhbGl6ZXIuZGlmZihzdGFydCwgZW5kLCAnZGF5Jyk7XG4gIHNwYW4gPSBNYXRoLm1pbihzcGFuLCBzbG90cyk7XG4gIC8vIFRoZSBzZWdtZW50T2Zmc2V0IGlzIG5lY2Vzc2FyeSB3aGVuIGFkanVzdGluZyBmb3IgdGltZXpvbmVzXG4gIC8vIGFoZWFkIG9mIHRoZSBicm93c2VyIHRpbWV6b25lXG4gIHNwYW4gPSBNYXRoLm1heChzcGFuIC0gbG9jYWxpemVyLnNlZ21lbnRPZmZzZXQsIDEpO1xuICByZXR1cm4ge1xuICAgIGV2ZW50OiBldmVudCxcbiAgICBzcGFuOiBzcGFuLFxuICAgIGxlZnQ6IHBhZGRpbmcgKyAxLFxuICAgIHJpZ2h0OiBNYXRoLm1heChwYWRkaW5nICsgc3BhbiwgMSlcbiAgfTtcbn1cbmZ1bmN0aW9uIGV2ZW50TGV2ZWxzKHJvd1NlZ21lbnRzKSB7XG4gIHZhciBsaW1pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogSW5maW5pdHk7XG4gIHZhciBpLFxuICAgIGosXG4gICAgc2VnLFxuICAgIGxldmVscyA9IFtdLFxuICAgIGV4dHJhID0gW107XG4gIGZvciAoaSA9IDA7IGkgPCByb3dTZWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHNlZyA9IHJvd1NlZ21lbnRzW2ldO1xuICAgIGZvciAoaiA9IDA7IGogPCBsZXZlbHMubGVuZ3RoOyBqKyspIGlmICghc2Vnc092ZXJsYXAoc2VnLCBsZXZlbHNbal0pKSBicmVhaztcbiAgICBpZiAoaiA+PSBsaW1pdCkge1xuICAgICAgZXh0cmEucHVzaChzZWcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAobGV2ZWxzW2pdIHx8IChsZXZlbHNbal0gPSBbXSkpLnB1c2goc2VnKTtcbiAgICB9XG4gIH1cbiAgZm9yIChpID0gMDsgaSA8IGxldmVscy5sZW5ndGg7IGkrKykge1xuICAgIGxldmVsc1tpXS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gYS5sZWZ0IC0gYi5sZWZ0O1xuICAgIH0pOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcbiAgfVxuICByZXR1cm4ge1xuICAgIGxldmVsczogbGV2ZWxzLFxuICAgIGV4dHJhOiBleHRyYVxuICB9O1xufVxuZnVuY3Rpb24gaW5SYW5nZShlLCBzdGFydCwgZW5kLCBhY2Nlc3NvcnMsIGxvY2FsaXplcikge1xuICB2YXIgZXZlbnQgPSB7XG4gICAgc3RhcnQ6IGFjY2Vzc29ycy5zdGFydChlKSxcbiAgICBlbmQ6IGFjY2Vzc29ycy5lbmQoZSlcbiAgfTtcbiAgdmFyIHJhbmdlID0ge1xuICAgIHN0YXJ0OiBzdGFydCxcbiAgICBlbmQ6IGVuZFxuICB9O1xuICByZXR1cm4gbG9jYWxpemVyLmluRXZlbnRSYW5nZSh7XG4gICAgZXZlbnQ6IGV2ZW50LFxuICAgIHJhbmdlOiByYW5nZVxuICB9KTtcbn1cbmZ1bmN0aW9uIHNlZ3NPdmVybGFwKHNlZywgb3RoZXJTZWdzKSB7XG4gIHJldHVybiBvdGhlclNlZ3Muc29tZShmdW5jdGlvbiAob3RoZXJTZWcpIHtcbiAgICByZXR1cm4gb3RoZXJTZWcubGVmdCA8PSBzZWcucmlnaHQgJiYgb3RoZXJTZWcucmlnaHQgPj0gc2VnLmxlZnQ7XG4gIH0pO1xufVxuZnVuY3Rpb24gc29ydFdlZWtFdmVudHMoZXZlbnRzLCBhY2Nlc3NvcnMsIGxvY2FsaXplcikge1xuICB2YXIgYmFzZSA9IF90b0NvbnN1bWFibGVBcnJheShldmVudHMpO1xuICB2YXIgbXVsdGlEYXlFdmVudHMgPSBbXTtcbiAgdmFyIHN0YW5kYXJkRXZlbnRzID0gW107XG4gIGJhc2UuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgc3RhcnRDaGVjayA9IGFjY2Vzc29ycy5zdGFydChldmVudCk7XG4gICAgdmFyIGVuZENoZWNrID0gYWNjZXNzb3JzLmVuZChldmVudCk7XG4gICAgaWYgKGxvY2FsaXplci5kYXlTcGFuKHN0YXJ0Q2hlY2ssIGVuZENoZWNrKSA+IDEpIHtcbiAgICAgIG11bHRpRGF5RXZlbnRzLnB1c2goZXZlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFuZGFyZEV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICB9XG4gIH0pO1xuICB2YXIgbXVsdGlTb3J0ZWQgPSBtdWx0aURheUV2ZW50cy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuIHNvcnRFdmVudHMoYSwgYiwgYWNjZXNzb3JzLCBsb2NhbGl6ZXIpO1xuICB9KTtcbiAgdmFyIHN0YW5kYXJkU29ydGVkID0gc3RhbmRhcmRFdmVudHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBzb3J0RXZlbnRzKGEsIGIsIGFjY2Vzc29ycywgbG9jYWxpemVyKTtcbiAgfSk7XG4gIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG11bHRpU29ydGVkKSwgX3RvQ29uc3VtYWJsZUFycmF5KHN0YW5kYXJkU29ydGVkKSk7XG59XG5mdW5jdGlvbiBzb3J0RXZlbnRzKGV2ZW50QSwgZXZlbnRCLCBhY2Nlc3NvcnMsIGxvY2FsaXplcikge1xuICB2YXIgZXZ0QSA9IHtcbiAgICBzdGFydDogYWNjZXNzb3JzLnN0YXJ0KGV2ZW50QSksXG4gICAgZW5kOiBhY2Nlc3NvcnMuZW5kKGV2ZW50QSksXG4gICAgYWxsRGF5OiBhY2Nlc3NvcnMuYWxsRGF5KGV2ZW50QSlcbiAgfTtcbiAgdmFyIGV2dEIgPSB7XG4gICAgc3RhcnQ6IGFjY2Vzc29ycy5zdGFydChldmVudEIpLFxuICAgIGVuZDogYWNjZXNzb3JzLmVuZChldmVudEIpLFxuICAgIGFsbERheTogYWNjZXNzb3JzLmFsbERheShldmVudEIpXG4gIH07XG4gIHJldHVybiBsb2NhbGl6ZXIuc29ydEV2ZW50cyh7XG4gICAgZXZ0QTogZXZ0QSxcbiAgICBldnRCOiBldnRCXG4gIH0pO1xufVxuXG52YXIgaXNTZWdtZW50SW5TbG90JDEgPSBmdW5jdGlvbiBpc1NlZ21lbnRJblNsb3Qoc2VnLCBzbG90KSB7XG4gIHJldHVybiBzZWcubGVmdCA8PSBzbG90ICYmIHNlZy5yaWdodCA+PSBzbG90O1xufTtcbnZhciBldmVudHNJblNsb3QgPSBmdW5jdGlvbiBldmVudHNJblNsb3Qoc2VnbWVudHMsIHNsb3QpIHtcbiAgcmV0dXJuIHNlZ21lbnRzLmZpbHRlcihmdW5jdGlvbiAoc2VnKSB7XG4gICAgcmV0dXJuIGlzU2VnbWVudEluU2xvdCQxKHNlZywgc2xvdCk7XG4gIH0pLm1hcChmdW5jdGlvbiAoc2VnKSB7XG4gICAgcmV0dXJuIHNlZy5ldmVudDtcbiAgfSk7XG59O1xudmFyIEV2ZW50RW5kaW5nUm93ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIEV2ZW50RW5kaW5nUm93KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFdmVudEVuZGluZ1Jvdyk7XG4gICAgcmV0dXJuIF9jYWxsU3VwZXIodGhpcywgRXZlbnRFbmRpbmdSb3csIGFyZ3VtZW50cyk7XG4gIH1cbiAgX2luaGVyaXRzKEV2ZW50RW5kaW5nUm93LCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhFdmVudEVuZGluZ1JvdywgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsXG4gICAgICAgIHNlZ21lbnRzID0gX3RoaXMkcHJvcHMuc2VnbWVudHMsXG4gICAgICAgIHNsb3RzID0gX3RoaXMkcHJvcHMuc2xvdE1ldHJpY3Muc2xvdHM7XG4gICAgICB2YXIgcm93U2VnbWVudHMgPSBldmVudExldmVscyhzZWdtZW50cykubGV2ZWxzWzBdO1xuICAgICAgdmFyIGN1cnJlbnQgPSAxLFxuICAgICAgICBsYXN0RW5kID0gMSxcbiAgICAgICAgcm93ID0gW107XG4gICAgICB3aGlsZSAoY3VycmVudCA8PSBzbG90cykge1xuICAgICAgICB2YXIga2V5ID0gJ19sdmxfJyArIGN1cnJlbnQ7XG4gICAgICAgIHZhciBfcmVmID0gcm93U2VnbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChzZWcpIHtcbiAgICAgICAgICAgIHJldHVybiBpc1NlZ21lbnRJblNsb3QkMShzZWcsIGN1cnJlbnQpO1xuICAgICAgICAgIH0pWzBdIHx8IHt9LFxuICAgICAgICAgIGV2ZW50ID0gX3JlZi5ldmVudCxcbiAgICAgICAgICBsZWZ0ID0gX3JlZi5sZWZ0LFxuICAgICAgICAgIHJpZ2h0ID0gX3JlZi5yaWdodCxcbiAgICAgICAgICBzcGFuID0gX3JlZi5zcGFuOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcblxuICAgICAgICBpZiAoIWV2ZW50KSB7XG4gICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBnYXAgPSBNYXRoLm1heCgwLCBsZWZ0IC0gbGFzdEVuZCk7XG4gICAgICAgIGlmICh0aGlzLmNhblJlbmRlclNsb3RFdmVudChsZWZ0LCBzcGFuKSkge1xuICAgICAgICAgIHZhciBjb250ZW50ID0gRXZlbnRSb3dNaXhpbi5yZW5kZXJFdmVudCh0aGlzLnByb3BzLCBldmVudCk7XG4gICAgICAgICAgaWYgKGdhcCkge1xuICAgICAgICAgICAgcm93LnB1c2goRXZlbnRSb3dNaXhpbi5yZW5kZXJTcGFuKHNsb3RzLCBnYXAsIGtleSArICdfZ2FwJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByb3cucHVzaChFdmVudFJvd01peGluLnJlbmRlclNwYW4oc2xvdHMsIHNwYW4sIGtleSwgY29udGVudCkpO1xuICAgICAgICAgIGxhc3RFbmQgPSBjdXJyZW50ID0gcmlnaHQgKyAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChnYXApIHtcbiAgICAgICAgICAgIHJvdy5wdXNoKEV2ZW50Um93TWl4aW4ucmVuZGVyU3BhbihzbG90cywgZ2FwLCBrZXkgKyAnX2dhcCcpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcm93LnB1c2goRXZlbnRSb3dNaXhpbi5yZW5kZXJTcGFuKHNsb3RzLCAxLCBrZXksIHRoaXMucmVuZGVyU2hvd01vcmUoc2VnbWVudHMsIGN1cnJlbnQpKSk7XG4gICAgICAgICAgbGFzdEVuZCA9IGN1cnJlbnQgPSBjdXJyZW50ICsgMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1yb3dcIlxuICAgICAgfSwgcm93KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2FuUmVuZGVyU2xvdEV2ZW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNhblJlbmRlclNsb3RFdmVudChzbG90LCBzcGFuKSB7XG4gICAgICB2YXIgc2VnbWVudHMgPSB0aGlzLnByb3BzLnNlZ21lbnRzO1xuICAgICAgcmV0dXJuIHJhbmdlJDEoc2xvdCwgc2xvdCArIHNwYW4pLmV2ZXJ5KGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHZhciBjb3VudCA9IGV2ZW50c0luU2xvdChzZWdtZW50cywgcykubGVuZ3RoO1xuICAgICAgICByZXR1cm4gY291bnQgPT09IDE7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyU2hvd01vcmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyU2hvd01vcmUoc2VnbWVudHMsIHNsb3QpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMyID0gdGhpcy5wcm9wcyxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMyLmxvY2FsaXplcixcbiAgICAgICAgc2xvdE1ldHJpY3MgPSBfdGhpcyRwcm9wczIuc2xvdE1ldHJpY3M7XG4gICAgICB2YXIgZXZlbnRzID0gc2xvdE1ldHJpY3MuZ2V0RXZlbnRzRm9yU2xvdChzbG90KTtcbiAgICAgIHZhciByZW1haW5pbmdFdmVudHMgPSBldmVudHNJblNsb3Qoc2VnbWVudHMsIHNsb3QpO1xuICAgICAgdmFyIGNvdW50ID0gcmVtYWluaW5nRXZlbnRzLmxlbmd0aDtcbiAgICAgIHJldHVybiBjb3VudCA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHtcbiAgICAgICAgdHlwZTogXCJidXR0b25cIixcbiAgICAgICAga2V5OiAnc21fJyArIHNsb3QsXG4gICAgICAgIGNsYXNzTmFtZTogY2xzeCgncmJjLWJ1dHRvbi1saW5rJywgJ3JiYy1zaG93LW1vcmUnKSxcbiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLnNob3dNb3JlKHNsb3QsIGUpO1xuICAgICAgICB9XG4gICAgICB9LCBsb2NhbGl6ZXIubWVzc2FnZXMuc2hvd01vcmUoY291bnQsIHJlbWFpbmluZ0V2ZW50cywgZXZlbnRzKSkgOiBmYWxzZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2hvd01vcmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvd01vcmUoc2xvdCwgZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRoaXMucHJvcHMub25TaG93TW9yZShzbG90LCBlLnRhcmdldCk7XG4gICAgfVxuICB9XSk7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5FdmVudEVuZGluZ1Jvdy5kZWZhdWx0UHJvcHMgPSBfb2JqZWN0U3ByZWFkKHt9LCBFdmVudFJvd01peGluLmRlZmF1bHRQcm9wcyk7XG5cbnZhciBTY3JvbGxhYmxlV2Vla1dyYXBwZXIgPSBmdW5jdGlvbiBTY3JvbGxhYmxlV2Vla1dyYXBwZXIoX3JlZikge1xuICB2YXIgY2hpbGRyZW4gPSBfcmVmLmNoaWxkcmVuO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIGNsYXNzTmFtZTogXCJyYmMtcm93LWNvbnRlbnQtc2Nyb2xsLWNvbnRhaW5lclwiXG4gIH0sIGNoaWxkcmVuKTtcbn07XG5cbnZhciBpc1NlZ21lbnRJblNsb3QgPSBmdW5jdGlvbiBpc1NlZ21lbnRJblNsb3Qoc2VnLCBzbG90KSB7XG4gIHJldHVybiBzZWcubGVmdCA8PSBzbG90ICYmIHNlZy5yaWdodCA+PSBzbG90O1xufTtcbnZhciBpc0VxdWFsID0gZnVuY3Rpb24gaXNFcXVhbChhLCBiKSB7XG4gIHJldHVybiBhWzBdLnJhbmdlID09PSBiWzBdLnJhbmdlICYmIGFbMF0uZXZlbnRzID09PSBiWzBdLmV2ZW50cztcbn07XG5mdW5jdGlvbiBnZXRTbG90TWV0cmljcyQxKCkge1xuICByZXR1cm4gbWVtb2l6ZShmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIHZhciByYW5nZSA9IG9wdGlvbnMucmFuZ2UsXG4gICAgICBldmVudHMgPSBvcHRpb25zLmV2ZW50cyxcbiAgICAgIG1heFJvd3MgPSBvcHRpb25zLm1heFJvd3MsXG4gICAgICBtaW5Sb3dzID0gb3B0aW9ucy5taW5Sb3dzLFxuICAgICAgYWNjZXNzb3JzID0gb3B0aW9ucy5hY2Nlc3NvcnMsXG4gICAgICBsb2NhbGl6ZXIgPSBvcHRpb25zLmxvY2FsaXplcjtcbiAgICB2YXIgX2VuZE9mUmFuZ2UgPSBlbmRPZlJhbmdlKHtcbiAgICAgICAgZGF0ZVJhbmdlOiByYW5nZSxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXJcbiAgICAgIH0pLFxuICAgICAgZmlyc3QgPSBfZW5kT2ZSYW5nZS5maXJzdCxcbiAgICAgIGxhc3QgPSBfZW5kT2ZSYW5nZS5sYXN0O1xuICAgIHZhciBzZWdtZW50cyA9IGV2ZW50cy5tYXAoZnVuY3Rpb24gKGV2dCkge1xuICAgICAgcmV0dXJuIGV2ZW50U2VnbWVudHMoZXZ0LCByYW5nZSwgYWNjZXNzb3JzLCBsb2NhbGl6ZXIpO1xuICAgIH0pO1xuICAgIHZhciBfZXZlbnRMZXZlbHMgPSBldmVudExldmVscyhzZWdtZW50cywgTWF0aC5tYXgobWF4Um93cyAtIDEsIDEpKSxcbiAgICAgIGxldmVscyA9IF9ldmVudExldmVscy5sZXZlbHMsXG4gICAgICBleHRyYSA9IF9ldmVudExldmVscy5leHRyYTtcbiAgICAvLyBTdWJ0cmFjdCAxIGZyb20gbWluUm93cyB0byBub3QgaW5jbHVkZSBzaG93TW9yZSBidXR0b24gcm93IHdoZW5cbiAgICAvLyBpdCB3b3VsZCBiZSByZW5kZXJlZFxuICAgIHZhciBtaW5FdmVudFJvd3MgPSBleHRyYS5sZW5ndGggPiAwID8gbWluUm93cyAtIDEgOiBtaW5Sb3dzO1xuICAgIHdoaWxlIChsZXZlbHMubGVuZ3RoIDwgbWluRXZlbnRSb3dzKSBsZXZlbHMucHVzaChbXSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZpcnN0OiBmaXJzdCxcbiAgICAgIGxhc3Q6IGxhc3QsXG4gICAgICBsZXZlbHM6IGxldmVscyxcbiAgICAgIGV4dHJhOiBleHRyYSxcbiAgICAgIHJhbmdlOiByYW5nZSxcbiAgICAgIHNsb3RzOiByYW5nZS5sZW5ndGgsXG4gICAgICBjbG9uZTogZnVuY3Rpb24gY2xvbmUoYXJncykge1xuICAgICAgICB2YXIgbWV0cmljcyA9IGdldFNsb3RNZXRyaWNzJDEoKTtcbiAgICAgICAgcmV0dXJuIG1ldHJpY3MoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBvcHRpb25zKSwgYXJncykpO1xuICAgICAgfSxcbiAgICAgIGdldERhdGVGb3JTbG90OiBmdW5jdGlvbiBnZXREYXRlRm9yU2xvdChzbG90TnVtYmVyKSB7XG4gICAgICAgIHJldHVybiByYW5nZVtzbG90TnVtYmVyXTtcbiAgICAgIH0sXG4gICAgICBnZXRTbG90Rm9yRGF0ZTogZnVuY3Rpb24gZ2V0U2xvdEZvckRhdGUoZGF0ZSkge1xuICAgICAgICByZXR1cm4gcmFuZ2UuZmluZChmdW5jdGlvbiAocikge1xuICAgICAgICAgIHJldHVybiBsb2NhbGl6ZXIuaXNTYW1lRGF0ZShyLCBkYXRlKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZ2V0RXZlbnRzRm9yU2xvdDogZnVuY3Rpb24gZ2V0RXZlbnRzRm9yU2xvdChzbG90KSB7XG4gICAgICAgIHJldHVybiBzZWdtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHNlZykge1xuICAgICAgICAgIHJldHVybiBpc1NlZ21lbnRJblNsb3Qoc2VnLCBzbG90KTtcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChzZWcpIHtcbiAgICAgICAgICByZXR1cm4gc2VnLmV2ZW50O1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBjb250aW51ZXNQcmlvcjogZnVuY3Rpb24gY29udGludWVzUHJpb3IoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplci5jb250aW51ZXNQcmlvcihhY2Nlc3NvcnMuc3RhcnQoZXZlbnQpLCBmaXJzdCk7XG4gICAgICB9LFxuICAgICAgY29udGludWVzQWZ0ZXI6IGZ1bmN0aW9uIGNvbnRpbnVlc0FmdGVyKGV2ZW50KSB7XG4gICAgICAgIHZhciBzdGFydCA9IGFjY2Vzc29ycy5zdGFydChldmVudCk7XG4gICAgICAgIHZhciBlbmQgPSBhY2Nlc3NvcnMuZW5kKGV2ZW50KTtcbiAgICAgICAgcmV0dXJuIGxvY2FsaXplci5jb250aW51ZXNBZnRlcihzdGFydCwgZW5kLCBsYXN0KTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBpc0VxdWFsKTtcbn1cblxudmFyIERhdGVDb250ZW50Um93ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIERhdGVDb250ZW50Um93KCkge1xuICAgIHZhciBfdGhpcztcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0ZUNvbnRlbnRSb3cpO1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG4gICAgX3RoaXMgPSBfY2FsbFN1cGVyKHRoaXMsIERhdGVDb250ZW50Um93LCBbXS5jb25jYXQoYXJncykpO1xuICAgIF90aGlzLmhhbmRsZVNlbGVjdFNsb3QgPSBmdW5jdGlvbiAoc2xvdCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsXG4gICAgICAgIHJhbmdlID0gX3RoaXMkcHJvcHMucmFuZ2UsXG4gICAgICAgIG9uU2VsZWN0U2xvdCA9IF90aGlzJHByb3BzLm9uU2VsZWN0U2xvdDtcbiAgICAgIG9uU2VsZWN0U2xvdChyYW5nZS5zbGljZShzbG90LnN0YXJ0LCBzbG90LmVuZCArIDEpLCBzbG90KTtcbiAgICB9O1xuICAgIF90aGlzLmhhbmRsZVNob3dNb3JlID0gZnVuY3Rpb24gKHNsb3QsIHRhcmdldCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLFxuICAgICAgICByYW5nZSA9IF90aGlzJHByb3BzMi5yYW5nZSxcbiAgICAgICAgb25TaG93TW9yZSA9IF90aGlzJHByb3BzMi5vblNob3dNb3JlO1xuICAgICAgdmFyIG1ldHJpY3MgPSBfdGhpcy5zbG90TWV0cmljcyhfdGhpcy5wcm9wcyk7XG4gICAgICB2YXIgcm93ID0gcXNhKF90aGlzLmNvbnRhaW5lclJlZi5jdXJyZW50LCAnLnJiYy1yb3ctYmcnKVswXTtcbiAgICAgIHZhciBjZWxsO1xuICAgICAgaWYgKHJvdykgY2VsbCA9IHJvdy5jaGlsZHJlbltzbG90IC0gMV07XG4gICAgICB2YXIgZXZlbnRzID0gbWV0cmljcy5nZXRFdmVudHNGb3JTbG90KHNsb3QpO1xuICAgICAgb25TaG93TW9yZShldmVudHMsIHJhbmdlW3Nsb3QgLSAxXSwgY2VsbCwgc2xvdCwgdGFyZ2V0KTtcbiAgICB9O1xuICAgIF90aGlzLmdldENvbnRhaW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjb250YWluZXIgPSBfdGhpcy5wcm9wcy5jb250YWluZXI7XG4gICAgICByZXR1cm4gY29udGFpbmVyID8gY29udGFpbmVyKCkgOiBfdGhpcy5jb250YWluZXJSZWYuY3VycmVudDtcbiAgICB9O1xuICAgIF90aGlzLnJlbmRlckhlYWRpbmdDZWxsID0gZnVuY3Rpb24gKGRhdGUsIGluZGV4KSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMzID0gX3RoaXMucHJvcHMsXG4gICAgICAgIHJlbmRlckhlYWRlciA9IF90aGlzJHByb3BzMy5yZW5kZXJIZWFkZXIsXG4gICAgICAgIGdldE5vdyA9IF90aGlzJHByb3BzMy5nZXROb3csXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzMy5sb2NhbGl6ZXI7XG4gICAgICByZXR1cm4gcmVuZGVySGVhZGVyKHtcbiAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAga2V5OiBcImhlYWRlcl9cIi5jb25jYXQoaW5kZXgpLFxuICAgICAgICBjbGFzc05hbWU6IGNsc3goJ3JiYy1kYXRlLWNlbGwnLCBsb2NhbGl6ZXIuaXNTYW1lRGF0ZShkYXRlLCBnZXROb3coKSkgJiYgJ3JiYy1ub3cnKVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBfdGhpcy5yZW5kZXJEdW1teSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczQgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgY2xhc3NOYW1lID0gX3RoaXMkcHJvcHM0LmNsYXNzTmFtZSxcbiAgICAgICAgcmFuZ2UgPSBfdGhpcyRwcm9wczQucmFuZ2UsXG4gICAgICAgIHJlbmRlckhlYWRlciA9IF90aGlzJHByb3BzNC5yZW5kZXJIZWFkZXIsXG4gICAgICAgIHNob3dBbGxFdmVudHMgPSBfdGhpcyRwcm9wczQuc2hvd0FsbEV2ZW50cztcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lLFxuICAgICAgICByZWY6IF90aGlzLmNvbnRhaW5lclJlZlxuICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IGNsc3goJ3JiYy1yb3ctY29udGVudCcsIHNob3dBbGxFdmVudHMgJiYgJ3JiYy1yb3ctY29udGVudC1zY3JvbGxhYmxlJylcbiAgICAgIH0sIHJlbmRlckhlYWRlciAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtcm93XCIsXG4gICAgICAgIHJlZjogX3RoaXMuaGVhZGluZ1Jvd1JlZlxuICAgICAgfSwgcmFuZ2UubWFwKF90aGlzLnJlbmRlckhlYWRpbmdDZWxsKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1yb3dcIixcbiAgICAgICAgcmVmOiBfdGhpcy5ldmVudFJvd1JlZlxuICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXJvdy1zZWdtZW50XCJcbiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1ldmVudFwiXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtZXZlbnQtY29udGVudFwiXG4gICAgICB9LCBcIlxceEEwXCIpKSkpKSk7XG4gICAgfTtcbiAgICBfdGhpcy5jb250YWluZXJSZWYgPSAvKiNfX1BVUkVfXyovY3JlYXRlUmVmKCk7XG4gICAgX3RoaXMuaGVhZGluZ1Jvd1JlZiA9IC8qI19fUFVSRV9fKi9jcmVhdGVSZWYoKTtcbiAgICBfdGhpcy5ldmVudFJvd1JlZiA9IC8qI19fUFVSRV9fKi9jcmVhdGVSZWYoKTtcbiAgICBfdGhpcy5zbG90TWV0cmljcyA9IGdldFNsb3RNZXRyaWNzJDEoKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cbiAgX2luaGVyaXRzKERhdGVDb250ZW50Um93LCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhEYXRlQ29udGVudFJvdywgW3tcbiAgICBrZXk6IFwiZ2V0Um93TGltaXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Um93TGltaXQoKSB7XG4gICAgICB2YXIgX3RoaXMkaGVhZGluZ1Jvd1JlZjtcbiAgICAgIC8qIEd1ZXNzaW5nIHRoaXMgb25seSBnZXRzIGNhbGxlZCBvbiB0aGUgZHVtbXlSb3cgKi9cbiAgICAgIHZhciBldmVudEhlaWdodCA9IGdldEhlaWdodCh0aGlzLmV2ZW50Um93UmVmLmN1cnJlbnQpO1xuICAgICAgdmFyIGhlYWRpbmdIZWlnaHQgPSAoX3RoaXMkaGVhZGluZ1Jvd1JlZiA9IHRoaXMuaGVhZGluZ1Jvd1JlZikgIT09IG51bGwgJiYgX3RoaXMkaGVhZGluZ1Jvd1JlZiAhPT0gdm9pZCAwICYmIF90aGlzJGhlYWRpbmdSb3dSZWYuY3VycmVudCA/IGdldEhlaWdodCh0aGlzLmhlYWRpbmdSb3dSZWYuY3VycmVudCkgOiAwO1xuICAgICAgdmFyIGV2ZW50U3BhY2UgPSBnZXRIZWlnaHQodGhpcy5jb250YWluZXJSZWYuY3VycmVudCkgLSBoZWFkaW5nSGVpZ2h0O1xuICAgICAgcmV0dXJuIE1hdGgubWF4KE1hdGguZmxvb3IoZXZlbnRTcGFjZSAvIGV2ZW50SGVpZ2h0KSwgMSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHM1ID0gdGhpcy5wcm9wcyxcbiAgICAgICAgZGF0ZSA9IF90aGlzJHByb3BzNS5kYXRlLFxuICAgICAgICBydGwgPSBfdGhpcyRwcm9wczUucnRsLFxuICAgICAgICByYW5nZSA9IF90aGlzJHByb3BzNS5yYW5nZSxcbiAgICAgICAgY2xhc3NOYW1lID0gX3RoaXMkcHJvcHM1LmNsYXNzTmFtZSxcbiAgICAgICAgc2VsZWN0ZWQgPSBfdGhpcyRwcm9wczUuc2VsZWN0ZWQsXG4gICAgICAgIHNlbGVjdGFibGUgPSBfdGhpcyRwcm9wczUuc2VsZWN0YWJsZSxcbiAgICAgICAgcmVuZGVyRm9yTWVhc3VyZSA9IF90aGlzJHByb3BzNS5yZW5kZXJGb3JNZWFzdXJlLFxuICAgICAgICBhY2Nlc3NvcnMgPSBfdGhpcyRwcm9wczUuYWNjZXNzb3JzLFxuICAgICAgICBnZXR0ZXJzID0gX3RoaXMkcHJvcHM1LmdldHRlcnMsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wczUuY29tcG9uZW50cyxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHM1LmdldE5vdyxcbiAgICAgICAgcmVuZGVySGVhZGVyID0gX3RoaXMkcHJvcHM1LnJlbmRlckhlYWRlcixcbiAgICAgICAgb25TZWxlY3QgPSBfdGhpcyRwcm9wczUub25TZWxlY3QsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzNS5sb2NhbGl6ZXIsXG4gICAgICAgIG9uU2VsZWN0U3RhcnQgPSBfdGhpcyRwcm9wczUub25TZWxlY3RTdGFydCxcbiAgICAgICAgb25TZWxlY3RFbmQgPSBfdGhpcyRwcm9wczUub25TZWxlY3RFbmQsXG4gICAgICAgIG9uRG91YmxlQ2xpY2sgPSBfdGhpcyRwcm9wczUub25Eb3VibGVDbGljayxcbiAgICAgICAgb25LZXlQcmVzcyA9IF90aGlzJHByb3BzNS5vbktleVByZXNzLFxuICAgICAgICByZXNvdXJjZUlkID0gX3RoaXMkcHJvcHM1LnJlc291cmNlSWQsXG4gICAgICAgIGxvbmdQcmVzc1RocmVzaG9sZCA9IF90aGlzJHByb3BzNS5sb25nUHJlc3NUaHJlc2hvbGQsXG4gICAgICAgIGlzQWxsRGF5ID0gX3RoaXMkcHJvcHM1LmlzQWxsRGF5LFxuICAgICAgICByZXNpemFibGUgPSBfdGhpcyRwcm9wczUucmVzaXphYmxlLFxuICAgICAgICBzaG93QWxsRXZlbnRzID0gX3RoaXMkcHJvcHM1LnNob3dBbGxFdmVudHM7XG4gICAgICBpZiAocmVuZGVyRm9yTWVhc3VyZSkgcmV0dXJuIHRoaXMucmVuZGVyRHVtbXkoKTtcbiAgICAgIHZhciBtZXRyaWNzID0gdGhpcy5zbG90TWV0cmljcyh0aGlzLnByb3BzKTtcbiAgICAgIHZhciBsZXZlbHMgPSBtZXRyaWNzLmxldmVscyxcbiAgICAgICAgZXh0cmEgPSBtZXRyaWNzLmV4dHJhO1xuICAgICAgdmFyIFNjcm9sbGFibGVXZWVrQ29tcG9uZW50ID0gc2hvd0FsbEV2ZW50cyA/IFNjcm9sbGFibGVXZWVrV3JhcHBlciA6IE5vb3BXcmFwcGVyO1xuICAgICAgdmFyIFdlZWtXcmFwcGVyID0gY29tcG9uZW50cy53ZWVrV3JhcHBlcjtcbiAgICAgIHZhciBldmVudFJvd1Byb3BzID0ge1xuICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWQsXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgb25TZWxlY3Q6IG9uU2VsZWN0LFxuICAgICAgICBvbkRvdWJsZUNsaWNrOiBvbkRvdWJsZUNsaWNrLFxuICAgICAgICBvbktleVByZXNzOiBvbktleVByZXNzLFxuICAgICAgICByZXNvdXJjZUlkOiByZXNvdXJjZUlkLFxuICAgICAgICBzbG90TWV0cmljczogbWV0cmljcyxcbiAgICAgICAgcmVzaXphYmxlOiByZXNpemFibGVcbiAgICAgIH07XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IGNsYXNzTmFtZSxcbiAgICAgICAgcm9sZTogXCJyb3dncm91cFwiLFxuICAgICAgICByZWY6IHRoaXMuY29udGFpbmVyUmVmXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChCYWNrZ3JvdW5kQ2VsbHMsIHtcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIGRhdGU6IGRhdGUsXG4gICAgICAgIGdldE5vdzogZ2V0Tm93LFxuICAgICAgICBydGw6IHJ0bCxcbiAgICAgICAgcmFuZ2U6IHJhbmdlLFxuICAgICAgICBzZWxlY3RhYmxlOiBzZWxlY3RhYmxlLFxuICAgICAgICBjb250YWluZXI6IHRoaXMuZ2V0Q29udGFpbmVyLFxuICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICBvblNlbGVjdFN0YXJ0OiBvblNlbGVjdFN0YXJ0LFxuICAgICAgICBvblNlbGVjdEVuZDogb25TZWxlY3RFbmQsXG4gICAgICAgIG9uU2VsZWN0U2xvdDogdGhpcy5oYW5kbGVTZWxlY3RTbG90LFxuICAgICAgICBjb21wb25lbnRzOiBjb21wb25lbnRzLFxuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQ6IGxvbmdQcmVzc1RocmVzaG9sZCxcbiAgICAgICAgcmVzb3VyY2VJZDogcmVzb3VyY2VJZFxuICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbHN4KCdyYmMtcm93LWNvbnRlbnQnLCBzaG93QWxsRXZlbnRzICYmICdyYmMtcm93LWNvbnRlbnQtc2Nyb2xsYWJsZScpLFxuICAgICAgICByb2xlOiBcInJvd1wiXG4gICAgICB9LCByZW5kZXJIZWFkZXIgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXJvdyBcIixcbiAgICAgICAgcmVmOiB0aGlzLmhlYWRpbmdSb3dSZWZcbiAgICAgIH0sIHJhbmdlLm1hcCh0aGlzLnJlbmRlckhlYWRpbmdDZWxsKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFNjcm9sbGFibGVXZWVrQ29tcG9uZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChXZWVrV3JhcHBlciwgT2JqZWN0LmFzc2lnbih7XG4gICAgICAgIGlzQWxsRGF5OiBpc0FsbERheVxuICAgICAgfSwgZXZlbnRSb3dQcm9wcywge1xuICAgICAgICBydGw6IHRoaXMucHJvcHMucnRsXG4gICAgICB9KSwgbGV2ZWxzLm1hcChmdW5jdGlvbiAoc2VncywgaWR4KSB7XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFdmVudFJvdywgT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAga2V5OiBpZHgsXG4gICAgICAgICAgc2VnbWVudHM6IHNlZ3NcbiAgICAgICAgfSwgZXZlbnRSb3dQcm9wcykpO1xuICAgICAgfSksICEhZXh0cmEubGVuZ3RoICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50RW5kaW5nUm93LCBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgc2VnbWVudHM6IGV4dHJhLFxuICAgICAgICBvblNob3dNb3JlOiB0aGlzLmhhbmRsZVNob3dNb3JlXG4gICAgICB9LCBldmVudFJvd1Byb3BzKSkpKSkpO1xuICAgIH1cbiAgfV0pO1xufShSZWFjdC5Db21wb25lbnQpO1xuRGF0ZUNvbnRlbnRSb3cuZGVmYXVsdFByb3BzID0ge1xuICBtaW5Sb3dzOiAwLFxuICBtYXhSb3dzOiBJbmZpbml0eVxufTtcblxudmFyIEhlYWRlciA9IGZ1bmN0aW9uIEhlYWRlcihfcmVmKSB7XG4gIHZhciBsYWJlbCA9IF9yZWYubGFiZWw7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgIHJvbGU6IFwiY29sdW1uaGVhZGVyXCIsXG4gICAgXCJhcmlhLXNvcnRcIjogXCJub25lXCJcbiAgfSwgbGFiZWwpO1xufTtcblxudmFyIERhdGVIZWFkZXIgPSBmdW5jdGlvbiBEYXRlSGVhZGVyKF9yZWYpIHtcbiAgdmFyIGxhYmVsID0gX3JlZi5sYWJlbCxcbiAgICBkcmlsbGRvd25WaWV3ID0gX3JlZi5kcmlsbGRvd25WaWV3LFxuICAgIG9uRHJpbGxEb3duID0gX3JlZi5vbkRyaWxsRG93bjtcbiAgaWYgKCFkcmlsbGRvd25WaWV3KSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCBudWxsLCBsYWJlbCk7XG4gIH1cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHtcbiAgICB0eXBlOiBcImJ1dHRvblwiLFxuICAgIGNsYXNzTmFtZTogXCJyYmMtYnV0dG9uLWxpbmtcIixcbiAgICBvbkNsaWNrOiBvbkRyaWxsRG93bixcbiAgICByb2xlOiBcImNlbGxcIlxuICB9LCBsYWJlbCk7XG59O1xuXG52YXIgX2V4Y2x1ZGVkJDYgPSBbXCJkYXRlXCIsIFwiY2xhc3NOYW1lXCJdO1xudmFyIGV2ZW50c0ZvcldlZWsgPSBmdW5jdGlvbiBldmVudHNGb3JXZWVrKGV2dHMsIHN0YXJ0LCBlbmQsIGFjY2Vzc29ycywgbG9jYWxpemVyKSB7XG4gIHJldHVybiBldnRzLmZpbHRlcihmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBpblJhbmdlKGUsIHN0YXJ0LCBlbmQsIGFjY2Vzc29ycywgbG9jYWxpemVyKTtcbiAgfSk7XG59O1xudmFyIE1vbnRoVmlldyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBmdW5jdGlvbiBNb250aFZpZXcoKSB7XG4gICAgdmFyIF90aGlzO1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNb250aFZpZXcpO1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBfYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIF9hcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cbiAgICBfdGhpcyA9IF9jYWxsU3VwZXIodGhpcywgTW9udGhWaWV3LCBbXS5jb25jYXQoX2FyZ3MpKTtcbiAgICBfdGhpcy5nZXRDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuY29udGFpbmVyUmVmLmN1cnJlbnQ7XG4gICAgfTtcbiAgICBfdGhpcy5yZW5kZXJXZWVrID0gZnVuY3Rpb24gKHdlZWssIHdlZWtJZHgpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLFxuICAgICAgICBldmVudHMgPSBfdGhpcyRwcm9wcy5ldmVudHMsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wcy5jb21wb25lbnRzLFxuICAgICAgICBzZWxlY3RhYmxlID0gX3RoaXMkcHJvcHMuc2VsZWN0YWJsZSxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHMuZ2V0Tm93LFxuICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzLnNlbGVjdGVkLFxuICAgICAgICBkYXRlID0gX3RoaXMkcHJvcHMuZGF0ZSxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMubG9jYWxpemVyLFxuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQgPSBfdGhpcyRwcm9wcy5sb25nUHJlc3NUaHJlc2hvbGQsXG4gICAgICAgIGFjY2Vzc29ycyA9IF90aGlzJHByb3BzLmFjY2Vzc29ycyxcbiAgICAgICAgZ2V0dGVycyA9IF90aGlzJHByb3BzLmdldHRlcnMsXG4gICAgICAgIHNob3dBbGxFdmVudHMgPSBfdGhpcyRwcm9wcy5zaG93QWxsRXZlbnRzO1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsXG4gICAgICAgIG5lZWRMaW1pdE1lYXN1cmUgPSBfdGhpcyRzdGF0ZS5uZWVkTGltaXRNZWFzdXJlLFxuICAgICAgICByb3dMaW1pdCA9IF90aGlzJHN0YXRlLnJvd0xpbWl0O1xuXG4gICAgICAvLyBsZXQncyBub3QgbXV0YXRlIHByb3BzXG4gICAgICB2YXIgd2Vla3NFdmVudHMgPSBldmVudHNGb3JXZWVrKF90b0NvbnN1bWFibGVBcnJheShldmVudHMpLCB3ZWVrWzBdLCB3ZWVrW3dlZWsubGVuZ3RoIC0gMV0sIGFjY2Vzc29ycywgbG9jYWxpemVyKTtcbiAgICAgIHZhciBzb3J0ZWQgPSBzb3J0V2Vla0V2ZW50cyh3ZWVrc0V2ZW50cywgYWNjZXNzb3JzLCBsb2NhbGl6ZXIpO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KERhdGVDb250ZW50Um93LCB7XG4gICAgICAgIGtleTogd2Vla0lkeCxcbiAgICAgICAgcmVmOiB3ZWVrSWR4ID09PSAwID8gX3RoaXMuc2xvdFJvd1JlZiA6IHVuZGVmaW5lZCxcbiAgICAgICAgY29udGFpbmVyOiBfdGhpcy5nZXRDb250YWluZXIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtbW9udGgtcm93XCIsXG4gICAgICAgIGdldE5vdzogZ2V0Tm93LFxuICAgICAgICBkYXRlOiBkYXRlLFxuICAgICAgICByYW5nZTogd2VlayxcbiAgICAgICAgZXZlbnRzOiBzb3J0ZWQsXG4gICAgICAgIG1heFJvd3M6IHNob3dBbGxFdmVudHMgPyBJbmZpbml0eSA6IHJvd0xpbWl0LFxuICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWQsXG4gICAgICAgIHNlbGVjdGFibGU6IHNlbGVjdGFibGUsXG4gICAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudHMsXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgcmVuZGVySGVhZGVyOiBfdGhpcy5yZWFkZXJEYXRlSGVhZGluZyxcbiAgICAgICAgcmVuZGVyRm9yTWVhc3VyZTogbmVlZExpbWl0TWVhc3VyZSxcbiAgICAgICAgb25TaG93TW9yZTogX3RoaXMuaGFuZGxlU2hvd01vcmUsXG4gICAgICAgIG9uU2VsZWN0OiBfdGhpcy5oYW5kbGVTZWxlY3RFdmVudCxcbiAgICAgICAgb25Eb3VibGVDbGljazogX3RoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCxcbiAgICAgICAgb25LZXlQcmVzczogX3RoaXMuaGFuZGxlS2V5UHJlc3NFdmVudCxcbiAgICAgICAgb25TZWxlY3RTbG90OiBfdGhpcy5oYW5kbGVTZWxlY3RTbG90LFxuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQ6IGxvbmdQcmVzc1RocmVzaG9sZCxcbiAgICAgICAgcnRsOiBfdGhpcy5wcm9wcy5ydGwsXG4gICAgICAgIHJlc2l6YWJsZTogX3RoaXMucHJvcHMucmVzaXphYmxlLFxuICAgICAgICBzaG93QWxsRXZlbnRzOiBzaG93QWxsRXZlbnRzXG4gICAgICB9KTtcbiAgICB9O1xuICAgIF90aGlzLnJlYWRlckRhdGVIZWFkaW5nID0gZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgIHZhciBkYXRlID0gX3JlZi5kYXRlLFxuICAgICAgICBjbGFzc05hbWUgPSBfcmVmLmNsYXNzTmFtZSxcbiAgICAgICAgcHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZiwgX2V4Y2x1ZGVkJDYpO1xuICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLFxuICAgICAgICBjdXJyZW50RGF0ZSA9IF90aGlzJHByb3BzMi5kYXRlLFxuICAgICAgICBnZXREcmlsbGRvd25WaWV3ID0gX3RoaXMkcHJvcHMyLmdldERyaWxsZG93blZpZXcsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzMi5sb2NhbGl6ZXI7XG4gICAgICB2YXIgaXNPZmZSYW5nZSA9IGxvY2FsaXplci5uZXEoZGF0ZSwgY3VycmVudERhdGUsICdtb250aCcpO1xuICAgICAgdmFyIGlzQ3VycmVudCA9IGxvY2FsaXplci5pc1NhbWVEYXRlKGRhdGUsIGN1cnJlbnREYXRlKTtcbiAgICAgIHZhciBkcmlsbGRvd25WaWV3ID0gZ2V0RHJpbGxkb3duVmlldyhkYXRlKTtcbiAgICAgIHZhciBsYWJlbCA9IGxvY2FsaXplci5mb3JtYXQoZGF0ZSwgJ2RhdGVGb3JtYXQnKTtcbiAgICAgIHZhciBEYXRlSGVhZGVyQ29tcG9uZW50ID0gX3RoaXMucHJvcHMuY29tcG9uZW50cy5kYXRlSGVhZGVyIHx8IERhdGVIZWFkZXI7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbHN4KGNsYXNzTmFtZSwgaXNPZmZSYW5nZSAmJiAncmJjLW9mZi1yYW5nZScsIGlzQ3VycmVudCAmJiAncmJjLWN1cnJlbnQnKSxcbiAgICAgICAgcm9sZTogXCJjZWxsXCJcbiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChEYXRlSGVhZGVyQ29tcG9uZW50LCB7XG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgZHJpbGxkb3duVmlldzogZHJpbGxkb3duVmlldyxcbiAgICAgICAgaXNPZmZSYW5nZTogaXNPZmZSYW5nZSxcbiAgICAgICAgb25EcmlsbERvd246IGZ1bmN0aW9uIG9uRHJpbGxEb3duKGUpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlSGVhZGluZ0NsaWNrKGRhdGUsIGRyaWxsZG93blZpZXcsIGUpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVTZWxlY3RTbG90ID0gZnVuY3Rpb24gKHJhbmdlLCBzbG90SW5mbykge1xuICAgICAgX3RoaXMuX3BlbmRpbmdTZWxlY3Rpb24gPSBfdGhpcy5fcGVuZGluZ1NlbGVjdGlvbi5jb25jYXQocmFuZ2UpO1xuICAgICAgY2xlYXJUaW1lb3V0KF90aGlzLl9zZWxlY3RUaW1lcik7XG4gICAgICBfdGhpcy5fc2VsZWN0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLnNlbGVjdERhdGVzKHNsb3RJbmZvKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlSGVhZGluZ0NsaWNrID0gZnVuY3Rpb24gKGRhdGUsIHZpZXcsIGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBub3RpZnkoX3RoaXMucHJvcHMub25EcmlsbERvd24sIFtkYXRlLCB2aWV3XSk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVTZWxlY3RFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgYXJnc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uU2VsZWN0RXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uRG91YmxlQ2xpY2tFdmVudCwgYXJncyk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVLZXlQcmVzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgIGZvciAodmFyIF9sZW40ID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuNCksIF9rZXk0ID0gMDsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykge1xuICAgICAgICBhcmdzW19rZXk0XSA9IGFyZ3VtZW50c1tfa2V5NF07XG4gICAgICB9XG4gICAgICBub3RpZnkoX3RoaXMucHJvcHMub25LZXlQcmVzc0V2ZW50LCBhcmdzKTtcbiAgICB9O1xuICAgIF90aGlzLmhhbmRsZVNob3dNb3JlID0gZnVuY3Rpb24gKGV2ZW50cywgZGF0ZSwgY2VsbCwgc2xvdCwgdGFyZ2V0KSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMzID0gX3RoaXMucHJvcHMsXG4gICAgICAgIHBvcHVwID0gX3RoaXMkcHJvcHMzLnBvcHVwLFxuICAgICAgICBvbkRyaWxsRG93biA9IF90aGlzJHByb3BzMy5vbkRyaWxsRG93bixcbiAgICAgICAgb25TaG93TW9yZSA9IF90aGlzJHByb3BzMy5vblNob3dNb3JlLFxuICAgICAgICBnZXREcmlsbGRvd25WaWV3ID0gX3RoaXMkcHJvcHMzLmdldERyaWxsZG93blZpZXcsXG4gICAgICAgIGRvU2hvd01vcmVEcmlsbERvd24gPSBfdGhpcyRwcm9wczMuZG9TaG93TW9yZURyaWxsRG93bjtcbiAgICAgIC8vY2FuY2VsIGFueSBwZW5kaW5nIHNlbGVjdGlvbnMgc28gb25seSB0aGUgZXZlbnQgY2xpY2sgZ29lcyB0aHJvdWdoLlxuICAgICAgX3RoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgIGlmIChwb3B1cCkge1xuICAgICAgICB2YXIgcG9zaXRpb24gPSBnZXRQb3NpdGlvbiQxKGNlbGwsIF90aGlzLmNvbnRhaW5lclJlZi5jdXJyZW50KTtcbiAgICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIG92ZXJsYXk6IHtcbiAgICAgICAgICAgIGRhdGU6IGRhdGUsXG4gICAgICAgICAgICBldmVudHM6IGV2ZW50cyxcbiAgICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoZG9TaG93TW9yZURyaWxsRG93bikge1xuICAgICAgICBub3RpZnkob25EcmlsbERvd24sIFtkYXRlLCBnZXREcmlsbGRvd25WaWV3KGRhdGUpIHx8IHZpZXdzLkRBWV0pO1xuICAgICAgfVxuICAgICAgbm90aWZ5KG9uU2hvd01vcmUsIFtldmVudHMsIGRhdGUsIHNsb3RdKTtcbiAgICB9O1xuICAgIF90aGlzLm92ZXJsYXlEaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICBvdmVybGF5OiBudWxsXG4gICAgICB9KTtcbiAgICB9O1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgcm93TGltaXQ6IDUsXG4gICAgICBuZWVkTGltaXRNZWFzdXJlOiB0cnVlLFxuICAgICAgZGF0ZTogbnVsbFxuICAgIH07XG4gICAgX3RoaXMuY29udGFpbmVyUmVmID0gLyojX19QVVJFX18qL2NyZWF0ZVJlZigpO1xuICAgIF90aGlzLnNsb3RSb3dSZWYgPSAvKiNfX1BVUkVfXyovY3JlYXRlUmVmKCk7XG4gICAgX3RoaXMuX2JnUm93cyA9IFtdO1xuICAgIF90aGlzLl9wZW5kaW5nU2VsZWN0aW9uID0gW107XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIF9pbmhlcml0cyhNb250aFZpZXcsIF9SZWFjdCRDb21wb25lbnQpO1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKE1vbnRoVmlldywgW3tcbiAgICBrZXk6IFwiY29tcG9uZW50RGlkTW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcbiAgICAgIHZhciBydW5uaW5nO1xuICAgICAgaWYgKHRoaXMuc3RhdGUubmVlZExpbWl0TWVhc3VyZSkgdGhpcy5tZWFzdXJlUm93TGltaXQodGhpcy5wcm9wcyk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5fcmVzaXplTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghcnVubmluZykge1xuICAgICAgICAgIGFuaW1hdGlvbkZyYW1lLnJlcXVlc3QoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgbmVlZExpbWl0TWVhc3VyZTogdHJ1ZVxuICAgICAgICAgICAgfSk7IC8vZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBmYWxzZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbXBvbmVudERpZFVwZGF0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5uZWVkTGltaXRNZWFzdXJlKSB0aGlzLm1lYXN1cmVSb3dMaW1pdCh0aGlzLnByb3BzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50V2lsbFVubW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5fcmVzaXplTGlzdGVuZXIsIGZhbHNlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczQgPSB0aGlzLnByb3BzLFxuICAgICAgICBkYXRlID0gX3RoaXMkcHJvcHM0LmRhdGUsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzNC5sb2NhbGl6ZXIsXG4gICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzNC5jbGFzc05hbWUsXG4gICAgICAgIG1vbnRoID0gbG9jYWxpemVyLnZpc2libGVEYXlzKGRhdGUsIGxvY2FsaXplciksXG4gICAgICAgIHdlZWtzID0gY2h1bmsobW9udGgsIDcpO1xuICAgICAgdGhpcy5fd2Vla0NvdW50ID0gd2Vla3MubGVuZ3RoO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbHN4KCdyYmMtbW9udGgtdmlldycsIGNsYXNzTmFtZSksXG4gICAgICAgIHJvbGU6IFwidGFibGVcIixcbiAgICAgICAgXCJhcmlhLWxhYmVsXCI6IFwiTW9udGggVmlld1wiLFxuICAgICAgICByZWY6IHRoaXMuY29udGFpbmVyUmVmXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtcm93IHJiYy1tb250aC1oZWFkZXJcIixcbiAgICAgICAgcm9sZTogXCJyb3dcIlxuICAgICAgfSwgdGhpcy5yZW5kZXJIZWFkZXJzKHdlZWtzWzBdKSksIHdlZWtzLm1hcCh0aGlzLnJlbmRlcldlZWspLCB0aGlzLnByb3BzLnBvcHVwICYmIHRoaXMucmVuZGVyT3ZlcmxheSgpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVySGVhZGVyc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJIZWFkZXJzKHJvdykge1xuICAgICAgdmFyIF90aGlzJHByb3BzNSA9IHRoaXMucHJvcHMsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzNS5sb2NhbGl6ZXIsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wczUuY29tcG9uZW50cztcbiAgICAgIHZhciBmaXJzdCA9IHJvd1swXTtcbiAgICAgIHZhciBsYXN0ID0gcm93W3Jvdy5sZW5ndGggLSAxXTtcbiAgICAgIHZhciBIZWFkZXJDb21wb25lbnQgPSBjb21wb25lbnRzLmhlYWRlciB8fCBIZWFkZXI7XG4gICAgICByZXR1cm4gbG9jYWxpemVyLnJhbmdlKGZpcnN0LCBsYXN0LCAnZGF5JykubWFwKGZ1bmN0aW9uIChkYXksIGlkeCkge1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICAgIGtleTogJ2hlYWRlcl8nICsgaWR4LFxuICAgICAgICAgIGNsYXNzTmFtZTogXCJyYmMtaGVhZGVyXCJcbiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoSGVhZGVyQ29tcG9uZW50LCB7XG4gICAgICAgICAgZGF0ZTogZGF5LFxuICAgICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgICAgIGxhYmVsOiBsb2NhbGl6ZXIuZm9ybWF0KGRheSwgJ3dlZWtkYXlGb3JtYXQnKVxuICAgICAgICB9KSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyT3ZlcmxheVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJPdmVybGF5KCkge1xuICAgICAgdmFyIF90aGlzJHN0YXRlJG92ZXJsYXksXG4gICAgICAgIF90aGlzJHN0YXRlMixcbiAgICAgICAgX3RoaXMzID0gdGhpcztcbiAgICAgIHZhciBvdmVybGF5ID0gKF90aGlzJHN0YXRlJG92ZXJsYXkgPSAoX3RoaXMkc3RhdGUyID0gdGhpcy5zdGF0ZSkgPT09IG51bGwgfHwgX3RoaXMkc3RhdGUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzdGF0ZTIub3ZlcmxheSkgIT09IG51bGwgJiYgX3RoaXMkc3RhdGUkb3ZlcmxheSAhPT0gdm9pZCAwID8gX3RoaXMkc3RhdGUkb3ZlcmxheSA6IHt9O1xuICAgICAgdmFyIF90aGlzJHByb3BzNiA9IHRoaXMucHJvcHMsXG4gICAgICAgIGFjY2Vzc29ycyA9IF90aGlzJHByb3BzNi5hY2Nlc3NvcnMsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzNi5sb2NhbGl6ZXIsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wczYuY29tcG9uZW50cyxcbiAgICAgICAgZ2V0dGVycyA9IF90aGlzJHByb3BzNi5nZXR0ZXJzLFxuICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzNi5zZWxlY3RlZCxcbiAgICAgICAgcG9wdXBPZmZzZXQgPSBfdGhpcyRwcm9wczYucG9wdXBPZmZzZXQsXG4gICAgICAgIGhhbmRsZURyYWdTdGFydCA9IF90aGlzJHByb3BzNi5oYW5kbGVEcmFnU3RhcnQ7XG4gICAgICB2YXIgb25IaWRlID0gZnVuY3Rpb24gb25IaWRlKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHtcbiAgICAgICAgICBvdmVybGF5OiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3BPdmVybGF5LCB7XG4gICAgICAgIG92ZXJsYXk6IG92ZXJsYXksXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgZ2V0dGVyczogZ2V0dGVycyxcbiAgICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgICAgICBwb3B1cE9mZnNldDogcG9wdXBPZmZzZXQsXG4gICAgICAgIHJlZjogdGhpcy5jb250YWluZXJSZWYsXG4gICAgICAgIGhhbmRsZUtleVByZXNzRXZlbnQ6IHRoaXMuaGFuZGxlS2V5UHJlc3NFdmVudCxcbiAgICAgICAgaGFuZGxlU2VsZWN0RXZlbnQ6IHRoaXMuaGFuZGxlU2VsZWN0RXZlbnQsXG4gICAgICAgIGhhbmRsZURvdWJsZUNsaWNrRXZlbnQ6IHRoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCxcbiAgICAgICAgaGFuZGxlRHJhZ1N0YXJ0OiBoYW5kbGVEcmFnU3RhcnQsXG4gICAgICAgIHNob3c6ICEhb3ZlcmxheS5wb3NpdGlvbixcbiAgICAgICAgb3ZlcmxheURpc3BsYXk6IHRoaXMub3ZlcmxheURpc3BsYXksXG4gICAgICAgIG9uSGlkZTogb25IaWRlXG4gICAgICB9KTtcblxuICAgICAgLyogcmV0dXJuIChcbiAgICAgICAgPE92ZXJsYXlcbiAgICAgICAgICByb290Q2xvc2VcbiAgICAgICAgICBwbGFjZW1lbnQ9XCJib3R0b21cIlxuICAgICAgICAgIHNob3c9eyEhb3ZlcmxheS5wb3NpdGlvbn1cbiAgICAgICAgICBvbkhpZGU9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBvdmVybGF5OiBudWxsIH0pfVxuICAgICAgICAgIHRhcmdldD17KCkgPT4gb3ZlcmxheS50YXJnZXR9XG4gICAgICAgID5cbiAgICAgICAgICB7KHsgcHJvcHMgfSkgPT4gKFxuICAgICAgICAgICAgPFBvcHVwXG4gICAgICAgICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgICAgICAgcG9wdXBPZmZzZXQ9e3BvcHVwT2Zmc2V0fVxuICAgICAgICAgICAgICBhY2Nlc3NvcnM9e2FjY2Vzc29yc31cbiAgICAgICAgICAgICAgZ2V0dGVycz17Z2V0dGVyc31cbiAgICAgICAgICAgICAgc2VsZWN0ZWQ9e3NlbGVjdGVkfVxuICAgICAgICAgICAgICBjb21wb25lbnRzPXtjb21wb25lbnRzfVxuICAgICAgICAgICAgICBsb2NhbGl6ZXI9e2xvY2FsaXplcn1cbiAgICAgICAgICAgICAgcG9zaXRpb249e292ZXJsYXkucG9zaXRpb259XG4gICAgICAgICAgICAgIHNob3c9e3RoaXMub3ZlcmxheURpc3BsYXl9XG4gICAgICAgICAgICAgIGV2ZW50cz17b3ZlcmxheS5ldmVudHN9XG4gICAgICAgICAgICAgIHNsb3RTdGFydD17b3ZlcmxheS5kYXRlfVxuICAgICAgICAgICAgICBzbG90RW5kPXtvdmVybGF5LmVuZH1cbiAgICAgICAgICAgICAgb25TZWxlY3Q9e3RoaXMuaGFuZGxlU2VsZWN0RXZlbnR9XG4gICAgICAgICAgICAgIG9uRG91YmxlQ2xpY2s9e3RoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudH1cbiAgICAgICAgICAgICAgb25LZXlQcmVzcz17dGhpcy5oYW5kbGVLZXlQcmVzc0V2ZW50fVxuICAgICAgICAgICAgICBoYW5kbGVEcmFnU3RhcnQ9e3RoaXMucHJvcHMuaGFuZGxlRHJhZ1N0YXJ0fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuICAgICAgICA8L092ZXJsYXk+XG4gICAgICApICovXG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm1lYXN1cmVSb3dMaW1pdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtZWFzdXJlUm93TGltaXQoKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgbmVlZExpbWl0TWVhc3VyZTogZmFsc2UsXG4gICAgICAgIHJvd0xpbWl0OiB0aGlzLnNsb3RSb3dSZWYuY3VycmVudC5nZXRSb3dMaW1pdCgpXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2VsZWN0RGF0ZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0RGF0ZXMoc2xvdEluZm8pIHtcbiAgICAgIHZhciBzbG90cyA9IHRoaXMuX3BlbmRpbmdTZWxlY3Rpb24uc2xpY2UoKTtcbiAgICAgIHRoaXMuX3BlbmRpbmdTZWxlY3Rpb24gPSBbXTtcbiAgICAgIHNsb3RzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuICthIC0gK2I7XG4gICAgICB9KTtcbiAgICAgIHZhciBzdGFydCA9IG5ldyBEYXRlKHNsb3RzWzBdKTtcbiAgICAgIHZhciBlbmQgPSBuZXcgRGF0ZShzbG90c1tzbG90cy5sZW5ndGggLSAxXSk7XG4gICAgICBlbmQuc2V0RGF0ZShzbG90c1tzbG90cy5sZW5ndGggLSAxXS5nZXREYXRlKCkgKyAxKTtcbiAgICAgIG5vdGlmeSh0aGlzLnByb3BzLm9uU2VsZWN0U2xvdCwge1xuICAgICAgICBzbG90czogc2xvdHMsXG4gICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgZW5kOiBlbmQsXG4gICAgICAgIGFjdGlvbjogc2xvdEluZm8uYWN0aW9uLFxuICAgICAgICBib3VuZHM6IHNsb3RJbmZvLmJvdW5kcyxcbiAgICAgICAgYm94OiBzbG90SW5mby5ib3hcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbGVhclNlbGVjdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhclNlbGVjdGlvbigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9zZWxlY3RUaW1lcik7XG4gICAgICB0aGlzLl9wZW5kaW5nU2VsZWN0aW9uID0gW107XG4gICAgfVxuICB9XSwgW3tcbiAgICBrZXk6IFwiZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhfcmVmMiwgc3RhdGUpIHtcbiAgICAgIHZhciBkYXRlID0gX3JlZjIuZGF0ZSxcbiAgICAgICAgbG9jYWxpemVyID0gX3JlZjIubG9jYWxpemVyO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgbmVlZExpbWl0TWVhc3VyZTogbG9jYWxpemVyLm5lcShkYXRlLCBzdGF0ZS5kYXRlLCAnbW9udGgnKVxuICAgICAgfTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcbk1vbnRoVmlldy5yYW5nZSA9IGZ1bmN0aW9uIChkYXRlLCBfcmVmMykge1xuICB2YXIgbG9jYWxpemVyID0gX3JlZjMubG9jYWxpemVyO1xuICB2YXIgc3RhcnQgPSBsb2NhbGl6ZXIuZmlyc3RWaXNpYmxlRGF5KGRhdGUsIGxvY2FsaXplcik7XG4gIHZhciBlbmQgPSBsb2NhbGl6ZXIubGFzdFZpc2libGVEYXkoZGF0ZSwgbG9jYWxpemVyKTtcbiAgcmV0dXJuIHtcbiAgICBzdGFydDogc3RhcnQsXG4gICAgZW5kOiBlbmRcbiAgfTtcbn07XG5Nb250aFZpZXcubmF2aWdhdGUgPSBmdW5jdGlvbiAoZGF0ZSwgYWN0aW9uLCBfcmVmNCkge1xuICB2YXIgbG9jYWxpemVyID0gX3JlZjQubG9jYWxpemVyO1xuICBzd2l0Y2ggKGFjdGlvbikge1xuICAgIGNhc2UgbmF2aWdhdGUuUFJFVklPVVM6XG4gICAgICByZXR1cm4gbG9jYWxpemVyLmFkZChkYXRlLCAtMSwgJ21vbnRoJyk7XG4gICAgY2FzZSBuYXZpZ2F0ZS5ORVhUOlxuICAgICAgcmV0dXJuIGxvY2FsaXplci5hZGQoZGF0ZSwgMSwgJ21vbnRoJyk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBkYXRlO1xuICB9XG59O1xuTW9udGhWaWV3LnRpdGxlID0gZnVuY3Rpb24gKGRhdGUsIF9yZWY1KSB7XG4gIHZhciBsb2NhbGl6ZXIgPSBfcmVmNS5sb2NhbGl6ZXI7XG4gIHJldHVybiBsb2NhbGl6ZXIuZm9ybWF0KGRhdGUsICdtb250aEhlYWRlckZvcm1hdCcpO1xufTtcblxudmFyIGdldEtleSA9IGZ1bmN0aW9uIGdldEtleShfcmVmKSB7XG4gIHZhciBtaW4gPSBfcmVmLm1pbixcbiAgICBtYXggPSBfcmVmLm1heCxcbiAgICBzdGVwID0gX3JlZi5zdGVwLFxuICAgIHNsb3RzID0gX3JlZi5zbG90cyxcbiAgICBsb2NhbGl6ZXIgPSBfcmVmLmxvY2FsaXplcjtcbiAgcmV0dXJuIFwiXCIuY29uY2F0KCtsb2NhbGl6ZXIuc3RhcnRPZihtaW4sICdtaW51dGVzJykpICsgXCJcIi5jb25jYXQoK2xvY2FsaXplci5zdGFydE9mKG1heCwgJ21pbnV0ZXMnKSkgKyBcIlwiLmNvbmNhdChzdGVwLCBcIi1cIikuY29uY2F0KHNsb3RzKTtcbn07XG5mdW5jdGlvbiBnZXRTbG90TWV0cmljcyhfcmVmMikge1xuICB2YXIgc3RhcnQgPSBfcmVmMi5taW4sXG4gICAgZW5kID0gX3JlZjIubWF4LFxuICAgIHN0ZXAgPSBfcmVmMi5zdGVwLFxuICAgIHRpbWVzbG90cyA9IF9yZWYyLnRpbWVzbG90cyxcbiAgICBsb2NhbGl6ZXIgPSBfcmVmMi5sb2NhbGl6ZXI7XG4gIHZhciBrZXkgPSBnZXRLZXkoe1xuICAgIHN0YXJ0OiBzdGFydCxcbiAgICBlbmQ6IGVuZCxcbiAgICBzdGVwOiBzdGVwLFxuICAgIHRpbWVzbG90czogdGltZXNsb3RzLFxuICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gIH0pO1xuXG4gIC8vIERTVCBkaWZmZXJlbmNlcyBhcmUgaGFuZGxlZCBpbnNpZGUgdGhlIGxvY2FsaXplclxuICB2YXIgdG90YWxNaW4gPSAxICsgbG9jYWxpemVyLmdldFRvdGFsTWluKHN0YXJ0LCBlbmQpO1xuICB2YXIgbWludXRlc0Zyb21NaWRuaWdodCA9IGxvY2FsaXplci5nZXRNaW51dGVzRnJvbU1pZG5pZ2h0KHN0YXJ0KTtcbiAgdmFyIG51bUdyb3VwcyA9IE1hdGguY2VpbCgodG90YWxNaW4gLSAxKSAvIChzdGVwICogdGltZXNsb3RzKSk7XG4gIHZhciBudW1TbG90cyA9IG51bUdyb3VwcyAqIHRpbWVzbG90cztcbiAgdmFyIGdyb3VwcyA9IG5ldyBBcnJheShudW1Hcm91cHMpO1xuICB2YXIgc2xvdHMgPSBuZXcgQXJyYXkobnVtU2xvdHMpO1xuICAvLyBFYWNoIHNsb3QgZGF0ZSBpcyBjcmVhdGVkIGZyb20gXCJ6ZXJvXCIsIGluc3RlYWQgb2YgYWRkaW5nIGBzdGVwYCB0b1xuICAvLyB0aGUgcHJldmlvdXMgb25lLCBpbiBvcmRlciB0byBhdm9pZCBEU1Qgb2RkaXRpZXNcbiAgZm9yICh2YXIgZ3JwID0gMDsgZ3JwIDwgbnVtR3JvdXBzOyBncnArKykge1xuICAgIGdyb3Vwc1tncnBdID0gbmV3IEFycmF5KHRpbWVzbG90cyk7XG4gICAgZm9yICh2YXIgc2xvdCA9IDA7IHNsb3QgPCB0aW1lc2xvdHM7IHNsb3QrKykge1xuICAgICAgdmFyIHNsb3RJZHggPSBncnAgKiB0aW1lc2xvdHMgKyBzbG90O1xuICAgICAgdmFyIG1pbkZyb21TdGFydCA9IHNsb3RJZHggKiBzdGVwO1xuICAgICAgLy8gQSBkYXRlIHdpdGggdG90YWwgbWludXRlcyBjYWxjdWxhdGVkIGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBkYXlcbiAgICAgIHNsb3RzW3Nsb3RJZHhdID0gZ3JvdXBzW2dycF1bc2xvdF0gPSBsb2NhbGl6ZXIuZ2V0U2xvdERhdGUoc3RhcnQsIG1pbnV0ZXNGcm9tTWlkbmlnaHQsIG1pbkZyb21TdGFydCk7XG4gICAgfVxuICB9XG5cbiAgLy8gTmVjZXNzYXJ5IHRvIGJlIGFibGUgdG8gc2VsZWN0IHVwIHVudGlsIHRoZSBsYXN0IHRpbWVzbG90IGluIGEgZGF5XG4gIHZhciBsYXN0U2xvdE1pbkZyb21TdGFydCA9IHNsb3RzLmxlbmd0aCAqIHN0ZXA7XG4gIHNsb3RzLnB1c2gobG9jYWxpemVyLmdldFNsb3REYXRlKHN0YXJ0LCBtaW51dGVzRnJvbU1pZG5pZ2h0LCBsYXN0U2xvdE1pbkZyb21TdGFydCkpO1xuICBmdW5jdGlvbiBwb3NpdGlvbkZyb21EYXRlKGRhdGUpIHtcbiAgICB2YXIgZGlmZiA9IGxvY2FsaXplci5kaWZmKHN0YXJ0LCBkYXRlLCAnbWludXRlcycpICsgbG9jYWxpemVyLmdldERzdE9mZnNldChzdGFydCwgZGF0ZSk7XG4gICAgcmV0dXJuIE1hdGgubWluKGRpZmYsIHRvdGFsTWluKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGdyb3VwczogZ3JvdXBzLFxuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGFyZ3MpIHtcbiAgICAgIGlmIChnZXRLZXkoYXJncykgIT09IGtleSkgcmV0dXJuIGdldFNsb3RNZXRyaWNzKGFyZ3MpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBkYXRlSXNJbkdyb3VwOiBmdW5jdGlvbiBkYXRlSXNJbkdyb3VwKGRhdGUsIGdyb3VwSW5kZXgpIHtcbiAgICAgIHZhciBuZXh0R3JvdXAgPSBncm91cHNbZ3JvdXBJbmRleCArIDFdO1xuICAgICAgcmV0dXJuIGxvY2FsaXplci5pblJhbmdlKGRhdGUsIGdyb3Vwc1tncm91cEluZGV4XVswXSwgbmV4dEdyb3VwID8gbmV4dEdyb3VwWzBdIDogZW5kLCAnbWludXRlcycpO1xuICAgIH0sXG4gICAgbmV4dFNsb3Q6IGZ1bmN0aW9uIG5leHRTbG90KHNsb3QpIHtcbiAgICAgIC8vIFdlIGNhbm5vdCBndWFyYW50ZWUgdGhhdCB0aGUgc2xvdCBvYmplY3QgbXVzdCBiZSBpbiBzbG90cyxcbiAgICAgIC8vIGJlY2F1c2UgYWZ0ZXIgZWFjaCB1cGRhdGUsIGEgbmV3IHNsb3RzIGFycmF5IHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgIHZhciBuZXh0ID0gc2xvdHNbTWF0aC5taW4oc2xvdHMuZmluZEluZGV4KGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHJldHVybiBzID09PSBzbG90IHx8IGxvY2FsaXplci5lcShzLCBzbG90KTtcbiAgICAgIH0pICsgMSwgc2xvdHMubGVuZ3RoIC0gMSldO1xuICAgICAgLy8gaW4gdGhlIGNhc2Ugb2YgdGhlIGxhc3Qgc2xvdCB3ZSB3b24ndCBhIGxvbmcgZW5vdWdoIHJhbmdlIHNvIG1hbnVhbGx5IGdldCBpdFxuICAgICAgaWYgKGxvY2FsaXplci5lcShuZXh0LCBzbG90KSkgbmV4dCA9IGxvY2FsaXplci5hZGQoc2xvdCwgc3RlcCwgJ21pbnV0ZXMnKTtcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH0sXG4gICAgY2xvc2VzdFNsb3RUb1Bvc2l0aW9uOiBmdW5jdGlvbiBjbG9zZXN0U2xvdFRvUG9zaXRpb24ocGVyY2VudCkge1xuICAgICAgdmFyIHNsb3QgPSBNYXRoLm1pbihzbG90cy5sZW5ndGggLSAxLCBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHBlcmNlbnQgKiBudW1TbG90cykpKTtcbiAgICAgIHJldHVybiBzbG90c1tzbG90XTtcbiAgICB9LFxuICAgIGNsb3Nlc3RTbG90RnJvbVBvaW50OiBmdW5jdGlvbiBjbG9zZXN0U2xvdEZyb21Qb2ludChwb2ludCwgYm91bmRhcnlSZWN0KSB7XG4gICAgICB2YXIgcmFuZ2UgPSBNYXRoLmFicyhib3VuZGFyeVJlY3QudG9wIC0gYm91bmRhcnlSZWN0LmJvdHRvbSk7XG4gICAgICByZXR1cm4gdGhpcy5jbG9zZXN0U2xvdFRvUG9zaXRpb24oKHBvaW50LnkgLSBib3VuZGFyeVJlY3QudG9wKSAvIHJhbmdlKTtcbiAgICB9LFxuICAgIGNsb3Nlc3RTbG90RnJvbURhdGU6IGZ1bmN0aW9uIGNsb3Nlc3RTbG90RnJvbURhdGUoZGF0ZSkge1xuICAgICAgdmFyIG9mZnNldCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMDtcbiAgICAgIGlmIChsb2NhbGl6ZXIubHQoZGF0ZSwgc3RhcnQsICdtaW51dGVzJykpIHJldHVybiBzbG90c1swXTtcbiAgICAgIGlmIChsb2NhbGl6ZXIuZ3QoZGF0ZSwgZW5kLCAnbWludXRlcycpKSByZXR1cm4gc2xvdHNbc2xvdHMubGVuZ3RoIC0gMV07XG4gICAgICB2YXIgZGlmZk1pbnMgPSBsb2NhbGl6ZXIuZGlmZihzdGFydCwgZGF0ZSwgJ21pbnV0ZXMnKTtcbiAgICAgIHJldHVybiBzbG90c1soZGlmZk1pbnMgLSBkaWZmTWlucyAlIHN0ZXApIC8gc3RlcCArIG9mZnNldF07XG4gICAgfSxcbiAgICBzdGFydHNCZWZvcmVEYXk6IGZ1bmN0aW9uIHN0YXJ0c0JlZm9yZURheShkYXRlKSB7XG4gICAgICByZXR1cm4gbG9jYWxpemVyLmx0KGRhdGUsIHN0YXJ0LCAnZGF5Jyk7XG4gICAgfSxcbiAgICBzdGFydHNBZnRlckRheTogZnVuY3Rpb24gc3RhcnRzQWZ0ZXJEYXkoZGF0ZSkge1xuICAgICAgcmV0dXJuIGxvY2FsaXplci5ndChkYXRlLCBlbmQsICdkYXknKTtcbiAgICB9LFxuICAgIHN0YXJ0c0JlZm9yZTogZnVuY3Rpb24gc3RhcnRzQmVmb3JlKGRhdGUpIHtcbiAgICAgIHJldHVybiBsb2NhbGl6ZXIubHQobG9jYWxpemVyLm1lcmdlKHN0YXJ0LCBkYXRlKSwgc3RhcnQsICdtaW51dGVzJyk7XG4gICAgfSxcbiAgICBzdGFydHNBZnRlcjogZnVuY3Rpb24gc3RhcnRzQWZ0ZXIoZGF0ZSkge1xuICAgICAgcmV0dXJuIGxvY2FsaXplci5ndChsb2NhbGl6ZXIubWVyZ2UoZW5kLCBkYXRlKSwgZW5kLCAnbWludXRlcycpO1xuICAgIH0sXG4gICAgZ2V0UmFuZ2U6IGZ1bmN0aW9uIGdldFJhbmdlKHJhbmdlU3RhcnQsIHJhbmdlRW5kLCBpZ25vcmVNaW4sIGlnbm9yZU1heCkge1xuICAgICAgaWYgKCFpZ25vcmVNaW4pIHJhbmdlU3RhcnQgPSBsb2NhbGl6ZXIubWluKGVuZCwgbG9jYWxpemVyLm1heChzdGFydCwgcmFuZ2VTdGFydCkpO1xuICAgICAgaWYgKCFpZ25vcmVNYXgpIHJhbmdlRW5kID0gbG9jYWxpemVyLm1pbihlbmQsIGxvY2FsaXplci5tYXgoc3RhcnQsIHJhbmdlRW5kKSk7XG4gICAgICB2YXIgcmFuZ2VTdGFydE1pbiA9IHBvc2l0aW9uRnJvbURhdGUocmFuZ2VTdGFydCk7XG4gICAgICB2YXIgcmFuZ2VFbmRNaW4gPSBwb3NpdGlvbkZyb21EYXRlKHJhbmdlRW5kKTtcbiAgICAgIHZhciB0b3AgPSByYW5nZUVuZE1pbiA+IHN0ZXAgKiBudW1TbG90cyAmJiAhbG9jYWxpemVyLmVxKGVuZCwgcmFuZ2VFbmQpID8gKHJhbmdlU3RhcnRNaW4gLSBzdGVwKSAvIChzdGVwICogbnVtU2xvdHMpICogMTAwIDogcmFuZ2VTdGFydE1pbiAvIChzdGVwICogbnVtU2xvdHMpICogMTAwO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiB0b3AsXG4gICAgICAgIGhlaWdodDogcmFuZ2VFbmRNaW4gLyAoc3RlcCAqIG51bVNsb3RzKSAqIDEwMCAtIHRvcCxcbiAgICAgICAgc3RhcnQ6IHBvc2l0aW9uRnJvbURhdGUocmFuZ2VTdGFydCksXG4gICAgICAgIHN0YXJ0RGF0ZTogcmFuZ2VTdGFydCxcbiAgICAgICAgZW5kOiBwb3NpdGlvbkZyb21EYXRlKHJhbmdlRW5kKSxcbiAgICAgICAgZW5kRGF0ZTogcmFuZ2VFbmRcbiAgICAgIH07XG4gICAgfSxcbiAgICBnZXRDdXJyZW50VGltZVBvc2l0aW9uOiBmdW5jdGlvbiBnZXRDdXJyZW50VGltZVBvc2l0aW9uKHJhbmdlU3RhcnQpIHtcbiAgICAgIHZhciByYW5nZVN0YXJ0TWluID0gcG9zaXRpb25Gcm9tRGF0ZShyYW5nZVN0YXJ0KTtcbiAgICAgIHZhciB0b3AgPSByYW5nZVN0YXJ0TWluIC8gKHN0ZXAgKiBudW1TbG90cykgKiAxMDA7XG4gICAgICByZXR1cm4gdG9wO1xuICAgIH1cbiAgfTtcbn1cblxudmFyIEV2ZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRXZlbnQoZGF0YSwgX3JlZikge1xuICAgIHZhciBhY2Nlc3NvcnMgPSBfcmVmLmFjY2Vzc29ycyxcbiAgICAgIHNsb3RNZXRyaWNzID0gX3JlZi5zbG90TWV0cmljcztcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnQpO1xuICAgIHZhciBfc2xvdE1ldHJpY3MkZ2V0UmFuZ2UgPSBzbG90TWV0cmljcy5nZXRSYW5nZShhY2Nlc3NvcnMuc3RhcnQoZGF0YSksIGFjY2Vzc29ycy5lbmQoZGF0YSkpLFxuICAgICAgc3RhcnQgPSBfc2xvdE1ldHJpY3MkZ2V0UmFuZ2Uuc3RhcnQsXG4gICAgICBzdGFydERhdGUgPSBfc2xvdE1ldHJpY3MkZ2V0UmFuZ2Uuc3RhcnREYXRlLFxuICAgICAgZW5kID0gX3Nsb3RNZXRyaWNzJGdldFJhbmdlLmVuZCxcbiAgICAgIGVuZERhdGUgPSBfc2xvdE1ldHJpY3MkZ2V0UmFuZ2UuZW5kRGF0ZSxcbiAgICAgIHRvcCA9IF9zbG90TWV0cmljcyRnZXRSYW5nZS50b3AsXG4gICAgICBoZWlnaHQgPSBfc2xvdE1ldHJpY3MkZ2V0UmFuZ2UuaGVpZ2h0O1xuICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgICB0aGlzLmVuZCA9IGVuZDtcbiAgICB0aGlzLnN0YXJ0TXMgPSArc3RhcnREYXRlO1xuICAgIHRoaXMuZW5kTXMgPSArZW5kRGF0ZTtcbiAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBldmVudCdzIHdpZHRoIHdpdGhvdXQgYW55IG92ZXJsYXAuXG4gICAqL1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKEV2ZW50LCBbe1xuICAgIGtleTogXCJfd2lkdGhcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIC8vIFRoZSBjb250YWluZXIgZXZlbnQncyB3aWR0aCBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBtYXhpbXVtIG51bWJlciBvZlxuICAgICAgLy8gZXZlbnRzIGluIGFueSBvZiBpdHMgcm93cy5cbiAgICAgIGlmICh0aGlzLnJvd3MpIHtcbiAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLnJvd3MucmVkdWNlKGZ1bmN0aW9uIChtYXgsIHJvdykge1xuICAgICAgICAgIHJldHVybiBNYXRoLm1heChtYXgsIHJvdy5sZWF2ZXMubGVuZ3RoICsgMSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGFkZCBpdHNlbGZcbiAgICAgICAgMCkgKyAxOyAvLyBhZGQgdGhlIGNvbnRhaW5lclxuXG4gICAgICAgIHJldHVybiAxMDAgLyBjb2x1bW5zO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgcm93IGV2ZW50J3Mgd2lkdGggaXMgdGhlIHNwYWNlIGxlZnQgYnkgdGhlIGNvbnRhaW5lciwgZGl2aWRlZFxuICAgICAgLy8gYW1vbmcgaXRzZWxmIGFuZCBpdHMgbGVhdmVzLlxuICAgICAgaWYgKHRoaXMubGVhdmVzKSB7XG4gICAgICAgIHZhciBhdmFpbGFibGVXaWR0aCA9IDEwMCAtIHRoaXMuY29udGFpbmVyLl93aWR0aDtcbiAgICAgICAgcmV0dXJuIGF2YWlsYWJsZVdpZHRoIC8gKHRoaXMubGVhdmVzLmxlbmd0aCArIDEpO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgbGVhZiBldmVudCdzIHdpZHRoIGlzIGRldGVybWluZWQgYnkgaXRzIHJvdydzIHdpZHRoXG4gICAgICByZXR1cm4gdGhpcy5yb3cuX3dpZHRoO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBldmVudCdzIGNhbGN1bGF0ZWQgd2lkdGgsIHBvc3NpYmx5IHdpdGggZXh0cmEgd2lkdGggYWRkZWQgZm9yXG4gICAgICogb3ZlcmxhcHBpbmcgZWZmZWN0LlxuICAgICAqL1xuICB9LCB7XG4gICAga2V5OiBcIndpZHRoXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgbm9PdmVybGFwID0gdGhpcy5fd2lkdGg7XG4gICAgICB2YXIgb3ZlcmxhcCA9IE1hdGgubWluKDEwMCwgdGhpcy5fd2lkdGggKiAxLjcpO1xuXG4gICAgICAvLyBDb250YWluZXJzIGNhbiBhbHdheXMgZ3Jvdy5cbiAgICAgIGlmICh0aGlzLnJvd3MpIHtcbiAgICAgICAgcmV0dXJuIG92ZXJsYXA7XG4gICAgICB9XG5cbiAgICAgIC8vIFJvd3MgY2FuIGdyb3cgaWYgdGhleSBoYXZlIGxlYXZlcy5cbiAgICAgIGlmICh0aGlzLmxlYXZlcykge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWF2ZXMubGVuZ3RoID4gMCA/IG92ZXJsYXAgOiBub092ZXJsYXA7XG4gICAgICB9XG5cbiAgICAgIC8vIExlYXZlcyBjYW4gZ3JvdyB1bmxlc3MgdGhleSdyZSB0aGUgbGFzdCBpdGVtIGluIGEgcm93LlxuICAgICAgdmFyIGxlYXZlcyA9IHRoaXMucm93LmxlYXZlcztcbiAgICAgIHZhciBpbmRleCA9IGxlYXZlcy5pbmRleE9mKHRoaXMpO1xuICAgICAgcmV0dXJuIGluZGV4ID09PSBsZWF2ZXMubGVuZ3RoIC0gMSA/IG5vT3ZlcmxhcCA6IG92ZXJsYXA7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInhPZmZzZXRcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIC8vIENvbnRhaW5lcnMgaGF2ZSBubyBvZmZzZXQuXG4gICAgICBpZiAodGhpcy5yb3dzKSByZXR1cm4gMDtcblxuICAgICAgLy8gUm93cyBhbHdheXMgc3RhcnQgd2hlcmUgdGhlaXIgY29udGFpbmVyIGVuZHMuXG4gICAgICBpZiAodGhpcy5sZWF2ZXMpIHJldHVybiB0aGlzLmNvbnRhaW5lci5fd2lkdGg7XG5cbiAgICAgIC8vIExlYXZlcyBhcmUgc3ByZWFkIG91dCBldmVubHkgb24gdGhlIHNwYWNlIGxlZnQgYnkgaXRzIHJvdy5cbiAgICAgIHZhciBfdGhpcyRyb3cgPSB0aGlzLnJvdyxcbiAgICAgICAgbGVhdmVzID0gX3RoaXMkcm93LmxlYXZlcyxcbiAgICAgICAgeE9mZnNldCA9IF90aGlzJHJvdy54T2Zmc2V0LFxuICAgICAgICBfd2lkdGggPSBfdGhpcyRyb3cuX3dpZHRoO1xuICAgICAgdmFyIGluZGV4ID0gbGVhdmVzLmluZGV4T2YodGhpcykgKyAxO1xuICAgICAgcmV0dXJuIHhPZmZzZXQgKyBpbmRleCAqIF93aWR0aDtcbiAgICB9XG4gIH1dKTtcbn0oKTtcbi8qKlxuICogUmV0dXJuIHRydWUgaWYgZXZlbnQgYSBhbmQgYiBpcyBjb25zaWRlcmVkIHRvIGJlIG9uIHRoZSBzYW1lIHJvdy5cbiAqL1xuZnVuY3Rpb24gb25TYW1lUm93KGEsIGIsIG1pbmltdW1TdGFydERpZmZlcmVuY2UpIHtcbiAgcmV0dXJuIChcbiAgICAvLyBPY2N1cGllcyB0aGUgc2FtZSBzdGFydCBzbG90LlxuICAgIE1hdGguYWJzKGIuc3RhcnQgLSBhLnN0YXJ0KSA8IG1pbmltdW1TdGFydERpZmZlcmVuY2UgfHxcbiAgICAvLyBBJ3Mgc3RhcnQgc2xvdCBvdmVybGFwcyB3aXRoIGIncyBlbmQgc2xvdC5cbiAgICBiLnN0YXJ0ID4gYS5zdGFydCAmJiBiLnN0YXJ0IDwgYS5lbmRcbiAgKTtcbn1cbmZ1bmN0aW9uIHNvcnRCeVJlbmRlcihldmVudHMpIHtcbiAgdmFyIHNvcnRlZEJ5VGltZSA9IHNvcnRCeShldmVudHMsIFsnc3RhcnRNcycsIGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIC1lLmVuZE1zO1xuICB9XSk7XG4gIHZhciBzb3J0ZWQgPSBbXTtcbiAgd2hpbGUgKHNvcnRlZEJ5VGltZS5sZW5ndGggPiAwKSB7XG4gICAgdmFyIGV2ZW50ID0gc29ydGVkQnlUaW1lLnNoaWZ0KCk7XG4gICAgc29ydGVkLnB1c2goZXZlbnQpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc29ydGVkQnlUaW1lLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdGVzdCA9IHNvcnRlZEJ5VGltZVtpXTtcblxuICAgICAgLy8gU3RpbGwgaW5zaWRlIHRoaXMgZXZlbnQsIGxvb2sgZm9yIG5leHQuXG4gICAgICBpZiAoZXZlbnQuZW5kTXMgPiB0ZXN0LnN0YXJ0TXMpIGNvbnRpbnVlO1xuXG4gICAgICAvLyBXZSd2ZSBmb3VuZCB0aGUgZmlyc3QgZXZlbnQgb2YgdGhlIG5leHQgZXZlbnQgZ3JvdXAuXG4gICAgICAvLyBJZiB0aGF0IGV2ZW50IGlzIG5vdCByaWdodCBuZXh0IHRvIG91ciBjdXJyZW50IGV2ZW50LCB3ZSBoYXZlIHRvXG4gICAgICAvLyBtb3ZlIGl0IGhlcmUuXG4gICAgICBpZiAoaSA+IDApIHtcbiAgICAgICAgdmFyIF9ldmVudCA9IHNvcnRlZEJ5VGltZS5zcGxpY2UoaSwgMSlbMF07XG4gICAgICAgIHNvcnRlZC5wdXNoKF9ldmVudCk7XG4gICAgICB9XG5cbiAgICAgIC8vIFdlJ3ZlIGFscmVhZHkgZm91bmQgdGhlIG5leHQgZXZlbnQgZ3JvdXAsIHNvIHN0b3AgbG9va2luZy5cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc29ydGVkO1xufVxuZnVuY3Rpb24gZ2V0U3R5bGVkRXZlbnRzJDEoX3JlZjIpIHtcbiAgdmFyIGV2ZW50cyA9IF9yZWYyLmV2ZW50cyxcbiAgICBtaW5pbXVtU3RhcnREaWZmZXJlbmNlID0gX3JlZjIubWluaW11bVN0YXJ0RGlmZmVyZW5jZSxcbiAgICBzbG90TWV0cmljcyA9IF9yZWYyLnNsb3RNZXRyaWNzLFxuICAgIGFjY2Vzc29ycyA9IF9yZWYyLmFjY2Vzc29ycztcbiAgLy8gQ3JlYXRlIHByb3h5IGV2ZW50cyBhbmQgb3JkZXIgdGhlbSBzbyB0aGF0IHdlIGRvbid0IGhhdmVcbiAgLy8gdG8gZmlkZGxlIHdpdGggei1pbmRleGVzLlxuICB2YXIgcHJveGllcyA9IGV2ZW50cy5tYXAoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgcmV0dXJuIG5ldyBFdmVudChldmVudCwge1xuICAgICAgc2xvdE1ldHJpY3M6IHNsb3RNZXRyaWNzLFxuICAgICAgYWNjZXNzb3JzOiBhY2Nlc3NvcnNcbiAgICB9KTtcbiAgfSk7XG4gIHZhciBldmVudHNJblJlbmRlck9yZGVyID0gc29ydEJ5UmVuZGVyKHByb3hpZXMpO1xuXG4gIC8vIEdyb3VwIG92ZXJsYXBwaW5nIGV2ZW50cywgd2hpbGUga2VlcGluZyBvcmRlci5cbiAgLy8gRXZlcnkgZXZlbnQgaXMgYWx3YXlzIG9uZSBvZjogY29udGFpbmVyLCByb3cgb3IgbGVhZi5cbiAgLy8gQ29udGFpbmVycyBjYW4gY29udGFpbiByb3dzLCBhbmQgcm93cyBjYW4gY29udGFpbiBsZWF2ZXMuXG4gIHZhciBjb250YWluZXJFdmVudHMgPSBbXTtcbiAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7XG4gICAgdmFyIGV2ZW50ID0gZXZlbnRzSW5SZW5kZXJPcmRlcltpXTtcblxuICAgIC8vIENoZWNrIGlmIHRoaXMgZXZlbnQgY2FuIGdvIGludG8gYSBjb250YWluZXIgZXZlbnQuXG4gICAgdmFyIGNvbnRhaW5lciA9IGNvbnRhaW5lckV2ZW50cy5maW5kKGZ1bmN0aW9uIChjKSB7XG4gICAgICByZXR1cm4gYy5lbmQgPiBldmVudC5zdGFydCB8fCBNYXRoLmFicyhldmVudC5zdGFydCAtIGMuc3RhcnQpIDwgbWluaW11bVN0YXJ0RGlmZmVyZW5jZTtcbiAgICB9KTtcblxuICAgIC8vIENvdWxkbid0IGZpbmQgYSBjb250YWluZXIg4oCUIHRoYXQgbWVhbnMgdGhpcyBldmVudCBpcyBhIGNvbnRhaW5lci5cbiAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgZXZlbnQucm93cyA9IFtdO1xuICAgICAgY29udGFpbmVyRXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgcmV0dXJuIDE7IC8vIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgLy8gRm91bmQgYSBjb250YWluZXIgZm9yIHRoZSBldmVudC5cbiAgICBldmVudC5jb250YWluZXIgPSBjb250YWluZXI7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgZXZlbnQgY2FuIGJlIHBsYWNlZCBpbiBhbiBleGlzdGluZyByb3cuXG4gICAgLy8gU3RhcnQgbG9va2luZyBmcm9tIGJlaGluZC5cbiAgICB2YXIgcm93ID0gbnVsbDtcbiAgICBmb3IgKHZhciBqID0gY29udGFpbmVyLnJvd3MubGVuZ3RoIC0gMTsgIXJvdyAmJiBqID49IDA7IGotLSkge1xuICAgICAgaWYgKG9uU2FtZVJvdyhjb250YWluZXIucm93c1tqXSwgZXZlbnQsIG1pbmltdW1TdGFydERpZmZlcmVuY2UpKSB7XG4gICAgICAgIHJvdyA9IGNvbnRhaW5lci5yb3dzW2pdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAocm93KSB7XG4gICAgICAvLyBGb3VuZCBhIHJvdywgc28gYWRkIGl0LlxuICAgICAgcm93LmxlYXZlcy5wdXNoKGV2ZW50KTtcbiAgICAgIGV2ZW50LnJvdyA9IHJvdztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ291bGRuJ3QgZmluZCBhIHJvdyDigJMgdGhhdCBtZWFucyB0aGlzIGV2ZW50IGlzIGEgcm93LlxuICAgICAgZXZlbnQubGVhdmVzID0gW107XG4gICAgICBjb250YWluZXIucm93cy5wdXNoKGV2ZW50KTtcbiAgICB9XG4gIH07XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzSW5SZW5kZXJPcmRlci5sZW5ndGg7IGkrKykge1xuICAgIGlmIChfbG9vcCgpKSBjb250aW51ZTtcbiAgfVxuXG4gIC8vIFJldHVybiB0aGUgb3JpZ2luYWwgZXZlbnRzLCBhbG9uZyB3aXRoIHRoZWlyIHN0eWxlcy5cbiAgcmV0dXJuIGV2ZW50c0luUmVuZGVyT3JkZXIubWFwKGZ1bmN0aW9uIChldmVudCkge1xuICAgIHJldHVybiB7XG4gICAgICBldmVudDogZXZlbnQuZGF0YSxcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIHRvcDogZXZlbnQudG9wLFxuICAgICAgICBoZWlnaHQ6IGV2ZW50LmhlaWdodCxcbiAgICAgICAgd2lkdGg6IGV2ZW50LndpZHRoLFxuICAgICAgICB4T2Zmc2V0OiBNYXRoLm1heCgwLCBldmVudC54T2Zmc2V0KVxuICAgICAgfVxuICAgIH07XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRNYXhJZHhERlMobm9kZSwgbWF4SWR4LCB2aXNpdGVkKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZS5mcmllbmRzLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKHZpc2l0ZWQuaW5kZXhPZihub2RlLmZyaWVuZHNbaV0pID4gLTEpIGNvbnRpbnVlO1xuICAgIG1heElkeCA9IG1heElkeCA+IG5vZGUuZnJpZW5kc1tpXS5pZHggPyBtYXhJZHggOiBub2RlLmZyaWVuZHNbaV0uaWR4O1xuICAgIC8vIFRPRE8gOiB0cmFjZSBpdCBieSBub3Qgb2JqZWN0IGJ1dCBraW5kYSBpbmRleCBvciBzb21ldGhpbmcgZm9yIHBlcmZvcm1hbmNlXG4gICAgdmlzaXRlZC5wdXNoKG5vZGUuZnJpZW5kc1tpXSk7XG4gICAgdmFyIG5ld0lkeCA9IGdldE1heElkeERGUyhub2RlLmZyaWVuZHNbaV0sIG1heElkeCwgdmlzaXRlZCk7XG4gICAgbWF4SWR4ID0gbWF4SWR4ID4gbmV3SWR4ID8gbWF4SWR4IDogbmV3SWR4O1xuICB9XG4gIHJldHVybiBtYXhJZHg7XG59XG5mdW5jdGlvbiBub092ZXJsYXAgKF9yZWYpIHtcbiAgdmFyIGV2ZW50cyA9IF9yZWYuZXZlbnRzLFxuICAgIG1pbmltdW1TdGFydERpZmZlcmVuY2UgPSBfcmVmLm1pbmltdW1TdGFydERpZmZlcmVuY2UsXG4gICAgc2xvdE1ldHJpY3MgPSBfcmVmLnNsb3RNZXRyaWNzLFxuICAgIGFjY2Vzc29ycyA9IF9yZWYuYWNjZXNzb3JzO1xuICB2YXIgc3R5bGVkRXZlbnRzID0gZ2V0U3R5bGVkRXZlbnRzJDEoe1xuICAgIGV2ZW50czogZXZlbnRzLFxuICAgIG1pbmltdW1TdGFydERpZmZlcmVuY2U6IG1pbmltdW1TdGFydERpZmZlcmVuY2UsXG4gICAgc2xvdE1ldHJpY3M6IHNsb3RNZXRyaWNzLFxuICAgIGFjY2Vzc29yczogYWNjZXNzb3JzXG4gIH0pO1xuICBzdHlsZWRFdmVudHMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIGEgPSBhLnN0eWxlO1xuICAgIGIgPSBiLnN0eWxlO1xuICAgIGlmIChhLnRvcCAhPT0gYi50b3ApIHJldHVybiBhLnRvcCA+IGIudG9wID8gMSA6IC0xO2Vsc2UgaWYgKGEuaGVpZ2h0ICE9PSBiLmhlaWdodCkgcmV0dXJuIGEudG9wICsgYS5oZWlnaHQgPCBiLnRvcCArIGIuaGVpZ2h0ID8gMSA6IC0xO2Vsc2UgcmV0dXJuIDA7XG4gIH0pO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlZEV2ZW50cy5sZW5ndGg7ICsraSkge1xuICAgIHN0eWxlZEV2ZW50c1tpXS5mcmllbmRzID0gW107XG4gICAgZGVsZXRlIHN0eWxlZEV2ZW50c1tpXS5zdHlsZS5sZWZ0O1xuICAgIGRlbGV0ZSBzdHlsZWRFdmVudHNbaV0uc3R5bGUubGVmdDtcbiAgICBkZWxldGUgc3R5bGVkRXZlbnRzW2ldLmlkeDtcbiAgICBkZWxldGUgc3R5bGVkRXZlbnRzW2ldLnNpemU7XG4gIH1cbiAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgc3R5bGVkRXZlbnRzLmxlbmd0aCAtIDE7ICsrX2kyKSB7XG4gICAgdmFyIHNlMSA9IHN0eWxlZEV2ZW50c1tfaTJdO1xuICAgIHZhciB5MSA9IHNlMS5zdHlsZS50b3A7XG4gICAgdmFyIHkyID0gc2UxLnN0eWxlLnRvcCArIHNlMS5zdHlsZS5oZWlnaHQ7XG4gICAgZm9yICh2YXIgaiA9IF9pMiArIDE7IGogPCBzdHlsZWRFdmVudHMubGVuZ3RoOyArK2opIHtcbiAgICAgIHZhciBzZTIgPSBzdHlsZWRFdmVudHNbal07XG4gICAgICB2YXIgeTMgPSBzZTIuc3R5bGUudG9wO1xuICAgICAgdmFyIHk0ID0gc2UyLnN0eWxlLnRvcCArIHNlMi5zdHlsZS5oZWlnaHQ7XG4gICAgICBpZiAoeTMgPj0geTEgJiYgeTQgPD0geTIgfHwgeTQgPiB5MSAmJiB5NCA8PSB5MiB8fCB5MyA+PSB5MSAmJiB5MyA8IHkyKSB7XG4gICAgICAgIC8vIFRPRE8gOiBoYXNobWFwIHdvdWxkIGJlIGVmZmVjdGl2ZSBmb3IgcGVyZm9ybWFuY2VcbiAgICAgICAgc2UxLmZyaWVuZHMucHVzaChzZTIpO1xuICAgICAgICBzZTIuZnJpZW5kcy5wdXNoKHNlMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZvciAodmFyIF9pNCA9IDA7IF9pNCA8IHN0eWxlZEV2ZW50cy5sZW5ndGg7ICsrX2k0KSB7XG4gICAgdmFyIHNlID0gc3R5bGVkRXZlbnRzW19pNF07XG4gICAgdmFyIGJpdG1hcCA9IFtdO1xuICAgIGZvciAodmFyIF9qMiA9IDA7IF9qMiA8IDEwMDsgKytfajIpIGJpdG1hcC5wdXNoKDEpOyAvLyAxIG1lYW5zIGF2YWlsYWJsZVxuXG4gICAgZm9yICh2YXIgX2o0ID0gMDsgX2o0IDwgc2UuZnJpZW5kcy5sZW5ndGg7ICsrX2o0KSBpZiAoc2UuZnJpZW5kc1tfajRdLmlkeCAhPT0gdW5kZWZpbmVkKSBiaXRtYXBbc2UuZnJpZW5kc1tfajRdLmlkeF0gPSAwOyAvLyAwIG1lYW5zIHJlc2VydmVkXG5cbiAgICBzZS5pZHggPSBiaXRtYXAuaW5kZXhPZigxKTtcbiAgfVxuICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBzdHlsZWRFdmVudHMubGVuZ3RoOyArK19pNikge1xuICAgIHZhciBzaXplID0gMDtcbiAgICBpZiAoc3R5bGVkRXZlbnRzW19pNl0uc2l6ZSkgY29udGludWU7XG4gICAgdmFyIGFsbEZyaWVuZHMgPSBbXTtcbiAgICB2YXIgbWF4SWR4ID0gZ2V0TWF4SWR4REZTKHN0eWxlZEV2ZW50c1tfaTZdLCAwLCBhbGxGcmllbmRzKTtcbiAgICBzaXplID0gMTAwIC8gKG1heElkeCArIDEpO1xuICAgIHN0eWxlZEV2ZW50c1tfaTZdLnNpemUgPSBzaXplO1xuICAgIGZvciAodmFyIF9qNiA9IDA7IF9qNiA8IGFsbEZyaWVuZHMubGVuZ3RoOyArK19qNikgYWxsRnJpZW5kc1tfajZdLnNpemUgPSBzaXplO1xuICB9XG4gIGZvciAodmFyIF9pOCA9IDA7IF9pOCA8IHN0eWxlZEV2ZW50cy5sZW5ndGg7ICsrX2k4KSB7XG4gICAgdmFyIGUgPSBzdHlsZWRFdmVudHNbX2k4XTtcbiAgICBlLnN0eWxlLmxlZnQgPSBlLmlkeCAqIGUuc2l6ZTtcblxuICAgIC8vIHN0cmV0Y2ggdG8gbWF4aW11bVxuICAgIHZhciBfbWF4SWR4ID0gMDtcbiAgICBmb3IgKHZhciBfajggPSAwOyBfajggPCBlLmZyaWVuZHMubGVuZ3RoOyArK19qOCkge1xuICAgICAgdmFyIGlkeCA9IGUuZnJpZW5kc1tfajhdLmlkeDtcbiAgICAgIF9tYXhJZHggPSBfbWF4SWR4ID4gaWR4ID8gX21heElkeCA6IGlkeDtcbiAgICB9XG4gICAgaWYgKF9tYXhJZHggPD0gZS5pZHgpIGUuc2l6ZSA9IDEwMCAtIGUuaWR4ICogZS5zaXplO1xuXG4gICAgLy8gcGFkZGluZyBiZXR3ZWVuIGV2ZW50c1xuICAgIC8vIGZvciB0aGlzIGZlYXR1cmUsIGB3aWR0aGAgaXMgbm90IHBlcmNlbnRhZ2UgYmFzZWQgdW5pdCBhbnltb3JlXG4gICAgLy8gaXQgd2lsbCBiZSB1c2VkIHdpdGggY2FsYygpXG4gICAgdmFyIHBhZGRpbmcgPSBlLmlkeCA9PT0gMCA/IDAgOiAzO1xuICAgIGUuc3R5bGUud2lkdGggPSBcImNhbGMoXCIuY29uY2F0KGUuc2l6ZSwgXCIlIC0gXCIpLmNvbmNhdChwYWRkaW5nLCBcInB4KVwiKTtcbiAgICBlLnN0eWxlLmhlaWdodCA9IFwiY2FsYyhcIi5jb25jYXQoZS5zdHlsZS5oZWlnaHQsIFwiJSAtIDJweClcIik7XG4gICAgZS5zdHlsZS54T2Zmc2V0ID0gXCJjYWxjKFwiLmNvbmNhdChlLnN0eWxlLmxlZnQsIFwiJSArIFwiKS5jb25jYXQocGFkZGluZywgXCJweClcIik7XG4gIH1cbiAgcmV0dXJuIHN0eWxlZEV2ZW50cztcbn1cblxuLyplc2xpbnQgbm8tdW51c2VkLXZhcnM6IFwib2ZmXCIqL1xuXG52YXIgRGVmYXVsdEFsZ29yaXRobXMgPSB7XG4gIG92ZXJsYXA6IGdldFN0eWxlZEV2ZW50cyQxLFxuICAnbm8tb3ZlcmxhcCc6IG5vT3ZlcmxhcFxufTtcbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYSkge1xuICByZXR1cm4gISEoYSAmJiBhLmNvbnN0cnVjdG9yICYmIGEuY2FsbCAmJiBhLmFwcGx5KTtcbn1cblxuLy9cbmZ1bmN0aW9uIGdldFN0eWxlZEV2ZW50cyhfcmVmKSB7XG4gIF9yZWYuZXZlbnRzO1xuICAgIF9yZWYubWluaW11bVN0YXJ0RGlmZmVyZW5jZTtcbiAgICBfcmVmLnNsb3RNZXRyaWNzO1xuICAgIF9yZWYuYWNjZXNzb3JzO1xuICAgIHZhciBkYXlMYXlvdXRBbGdvcml0aG0gPSBfcmVmLmRheUxheW91dEFsZ29yaXRobTtcbiAgdmFyIGFsZ29yaXRobSA9IGRheUxheW91dEFsZ29yaXRobTtcbiAgaWYgKGRheUxheW91dEFsZ29yaXRobSBpbiBEZWZhdWx0QWxnb3JpdGhtcykgYWxnb3JpdGhtID0gRGVmYXVsdEFsZ29yaXRobXNbZGF5TGF5b3V0QWxnb3JpdGhtXTtcbiAgaWYgKCFpc0Z1bmN0aW9uKGFsZ29yaXRobSkpIHtcbiAgICAvLyBpbnZhbGlkIGFsZ29yaXRobVxuICAgIHJldHVybiBbXTtcbiAgfVxuICByZXR1cm4gYWxnb3JpdGhtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbnZhciBUaW1lU2xvdEdyb3VwID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIFRpbWVTbG90R3JvdXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRpbWVTbG90R3JvdXApO1xuICAgIHJldHVybiBfY2FsbFN1cGVyKHRoaXMsIFRpbWVTbG90R3JvdXAsIGFyZ3VtZW50cyk7XG4gIH1cbiAgX2luaGVyaXRzKFRpbWVTbG90R3JvdXAsIF9Db21wb25lbnQpO1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKFRpbWVTbG90R3JvdXAsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLFxuICAgICAgICByZW5kZXJTbG90ID0gX3RoaXMkcHJvcHMucmVuZGVyU2xvdCxcbiAgICAgICAgcmVzb3VyY2UgPSBfdGhpcyRwcm9wcy5yZXNvdXJjZSxcbiAgICAgICAgZ3JvdXAgPSBfdGhpcyRwcm9wcy5ncm91cCxcbiAgICAgICAgZ2V0dGVycyA9IF90aGlzJHByb3BzLmdldHRlcnMsXG4gICAgICAgIF90aGlzJHByb3BzJGNvbXBvbmVudCA9IF90aGlzJHByb3BzLmNvbXBvbmVudHMsXG4gICAgICAgIF90aGlzJHByb3BzJGNvbXBvbmVudDIgPSBfdGhpcyRwcm9wcyRjb21wb25lbnQgPT09IHZvaWQgMCA/IHt9IDogX3RoaXMkcHJvcHMkY29tcG9uZW50LFxuICAgICAgICBfdGhpcyRwcm9wcyRjb21wb25lbnQzID0gX3RoaXMkcHJvcHMkY29tcG9uZW50Mi50aW1lU2xvdFdyYXBwZXIsXG4gICAgICAgIFdyYXBwZXIgPSBfdGhpcyRwcm9wcyRjb21wb25lbnQzID09PSB2b2lkIDAgPyBOb29wV3JhcHBlciA6IF90aGlzJHByb3BzJGNvbXBvbmVudDM7XG4gICAgICB2YXIgZ3JvdXBQcm9wcyA9IGdldHRlcnMgPyBnZXR0ZXJzLnNsb3RHcm91cFByb3AoZ3JvdXApIDoge307XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgT2JqZWN0LmFzc2lnbih7XG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtdGltZXNsb3QtZ3JvdXBcIlxuICAgICAgfSwgZ3JvdXBQcm9wcyksIGdyb3VwLm1hcChmdW5jdGlvbiAodmFsdWUsIGlkeCkge1xuICAgICAgICB2YXIgc2xvdFByb3BzID0gZ2V0dGVycyA/IGdldHRlcnMuc2xvdFByb3AodmFsdWUsIHJlc291cmNlKSA6IHt9O1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoV3JhcHBlciwge1xuICAgICAgICAgIGtleTogaWR4LFxuICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICByZXNvdXJjZTogcmVzb3VyY2VcbiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgT2JqZWN0LmFzc2lnbih7fSwgc2xvdFByb3BzLCB7XG4gICAgICAgICAgY2xhc3NOYW1lOiBjbHN4KCdyYmMtdGltZS1zbG90Jywgc2xvdFByb3BzLmNsYXNzTmFtZSlcbiAgICAgICAgfSksIHJlbmRlclNsb3QgJiYgcmVuZGVyU2xvdCh2YWx1ZSwgaWR4KSkpO1xuICAgICAgfSkpO1xuICAgIH1cbiAgfV0pO1xufShDb21wb25lbnQpO1xuXG5mdW5jdGlvbiBzdHJpbmdpZnlQZXJjZW50KHYpIHtcbiAgcmV0dXJuIHR5cGVvZiB2ID09PSAnc3RyaW5nJyA/IHYgOiB2ICsgJyUnO1xufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9wcm9wLXR5cGVzICovXG5mdW5jdGlvbiBUaW1lR3JpZEV2ZW50KHByb3BzKSB7XG4gIHZhciBzdHlsZSA9IHByb3BzLnN0eWxlLFxuICAgIGNsYXNzTmFtZSA9IHByb3BzLmNsYXNzTmFtZSxcbiAgICBldmVudCA9IHByb3BzLmV2ZW50LFxuICAgIGFjY2Vzc29ycyA9IHByb3BzLmFjY2Vzc29ycyxcbiAgICBydGwgPSBwcm9wcy5ydGwsXG4gICAgc2VsZWN0ZWQgPSBwcm9wcy5zZWxlY3RlZCxcbiAgICBsYWJlbCA9IHByb3BzLmxhYmVsLFxuICAgIGNvbnRpbnVlc1ByaW9yID0gcHJvcHMuY29udGludWVzUHJpb3IsXG4gICAgY29udGludWVzQWZ0ZXIgPSBwcm9wcy5jb250aW51ZXNBZnRlcixcbiAgICBnZXR0ZXJzID0gcHJvcHMuZ2V0dGVycyxcbiAgICBvbkNsaWNrID0gcHJvcHMub25DbGljayxcbiAgICBvbkRvdWJsZUNsaWNrID0gcHJvcHMub25Eb3VibGVDbGljayxcbiAgICBpc0JhY2tncm91bmRFdmVudCA9IHByb3BzLmlzQmFja2dyb3VuZEV2ZW50LFxuICAgIG9uS2V5UHJlc3MgPSBwcm9wcy5vbktleVByZXNzLFxuICAgIF9wcm9wcyRjb21wb25lbnRzID0gcHJvcHMuY29tcG9uZW50cyxcbiAgICBFdmVudCA9IF9wcm9wcyRjb21wb25lbnRzLmV2ZW50LFxuICAgIEV2ZW50V3JhcHBlciA9IF9wcm9wcyRjb21wb25lbnRzLmV2ZW50V3JhcHBlcjtcbiAgdmFyIHRpdGxlID0gYWNjZXNzb3JzLnRpdGxlKGV2ZW50KTtcbiAgdmFyIHRvb2x0aXAgPSBhY2Nlc3NvcnMudG9vbHRpcChldmVudCk7XG4gIHZhciBlbmQgPSBhY2Nlc3NvcnMuZW5kKGV2ZW50KTtcbiAgdmFyIHN0YXJ0ID0gYWNjZXNzb3JzLnN0YXJ0KGV2ZW50KTtcbiAgdmFyIHVzZXJQcm9wcyA9IGdldHRlcnMuZXZlbnRQcm9wKGV2ZW50LCBzdGFydCwgZW5kLCBzZWxlY3RlZCk7XG4gIHZhciBpbm5lciA9IFsvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAga2V5OiBcIjFcIixcbiAgICBjbGFzc05hbWU6IFwicmJjLWV2ZW50LWxhYmVsXCJcbiAgfSwgbGFiZWwpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAga2V5OiBcIjJcIixcbiAgICBjbGFzc05hbWU6IFwicmJjLWV2ZW50LWNvbnRlbnRcIlxuICB9LCBFdmVudCA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV2ZW50LCB7XG4gICAgZXZlbnQ6IGV2ZW50LFxuICAgIHRpdGxlOiB0aXRsZVxuICB9KSA6IHRpdGxlKV07XG4gIHZhciBoZWlnaHQgPSBzdHlsZS5oZWlnaHQsXG4gICAgdG9wID0gc3R5bGUudG9wLFxuICAgIHdpZHRoID0gc3R5bGUud2lkdGgsXG4gICAgeE9mZnNldCA9IHN0eWxlLnhPZmZzZXQ7XG4gIHZhciBldmVudFN0eWxlID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB1c2VyUHJvcHMuc3R5bGUpLCB7fSwgX2RlZmluZVByb3BlcnR5KHtcbiAgICB0b3A6IHN0cmluZ2lmeVBlcmNlbnQodG9wKSxcbiAgICBoZWlnaHQ6IHN0cmluZ2lmeVBlcmNlbnQoaGVpZ2h0KSxcbiAgICB3aWR0aDogc3RyaW5naWZ5UGVyY2VudCh3aWR0aClcbiAgfSwgcnRsID8gJ3JpZ2h0JyA6ICdsZWZ0Jywgc3RyaW5naWZ5UGVyY2VudCh4T2Zmc2V0KSkpO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRXZlbnRXcmFwcGVyLCBPYmplY3QuYXNzaWduKHtcbiAgICB0eXBlOiBcInRpbWVcIlxuICB9LCBwcm9wcyksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICByb2xlOiBcImJ1dHRvblwiLFxuICAgIHRhYkluZGV4OiAwLFxuICAgIG9uQ2xpY2s6IG9uQ2xpY2ssXG4gICAgb25Eb3VibGVDbGljazogb25Eb3VibGVDbGljayxcbiAgICBzdHlsZTogZXZlbnRTdHlsZSxcbiAgICBvbktleURvd246IG9uS2V5UHJlc3MsXG4gICAgdGl0bGU6IHRvb2x0aXAgPyAodHlwZW9mIGxhYmVsID09PSAnc3RyaW5nJyA/IGxhYmVsICsgJzogJyA6ICcnKSArIHRvb2x0aXAgOiB1bmRlZmluZWQsXG4gICAgY2xhc3NOYW1lOiBjbHN4KGlzQmFja2dyb3VuZEV2ZW50ID8gJ3JiYy1iYWNrZ3JvdW5kLWV2ZW50JyA6ICdyYmMtZXZlbnQnLCBjbGFzc05hbWUsIHVzZXJQcm9wcy5jbGFzc05hbWUsIHtcbiAgICAgICdyYmMtc2VsZWN0ZWQnOiBzZWxlY3RlZCxcbiAgICAgICdyYmMtZXZlbnQtY29udGludWVzLWVhcmxpZXInOiBjb250aW51ZXNQcmlvcixcbiAgICAgICdyYmMtZXZlbnQtY29udGludWVzLWxhdGVyJzogY29udGludWVzQWZ0ZXJcbiAgICB9KVxuICB9LCBpbm5lcikpO1xufVxuXG52YXIgRGF5Q29sdW1uV3JhcHBlciA9IGZ1bmN0aW9uIERheUNvbHVtbldyYXBwZXIoX3JlZikge1xuICB2YXIgY2hpbGRyZW4gPSBfcmVmLmNoaWxkcmVuLFxuICAgIGNsYXNzTmFtZSA9IF9yZWYuY2xhc3NOYW1lLFxuICAgIHN0eWxlID0gX3JlZi5zdHlsZSxcbiAgICBpbm5lclJlZiA9IF9yZWYuaW5uZXJSZWY7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgY2xhc3NOYW1lOiBjbGFzc05hbWUsXG4gICAgc3R5bGU6IHN0eWxlLFxuICAgIHJlZjogaW5uZXJSZWZcbiAgfSwgY2hpbGRyZW4pO1xufTtcbnZhciBEYXlDb2x1bW5XcmFwcGVyJDEgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiAocHJvcHMsIHJlZikge1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRGF5Q29sdW1uV3JhcHBlciwgT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMsIHtcbiAgICBpbm5lclJlZjogcmVmXG4gIH0pKTtcbn0pO1xuXG52YXIgX2V4Y2x1ZGVkJDUgPSBbXCJkYXlQcm9wXCJdLFxuICBfZXhjbHVkZWQyJDEgPSBbXCJldmVudENvbnRhaW5lcldyYXBwZXJcIl07XG52YXIgRGF5Q29sdW1uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIERheUNvbHVtbigpIHtcbiAgICB2YXIgX3RoaXM7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERheUNvbHVtbik7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIF9hcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgX2FyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuICAgIF90aGlzID0gX2NhbGxTdXBlcih0aGlzLCBEYXlDb2x1bW4sIFtdLmNvbmNhdChfYXJncykpO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgc2VsZWN0aW5nOiBmYWxzZSxcbiAgICAgIHRpbWVJbmRpY2F0b3JQb3NpdGlvbjogbnVsbFxuICAgIH07XG4gICAgX3RoaXMuaW50ZXJ2YWxUcmlnZ2VyZWQgPSBmYWxzZTtcbiAgICBfdGhpcy5yZW5kZXJFdmVudHMgPSBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgdmFyIGV2ZW50cyA9IF9yZWYuZXZlbnRzLFxuICAgICAgICBpc0JhY2tncm91bmRFdmVudCA9IF9yZWYuaXNCYWNrZ3JvdW5kRXZlbnQ7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgcnRsID0gX3RoaXMkcHJvcHMucnRsLFxuICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzLnNlbGVjdGVkLFxuICAgICAgICBhY2Nlc3NvcnMgPSBfdGhpcyRwcm9wcy5hY2Nlc3NvcnMsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzLmxvY2FsaXplcixcbiAgICAgICAgZ2V0dGVycyA9IF90aGlzJHByb3BzLmdldHRlcnMsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wcy5jb21wb25lbnRzLFxuICAgICAgICBzdGVwID0gX3RoaXMkcHJvcHMuc3RlcCxcbiAgICAgICAgdGltZXNsb3RzID0gX3RoaXMkcHJvcHMudGltZXNsb3RzLFxuICAgICAgICBkYXlMYXlvdXRBbGdvcml0aG0gPSBfdGhpcyRwcm9wcy5kYXlMYXlvdXRBbGdvcml0aG0sXG4gICAgICAgIHJlc2l6YWJsZSA9IF90aGlzJHByb3BzLnJlc2l6YWJsZTtcbiAgICAgIHZhciBfdGhpczIgPSBfdGhpcyxcbiAgICAgICAgc2xvdE1ldHJpY3MgPSBfdGhpczIuc2xvdE1ldHJpY3M7XG4gICAgICB2YXIgbWVzc2FnZXMgPSBsb2NhbGl6ZXIubWVzc2FnZXM7XG4gICAgICB2YXIgc3R5bGVkRXZlbnRzID0gZ2V0U3R5bGVkRXZlbnRzKHtcbiAgICAgICAgZXZlbnRzOiBldmVudHMsXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBzbG90TWV0cmljczogc2xvdE1ldHJpY3MsXG4gICAgICAgIG1pbmltdW1TdGFydERpZmZlcmVuY2U6IE1hdGguY2VpbChzdGVwICogdGltZXNsb3RzIC8gMiksXG4gICAgICAgIGRheUxheW91dEFsZ29yaXRobTogZGF5TGF5b3V0QWxnb3JpdGhtXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzdHlsZWRFdmVudHMubWFwKGZ1bmN0aW9uIChfcmVmMiwgaWR4KSB7XG4gICAgICAgIHZhciBldmVudCA9IF9yZWYyLmV2ZW50LFxuICAgICAgICAgIHN0eWxlID0gX3JlZjIuc3R5bGU7XG4gICAgICAgIHZhciBlbmQgPSBhY2Nlc3NvcnMuZW5kKGV2ZW50KTtcbiAgICAgICAgdmFyIHN0YXJ0ID0gYWNjZXNzb3JzLnN0YXJ0KGV2ZW50KTtcbiAgICAgICAgdmFyIGZvcm1hdCA9ICdldmVudFRpbWVSYW5nZUZvcm1hdCc7XG4gICAgICAgIHZhciBsYWJlbDtcbiAgICAgICAgdmFyIHN0YXJ0c0JlZm9yZURheSA9IHNsb3RNZXRyaWNzLnN0YXJ0c0JlZm9yZURheShzdGFydCk7XG4gICAgICAgIHZhciBzdGFydHNBZnRlckRheSA9IHNsb3RNZXRyaWNzLnN0YXJ0c0FmdGVyRGF5KGVuZCk7XG4gICAgICAgIGlmIChzdGFydHNCZWZvcmVEYXkpIGZvcm1hdCA9ICdldmVudFRpbWVSYW5nZUVuZEZvcm1hdCc7ZWxzZSBpZiAoc3RhcnRzQWZ0ZXJEYXkpIGZvcm1hdCA9ICdldmVudFRpbWVSYW5nZVN0YXJ0Rm9ybWF0JztcbiAgICAgICAgaWYgKHN0YXJ0c0JlZm9yZURheSAmJiBzdGFydHNBZnRlckRheSkgbGFiZWwgPSBtZXNzYWdlcy5hbGxEYXk7ZWxzZSBsYWJlbCA9IGxvY2FsaXplci5mb3JtYXQoe1xuICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICBlbmQ6IGVuZFxuICAgICAgICB9LCBmb3JtYXQpO1xuICAgICAgICB2YXIgY29udGludWVzUHJpb3IgPSBzdGFydHNCZWZvcmVEYXkgfHwgc2xvdE1ldHJpY3Muc3RhcnRzQmVmb3JlKHN0YXJ0KTtcbiAgICAgICAgdmFyIGNvbnRpbnVlc0FmdGVyID0gc3RhcnRzQWZ0ZXJEYXkgfHwgc2xvdE1ldHJpY3Muc3RhcnRzQWZ0ZXIoZW5kKTtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRpbWVHcmlkRXZlbnQsIHtcbiAgICAgICAgICBzdHlsZTogc3R5bGUsXG4gICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgICBrZXk6ICdldnRfJyArIGlkeCxcbiAgICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICAgIHJ0bDogcnRsLFxuICAgICAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudHMsXG4gICAgICAgICAgY29udGludWVzUHJpb3I6IGNvbnRpbnVlc1ByaW9yLFxuICAgICAgICAgIGNvbnRpbnVlc0FmdGVyOiBjb250aW51ZXNBZnRlcixcbiAgICAgICAgICBhY2Nlc3NvcnM6IGFjY2Vzc29ycyxcbiAgICAgICAgICByZXNvdXJjZTogX3RoaXMucHJvcHMucmVzb3VyY2UsXG4gICAgICAgICAgc2VsZWN0ZWQ6IGlzU2VsZWN0ZWQoZXZlbnQsIHNlbGVjdGVkKSxcbiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5fc2VsZWN0KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBldmVudCksIF90aGlzLnByb3BzLnJlc291cmNlICYmIHtcbiAgICAgICAgICAgICAgc291cmNlUmVzb3VyY2U6IF90aGlzLnByb3BzLnJlc291cmNlXG4gICAgICAgICAgICB9KSwgaXNCYWNrZ3JvdW5kRXZlbnQgJiYge1xuICAgICAgICAgICAgICBpc0JhY2tncm91bmRFdmVudDogdHJ1ZVxuICAgICAgICAgICAgfSksIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25Eb3VibGVDbGljazogZnVuY3Rpb24gb25Eb3VibGVDbGljayhlKSB7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuX2RvdWJsZUNsaWNrKGV2ZW50LCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGlzQmFja2dyb3VuZEV2ZW50OiBpc0JhY2tncm91bmRFdmVudCxcbiAgICAgICAgICBvbktleVByZXNzOiBmdW5jdGlvbiBvbktleVByZXNzKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5fa2V5UHJlc3MoZXZlbnQsIGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVzaXphYmxlOiByZXNpemFibGVcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIF90aGlzLl9zZWxlY3RhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIG5vZGUgPSBfdGhpcy5jb250YWluZXJSZWYuY3VycmVudDtcbiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgbG9uZ1ByZXNzVGhyZXNob2xkID0gX3RoaXMkcHJvcHMyLmxvbmdQcmVzc1RocmVzaG9sZCxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMyLmxvY2FsaXplcjtcbiAgICAgIHZhciBzZWxlY3RvciA9IF90aGlzLl9zZWxlY3RvciA9IG5ldyBTZWxlY3Rpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgIH0sIHtcbiAgICAgICAgbG9uZ1ByZXNzVGhyZXNob2xkOiBsb25nUHJlc3NUaHJlc2hvbGRcbiAgICAgIH0pO1xuICAgICAgdmFyIG1heWJlU2VsZWN0ID0gZnVuY3Rpb24gbWF5YmVTZWxlY3QoYm94KSB7XG4gICAgICAgIHZhciBvblNlbGVjdGluZyA9IF90aGlzLnByb3BzLm9uU2VsZWN0aW5nO1xuICAgICAgICB2YXIgY3VycmVudCA9IF90aGlzLnN0YXRlIHx8IHt9O1xuICAgICAgICB2YXIgc3RhdGUgPSBzZWxlY3Rpb25TdGF0ZShib3gpO1xuICAgICAgICB2YXIgc3RhcnQgPSBzdGF0ZS5zdGFydERhdGUsXG4gICAgICAgICAgZW5kID0gc3RhdGUuZW5kRGF0ZTtcbiAgICAgICAgaWYgKG9uU2VsZWN0aW5nKSB7XG4gICAgICAgICAgaWYgKGxvY2FsaXplci5lcShjdXJyZW50LnN0YXJ0RGF0ZSwgc3RhcnQsICdtaW51dGVzJykgJiYgbG9jYWxpemVyLmVxKGN1cnJlbnQuZW5kRGF0ZSwgZW5kLCAnbWludXRlcycpIHx8IG9uU2VsZWN0aW5nKHtcbiAgICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICAgIGVuZDogZW5kLFxuICAgICAgICAgICAgcmVzb3VyY2VJZDogX3RoaXMucHJvcHMucmVzb3VyY2VcbiAgICAgICAgICB9KSA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX3RoaXMuc3RhdGUuc3RhcnQgIT09IHN0YXRlLnN0YXJ0IHx8IF90aGlzLnN0YXRlLmVuZCAhPT0gc3RhdGUuZW5kIHx8IF90aGlzLnN0YXRlLnNlbGVjdGluZyAhPT0gc3RhdGUuc2VsZWN0aW5nKSB7XG4gICAgICAgICAgX3RoaXMuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgdmFyIHNlbGVjdGlvblN0YXRlID0gZnVuY3Rpb24gc2VsZWN0aW9uU3RhdGUocG9pbnQpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRTbG90ID0gX3RoaXMuc2xvdE1ldHJpY3MuY2xvc2VzdFNsb3RGcm9tUG9pbnQocG9pbnQsIGdldEJvdW5kc0Zvck5vZGUobm9kZSkpO1xuICAgICAgICBpZiAoIV90aGlzLnN0YXRlLnNlbGVjdGluZykge1xuICAgICAgICAgIF90aGlzLl9pbml0aWFsU2xvdCA9IGN1cnJlbnRTbG90O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbml0aWFsU2xvdCA9IF90aGlzLl9pbml0aWFsU2xvdDtcbiAgICAgICAgaWYgKGxvY2FsaXplci5sdGUoaW5pdGlhbFNsb3QsIGN1cnJlbnRTbG90KSkge1xuICAgICAgICAgIGN1cnJlbnRTbG90ID0gX3RoaXMuc2xvdE1ldHJpY3MubmV4dFNsb3QoY3VycmVudFNsb3QpO1xuICAgICAgICB9IGVsc2UgaWYgKGxvY2FsaXplci5ndChpbml0aWFsU2xvdCwgY3VycmVudFNsb3QpKSB7XG4gICAgICAgICAgaW5pdGlhbFNsb3QgPSBfdGhpcy5zbG90TWV0cmljcy5uZXh0U2xvdChpbml0aWFsU2xvdCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbGVjdFJhbmdlID0gX3RoaXMuc2xvdE1ldHJpY3MuZ2V0UmFuZ2UobG9jYWxpemVyLm1pbihpbml0aWFsU2xvdCwgY3VycmVudFNsb3QpLCBsb2NhbGl6ZXIubWF4KGluaXRpYWxTbG90LCBjdXJyZW50U2xvdCkpO1xuICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzZWxlY3RSYW5nZSksIHt9LCB7XG4gICAgICAgICAgc2VsZWN0aW5nOiB0cnVlLFxuICAgICAgICAgIHRvcDogXCJcIi5jb25jYXQoc2VsZWN0UmFuZ2UudG9wLCBcIiVcIiksXG4gICAgICAgICAgaGVpZ2h0OiBcIlwiLmNvbmNhdChzZWxlY3RSYW5nZS5oZWlnaHQsIFwiJVwiKVxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICB2YXIgc2VsZWN0b3JDbGlja3NIYW5kbGVyID0gZnVuY3Rpb24gc2VsZWN0b3JDbGlja3NIYW5kbGVyKGJveCwgYWN0aW9uVHlwZSkge1xuICAgICAgICBpZiAoIWlzRXZlbnQoX3RoaXMuY29udGFpbmVyUmVmLmN1cnJlbnQsIGJveCkpIHtcbiAgICAgICAgICB2YXIgX3NlbGVjdGlvblN0YXRlID0gc2VsZWN0aW9uU3RhdGUoYm94KSxcbiAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IF9zZWxlY3Rpb25TdGF0ZS5zdGFydERhdGUsXG4gICAgICAgICAgICBlbmREYXRlID0gX3NlbGVjdGlvblN0YXRlLmVuZERhdGU7XG4gICAgICAgICAgX3RoaXMuX3NlbGVjdFNsb3Qoe1xuICAgICAgICAgICAgc3RhcnREYXRlOiBzdGFydERhdGUsXG4gICAgICAgICAgICBlbmREYXRlOiBlbmREYXRlLFxuICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb25UeXBlLFxuICAgICAgICAgICAgYm94OiBib3hcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgc2VsZWN0aW5nOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICBzZWxlY3Rvci5vbignc2VsZWN0aW5nJywgbWF5YmVTZWxlY3QpO1xuICAgICAgc2VsZWN0b3Iub24oJ3NlbGVjdFN0YXJ0JywgbWF5YmVTZWxlY3QpO1xuICAgICAgc2VsZWN0b3Iub24oJ2JlZm9yZVNlbGVjdCcsIGZ1bmN0aW9uIChib3gpIHtcbiAgICAgICAgaWYgKF90aGlzLnByb3BzLnNlbGVjdGFibGUgIT09ICdpZ25vcmVFdmVudHMnKSByZXR1cm47XG4gICAgICAgIHJldHVybiAhaXNFdmVudChfdGhpcy5jb250YWluZXJSZWYuY3VycmVudCwgYm94KTtcbiAgICAgIH0pO1xuICAgICAgc2VsZWN0b3Iub24oJ2NsaWNrJywgZnVuY3Rpb24gKGJveCkge1xuICAgICAgICByZXR1cm4gc2VsZWN0b3JDbGlja3NIYW5kbGVyKGJveCwgJ2NsaWNrJyk7XG4gICAgICB9KTtcbiAgICAgIHNlbGVjdG9yLm9uKCdkb3VibGVDbGljaycsIGZ1bmN0aW9uIChib3gpIHtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yQ2xpY2tzSGFuZGxlcihib3gsICdkb3VibGVDbGljaycpO1xuICAgICAgfSk7XG4gICAgICBzZWxlY3Rvci5vbignc2VsZWN0JywgZnVuY3Rpb24gKGJvdW5kcykge1xuICAgICAgICBpZiAoX3RoaXMuc3RhdGUuc2VsZWN0aW5nKSB7XG4gICAgICAgICAgX3RoaXMuX3NlbGVjdFNsb3QoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5zdGF0ZSksIHt9LCB7XG4gICAgICAgICAgICBhY3Rpb246ICdzZWxlY3QnLFxuICAgICAgICAgICAgYm91bmRzOiBib3VuZHNcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgc2VsZWN0aW5nOiBmYWxzZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHNlbGVjdG9yLm9uKCdyZXNldCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKF90aGlzLnN0YXRlLnNlbGVjdGluZykge1xuICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlbGVjdGluZzogZmFsc2VcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBfdGhpcy5fdGVhcmRvd25TZWxlY3RhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCFfdGhpcy5fc2VsZWN0b3IpIHJldHVybjtcbiAgICAgIF90aGlzLl9zZWxlY3Rvci50ZWFyZG93bigpO1xuICAgICAgX3RoaXMuX3NlbGVjdG9yID0gbnVsbDtcbiAgICB9O1xuICAgIF90aGlzLl9zZWxlY3RTbG90ID0gZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICB2YXIgc3RhcnREYXRlID0gX3JlZjMuc3RhcnREYXRlLFxuICAgICAgICBlbmREYXRlID0gX3JlZjMuZW5kRGF0ZSxcbiAgICAgICAgYWN0aW9uID0gX3JlZjMuYWN0aW9uLFxuICAgICAgICBib3VuZHMgPSBfcmVmMy5ib3VuZHMsXG4gICAgICAgIGJveCA9IF9yZWYzLmJveDtcbiAgICAgIHZhciBjdXJyZW50ID0gc3RhcnREYXRlLFxuICAgICAgICBzbG90cyA9IFtdO1xuICAgICAgd2hpbGUgKF90aGlzLnByb3BzLmxvY2FsaXplci5sdGUoY3VycmVudCwgZW5kRGF0ZSkpIHtcbiAgICAgICAgc2xvdHMucHVzaChjdXJyZW50KTtcbiAgICAgICAgY3VycmVudCA9IG5ldyBEYXRlKCtjdXJyZW50ICsgX3RoaXMucHJvcHMuc3RlcCAqIDYwICogMTAwMCk7IC8vIHVzaW5nIERhdGUgZW5zdXJlcyBub3QgdG8gY3JlYXRlIGFuIGVuZGxlc3MgbG9vcCB0aGUgZGF5IERTVCBiZWdpbnNcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vblNlbGVjdFNsb3QsIHtcbiAgICAgICAgc2xvdHM6IHNsb3RzLFxuICAgICAgICBzdGFydDogc3RhcnREYXRlLFxuICAgICAgICBlbmQ6IGVuZERhdGUsXG4gICAgICAgIHJlc291cmNlSWQ6IF90aGlzLnByb3BzLnJlc291cmNlLFxuICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgYm91bmRzOiBib3VuZHMsXG4gICAgICAgIGJveDogYm94XG4gICAgICB9KTtcbiAgICB9O1xuICAgIF90aGlzLl9zZWxlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgYXJnc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uU2VsZWN0RXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuX2RvdWJsZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4zKSwgX2tleTMgPSAwOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7XG4gICAgICAgIGFyZ3NbX2tleTNdID0gYXJndW1lbnRzW19rZXkzXTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vbkRvdWJsZUNsaWNrRXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuX2tleVByZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW40KSwgX2tleTQgPSAwOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7XG4gICAgICAgIGFyZ3NbX2tleTRdID0gYXJndW1lbnRzW19rZXk0XTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vbktleVByZXNzRXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuc2xvdE1ldHJpY3MgPSBnZXRTbG90TWV0cmljcyhfdGhpcy5wcm9wcyk7XG4gICAgX3RoaXMuY29udGFpbmVyUmVmID0gLyojX19QVVJFX18qL2NyZWF0ZVJlZigpO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuICBfaW5oZXJpdHMoRGF5Q29sdW1uLCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhEYXlDb2x1bW4sIFt7XG4gICAga2V5OiBcImNvbXBvbmVudERpZE1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5wcm9wcy5zZWxlY3RhYmxlICYmIHRoaXMuX3NlbGVjdGFibGUoKTtcbiAgICAgIGlmICh0aGlzLnByb3BzLmlzTm93KSB7XG4gICAgICAgIHRoaXMuc2V0VGltZUluZGljYXRvclBvc2l0aW9uVXBkYXRlSW50ZXJ2YWwoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50V2lsbFVubW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLl90ZWFyZG93blNlbGVjdGFibGUoKTtcbiAgICAgIHRoaXMuY2xlYXJUaW1lSW5kaWNhdG9ySW50ZXJ2YWwoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50RGlkVXBkYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgaWYgKHRoaXMucHJvcHMuc2VsZWN0YWJsZSAmJiAhcHJldlByb3BzLnNlbGVjdGFibGUpIHRoaXMuX3NlbGVjdGFibGUoKTtcbiAgICAgIGlmICghdGhpcy5wcm9wcy5zZWxlY3RhYmxlICYmIHByZXZQcm9wcy5zZWxlY3RhYmxlKSB0aGlzLl90ZWFyZG93blNlbGVjdGFibGUoKTtcbiAgICAgIHZhciBfdGhpcyRwcm9wczMgPSB0aGlzLnByb3BzLFxuICAgICAgICBnZXROb3cgPSBfdGhpcyRwcm9wczMuZ2V0Tm93LFxuICAgICAgICBpc05vdyA9IF90aGlzJHByb3BzMy5pc05vdyxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMzLmxvY2FsaXplcixcbiAgICAgICAgZGF0ZSA9IF90aGlzJHByb3BzMy5kYXRlLFxuICAgICAgICBtaW4gPSBfdGhpcyRwcm9wczMubWluLFxuICAgICAgICBtYXggPSBfdGhpcyRwcm9wczMubWF4O1xuICAgICAgdmFyIGdldE5vd0NoYW5nZWQgPSBsb2NhbGl6ZXIubmVxKHByZXZQcm9wcy5nZXROb3coKSwgZ2V0Tm93KCksICdtaW51dGVzJyk7XG4gICAgICBpZiAocHJldlByb3BzLmlzTm93ICE9PSBpc05vdyB8fCBnZXROb3dDaGFuZ2VkKSB7XG4gICAgICAgIHRoaXMuY2xlYXJUaW1lSW5kaWNhdG9ySW50ZXJ2YWwoKTtcbiAgICAgICAgaWYgKGlzTm93KSB7XG4gICAgICAgICAgdmFyIHRhaWwgPSAhZ2V0Tm93Q2hhbmdlZCAmJiBsb2NhbGl6ZXIuZXEocHJldlByb3BzLmRhdGUsIGRhdGUsICdtaW51dGVzJykgJiYgcHJldlN0YXRlLnRpbWVJbmRpY2F0b3JQb3NpdGlvbiA9PT0gdGhpcy5zdGF0ZS50aW1lSW5kaWNhdG9yUG9zaXRpb247XG4gICAgICAgICAgdGhpcy5zZXRUaW1lSW5kaWNhdG9yUG9zaXRpb25VcGRhdGVJbnRlcnZhbCh0YWlsKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChpc05vdyAmJiAobG9jYWxpemVyLm5lcShwcmV2UHJvcHMubWluLCBtaW4sICdtaW51dGVzJykgfHwgbG9jYWxpemVyLm5lcShwcmV2UHJvcHMubWF4LCBtYXgsICdtaW51dGVzJykpKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb25UaW1lSW5kaWNhdG9yKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHRhaWwge0Jvb2xlYW59IC0gd2hldGhlciBgcG9zaXRpb25UaW1lSW5kaWNhdG9yYCBjYWxsIHNob3VsZCBiZVxuICAgICAqICAgZGVmZXJyZWQgb3IgY2FsbGVkIHVwb24gc2V0dGluZyBpbnRlcnZhbCAoYHRydWVgIC0gaWYgZGVmZXJyZWQpO1xuICAgICAqL1xuICB9LCB7XG4gICAga2V5OiBcInNldFRpbWVJbmRpY2F0b3JQb3NpdGlvblVwZGF0ZUludGVydmFsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRpbWVJbmRpY2F0b3JQb3NpdGlvblVwZGF0ZUludGVydmFsKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG4gICAgICB2YXIgdGFpbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgICBpZiAoIXRoaXMuaW50ZXJ2YWxUcmlnZ2VyZWQgJiYgIXRhaWwpIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvblRpbWVJbmRpY2F0b3IoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3RpbWVJbmRpY2F0b3JUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczMuaW50ZXJ2YWxUcmlnZ2VyZWQgPSB0cnVlO1xuICAgICAgICBfdGhpczMucG9zaXRpb25UaW1lSW5kaWNhdG9yKCk7XG4gICAgICAgIF90aGlzMy5zZXRUaW1lSW5kaWNhdG9yUG9zaXRpb25VcGRhdGVJbnRlcnZhbCgpO1xuICAgICAgfSwgNjAwMDApO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbGVhclRpbWVJbmRpY2F0b3JJbnRlcnZhbFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhclRpbWVJbmRpY2F0b3JJbnRlcnZhbCgpIHtcbiAgICAgIHRoaXMuaW50ZXJ2YWxUcmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fdGltZUluZGljYXRvclRpbWVvdXQpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwb3NpdGlvblRpbWVJbmRpY2F0b3JcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcG9zaXRpb25UaW1lSW5kaWNhdG9yKCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsXG4gICAgICAgIG1pbiA9IF90aGlzJHByb3BzNC5taW4sXG4gICAgICAgIG1heCA9IF90aGlzJHByb3BzNC5tYXgsXG4gICAgICAgIGdldE5vdyA9IF90aGlzJHByb3BzNC5nZXROb3c7XG4gICAgICB2YXIgY3VycmVudCA9IGdldE5vdygpO1xuICAgICAgaWYgKGN1cnJlbnQgPj0gbWluICYmIGN1cnJlbnQgPD0gbWF4KSB7XG4gICAgICAgIHZhciB0b3AgPSB0aGlzLnNsb3RNZXRyaWNzLmdldEN1cnJlbnRUaW1lUG9zaXRpb24oY3VycmVudCk7XG4gICAgICAgIHRoaXMuaW50ZXJ2YWxUcmlnZ2VyZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICB0aW1lSW5kaWNhdG9yUG9zaXRpb246IHRvcFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2xlYXJUaW1lSW5kaWNhdG9ySW50ZXJ2YWwoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczUgPSB0aGlzLnByb3BzLFxuICAgICAgICBkYXRlID0gX3RoaXMkcHJvcHM1LmRhdGUsXG4gICAgICAgIG1heCA9IF90aGlzJHByb3BzNS5tYXgsXG4gICAgICAgIHJ0bCA9IF90aGlzJHByb3BzNS5ydGwsXG4gICAgICAgIGlzTm93ID0gX3RoaXMkcHJvcHM1LmlzTm93LFxuICAgICAgICByZXNvdXJjZSA9IF90aGlzJHByb3BzNS5yZXNvdXJjZSxcbiAgICAgICAgYWNjZXNzb3JzID0gX3RoaXMkcHJvcHM1LmFjY2Vzc29ycyxcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHM1LmxvY2FsaXplcixcbiAgICAgICAgX3RoaXMkcHJvcHM1JGdldHRlcnMgPSBfdGhpcyRwcm9wczUuZ2V0dGVycyxcbiAgICAgICAgZGF5UHJvcCA9IF90aGlzJHByb3BzNSRnZXR0ZXJzLmRheVByb3AsXG4gICAgICAgIGdldHRlcnMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3RoaXMkcHJvcHM1JGdldHRlcnMsIF9leGNsdWRlZCQ1KSxcbiAgICAgICAgX3RoaXMkcHJvcHM1JGNvbXBvbmVuID0gX3RoaXMkcHJvcHM1LmNvbXBvbmVudHMsXG4gICAgICAgIEV2ZW50Q29udGFpbmVyID0gX3RoaXMkcHJvcHM1JGNvbXBvbmVuLmV2ZW50Q29udGFpbmVyV3JhcHBlcixcbiAgICAgICAgY29tcG9uZW50cyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfdGhpcyRwcm9wczUkY29tcG9uZW4sIF9leGNsdWRlZDIkMSk7XG4gICAgICB0aGlzLnNsb3RNZXRyaWNzID0gdGhpcy5zbG90TWV0cmljcy51cGRhdGUodGhpcy5wcm9wcyk7XG4gICAgICB2YXIgc2xvdE1ldHJpY3MgPSB0aGlzLnNsb3RNZXRyaWNzO1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gdGhpcy5zdGF0ZSxcbiAgICAgICAgc2VsZWN0aW5nID0gX3RoaXMkc3RhdGUuc2VsZWN0aW5nLFxuICAgICAgICB0b3AgPSBfdGhpcyRzdGF0ZS50b3AsXG4gICAgICAgIGhlaWdodCA9IF90aGlzJHN0YXRlLmhlaWdodCxcbiAgICAgICAgc3RhcnREYXRlID0gX3RoaXMkc3RhdGUuc3RhcnREYXRlLFxuICAgICAgICBlbmREYXRlID0gX3RoaXMkc3RhdGUuZW5kRGF0ZTtcbiAgICAgIHZhciBzZWxlY3REYXRlcyA9IHtcbiAgICAgICAgc3RhcnQ6IHN0YXJ0RGF0ZSxcbiAgICAgICAgZW5kOiBlbmREYXRlXG4gICAgICB9O1xuICAgICAgdmFyIF9kYXlQcm9wID0gZGF5UHJvcChtYXgpLFxuICAgICAgICBjbGFzc05hbWUgPSBfZGF5UHJvcC5jbGFzc05hbWUsXG4gICAgICAgIHN0eWxlID0gX2RheVByb3Auc3R5bGU7XG4gICAgICB2YXIgRGF5Q29sdW1uV3JhcHBlckNvbXBvbmVudCA9IGNvbXBvbmVudHMuZGF5Q29sdW1uV3JhcHBlciB8fCBEYXlDb2x1bW5XcmFwcGVyJDE7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRGF5Q29sdW1uV3JhcHBlckNvbXBvbmVudCwge1xuICAgICAgICByZWY6IHRoaXMuY29udGFpbmVyUmVmLFxuICAgICAgICBkYXRlOiBkYXRlLFxuICAgICAgICBzdHlsZTogc3R5bGUsXG4gICAgICAgIGNsYXNzTmFtZTogY2xzeChjbGFzc05hbWUsICdyYmMtZGF5LXNsb3QnLCAncmJjLXRpbWUtY29sdW1uJywgaXNOb3cgJiYgJ3JiYy1ub3cnLCBpc05vdyAmJiAncmJjLXRvZGF5JyxcbiAgICAgICAgLy8gV0hZXG4gICAgICAgIHNlbGVjdGluZyAmJiAncmJjLXNsb3Qtc2VsZWN0aW5nJyksXG4gICAgICAgIHNsb3RNZXRyaWNzOiBzbG90TWV0cmljcyxcbiAgICAgICAgcmVzb3VyY2U6IHJlc291cmNlXG4gICAgICB9LCBzbG90TWV0cmljcy5ncm91cHMubWFwKGZ1bmN0aW9uIChncnAsIGlkeCkge1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVGltZVNsb3RHcm91cCwge1xuICAgICAgICAgIGtleTogaWR4LFxuICAgICAgICAgIGdyb3VwOiBncnAsXG4gICAgICAgICAgcmVzb3VyY2U6IHJlc291cmNlLFxuICAgICAgICAgIGdldHRlcnM6IGdldHRlcnMsXG4gICAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50c1xuICAgICAgICB9KTtcbiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFdmVudENvbnRhaW5lciwge1xuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgcmVzb3VyY2U6IHJlc291cmNlLFxuICAgICAgICBhY2Nlc3NvcnM6IGFjY2Vzc29ycyxcbiAgICAgICAgZ2V0dGVyczogZ2V0dGVycyxcbiAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgc2xvdE1ldHJpY3M6IHNsb3RNZXRyaWNzXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xzeCgncmJjLWV2ZW50cy1jb250YWluZXInLCBydGwgJiYgJ3J0bCcpXG4gICAgICB9LCB0aGlzLnJlbmRlckV2ZW50cyh7XG4gICAgICAgIGV2ZW50czogdGhpcy5wcm9wcy5iYWNrZ3JvdW5kRXZlbnRzLFxuICAgICAgICBpc0JhY2tncm91bmRFdmVudDogdHJ1ZVxuICAgICAgfSksIHRoaXMucmVuZGVyRXZlbnRzKHtcbiAgICAgICAgZXZlbnRzOiB0aGlzLnByb3BzLmV2ZW50c1xuICAgICAgfSkpKSwgc2VsZWN0aW5nICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1zbG90LXNlbGVjdGlvblwiLFxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgICAgIH1cbiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCBudWxsLCBsb2NhbGl6ZXIuZm9ybWF0KHNlbGVjdERhdGVzLCAnc2VsZWN0UmFuZ2VGb3JtYXQnKSkpLCBpc05vdyAmJiB0aGlzLmludGVydmFsVHJpZ2dlcmVkICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1jdXJyZW50LXRpbWUtaW5kaWNhdG9yXCIsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgdG9wOiBcIlwiLmNvbmNhdCh0aGlzLnN0YXRlLnRpbWVJbmRpY2F0b3JQb3NpdGlvbiwgXCIlXCIpXG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcbkRheUNvbHVtbi5kZWZhdWx0UHJvcHMgPSB7XG4gIGRyYWdUaHJvdWdoRXZlbnRzOiB0cnVlLFxuICB0aW1lc2xvdHM6IDJcbn07XG5cbi8qKlxuICogU2luY2UgdGhlIFRpbWVHdXR0ZXIgb25seSBkaXNwbGF5cyB0aGUgJ3RpbWVzJyBvZiBzbG90cyBpbiBhIGRheSwgYW5kIGlzIHNlcGFyYXRlXG4gKiBmcm9tIHRoZSBEYXkgQ29sdW1ucyB0aGVtc2VsdmVzLCB3ZSBjaGVjayB0byBzZWUgaWYgdGhlIHJhbmdlIGNvbnRhaW5zIGFuIG9mZnNldCBkaWZmZXJlbmNlXG4gKiBhbmQsIGlmIHNvLCBjaGFuZ2UgdGhlIGJlZ2lubmluZyBhbmQgZW5kICdkYXRlJyBieSBhIGRheSB0byBwcm9wZXJseSBkaXNwbGF5IHRoZSBzbG90cyB0aW1lc1xuICogdXNlZC5cbiAqL1xuZnVuY3Rpb24gYWRqdXN0Rm9yRFNUKF9yZWYpIHtcbiAgdmFyIG1pbiA9IF9yZWYubWluLFxuICAgIG1heCA9IF9yZWYubWF4LFxuICAgIGxvY2FsaXplciA9IF9yZWYubG9jYWxpemVyO1xuICBpZiAobG9jYWxpemVyLmdldFRpbWV6b25lT2Zmc2V0KG1pbikgIT09IGxvY2FsaXplci5nZXRUaW1lem9uZU9mZnNldChtYXgpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXJ0OiBsb2NhbGl6ZXIuYWRkKG1pbiwgLTEsICdkYXknKSxcbiAgICAgIGVuZDogbG9jYWxpemVyLmFkZChtYXgsIC0xLCAnZGF5JylcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgc3RhcnQ6IG1pbixcbiAgICBlbmQ6IG1heFxuICB9O1xufVxudmFyIFRpbWVHdXR0ZXIgPSBmdW5jdGlvbiBUaW1lR3V0dGVyKF9yZWYyKSB7XG4gIHZhciBtaW4gPSBfcmVmMi5taW4sXG4gICAgbWF4ID0gX3JlZjIubWF4LFxuICAgIHRpbWVzbG90cyA9IF9yZWYyLnRpbWVzbG90cyxcbiAgICBzdGVwID0gX3JlZjIuc3RlcCxcbiAgICBsb2NhbGl6ZXIgPSBfcmVmMi5sb2NhbGl6ZXIsXG4gICAgZ2V0Tm93ID0gX3JlZjIuZ2V0Tm93LFxuICAgIHJlc291cmNlID0gX3JlZjIucmVzb3VyY2UsXG4gICAgY29tcG9uZW50cyA9IF9yZWYyLmNvbXBvbmVudHMsXG4gICAgZ2V0dGVycyA9IF9yZWYyLmdldHRlcnMsXG4gICAgZ3V0dGVyUmVmID0gX3JlZjIuZ3V0dGVyUmVmO1xuICB2YXIgVGltZUd1dHRlcldyYXBwZXIgPSBjb21wb25lbnRzLnRpbWVHdXR0ZXJXcmFwcGVyO1xuICB2YXIgX3VzZU1lbW8gPSB1c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBhZGp1c3RGb3JEU1Qoe1xuICAgICAgICBtaW46IG1pbixcbiAgICAgICAgbWF4OiBtYXgsXG4gICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gICAgICB9KTtcbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICBbbWluID09PSBudWxsIHx8IG1pbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWluLnRvSVNPU3RyaW5nKCksIG1heCA9PT0gbnVsbCB8fCBtYXggPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1heC50b0lTT1N0cmluZygpLCBsb2NhbGl6ZXJdKSxcbiAgICBzdGFydCA9IF91c2VNZW1vLnN0YXJ0LFxuICAgIGVuZCA9IF91c2VNZW1vLmVuZDtcbiAgdmFyIF91c2VTdGF0ZSA9IHVzZVN0YXRlKGdldFNsb3RNZXRyaWNzKHtcbiAgICAgIG1pbjogc3RhcnQsXG4gICAgICBtYXg6IGVuZCxcbiAgICAgIHRpbWVzbG90czogdGltZXNsb3RzLFxuICAgICAgc3RlcDogc3RlcCxcbiAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gICAgfSkpLFxuICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLFxuICAgIHNsb3RNZXRyaWNzID0gX3VzZVN0YXRlMlswXSxcbiAgICBzZXRTbG90TWV0cmljcyA9IF91c2VTdGF0ZTJbMV07XG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHNsb3RNZXRyaWNzKSB7XG4gICAgICBzZXRTbG90TWV0cmljcyhzbG90TWV0cmljcy51cGRhdGUoe1xuICAgICAgICBtaW46IHN0YXJ0LFxuICAgICAgICBtYXg6IGVuZCxcbiAgICAgICAgdGltZXNsb3RzOiB0aW1lc2xvdHMsXG4gICAgICAgIHN0ZXA6IHN0ZXAsXG4gICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdlIGRvbid0IHdhbnQgdGhpcyB0byBmaXJlIHdoZW4gc2xvdE1ldHJpY3MgaXMgdXBkYXRlZCBhcyBpdCB3b3VsZCByZWN1cnNpdmVseSBib21iXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbc3RhcnQgPT09IG51bGwgfHwgc3RhcnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0YXJ0LnRvSVNPU3RyaW5nKCksIGVuZCA9PT0gbnVsbCB8fCBlbmQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVuZC50b0lTT1N0cmluZygpLCB0aW1lc2xvdHMsIHN0ZXBdKTtcbiAgdmFyIHJlbmRlclNsb3QgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAodmFsdWUsIGlkeCkge1xuICAgIGlmIChpZHgpIHJldHVybiBudWxsOyAvLyBkb24ndCByZXR1cm4gdGhlIGZpcnN0ICgwKSBpZHhcblxuICAgIHZhciBpc05vdyA9IHNsb3RNZXRyaWNzLmRhdGVJc0luR3JvdXAoZ2V0Tm93KCksIGlkeCk7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7XG4gICAgICBjbGFzc05hbWU6IGNsc3goJ3JiYy1sYWJlbCcsIGlzTm93ICYmICdyYmMtbm93JylcbiAgICB9LCBsb2NhbGl6ZXIuZm9ybWF0KHZhbHVlLCAndGltZUd1dHRlckZvcm1hdCcpKTtcbiAgfSwgW3Nsb3RNZXRyaWNzLCBsb2NhbGl6ZXIsIGdldE5vd10pO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVGltZUd1dHRlcldyYXBwZXIsIHtcbiAgICBzbG90TWV0cmljczogc2xvdE1ldHJpY3NcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIGNsYXNzTmFtZTogXCJyYmMtdGltZS1ndXR0ZXIgcmJjLXRpbWUtY29sdW1uXCIsXG4gICAgcmVmOiBndXR0ZXJSZWZcbiAgfSwgc2xvdE1ldHJpY3MuZ3JvdXBzLm1hcChmdW5jdGlvbiAoZ3JwLCBpZHgpIHtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVGltZVNsb3RHcm91cCwge1xuICAgICAga2V5OiBpZHgsXG4gICAgICBncm91cDogZ3JwLFxuICAgICAgcmVzb3VyY2U6IHJlc291cmNlLFxuICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgIHJlbmRlclNsb3Q6IHJlbmRlclNsb3QsXG4gICAgICBnZXR0ZXJzOiBnZXR0ZXJzXG4gICAgfSk7XG4gIH0pKSk7XG59O1xudmFyIFRpbWVHdXR0ZXIkMSA9IC8qI19fUFVSRV9fKi9SZWFjdC5mb3J3YXJkUmVmKGZ1bmN0aW9uIChwcm9wcywgcmVmKSB7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUaW1lR3V0dGVyLCBPYmplY3QuYXNzaWduKHtcbiAgICBndXR0ZXJSZWY6IHJlZlxuICB9LCBwcm9wcykpO1xufSk7XG5cbnZhciBSZXNvdXJjZUhlYWRlciA9IGZ1bmN0aW9uIFJlc291cmNlSGVhZGVyKF9yZWYpIHtcbiAgdmFyIGxhYmVsID0gX3JlZi5sYWJlbDtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCBsYWJlbCk7XG59O1xuXG52YXIgVGltZUdyaWRIZWFkZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgZnVuY3Rpb24gVGltZUdyaWRIZWFkZXIoKSB7XG4gICAgdmFyIF90aGlzO1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUaW1lR3JpZEhlYWRlcik7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cbiAgICBfdGhpcyA9IF9jYWxsU3VwZXIodGhpcywgVGltZUdyaWRIZWFkZXIsIFtdLmNvbmNhdChhcmdzKSk7XG4gICAgX3RoaXMuaGFuZGxlSGVhZGVyQ2xpY2sgPSBmdW5jdGlvbiAoZGF0ZSwgdmlldywgZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uRHJpbGxEb3duLCBbZGF0ZSwgdmlld10pO1xuICAgIH07XG4gICAgX3RoaXMucmVuZGVyUm93ID0gZnVuY3Rpb24gKHJlc291cmNlKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgZXZlbnRzID0gX3RoaXMkcHJvcHMuZXZlbnRzLFxuICAgICAgICBydGwgPSBfdGhpcyRwcm9wcy5ydGwsXG4gICAgICAgIHNlbGVjdGFibGUgPSBfdGhpcyRwcm9wcy5zZWxlY3RhYmxlLFxuICAgICAgICBnZXROb3cgPSBfdGhpcyRwcm9wcy5nZXROb3csXG4gICAgICAgIHJhbmdlID0gX3RoaXMkcHJvcHMucmFuZ2UsXG4gICAgICAgIGdldHRlcnMgPSBfdGhpcyRwcm9wcy5nZXR0ZXJzLFxuICAgICAgICBsb2NhbGl6ZXIgPSBfdGhpcyRwcm9wcy5sb2NhbGl6ZXIsXG4gICAgICAgIGFjY2Vzc29ycyA9IF90aGlzJHByb3BzLmFjY2Vzc29ycyxcbiAgICAgICAgY29tcG9uZW50cyA9IF90aGlzJHByb3BzLmNvbXBvbmVudHMsXG4gICAgICAgIHJlc2l6YWJsZSA9IF90aGlzJHByb3BzLnJlc2l6YWJsZTtcbiAgICAgIHZhciByZXNvdXJjZUlkID0gYWNjZXNzb3JzLnJlc291cmNlSWQocmVzb3VyY2UpO1xuICAgICAgdmFyIGV2ZW50c1RvRGlzcGxheSA9IHJlc291cmNlID8gZXZlbnRzLmZpbHRlcihmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGFjY2Vzc29ycy5yZXNvdXJjZShldmVudCkgPT09IHJlc291cmNlSWQ7XG4gICAgICB9KSA6IGV2ZW50cztcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChEYXRlQ29udGVudFJvdywge1xuICAgICAgICBpc0FsbERheTogdHJ1ZSxcbiAgICAgICAgcnRsOiBydGwsXG4gICAgICAgIGdldE5vdzogZ2V0Tm93LFxuICAgICAgICBtaW5Sb3dzOiAyXG4gICAgICAgIC8vIEFkZCArMSB0byBpbmNsdWRlIHNob3dNb3JlIGJ1dHRvbiByb3cgaW4gdGhlIHJvdyBsaW1pdFxuICAgICAgICAsXG4gICAgICAgIG1heFJvd3M6IF90aGlzLnByb3BzLmFsbERheU1heFJvd3MgKyAxLFxuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIGV2ZW50czogZXZlbnRzVG9EaXNwbGF5LFxuICAgICAgICByZXNvdXJjZUlkOiByZXNvdXJjZUlkLFxuICAgICAgICBjbGFzc05hbWU6IFwicmJjLWFsbGRheS1jZWxsXCIsXG4gICAgICAgIHNlbGVjdGFibGU6IHNlbGVjdGFibGUsXG4gICAgICAgIHNlbGVjdGVkOiBfdGhpcy5wcm9wcy5zZWxlY3RlZCxcbiAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgYWNjZXNzb3JzOiBhY2Nlc3NvcnMsXG4gICAgICAgIGdldHRlcnM6IGdldHRlcnMsXG4gICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgICBvblNlbGVjdDogX3RoaXMucHJvcHMub25TZWxlY3RFdmVudCxcbiAgICAgICAgb25TaG93TW9yZTogX3RoaXMucHJvcHMub25TaG93TW9yZSxcbiAgICAgICAgb25Eb3VibGVDbGljazogX3RoaXMucHJvcHMub25Eb3VibGVDbGlja0V2ZW50LFxuICAgICAgICBvbktleVByZXNzOiBfdGhpcy5wcm9wcy5vbktleVByZXNzRXZlbnQsXG4gICAgICAgIG9uU2VsZWN0U2xvdDogX3RoaXMucHJvcHMub25TZWxlY3RTbG90LFxuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQ6IF90aGlzLnByb3BzLmxvbmdQcmVzc1RocmVzaG9sZCxcbiAgICAgICAgcmVzaXphYmxlOiByZXNpemFibGVcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIF9pbmhlcml0cyhUaW1lR3JpZEhlYWRlciwgX1JlYWN0JENvbXBvbmVudCk7XG4gIHJldHVybiBfY3JlYXRlQ2xhc3MoVGltZUdyaWRIZWFkZXIsIFt7XG4gICAga2V5OiBcInJlbmRlckhlYWRlckNlbGxzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckhlYWRlckNlbGxzKHJhbmdlKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcbiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSB0aGlzLnByb3BzLFxuICAgICAgICBsb2NhbGl6ZXIgPSBfdGhpcyRwcm9wczIubG9jYWxpemVyLFxuICAgICAgICBnZXREcmlsbGRvd25WaWV3ID0gX3RoaXMkcHJvcHMyLmdldERyaWxsZG93blZpZXcsXG4gICAgICAgIGdldE5vdyA9IF90aGlzJHByb3BzMi5nZXROb3csXG4gICAgICAgIGRheVByb3AgPSBfdGhpcyRwcm9wczIuZ2V0dGVycy5kYXlQcm9wLFxuICAgICAgICBfdGhpcyRwcm9wczIkY29tcG9uZW4gPSBfdGhpcyRwcm9wczIuY29tcG9uZW50cy5oZWFkZXIsXG4gICAgICAgIEhlYWRlckNvbXBvbmVudCA9IF90aGlzJHByb3BzMiRjb21wb25lbiA9PT0gdm9pZCAwID8gSGVhZGVyIDogX3RoaXMkcHJvcHMyJGNvbXBvbmVuO1xuICAgICAgdmFyIHRvZGF5ID0gZ2V0Tm93KCk7XG4gICAgICByZXR1cm4gcmFuZ2UubWFwKGZ1bmN0aW9uIChkYXRlLCBpKSB7XG4gICAgICAgIHZhciBkcmlsbGRvd25WaWV3ID0gZ2V0RHJpbGxkb3duVmlldyhkYXRlKTtcbiAgICAgICAgdmFyIGxhYmVsID0gbG9jYWxpemVyLmZvcm1hdChkYXRlLCAnZGF5Rm9ybWF0Jyk7XG4gICAgICAgIHZhciBfZGF5UHJvcCA9IGRheVByb3AoZGF0ZSksXG4gICAgICAgICAgY2xhc3NOYW1lID0gX2RheVByb3AuY2xhc3NOYW1lLFxuICAgICAgICAgIHN0eWxlID0gX2RheVByb3Auc3R5bGU7XG4gICAgICAgIHZhciBoZWFkZXIgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChIZWFkZXJDb21wb25lbnQsIHtcbiAgICAgICAgICBkYXRlOiBkYXRlLFxuICAgICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplclxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgICBrZXk6IGksXG4gICAgICAgICAgc3R5bGU6IHN0eWxlLFxuICAgICAgICAgIGNsYXNzTmFtZTogY2xzeCgncmJjLWhlYWRlcicsIGNsYXNzTmFtZSwgbG9jYWxpemVyLmlzU2FtZURhdGUoZGF0ZSwgdG9kYXkpICYmICdyYmMtdG9kYXknKVxuICAgICAgICB9LCBkcmlsbGRvd25WaWV3ID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwge1xuICAgICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXG4gICAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1idXR0b24tbGlua1wiLFxuICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soZSkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5oYW5kbGVIZWFkZXJDbGljayhkYXRlLCBkcmlsbGRvd25WaWV3LCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGhlYWRlcikgOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgbnVsbCwgaGVhZGVyKSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsXG4gICAgICAgIHdpZHRoID0gX3RoaXMkcHJvcHMzLndpZHRoLFxuICAgICAgICBydGwgPSBfdGhpcyRwcm9wczMucnRsLFxuICAgICAgICByZXNvdXJjZXMgPSBfdGhpcyRwcm9wczMucmVzb3VyY2VzLFxuICAgICAgICByYW5nZSA9IF90aGlzJHByb3BzMy5yYW5nZSxcbiAgICAgICAgZXZlbnRzID0gX3RoaXMkcHJvcHMzLmV2ZW50cyxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHMzLmdldE5vdyxcbiAgICAgICAgYWNjZXNzb3JzID0gX3RoaXMkcHJvcHMzLmFjY2Vzc29ycyxcbiAgICAgICAgc2VsZWN0YWJsZSA9IF90aGlzJHByb3BzMy5zZWxlY3RhYmxlLFxuICAgICAgICBjb21wb25lbnRzID0gX3RoaXMkcHJvcHMzLmNvbXBvbmVudHMsXG4gICAgICAgIGdldHRlcnMgPSBfdGhpcyRwcm9wczMuZ2V0dGVycyxcbiAgICAgICAgc2Nyb2xsUmVmID0gX3RoaXMkcHJvcHMzLnNjcm9sbFJlZixcbiAgICAgICAgbG9jYWxpemVyID0gX3RoaXMkcHJvcHMzLmxvY2FsaXplcixcbiAgICAgICAgaXNPdmVyZmxvd2luZyA9IF90aGlzJHByb3BzMy5pc092ZXJmbG93aW5nLFxuICAgICAgICBfdGhpcyRwcm9wczMkY29tcG9uZW4gPSBfdGhpcyRwcm9wczMuY29tcG9uZW50cyxcbiAgICAgICAgVGltZUd1dHRlckhlYWRlciA9IF90aGlzJHByb3BzMyRjb21wb25lbi50aW1lR3V0dGVySGVhZGVyLFxuICAgICAgICBfdGhpcyRwcm9wczMkY29tcG9uZW4yID0gX3RoaXMkcHJvcHMzJGNvbXBvbmVuLnJlc291cmNlSGVhZGVyLFxuICAgICAgICBSZXNvdXJjZUhlYWRlckNvbXBvbmVudCA9IF90aGlzJHByb3BzMyRjb21wb25lbjIgPT09IHZvaWQgMCA/IFJlc291cmNlSGVhZGVyIDogX3RoaXMkcHJvcHMzJGNvbXBvbmVuMixcbiAgICAgICAgcmVzaXphYmxlID0gX3RoaXMkcHJvcHMzLnJlc2l6YWJsZTtcbiAgICAgIHZhciBzdHlsZSA9IHt9O1xuICAgICAgaWYgKGlzT3ZlcmZsb3dpbmcpIHtcbiAgICAgICAgc3R5bGVbcnRsID8gJ21hcmdpbkxlZnQnIDogJ21hcmdpblJpZ2h0J10gPSBcIlwiLmNvbmNhdChzY3JvbGxiYXJTaXplKCkgLSAxLCBcInB4XCIpO1xuICAgICAgfVxuICAgICAgdmFyIGdyb3VwZWRFdmVudHMgPSByZXNvdXJjZXMuZ3JvdXBFdmVudHMoZXZlbnRzKTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIHN0eWxlOiBzdHlsZSxcbiAgICAgICAgcmVmOiBzY3JvbGxSZWYsXG4gICAgICAgIGNsYXNzTmFtZTogY2xzeCgncmJjLXRpbWUtaGVhZGVyJywgaXNPdmVyZmxvd2luZyAmJiAncmJjLW92ZXJmbG93aW5nJylcbiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1sYWJlbCByYmMtdGltZS1oZWFkZXItZ3V0dGVyXCIsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgIG1pbldpZHRoOiB3aWR0aCxcbiAgICAgICAgICBtYXhXaWR0aDogd2lkdGhcbiAgICAgICAgfVxuICAgICAgfSwgVGltZUd1dHRlckhlYWRlciAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUaW1lR3V0dGVySGVhZGVyLCBudWxsKSksIHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKF9yZWYsIGlkeCkge1xuICAgICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSxcbiAgICAgICAgICBpZCA9IF9yZWYyWzBdLFxuICAgICAgICAgIHJlc291cmNlID0gX3JlZjJbMV07XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgICAgY2xhc3NOYW1lOiBcInJiYy10aW1lLWhlYWRlci1jb250ZW50XCIsXG4gICAgICAgICAga2V5OiBpZCB8fCBpZHhcbiAgICAgICAgfSwgcmVzb3VyY2UgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJyYmMtcm93IHJiYy1yb3ctcmVzb3VyY2VcIixcbiAgICAgICAgICBrZXk6IFwicmVzb3VyY2VfXCIuY29uY2F0KGlkeClcbiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJyYmMtaGVhZGVyXCJcbiAgICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmVzb3VyY2VIZWFkZXJDb21wb25lbnQsIHtcbiAgICAgICAgICBpbmRleDogaWR4LFxuICAgICAgICAgIGxhYmVsOiBhY2Nlc3NvcnMucmVzb3VyY2VUaXRsZShyZXNvdXJjZSksXG4gICAgICAgICAgcmVzb3VyY2U6IHJlc291cmNlXG4gICAgICAgIH0pKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgICBjbGFzc05hbWU6IFwicmJjLXJvdyByYmMtdGltZS1oZWFkZXItY2VsbFwiLmNvbmNhdChyYW5nZS5sZW5ndGggPD0gMSA/ICcgcmJjLXRpbWUtaGVhZGVyLWNlbGwtc2luZ2xlLWRheScgOiAnJylcbiAgICAgICAgfSwgX3RoaXMzLnJlbmRlckhlYWRlckNlbGxzKHJhbmdlKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KERhdGVDb250ZW50Um93LCB7XG4gICAgICAgICAgaXNBbGxEYXk6IHRydWUsXG4gICAgICAgICAgcnRsOiBydGwsXG4gICAgICAgICAgZ2V0Tm93OiBnZXROb3csXG4gICAgICAgICAgbWluUm93czogMlxuICAgICAgICAgIC8vIEFkZCArMSB0byBpbmNsdWRlIHNob3dNb3JlIGJ1dHRvbiByb3cgaW4gdGhlIHJvdyBsaW1pdFxuICAgICAgICAgICxcbiAgICAgICAgICBtYXhSb3dzOiBfdGhpczMucHJvcHMuYWxsRGF5TWF4Um93cyArIDEsXG4gICAgICAgICAgcmFuZ2U6IHJhbmdlLFxuICAgICAgICAgIGV2ZW50czogZ3JvdXBlZEV2ZW50cy5nZXQoaWQpIHx8IFtdLFxuICAgICAgICAgIHJlc291cmNlSWQ6IHJlc291cmNlICYmIGlkLFxuICAgICAgICAgIGNsYXNzTmFtZTogXCJyYmMtYWxsZGF5LWNlbGxcIixcbiAgICAgICAgICBzZWxlY3RhYmxlOiBzZWxlY3RhYmxlLFxuICAgICAgICAgIHNlbGVjdGVkOiBfdGhpczMucHJvcHMuc2VsZWN0ZWQsXG4gICAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgICBhY2Nlc3NvcnM6IGFjY2Vzc29ycyxcbiAgICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgICAgIG9uU2VsZWN0OiBfdGhpczMucHJvcHMub25TZWxlY3RFdmVudCxcbiAgICAgICAgICBvblNob3dNb3JlOiBfdGhpczMucHJvcHMub25TaG93TW9yZSxcbiAgICAgICAgICBvbkRvdWJsZUNsaWNrOiBfdGhpczMucHJvcHMub25Eb3VibGVDbGlja0V2ZW50LFxuICAgICAgICAgIG9uS2V5RG93bjogX3RoaXMzLnByb3BzLm9uS2V5UHJlc3NFdmVudCxcbiAgICAgICAgICBvblNlbGVjdFNsb3Q6IF90aGlzMy5wcm9wcy5vblNlbGVjdFNsb3QsXG4gICAgICAgICAgbG9uZ1ByZXNzVGhyZXNob2xkOiBfdGhpczMucHJvcHMubG9uZ1ByZXNzVGhyZXNob2xkLFxuICAgICAgICAgIHJlc2l6YWJsZTogcmVzaXphYmxlXG4gICAgICAgIH0pKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcblxudmFyIE5PTkUgPSB7fTtcbmZ1bmN0aW9uIFJlc291cmNlcyhyZXNvdXJjZXMsIGFjY2Vzc29ycykge1xuICByZXR1cm4ge1xuICAgIG1hcDogZnVuY3Rpb24gbWFwKGZuKSB7XG4gICAgICBpZiAoIXJlc291cmNlcykgcmV0dXJuIFtmbihbTk9ORSwgbnVsbF0sIDApXTtcbiAgICAgIHJldHVybiByZXNvdXJjZXMubWFwKGZ1bmN0aW9uIChyZXNvdXJjZSwgaWR4KSB7XG4gICAgICAgIHJldHVybiBmbihbYWNjZXNzb3JzLnJlc291cmNlSWQocmVzb3VyY2UpLCByZXNvdXJjZV0sIGlkeCk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdyb3VwRXZlbnRzOiBmdW5jdGlvbiBncm91cEV2ZW50cyhldmVudHMpIHtcbiAgICAgIHZhciBldmVudHNCeVJlc291cmNlID0gbmV3IE1hcCgpO1xuICAgICAgaWYgKCFyZXNvdXJjZXMpIHtcbiAgICAgICAgLy8gUmV0dXJuIGFsbCBldmVudHMgaWYgcmVzb3VyY2VzIGFyZSBub3QgcHJvdmlkZWRcbiAgICAgICAgZXZlbnRzQnlSZXNvdXJjZS5zZXQoTk9ORSwgZXZlbnRzKTtcbiAgICAgICAgcmV0dXJuIGV2ZW50c0J5UmVzb3VyY2U7XG4gICAgICB9XG4gICAgICBldmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGlkID0gYWNjZXNzb3JzLnJlc291cmNlKGV2ZW50KSB8fCBOT05FO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpZCkpIHtcbiAgICAgICAgICBpZC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgcmVzb3VyY2VFdmVudHMgPSBldmVudHNCeVJlc291cmNlLmdldChpdGVtKSB8fCBbXTtcbiAgICAgICAgICAgIHJlc291cmNlRXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICAgICAgZXZlbnRzQnlSZXNvdXJjZS5zZXQoaXRlbSwgcmVzb3VyY2VFdmVudHMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciByZXNvdXJjZUV2ZW50cyA9IGV2ZW50c0J5UmVzb3VyY2UuZ2V0KGlkKSB8fCBbXTtcbiAgICAgICAgICByZXNvdXJjZUV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgICBldmVudHNCeVJlc291cmNlLnNldChpZCwgcmVzb3VyY2VFdmVudHMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBldmVudHNCeVJlc291cmNlO1xuICAgIH1cbiAgfTtcbn1cblxudmFyIFRpbWVHcmlkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIFRpbWVHcmlkKHByb3BzKSB7XG4gICAgdmFyIF90aGlzO1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUaW1lR3JpZCk7XG4gICAgX3RoaXMgPSBfY2FsbFN1cGVyKHRoaXMsIFRpbWVHcmlkLCBbcHJvcHNdKTtcbiAgICBfdGhpcy5oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKF90aGlzLnNjcm9sbFJlZi5jdXJyZW50KSB7XG4gICAgICAgIF90aGlzLnNjcm9sbFJlZi5jdXJyZW50LnNjcm9sbExlZnQgPSBlLnRhcmdldC5zY3JvbGxMZWZ0O1xuICAgICAgfVxuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlUmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgYW5pbWF0aW9uRnJhbWUuY2FuY2VsKF90aGlzLnJhZkhhbmRsZSk7XG4gICAgICBfdGhpcy5yYWZIYW5kbGUgPSBhbmltYXRpb25GcmFtZS5yZXF1ZXN0KF90aGlzLmNoZWNrT3ZlcmZsb3cpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlS2V5UHJlc3NFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vbktleVByZXNzRXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlU2VsZWN0RXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvL2NhbmNlbCBhbnkgcGVuZGluZyBzZWxlY3Rpb25zIHNvIG9ubHkgdGhlIGV2ZW50IGNsaWNrIGdvZXMgdGhyb3VnaC5cbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgYXJnc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uU2VsZWN0RXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uRG91YmxlQ2xpY2tFdmVudCwgYXJncyk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVTaG93TW9yZSA9IGZ1bmN0aW9uIChldmVudHMsIGRhdGUsIGNlbGwsIHNsb3QsIHRhcmdldCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsXG4gICAgICAgIHBvcHVwID0gX3RoaXMkcHJvcHMucG9wdXAsXG4gICAgICAgIG9uRHJpbGxEb3duID0gX3RoaXMkcHJvcHMub25EcmlsbERvd24sXG4gICAgICAgIG9uU2hvd01vcmUgPSBfdGhpcyRwcm9wcy5vblNob3dNb3JlLFxuICAgICAgICBnZXREcmlsbGRvd25WaWV3ID0gX3RoaXMkcHJvcHMuZ2V0RHJpbGxkb3duVmlldyxcbiAgICAgICAgZG9TaG93TW9yZURyaWxsRG93biA9IF90aGlzJHByb3BzLmRvU2hvd01vcmVEcmlsbERvd247XG4gICAgICBfdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgaWYgKHBvcHVwKSB7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGdldFBvc2l0aW9uJDEoY2VsbCwgX3RoaXMuY29udGFpbmVyUmVmLmN1cnJlbnQpO1xuICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgb3ZlcmxheToge1xuICAgICAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgICAgIGV2ZW50czogZXZlbnRzLFxuICAgICAgICAgICAgcG9zaXRpb246IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcG9zaXRpb24pLCB7fSwge1xuICAgICAgICAgICAgICB3aWR0aDogJzIwMHB4J1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGRvU2hvd01vcmVEcmlsbERvd24pIHtcbiAgICAgICAgbm90aWZ5KG9uRHJpbGxEb3duLCBbZGF0ZSwgZ2V0RHJpbGxkb3duVmlldyhkYXRlKSB8fCB2aWV3cy5EQVldKTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShvblNob3dNb3JlLCBbZXZlbnRzLCBkYXRlLCBzbG90XSk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVTZWxlY3RBbGxEYXlTbG90ID0gZnVuY3Rpb24gKHNsb3RzLCBzbG90SW5mbykge1xuICAgICAgdmFyIG9uU2VsZWN0U2xvdCA9IF90aGlzLnByb3BzLm9uU2VsZWN0U2xvdDtcbiAgICAgIHZhciBzdGFydCA9IG5ldyBEYXRlKHNsb3RzWzBdKTtcbiAgICAgIHZhciBlbmQgPSBuZXcgRGF0ZShzbG90c1tzbG90cy5sZW5ndGggLSAxXSk7XG4gICAgICBlbmQuc2V0RGF0ZShzbG90c1tzbG90cy5sZW5ndGggLSAxXS5nZXREYXRlKCkgKyAxKTtcbiAgICAgIG5vdGlmeShvblNlbGVjdFNsb3QsIHtcbiAgICAgICAgc2xvdHM6IHNsb3RzLFxuICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgIGVuZDogZW5kLFxuICAgICAgICBhY3Rpb246IHNsb3RJbmZvLmFjdGlvbixcbiAgICAgICAgcmVzb3VyY2VJZDogc2xvdEluZm8ucmVzb3VyY2VJZFxuICAgICAgfSk7XG4gICAgfTtcbiAgICBfdGhpcy5vdmVybGF5RGlzcGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgb3ZlcmxheTogbnVsbFxuICAgICAgfSk7XG4gICAgfTtcbiAgICBfdGhpcy5jaGVja092ZXJmbG93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKF90aGlzLl91cGRhdGluZ092ZXJmbG93KSByZXR1cm47XG4gICAgICB2YXIgY29udGVudCA9IF90aGlzLmNvbnRlbnRSZWYuY3VycmVudDtcbiAgICAgIGlmICghKGNvbnRlbnQgIT09IG51bGwgJiYgY29udGVudCAhPT0gdm9pZCAwICYmIGNvbnRlbnQuc2Nyb2xsSGVpZ2h0KSkgcmV0dXJuO1xuICAgICAgdmFyIGlzT3ZlcmZsb3dpbmcgPSBjb250ZW50LnNjcm9sbEhlaWdodCA+IGNvbnRlbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgaWYgKF90aGlzLnN0YXRlLmlzT3ZlcmZsb3dpbmcgIT09IGlzT3ZlcmZsb3dpbmcpIHtcbiAgICAgICAgX3RoaXMuX3VwZGF0aW5nT3ZlcmZsb3cgPSB0cnVlO1xuICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgaXNPdmVyZmxvd2luZzogaXNPdmVyZmxvd2luZ1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMuX3VwZGF0aW5nT3ZlcmZsb3cgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBfdGhpcy5tZW1vaXplZFJlc291cmNlcyA9IG1lbW9pemUoZnVuY3Rpb24gKHJlc291cmNlcywgYWNjZXNzb3JzKSB7XG4gICAgICByZXR1cm4gUmVzb3VyY2VzKHJlc291cmNlcywgYWNjZXNzb3JzKTtcbiAgICB9KTtcbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGd1dHRlcldpZHRoOiB1bmRlZmluZWQsXG4gICAgICBpc092ZXJmbG93aW5nOiBudWxsXG4gICAgfTtcbiAgICBfdGhpcy5zY3JvbGxSZWYgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgX3RoaXMuY29udGVudFJlZiA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVSZWYoKTtcbiAgICBfdGhpcy5jb250YWluZXJSZWYgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgX3RoaXMuX3Njcm9sbFJhdGlvID0gbnVsbDtcbiAgICBfdGhpcy5ndXR0ZXJSZWYgPSAvKiNfX1BVUkVfXyovY3JlYXRlUmVmKCk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIF9pbmhlcml0cyhUaW1lR3JpZCwgX0NvbXBvbmVudCk7XG4gIHJldHVybiBfY3JlYXRlQ2xhc3MoVGltZUdyaWQsIFt7XG4gICAga2V5OiBcImdldFNuYXBzaG90QmVmb3JlVXBkYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNuYXBzaG90QmVmb3JlVXBkYXRlKCkge1xuICAgICAgdGhpcy5jaGVja092ZXJmbG93KCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50RGlkTW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICBpZiAodGhpcy5wcm9wcy53aWR0aCA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMubWVhc3VyZUd1dHRlcigpO1xuICAgICAgfVxuICAgICAgdGhpcy5jYWxjdWxhdGVTY3JvbGwoKTtcbiAgICAgIHRoaXMuYXBwbHlTY3JvbGwoKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmhhbmRsZVJlc2l6ZSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbXBvbmVudFdpbGxVbm1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuaGFuZGxlUmVzaXplKTtcbiAgICAgIGFuaW1hdGlvbkZyYW1lLmNhbmNlbCh0aGlzLnJhZkhhbmRsZSk7XG4gICAgICBpZiAodGhpcy5tZWFzdXJlR3V0dGVyQW5pbWF0aW9uRnJhbWVSZXF1ZXN0KSB7XG4gICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLm1lYXN1cmVHdXR0ZXJBbmltYXRpb25GcmFtZVJlcXVlc3QpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjb21wb25lbnREaWRVcGRhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgdGhpcy5hcHBseVNjcm9sbCgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW5kZXJFdmVudHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRXZlbnRzKHJhbmdlLCBldmVudHMsIGJhY2tncm91bmRFdmVudHMsIG5vdykge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMyID0gdGhpcy5wcm9wcyxcbiAgICAgICAgbWluID0gX3RoaXMkcHJvcHMyLm1pbixcbiAgICAgICAgbWF4ID0gX3RoaXMkcHJvcHMyLm1heCxcbiAgICAgICAgY29tcG9uZW50cyA9IF90aGlzJHByb3BzMi5jb21wb25lbnRzLFxuICAgICAgICBhY2Nlc3NvcnMgPSBfdGhpcyRwcm9wczIuYWNjZXNzb3JzLFxuICAgICAgICBsb2NhbGl6ZXIgPSBfdGhpcyRwcm9wczIubG9jYWxpemVyLFxuICAgICAgICBkYXlMYXlvdXRBbGdvcml0aG0gPSBfdGhpcyRwcm9wczIuZGF5TGF5b3V0QWxnb3JpdGhtO1xuICAgICAgdmFyIHJlc291cmNlcyA9IHRoaXMubWVtb2l6ZWRSZXNvdXJjZXModGhpcy5wcm9wcy5yZXNvdXJjZXMsIGFjY2Vzc29ycyk7XG4gICAgICB2YXIgZ3JvdXBlZEV2ZW50cyA9IHJlc291cmNlcy5ncm91cEV2ZW50cyhldmVudHMpO1xuICAgICAgdmFyIGdyb3VwZWRCYWNrZ3JvdW5kRXZlbnRzID0gcmVzb3VyY2VzLmdyb3VwRXZlbnRzKGJhY2tncm91bmRFdmVudHMpO1xuICAgICAgcmV0dXJuIHJlc291cmNlcy5tYXAoZnVuY3Rpb24gKF9yZWYsIGkpIHtcbiAgICAgICAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMiksXG4gICAgICAgICAgaWQgPSBfcmVmMlswXSxcbiAgICAgICAgICByZXNvdXJjZSA9IF9yZWYyWzFdO1xuICAgICAgICByZXR1cm4gcmFuZ2UubWFwKGZ1bmN0aW9uIChkYXRlLCBqaikge1xuICAgICAgICAgIHZhciBkYXlzRXZlbnRzID0gKGdyb3VwZWRFdmVudHMuZ2V0KGlkKSB8fCBbXSkuZmlsdGVyKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplci5pblJhbmdlKGRhdGUsIGFjY2Vzc29ycy5zdGFydChldmVudCksIGFjY2Vzc29ycy5lbmQoZXZlbnQpLCAnZGF5Jyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdmFyIGRheXNCYWNrZ3JvdW5kRXZlbnRzID0gKGdyb3VwZWRCYWNrZ3JvdW5kRXZlbnRzLmdldChpZCkgfHwgW10pLmZpbHRlcihmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZXIuaW5SYW5nZShkYXRlLCBhY2Nlc3NvcnMuc3RhcnQoZXZlbnQpLCBhY2Nlc3NvcnMuZW5kKGV2ZW50KSwgJ2RheScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChEYXlDb2x1bW4sIE9iamVjdC5hc3NpZ24oe30sIF90aGlzMi5wcm9wcywge1xuICAgICAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgICAgICBtaW46IGxvY2FsaXplci5tZXJnZShkYXRlLCBtaW4pLFxuICAgICAgICAgICAgbWF4OiBsb2NhbGl6ZXIubWVyZ2UoZGF0ZSwgbWF4KSxcbiAgICAgICAgICAgIHJlc291cmNlOiByZXNvdXJjZSAmJiBpZCxcbiAgICAgICAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudHMsXG4gICAgICAgICAgICBpc05vdzogbG9jYWxpemVyLmlzU2FtZURhdGUoZGF0ZSwgbm93KSxcbiAgICAgICAgICAgIGtleTogaSArICctJyArIGpqLFxuICAgICAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgICAgIGV2ZW50czogZGF5c0V2ZW50cyxcbiAgICAgICAgICAgIGJhY2tncm91bmRFdmVudHM6IGRheXNCYWNrZ3JvdW5kRXZlbnRzLFxuICAgICAgICAgICAgZGF5TGF5b3V0QWxnb3JpdGhtOiBkYXlMYXlvdXRBbGdvcml0aG1cbiAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMkYWxsRGF5TWF4O1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsXG4gICAgICAgIGV2ZW50cyA9IF90aGlzJHByb3BzMy5ldmVudHMsXG4gICAgICAgIGJhY2tncm91bmRFdmVudHMgPSBfdGhpcyRwcm9wczMuYmFja2dyb3VuZEV2ZW50cyxcbiAgICAgICAgcmFuZ2UgPSBfdGhpcyRwcm9wczMucmFuZ2UsXG4gICAgICAgIHdpZHRoID0gX3RoaXMkcHJvcHMzLndpZHRoLFxuICAgICAgICBydGwgPSBfdGhpcyRwcm9wczMucnRsLFxuICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzMy5zZWxlY3RlZCxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHMzLmdldE5vdyxcbiAgICAgICAgcmVzb3VyY2VzID0gX3RoaXMkcHJvcHMzLnJlc291cmNlcyxcbiAgICAgICAgY29tcG9uZW50cyA9IF90aGlzJHByb3BzMy5jb21wb25lbnRzLFxuICAgICAgICBhY2Nlc3NvcnMgPSBfdGhpcyRwcm9wczMuYWNjZXNzb3JzLFxuICAgICAgICBnZXR0ZXJzID0gX3RoaXMkcHJvcHMzLmdldHRlcnMsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzMy5sb2NhbGl6ZXIsXG4gICAgICAgIG1pbiA9IF90aGlzJHByb3BzMy5taW4sXG4gICAgICAgIG1heCA9IF90aGlzJHByb3BzMy5tYXgsXG4gICAgICAgIHNob3dNdWx0aURheVRpbWVzID0gX3RoaXMkcHJvcHMzLnNob3dNdWx0aURheVRpbWVzLFxuICAgICAgICBsb25nUHJlc3NUaHJlc2hvbGQgPSBfdGhpcyRwcm9wczMubG9uZ1ByZXNzVGhyZXNob2xkLFxuICAgICAgICByZXNpemFibGUgPSBfdGhpcyRwcm9wczMucmVzaXphYmxlO1xuICAgICAgd2lkdGggPSB3aWR0aCB8fCB0aGlzLnN0YXRlLmd1dHRlcldpZHRoO1xuICAgICAgdmFyIHN0YXJ0ID0gcmFuZ2VbMF0sXG4gICAgICAgIGVuZCA9IHJhbmdlW3JhbmdlLmxlbmd0aCAtIDFdO1xuICAgICAgdGhpcy5zbG90cyA9IHJhbmdlLmxlbmd0aDtcbiAgICAgIHZhciBhbGxEYXlFdmVudHMgPSBbXSxcbiAgICAgICAgcmFuZ2VFdmVudHMgPSBbXSxcbiAgICAgICAgcmFuZ2VCYWNrZ3JvdW5kRXZlbnRzID0gW107XG4gICAgICBldmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGluUmFuZ2UoZXZlbnQsIHN0YXJ0LCBlbmQsIGFjY2Vzc29ycywgbG9jYWxpemVyKSkge1xuICAgICAgICAgIHZhciBlU3RhcnQgPSBhY2Nlc3NvcnMuc3RhcnQoZXZlbnQpLFxuICAgICAgICAgICAgZUVuZCA9IGFjY2Vzc29ycy5lbmQoZXZlbnQpO1xuICAgICAgICAgIGlmIChhY2Nlc3NvcnMuYWxsRGF5KGV2ZW50KSB8fCBsb2NhbGl6ZXIuc3RhcnRBbmRFbmRBcmVEYXRlT25seShlU3RhcnQsIGVFbmQpIHx8ICFzaG93TXVsdGlEYXlUaW1lcyAmJiAhbG9jYWxpemVyLmlzU2FtZURhdGUoZVN0YXJ0LCBlRW5kKSkge1xuICAgICAgICAgICAgYWxsRGF5RXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByYW5nZUV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYmFja2dyb3VuZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoaW5SYW5nZShldmVudCwgc3RhcnQsIGVuZCwgYWNjZXNzb3JzLCBsb2NhbGl6ZXIpKSB7XG4gICAgICAgICAgcmFuZ2VCYWNrZ3JvdW5kRXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGFsbERheUV2ZW50cy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBzb3J0RXZlbnRzKGEsIGIsIGFjY2Vzc29ycywgbG9jYWxpemVyKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbHN4KCdyYmMtdGltZS12aWV3JywgcmVzb3VyY2VzICYmICdyYmMtdGltZS12aWV3LXJlc291cmNlcycpLFxuICAgICAgICByZWY6IHRoaXMuY29udGFpbmVyUmVmXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUaW1lR3JpZEhlYWRlciwge1xuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIGV2ZW50czogYWxsRGF5RXZlbnRzLFxuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgIHJ0bDogcnRsLFxuICAgICAgICBnZXROb3c6IGdldE5vdyxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIHNlbGVjdGVkOiBzZWxlY3RlZCxcbiAgICAgICAgYWxsRGF5TWF4Um93czogdGhpcy5wcm9wcy5zaG93QWxsRXZlbnRzID8gSW5maW5pdHkgOiAoX3RoaXMkcHJvcHMkYWxsRGF5TWF4ID0gdGhpcy5wcm9wcy5hbGxEYXlNYXhSb3dzKSAhPT0gbnVsbCAmJiBfdGhpcyRwcm9wcyRhbGxEYXlNYXggIT09IHZvaWQgMCA/IF90aGlzJHByb3BzJGFsbERheU1heCA6IEluZmluaXR5LFxuICAgICAgICByZXNvdXJjZXM6IHRoaXMubWVtb2l6ZWRSZXNvdXJjZXMocmVzb3VyY2VzLCBhY2Nlc3NvcnMpLFxuICAgICAgICBzZWxlY3RhYmxlOiB0aGlzLnByb3BzLnNlbGVjdGFibGUsXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBnZXR0ZXJzOiBnZXR0ZXJzLFxuICAgICAgICBjb21wb25lbnRzOiBjb21wb25lbnRzLFxuICAgICAgICBzY3JvbGxSZWY6IHRoaXMuc2Nyb2xsUmVmLFxuICAgICAgICBpc092ZXJmbG93aW5nOiB0aGlzLnN0YXRlLmlzT3ZlcmZsb3dpbmcsXG4gICAgICAgIGxvbmdQcmVzc1RocmVzaG9sZDogbG9uZ1ByZXNzVGhyZXNob2xkLFxuICAgICAgICBvblNlbGVjdFNsb3Q6IHRoaXMuaGFuZGxlU2VsZWN0QWxsRGF5U2xvdCxcbiAgICAgICAgb25TZWxlY3RFdmVudDogdGhpcy5oYW5kbGVTZWxlY3RFdmVudCxcbiAgICAgICAgb25TaG93TW9yZTogdGhpcy5oYW5kbGVTaG93TW9yZSxcbiAgICAgICAgb25Eb3VibGVDbGlja0V2ZW50OiB0aGlzLnByb3BzLm9uRG91YmxlQ2xpY2tFdmVudCxcbiAgICAgICAgb25LZXlQcmVzc0V2ZW50OiB0aGlzLnByb3BzLm9uS2V5UHJlc3NFdmVudCxcbiAgICAgICAgb25EcmlsbERvd246IHRoaXMucHJvcHMub25EcmlsbERvd24sXG4gICAgICAgIGdldERyaWxsZG93blZpZXc6IHRoaXMucHJvcHMuZ2V0RHJpbGxkb3duVmlldyxcbiAgICAgICAgcmVzaXphYmxlOiByZXNpemFibGVcbiAgICAgIH0pLCB0aGlzLnByb3BzLnBvcHVwICYmIHRoaXMucmVuZGVyT3ZlcmxheSgpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICAgIHJlZjogdGhpcy5jb250ZW50UmVmLFxuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXRpbWUtY29udGVudFwiLFxuICAgICAgICBvblNjcm9sbDogdGhpcy5oYW5kbGVTY3JvbGxcbiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRpbWVHdXR0ZXIkMSwge1xuICAgICAgICBkYXRlOiBzdGFydCxcbiAgICAgICAgcmVmOiB0aGlzLmd1dHRlclJlZixcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIG1pbjogbG9jYWxpemVyLm1lcmdlKHN0YXJ0LCBtaW4pLFxuICAgICAgICBtYXg6IGxvY2FsaXplci5tZXJnZShzdGFydCwgbWF4KSxcbiAgICAgICAgc3RlcDogdGhpcy5wcm9wcy5zdGVwLFxuICAgICAgICBnZXROb3c6IHRoaXMucHJvcHMuZ2V0Tm93LFxuICAgICAgICB0aW1lc2xvdHM6IHRoaXMucHJvcHMudGltZXNsb3RzLFxuICAgICAgICBjb21wb25lbnRzOiBjb21wb25lbnRzLFxuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXRpbWUtZ3V0dGVyXCIsXG4gICAgICAgIGdldHRlcnM6IGdldHRlcnNcbiAgICAgIH0pLCB0aGlzLnJlbmRlckV2ZW50cyhyYW5nZSwgcmFuZ2VFdmVudHMsIHJhbmdlQmFja2dyb3VuZEV2ZW50cywgZ2V0Tm93KCkpKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlck92ZXJsYXlcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyT3ZlcmxheSgpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZSRvdmVybGF5LFxuICAgICAgICBfdGhpcyRzdGF0ZSxcbiAgICAgICAgX3RoaXMzID0gdGhpcztcbiAgICAgIHZhciBvdmVybGF5ID0gKF90aGlzJHN0YXRlJG92ZXJsYXkgPSAoX3RoaXMkc3RhdGUgPSB0aGlzLnN0YXRlKSA9PT0gbnVsbCB8fCBfdGhpcyRzdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3RhdGUub3ZlcmxheSkgIT09IG51bGwgJiYgX3RoaXMkc3RhdGUkb3ZlcmxheSAhPT0gdm9pZCAwID8gX3RoaXMkc3RhdGUkb3ZlcmxheSA6IHt9O1xuICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsXG4gICAgICAgIGFjY2Vzc29ycyA9IF90aGlzJHByb3BzNC5hY2Nlc3NvcnMsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzNC5sb2NhbGl6ZXIsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfdGhpcyRwcm9wczQuY29tcG9uZW50cyxcbiAgICAgICAgZ2V0dGVycyA9IF90aGlzJHByb3BzNC5nZXR0ZXJzLFxuICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzNC5zZWxlY3RlZCxcbiAgICAgICAgcG9wdXBPZmZzZXQgPSBfdGhpcyRwcm9wczQucG9wdXBPZmZzZXQsXG4gICAgICAgIGhhbmRsZURyYWdTdGFydCA9IF90aGlzJHByb3BzNC5oYW5kbGVEcmFnU3RhcnQ7XG4gICAgICB2YXIgb25IaWRlID0gZnVuY3Rpb24gb25IaWRlKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHtcbiAgICAgICAgICBvdmVybGF5OiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3BPdmVybGF5LCB7XG4gICAgICAgIG92ZXJsYXk6IG92ZXJsYXksXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgY29tcG9uZW50czogY29tcG9uZW50cyxcbiAgICAgICAgZ2V0dGVyczogZ2V0dGVycyxcbiAgICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgICAgICBwb3B1cE9mZnNldDogcG9wdXBPZmZzZXQsXG4gICAgICAgIHJlZjogdGhpcy5jb250YWluZXJSZWYsXG4gICAgICAgIGhhbmRsZUtleVByZXNzRXZlbnQ6IHRoaXMuaGFuZGxlS2V5UHJlc3NFdmVudCxcbiAgICAgICAgaGFuZGxlU2VsZWN0RXZlbnQ6IHRoaXMuaGFuZGxlU2VsZWN0RXZlbnQsXG4gICAgICAgIGhhbmRsZURvdWJsZUNsaWNrRXZlbnQ6IHRoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCxcbiAgICAgICAgaGFuZGxlRHJhZ1N0YXJ0OiBoYW5kbGVEcmFnU3RhcnQsXG4gICAgICAgIHNob3c6ICEhb3ZlcmxheS5wb3NpdGlvbixcbiAgICAgICAgb3ZlcmxheURpc3BsYXk6IHRoaXMub3ZlcmxheURpc3BsYXksXG4gICAgICAgIG9uSGlkZTogb25IaWRlXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2xlYXJTZWxlY3Rpb25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXJTZWxlY3Rpb24oKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5fc2VsZWN0VGltZXIpO1xuICAgICAgdGhpcy5fcGVuZGluZ1NlbGVjdGlvbiA9IFtdO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJtZWFzdXJlR3V0dGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1lYXN1cmVHdXR0ZXIoKSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcbiAgICAgIGlmICh0aGlzLm1lYXN1cmVHdXR0ZXJBbmltYXRpb25GcmFtZVJlcXVlc3QpIHtcbiAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMubWVhc3VyZUd1dHRlckFuaW1hdGlvbkZyYW1lUmVxdWVzdCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1lYXN1cmVHdXR0ZXJBbmltYXRpb25GcmFtZVJlcXVlc3QgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzNCRndXR0ZXJSZWY7XG4gICAgICAgIHZhciB3aWR0aCA9IChfdGhpczQkZ3V0dGVyUmVmID0gX3RoaXM0Lmd1dHRlclJlZikgIT09IG51bGwgJiYgX3RoaXM0JGd1dHRlclJlZiAhPT0gdm9pZCAwICYmIF90aGlzNCRndXR0ZXJSZWYuY3VycmVudCA/IGdldFdpZHRoKF90aGlzNC5ndXR0ZXJSZWYuY3VycmVudCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmICh3aWR0aCAmJiBfdGhpczQuc3RhdGUuZ3V0dGVyV2lkdGggIT09IHdpZHRoKSB7XG4gICAgICAgICAgX3RoaXM0LnNldFN0YXRlKHtcbiAgICAgICAgICAgIGd1dHRlcldpZHRoOiB3aWR0aFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiYXBwbHlTY3JvbGxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlTY3JvbGwoKSB7XG4gICAgICAvLyBJZiBhdXRvLXNjcm9sbCBpcyBkaXNhYmxlZCwgd2UgZG9uJ3QgYWN0dWFsbHkgYXBwbHkgdGhlIHNjcm9sbFxuICAgICAgaWYgKHRoaXMuX3Njcm9sbFJhdGlvICE9IG51bGwgJiYgdGhpcy5wcm9wcy5lbmFibGVBdXRvU2Nyb2xsID09PSB0cnVlKSB7XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb250ZW50UmVmLmN1cnJlbnQ7XG4gICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gY29udGVudC5zY3JvbGxIZWlnaHQgKiB0aGlzLl9zY3JvbGxSYXRpbztcbiAgICAgICAgLy8gT25seSBkbyB0aGlzIG9uY2VcbiAgICAgICAgdGhpcy5fc2Nyb2xsUmF0aW8gPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjYWxjdWxhdGVTY3JvbGxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2FsY3VsYXRlU2Nyb2xsKCkge1xuICAgICAgdmFyIHByb3BzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB0aGlzLnByb3BzO1xuICAgICAgdmFyIG1pbiA9IHByb3BzLm1pbixcbiAgICAgICAgbWF4ID0gcHJvcHMubWF4LFxuICAgICAgICBzY3JvbGxUb1RpbWUgPSBwcm9wcy5zY3JvbGxUb1RpbWUsXG4gICAgICAgIGxvY2FsaXplciA9IHByb3BzLmxvY2FsaXplcjtcbiAgICAgIHZhciBkaWZmTWlsbGlzID0gbG9jYWxpemVyLmRpZmYobG9jYWxpemVyLm1lcmdlKHNjcm9sbFRvVGltZSwgbWluKSwgc2Nyb2xsVG9UaW1lLCAnbWlsbGlzZWNvbmRzJyk7XG4gICAgICB2YXIgdG90YWxNaWxsaXMgPSBsb2NhbGl6ZXIuZGlmZihtaW4sIG1heCwgJ21pbGxpc2Vjb25kcycpO1xuICAgICAgdGhpcy5fc2Nyb2xsUmF0aW8gPSBkaWZmTWlsbGlzIC8gdG90YWxNaWxsaXM7XG4gICAgfVxuICB9XSk7XG59KENvbXBvbmVudCk7XG5UaW1lR3JpZC5kZWZhdWx0UHJvcHMgPSB7XG4gIHN0ZXA6IDMwLFxuICB0aW1lc2xvdHM6IDJcbn07XG5cbnZhciBfZXhjbHVkZWQkNCA9IFtcImRhdGVcIiwgXCJsb2NhbGl6ZXJcIiwgXCJtaW5cIiwgXCJtYXhcIiwgXCJzY3JvbGxUb1RpbWVcIiwgXCJlbmFibGVBdXRvU2Nyb2xsXCJdO1xudmFyIERheSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBmdW5jdGlvbiBEYXkoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERheSk7XG4gICAgcmV0dXJuIF9jYWxsU3VwZXIodGhpcywgRGF5LCBhcmd1bWVudHMpO1xuICB9XG4gIF9pbmhlcml0cyhEYXksIF9SZWFjdCRDb21wb25lbnQpO1xuICByZXR1cm4gX2NyZWF0ZUNsYXNzKERheSwgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIC8qKlxuICAgICAgICogVGhpcyBhbGxvd3MgdXMgdG8gZGVmYXVsdCBtaW4sIG1heCwgYW5kIHNjcm9sbFRvVGltZVxuICAgICAgICogdXNpbmcgb3VyIGxvY2FsaXplci4gVGhpcyBpcyBuZWNlc3NhcnkgdW50aWwgc3VjaCB0aW1lXG4gICAgICAgKiBhcyBUT0RPOiBUaW1lR3JpZCBpcyBjb252ZXJ0ZWQgdG8gYSBmdW5jdGlvbmFsIGNvbXBvbmVudC5cbiAgICAgICAqL1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgZGF0ZSA9IF90aGlzJHByb3BzLmRhdGUsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzLmxvY2FsaXplcixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWluID0gX3RoaXMkcHJvcHMubWluLFxuICAgICAgICBtaW4gPSBfdGhpcyRwcm9wcyRtaW4gPT09IHZvaWQgMCA/IGxvY2FsaXplci5zdGFydE9mKG5ldyBEYXRlKCksICdkYXknKSA6IF90aGlzJHByb3BzJG1pbixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWF4ID0gX3RoaXMkcHJvcHMubWF4LFxuICAgICAgICBtYXggPSBfdGhpcyRwcm9wcyRtYXggPT09IHZvaWQgMCA/IGxvY2FsaXplci5lbmRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRtYXgsXG4gICAgICAgIF90aGlzJHByb3BzJHNjcm9sbFRvVCA9IF90aGlzJHByb3BzLnNjcm9sbFRvVGltZSxcbiAgICAgICAgc2Nyb2xsVG9UaW1lID0gX3RoaXMkcHJvcHMkc2Nyb2xsVG9UID09PSB2b2lkIDAgPyBsb2NhbGl6ZXIuc3RhcnRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRzY3JvbGxUb1QsXG4gICAgICAgIF90aGlzJHByb3BzJGVuYWJsZUF1dCA9IF90aGlzJHByb3BzLmVuYWJsZUF1dG9TY3JvbGwsXG4gICAgICAgIGVuYWJsZUF1dG9TY3JvbGwgPSBfdGhpcyRwcm9wcyRlbmFibGVBdXQgPT09IHZvaWQgMCA/IHRydWUgOiBfdGhpcyRwcm9wcyRlbmFibGVBdXQsXG4gICAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF90aGlzJHByb3BzLCBfZXhjbHVkZWQkNCk7XG4gICAgICB2YXIgcmFuZ2UgPSBEYXkucmFuZ2UoZGF0ZSwge1xuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplclxuICAgICAgfSk7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVGltZUdyaWQsIE9iamVjdC5hc3NpZ24oe30sIHByb3BzLCB7XG4gICAgICAgIHJhbmdlOiByYW5nZSxcbiAgICAgICAgZXZlbnRPZmZzZXQ6IDEwLFxuICAgICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplcixcbiAgICAgICAgbWluOiBtaW4sXG4gICAgICAgIG1heDogbWF4LFxuICAgICAgICBzY3JvbGxUb1RpbWU6IHNjcm9sbFRvVGltZSxcbiAgICAgICAgZW5hYmxlQXV0b1Njcm9sbDogZW5hYmxlQXV0b1Njcm9sbFxuICAgICAgfSkpO1xuICAgIH1cbiAgfV0pO1xufShSZWFjdC5Db21wb25lbnQpO1xuRGF5LnJhbmdlID0gZnVuY3Rpb24gKGRhdGUsIF9yZWYpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYubG9jYWxpemVyO1xuICByZXR1cm4gW2xvY2FsaXplci5zdGFydE9mKGRhdGUsICdkYXknKV07XG59O1xuRGF5Lm5hdmlnYXRlID0gZnVuY3Rpb24gKGRhdGUsIGFjdGlvbiwgX3JlZjIpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYyLmxvY2FsaXplcjtcbiAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICBjYXNlIG5hdmlnYXRlLlBSRVZJT1VTOlxuICAgICAgcmV0dXJuIGxvY2FsaXplci5hZGQoZGF0ZSwgLTEsICdkYXknKTtcbiAgICBjYXNlIG5hdmlnYXRlLk5FWFQ6XG4gICAgICByZXR1cm4gbG9jYWxpemVyLmFkZChkYXRlLCAxLCAnZGF5Jyk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBkYXRlO1xuICB9XG59O1xuRGF5LnRpdGxlID0gZnVuY3Rpb24gKGRhdGUsIF9yZWYzKSB7XG4gIHZhciBsb2NhbGl6ZXIgPSBfcmVmMy5sb2NhbGl6ZXI7XG4gIHJldHVybiBsb2NhbGl6ZXIuZm9ybWF0KGRhdGUsICdkYXlIZWFkZXJGb3JtYXQnKTtcbn07XG5cbnZhciBfZXhjbHVkZWQkMyA9IFtcImRhdGVcIiwgXCJsb2NhbGl6ZXJcIiwgXCJtaW5cIiwgXCJtYXhcIiwgXCJzY3JvbGxUb1RpbWVcIiwgXCJlbmFibGVBdXRvU2Nyb2xsXCJdO1xudmFyIFdlZWsgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgZnVuY3Rpb24gV2VlaygpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2Vlayk7XG4gICAgcmV0dXJuIF9jYWxsU3VwZXIodGhpcywgV2VlaywgYXJndW1lbnRzKTtcbiAgfVxuICBfaW5oZXJpdHMoV2VlaywgX1JlYWN0JENvbXBvbmVudCk7XG4gIHJldHVybiBfY3JlYXRlQ2xhc3MoV2VlaywgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIC8qKlxuICAgICAgICogVGhpcyBhbGxvd3MgdXMgdG8gZGVmYXVsdCBtaW4sIG1heCwgYW5kIHNjcm9sbFRvVGltZVxuICAgICAgICogdXNpbmcgb3VyIGxvY2FsaXplci4gVGhpcyBpcyBuZWNlc3NhcnkgdW50aWwgc3VjaCB0aW1lXG4gICAgICAgKiBhcyBUaW1lR3JpZCBpcyBjb252ZXJ0ZWQgdG8gYSBmdW5jdGlvbmFsIGNvbXBvbmVudC5cbiAgICAgICAqL1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgZGF0ZSA9IF90aGlzJHByb3BzLmRhdGUsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzLmxvY2FsaXplcixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWluID0gX3RoaXMkcHJvcHMubWluLFxuICAgICAgICBtaW4gPSBfdGhpcyRwcm9wcyRtaW4gPT09IHZvaWQgMCA/IGxvY2FsaXplci5zdGFydE9mKG5ldyBEYXRlKCksICdkYXknKSA6IF90aGlzJHByb3BzJG1pbixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWF4ID0gX3RoaXMkcHJvcHMubWF4LFxuICAgICAgICBtYXggPSBfdGhpcyRwcm9wcyRtYXggPT09IHZvaWQgMCA/IGxvY2FsaXplci5lbmRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRtYXgsXG4gICAgICAgIF90aGlzJHByb3BzJHNjcm9sbFRvVCA9IF90aGlzJHByb3BzLnNjcm9sbFRvVGltZSxcbiAgICAgICAgc2Nyb2xsVG9UaW1lID0gX3RoaXMkcHJvcHMkc2Nyb2xsVG9UID09PSB2b2lkIDAgPyBsb2NhbGl6ZXIuc3RhcnRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRzY3JvbGxUb1QsXG4gICAgICAgIF90aGlzJHByb3BzJGVuYWJsZUF1dCA9IF90aGlzJHByb3BzLmVuYWJsZUF1dG9TY3JvbGwsXG4gICAgICAgIGVuYWJsZUF1dG9TY3JvbGwgPSBfdGhpcyRwcm9wcyRlbmFibGVBdXQgPT09IHZvaWQgMCA/IHRydWUgOiBfdGhpcyRwcm9wcyRlbmFibGVBdXQsXG4gICAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF90aGlzJHByb3BzLCBfZXhjbHVkZWQkMyk7XG4gICAgICB2YXIgcmFuZ2UgPSBXZWVrLnJhbmdlKGRhdGUsIHRoaXMucHJvcHMpO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRpbWVHcmlkLCBPYmplY3QuYXNzaWduKHt9LCBwcm9wcywge1xuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIGV2ZW50T2Zmc2V0OiAxNSxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIG1pbjogbWluLFxuICAgICAgICBtYXg6IG1heCxcbiAgICAgICAgc2Nyb2xsVG9UaW1lOiBzY3JvbGxUb1RpbWUsXG4gICAgICAgIGVuYWJsZUF1dG9TY3JvbGw6IGVuYWJsZUF1dG9TY3JvbGxcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcbldlZWsuZGVmYXVsdFByb3BzID0gVGltZUdyaWQuZGVmYXVsdFByb3BzO1xuV2Vlay5uYXZpZ2F0ZSA9IGZ1bmN0aW9uIChkYXRlLCBhY3Rpb24sIF9yZWYpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYubG9jYWxpemVyO1xuICBzd2l0Y2ggKGFjdGlvbikge1xuICAgIGNhc2UgbmF2aWdhdGUuUFJFVklPVVM6XG4gICAgICByZXR1cm4gbG9jYWxpemVyLmFkZChkYXRlLCAtMSwgJ3dlZWsnKTtcbiAgICBjYXNlIG5hdmlnYXRlLk5FWFQ6XG4gICAgICByZXR1cm4gbG9jYWxpemVyLmFkZChkYXRlLCAxLCAnd2VlaycpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZGF0ZTtcbiAgfVxufTtcbldlZWsucmFuZ2UgPSBmdW5jdGlvbiAoZGF0ZSwgX3JlZjIpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYyLmxvY2FsaXplcjtcbiAgdmFyIGZpcnN0T2ZXZWVrID0gbG9jYWxpemVyLnN0YXJ0T2ZXZWVrKCk7XG4gIHZhciBzdGFydCA9IGxvY2FsaXplci5zdGFydE9mKGRhdGUsICd3ZWVrJywgZmlyc3RPZldlZWspO1xuICB2YXIgZW5kID0gbG9jYWxpemVyLmVuZE9mKGRhdGUsICd3ZWVrJywgZmlyc3RPZldlZWspO1xuICByZXR1cm4gbG9jYWxpemVyLnJhbmdlKHN0YXJ0LCBlbmQpO1xufTtcbldlZWsudGl0bGUgPSBmdW5jdGlvbiAoZGF0ZSwgX3JlZjMpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYzLmxvY2FsaXplcjtcbiAgdmFyIF9XZWVrJHJhbmdlID0gV2Vlay5yYW5nZShkYXRlLCB7XG4gICAgICBsb2NhbGl6ZXI6IGxvY2FsaXplclxuICAgIH0pLFxuICAgIF9XZWVrJHJhbmdlMiA9IF90b0FycmF5KF9XZWVrJHJhbmdlKSxcbiAgICBzdGFydCA9IF9XZWVrJHJhbmdlMlswXSxcbiAgICByZXN0ID0gX1dlZWskcmFuZ2UyLnNsaWNlKDEpO1xuICByZXR1cm4gbG9jYWxpemVyLmZvcm1hdCh7XG4gICAgc3RhcnQ6IHN0YXJ0LFxuICAgIGVuZDogcmVzdC5wb3AoKVxuICB9LCAnZGF5UmFuZ2VIZWFkZXJGb3JtYXQnKTtcbn07XG5cbnZhciBfZXhjbHVkZWQkMiA9IFtcImRhdGVcIiwgXCJsb2NhbGl6ZXJcIiwgXCJtaW5cIiwgXCJtYXhcIiwgXCJzY3JvbGxUb1RpbWVcIiwgXCJlbmFibGVBdXRvU2Nyb2xsXCJdO1xuZnVuY3Rpb24gd29ya1dlZWtSYW5nZShkYXRlLCBvcHRpb25zKSB7XG4gIHJldHVybiBXZWVrLnJhbmdlKGRhdGUsIG9wdGlvbnMpLmZpbHRlcihmdW5jdGlvbiAoZCkge1xuICAgIHJldHVybiBbNiwgMF0uaW5kZXhPZihkLmdldERheSgpKSA9PT0gLTE7XG4gIH0pO1xufVxudmFyIFdvcmtXZWVrID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIFdvcmtXZWVrKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXb3JrV2Vlayk7XG4gICAgcmV0dXJuIF9jYWxsU3VwZXIodGhpcywgV29ya1dlZWssIGFyZ3VtZW50cyk7XG4gIH1cbiAgX2luaGVyaXRzKFdvcmtXZWVrLCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhXb3JrV2VlaywgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIC8qKlxuICAgICAgICogVGhpcyBhbGxvd3MgdXMgdG8gZGVmYXVsdCBtaW4sIG1heCwgYW5kIHNjcm9sbFRvVGltZVxuICAgICAgICogdXNpbmcgb3VyIGxvY2FsaXplci4gVGhpcyBpcyBuZWNlc3NhcnkgdW50aWwgc3VjaCB0aW1lXG4gICAgICAgKiBhcyBUaW1lR3JpZCBpcyBjb252ZXJ0ZWQgdG8gYSBmdW5jdGlvbmFsIGNvbXBvbmVudC5cbiAgICAgICAqL1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgZGF0ZSA9IF90aGlzJHByb3BzLmRhdGUsXG4gICAgICAgIGxvY2FsaXplciA9IF90aGlzJHByb3BzLmxvY2FsaXplcixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWluID0gX3RoaXMkcHJvcHMubWluLFxuICAgICAgICBtaW4gPSBfdGhpcyRwcm9wcyRtaW4gPT09IHZvaWQgMCA/IGxvY2FsaXplci5zdGFydE9mKG5ldyBEYXRlKCksICdkYXknKSA6IF90aGlzJHByb3BzJG1pbixcbiAgICAgICAgX3RoaXMkcHJvcHMkbWF4ID0gX3RoaXMkcHJvcHMubWF4LFxuICAgICAgICBtYXggPSBfdGhpcyRwcm9wcyRtYXggPT09IHZvaWQgMCA/IGxvY2FsaXplci5lbmRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRtYXgsXG4gICAgICAgIF90aGlzJHByb3BzJHNjcm9sbFRvVCA9IF90aGlzJHByb3BzLnNjcm9sbFRvVGltZSxcbiAgICAgICAgc2Nyb2xsVG9UaW1lID0gX3RoaXMkcHJvcHMkc2Nyb2xsVG9UID09PSB2b2lkIDAgPyBsb2NhbGl6ZXIuc3RhcnRPZihuZXcgRGF0ZSgpLCAnZGF5JykgOiBfdGhpcyRwcm9wcyRzY3JvbGxUb1QsXG4gICAgICAgIF90aGlzJHByb3BzJGVuYWJsZUF1dCA9IF90aGlzJHByb3BzLmVuYWJsZUF1dG9TY3JvbGwsXG4gICAgICAgIGVuYWJsZUF1dG9TY3JvbGwgPSBfdGhpcyRwcm9wcyRlbmFibGVBdXQgPT09IHZvaWQgMCA/IHRydWUgOiBfdGhpcyRwcm9wcyRlbmFibGVBdXQsXG4gICAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF90aGlzJHByb3BzLCBfZXhjbHVkZWQkMik7XG4gICAgICB2YXIgcmFuZ2UgPSB3b3JrV2Vla1JhbmdlKGRhdGUsIHRoaXMucHJvcHMpO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRpbWVHcmlkLCBPYmplY3QuYXNzaWduKHt9LCBwcm9wcywge1xuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIGV2ZW50T2Zmc2V0OiAxNSxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIG1pbjogbWluLFxuICAgICAgICBtYXg6IG1heCxcbiAgICAgICAgc2Nyb2xsVG9UaW1lOiBzY3JvbGxUb1RpbWUsXG4gICAgICAgIGVuYWJsZUF1dG9TY3JvbGw6IGVuYWJsZUF1dG9TY3JvbGxcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1dKTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcbldvcmtXZWVrLmRlZmF1bHRQcm9wcyA9IFRpbWVHcmlkLmRlZmF1bHRQcm9wcztcbldvcmtXZWVrLnJhbmdlID0gd29ya1dlZWtSYW5nZTtcbldvcmtXZWVrLm5hdmlnYXRlID0gV2Vlay5uYXZpZ2F0ZTtcbldvcmtXZWVrLnRpdGxlID0gZnVuY3Rpb24gKGRhdGUsIF9yZWYpIHtcbiAgdmFyIGxvY2FsaXplciA9IF9yZWYubG9jYWxpemVyO1xuICB2YXIgX3dvcmtXZWVrUmFuZ2UgPSB3b3JrV2Vla1JhbmdlKGRhdGUsIHtcbiAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gICAgfSksXG4gICAgX3dvcmtXZWVrUmFuZ2UyID0gX3RvQXJyYXkoX3dvcmtXZWVrUmFuZ2UpLFxuICAgIHN0YXJ0ID0gX3dvcmtXZWVrUmFuZ2UyWzBdLFxuICAgIHJlc3QgPSBfd29ya1dlZWtSYW5nZTIuc2xpY2UoMSk7XG4gIHJldHVybiBsb2NhbGl6ZXIuZm9ybWF0KHtcbiAgICBzdGFydDogc3RhcnQsXG4gICAgZW5kOiByZXN0LnBvcCgpXG4gIH0sICdkYXlSYW5nZUhlYWRlckZvcm1hdCcpO1xufTtcblxudmFyIERFRkFVTFRfTEVOR1RIID0gMzA7XG5mdW5jdGlvbiBBZ2VuZGEoX3JlZikge1xuICB2YXIgYWNjZXNzb3JzID0gX3JlZi5hY2Nlc3NvcnMsXG4gICAgY29tcG9uZW50cyA9IF9yZWYuY29tcG9uZW50cyxcbiAgICBkYXRlID0gX3JlZi5kYXRlLFxuICAgIGV2ZW50cyA9IF9yZWYuZXZlbnRzLFxuICAgIGdldHRlcnMgPSBfcmVmLmdldHRlcnMsXG4gICAgX3JlZiRsZW5ndGggPSBfcmVmLmxlbmd0aCxcbiAgICBsZW5ndGggPSBfcmVmJGxlbmd0aCA9PT0gdm9pZCAwID8gREVGQVVMVF9MRU5HVEggOiBfcmVmJGxlbmd0aCxcbiAgICBsb2NhbGl6ZXIgPSBfcmVmLmxvY2FsaXplcixcbiAgICBvbkRvdWJsZUNsaWNrRXZlbnQgPSBfcmVmLm9uRG91YmxlQ2xpY2tFdmVudCxcbiAgICBvblNlbGVjdEV2ZW50ID0gX3JlZi5vblNlbGVjdEV2ZW50LFxuICAgIHNlbGVjdGVkID0gX3JlZi5zZWxlY3RlZDtcbiAgdmFyIGhlYWRlclJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIGRhdGVDb2xSZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciB0aW1lQ29sUmVmID0gdXNlUmVmKG51bGwpO1xuICB2YXIgY29udGVudFJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIHRib2R5UmVmID0gdXNlUmVmKG51bGwpO1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIF9hZGp1c3RIZWFkZXIoKTtcbiAgfSk7XG4gIHZhciByZW5kZXJEYXkgPSBmdW5jdGlvbiByZW5kZXJEYXkoZGF5LCBldmVudHMsIGRheUtleSkge1xuICAgIHZhciBFdmVudCA9IGNvbXBvbmVudHMuZXZlbnQsXG4gICAgICBBZ2VuZGFEYXRlID0gY29tcG9uZW50cy5kYXRlO1xuICAgIGV2ZW50cyA9IGV2ZW50cy5maWx0ZXIoZnVuY3Rpb24gKGUpIHtcbiAgICAgIHJldHVybiBpblJhbmdlKGUsIGxvY2FsaXplci5zdGFydE9mKGRheSwgJ2RheScpLCBsb2NhbGl6ZXIuZW5kT2YoZGF5LCAnZGF5JyksIGFjY2Vzc29ycywgbG9jYWxpemVyKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZXZlbnRzLm1hcChmdW5jdGlvbiAoZXZlbnQsIGlkeCkge1xuICAgICAgdmFyIHRpdGxlID0gYWNjZXNzb3JzLnRpdGxlKGV2ZW50KTtcbiAgICAgIHZhciBlbmQgPSBhY2Nlc3NvcnMuZW5kKGV2ZW50KTtcbiAgICAgIHZhciBzdGFydCA9IGFjY2Vzc29ycy5zdGFydChldmVudCk7XG4gICAgICB2YXIgdXNlclByb3BzID0gZ2V0dGVycy5ldmVudFByb3AoZXZlbnQsIHN0YXJ0LCBlbmQsIGlzU2VsZWN0ZWQoZXZlbnQsIHNlbGVjdGVkKSk7XG4gICAgICB2YXIgZGF0ZUxhYmVsID0gaWR4ID09PSAwICYmIGxvY2FsaXplci5mb3JtYXQoZGF5LCAnYWdlbmRhRGF0ZUZvcm1hdCcpO1xuICAgICAgdmFyIGZpcnN0ID0gaWR4ID09PSAwID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiLCB7XG4gICAgICAgIHJvd1NwYW46IGV2ZW50cy5sZW5ndGgsXG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtYWdlbmRhLWRhdGUtY2VsbFwiXG4gICAgICB9LCBBZ2VuZGFEYXRlID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQWdlbmRhRGF0ZSwge1xuICAgICAgICBkYXk6IGRheSxcbiAgICAgICAgbGFiZWw6IGRhdGVMYWJlbFxuICAgICAgfSkgOiBkYXRlTGFiZWwpIDogZmFsc2U7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0clwiLCB7XG4gICAgICAgIGtleTogZGF5S2V5ICsgJ18nICsgaWR4LFxuICAgICAgICBjbGFzc05hbWU6IHVzZXJQcm9wcy5jbGFzc05hbWUsXG4gICAgICAgIHN0eWxlOiB1c2VyUHJvcHMuc3R5bGVcbiAgICAgIH0sIGZpcnN0LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInRkXCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1hZ2VuZGEtdGltZS1jZWxsXCJcbiAgICAgIH0sIHRpbWVSYW5nZUxhYmVsKGRheSwgZXZlbnQpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJyYmMtYWdlbmRhLWV2ZW50LWNlbGxcIixcbiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICAgICAgcmV0dXJuIG9uU2VsZWN0RXZlbnQgJiYgb25TZWxlY3RFdmVudChldmVudCwgZSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRG91YmxlQ2xpY2s6IGZ1bmN0aW9uIG9uRG91YmxlQ2xpY2soZSkge1xuICAgICAgICAgIHJldHVybiBvbkRvdWJsZUNsaWNrRXZlbnQgJiYgb25Eb3VibGVDbGlja0V2ZW50KGV2ZW50LCBlKTtcbiAgICAgICAgfVxuICAgICAgfSwgRXZlbnQgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChFdmVudCwge1xuICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgIHRpdGxlOiB0aXRsZVxuICAgICAgfSkgOiB0aXRsZSkpO1xuICAgIH0sIFtdKTtcbiAgfTtcbiAgdmFyIHRpbWVSYW5nZUxhYmVsID0gZnVuY3Rpb24gdGltZVJhbmdlTGFiZWwoZGF5LCBldmVudCkge1xuICAgIHZhciBsYWJlbENsYXNzID0gJycsXG4gICAgICBUaW1lQ29tcG9uZW50ID0gY29tcG9uZW50cy50aW1lLFxuICAgICAgbGFiZWwgPSBsb2NhbGl6ZXIubWVzc2FnZXMuYWxsRGF5O1xuICAgIHZhciBlbmQgPSBhY2Nlc3NvcnMuZW5kKGV2ZW50KTtcbiAgICB2YXIgc3RhcnQgPSBhY2Nlc3NvcnMuc3RhcnQoZXZlbnQpO1xuICAgIGlmICghYWNjZXNzb3JzLmFsbERheShldmVudCkpIHtcbiAgICAgIGlmIChsb2NhbGl6ZXIuZXEoc3RhcnQsIGVuZCkpIHtcbiAgICAgICAgbGFiZWwgPSBsb2NhbGl6ZXIuZm9ybWF0KHN0YXJ0LCAnYWdlbmRhVGltZUZvcm1hdCcpO1xuICAgICAgfSBlbHNlIGlmIChsb2NhbGl6ZXIuaXNTYW1lRGF0ZShzdGFydCwgZW5kKSkge1xuICAgICAgICBsYWJlbCA9IGxvY2FsaXplci5mb3JtYXQoe1xuICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICBlbmQ6IGVuZFxuICAgICAgICB9LCAnYWdlbmRhVGltZVJhbmdlRm9ybWF0Jyk7XG4gICAgICB9IGVsc2UgaWYgKGxvY2FsaXplci5pc1NhbWVEYXRlKGRheSwgc3RhcnQpKSB7XG4gICAgICAgIGxhYmVsID0gbG9jYWxpemVyLmZvcm1hdChzdGFydCwgJ2FnZW5kYVRpbWVGb3JtYXQnKTtcbiAgICAgIH0gZWxzZSBpZiAobG9jYWxpemVyLmlzU2FtZURhdGUoZGF5LCBlbmQpKSB7XG4gICAgICAgIGxhYmVsID0gbG9jYWxpemVyLmZvcm1hdChlbmQsICdhZ2VuZGFUaW1lRm9ybWF0Jyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChsb2NhbGl6ZXIuZ3QoZGF5LCBzdGFydCwgJ2RheScpKSBsYWJlbENsYXNzID0gJ3JiYy1jb250aW51ZXMtcHJpb3InO1xuICAgIGlmIChsb2NhbGl6ZXIubHQoZGF5LCBlbmQsICdkYXknKSkgbGFiZWxDbGFzcyArPSAnIHJiYy1jb250aW51ZXMtYWZ0ZXInO1xuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgY2xhc3NOYW1lOiBsYWJlbENsYXNzLnRyaW0oKVxuICAgIH0sIFRpbWVDb21wb25lbnQgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUaW1lQ29tcG9uZW50LCB7XG4gICAgICBldmVudDogZXZlbnQsXG4gICAgICBkYXk6IGRheSxcbiAgICAgIGxhYmVsOiBsYWJlbFxuICAgIH0pIDogbGFiZWwpO1xuICB9O1xuICB2YXIgX2FkanVzdEhlYWRlciA9IGZ1bmN0aW9uIF9hZGp1c3RIZWFkZXIoKSB7XG4gICAgaWYgKCF0Ym9keVJlZi5jdXJyZW50KSByZXR1cm47XG4gICAgdmFyIGhlYWRlciA9IGhlYWRlclJlZi5jdXJyZW50O1xuICAgIHZhciBmaXJzdFJvdyA9IHRib2R5UmVmLmN1cnJlbnQuZmlyc3RDaGlsZDtcbiAgICBpZiAoIWZpcnN0Um93KSByZXR1cm47XG4gICAgdmFyIGlzT3ZlcmZsb3dpbmcgPSBjb250ZW50UmVmLmN1cnJlbnQuc2Nyb2xsSGVpZ2h0ID4gY29udGVudFJlZi5jdXJyZW50LmNsaWVudEhlaWdodDtcbiAgICB2YXIgX3dpZHRocyA9IFtdO1xuICAgIHZhciB3aWR0aHMgPSBfd2lkdGhzO1xuICAgIF93aWR0aHMgPSBbZ2V0V2lkdGgoZmlyc3RSb3cuY2hpbGRyZW5bMF0pLCBnZXRXaWR0aChmaXJzdFJvdy5jaGlsZHJlblsxXSldO1xuICAgIGlmICh3aWR0aHNbMF0gIT09IF93aWR0aHNbMF0gfHwgd2lkdGhzWzFdICE9PSBfd2lkdGhzWzFdKSB7XG4gICAgICBkYXRlQ29sUmVmLmN1cnJlbnQuc3R5bGUud2lkdGggPSBfd2lkdGhzWzBdICsgJ3B4JztcbiAgICAgIHRpbWVDb2xSZWYuY3VycmVudC5zdHlsZS53aWR0aCA9IF93aWR0aHNbMV0gKyAncHgnO1xuICAgIH1cbiAgICBpZiAoaXNPdmVyZmxvd2luZykge1xuICAgICAgYWRkQ2xhc3MoaGVhZGVyLCAncmJjLWhlYWRlci1vdmVyZmxvd2luZycpO1xuICAgICAgaGVhZGVyLnN0eWxlLm1hcmdpblJpZ2h0ID0gc2Nyb2xsYmFyU2l6ZSgpICsgJ3B4JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlQ2xhc3MoaGVhZGVyLCAncmJjLWhlYWRlci1vdmVyZmxvd2luZycpO1xuICAgIH1cbiAgfTtcbiAgdmFyIG1lc3NhZ2VzID0gbG9jYWxpemVyLm1lc3NhZ2VzO1xuICB2YXIgZW5kID0gbG9jYWxpemVyLmFkZChkYXRlLCBsZW5ndGgsICdkYXknKTtcbiAgdmFyIHJhbmdlID0gbG9jYWxpemVyLnJhbmdlKGRhdGUsIGVuZCwgJ2RheScpO1xuICBldmVudHMgPSBldmVudHMuZmlsdGVyKGZ1bmN0aW9uIChldmVudCkge1xuICAgIHJldHVybiBpblJhbmdlKGV2ZW50LCBsb2NhbGl6ZXIuc3RhcnRPZihkYXRlLCAnZGF5JyksIGxvY2FsaXplci5lbmRPZihlbmQsICdkYXknKSwgYWNjZXNzb3JzLCBsb2NhbGl6ZXIpO1xuICB9KTtcbiAgZXZlbnRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gK2FjY2Vzc29ycy5zdGFydChhKSAtICthY2Nlc3NvcnMuc3RhcnQoYik7XG4gIH0pO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIGNsYXNzTmFtZTogXCJyYmMtYWdlbmRhLXZpZXdcIlxuICB9LCBldmVudHMubGVuZ3RoICE9PSAwID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwidGFibGVcIiwge1xuICAgIHJlZjogaGVhZGVyUmVmLFxuICAgIGNsYXNzTmFtZTogXCJyYmMtYWdlbmRhLXRhYmxlXCJcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0aGVhZFwiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInRyXCIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwidGhcIiwge1xuICAgIGNsYXNzTmFtZTogXCJyYmMtaGVhZGVyXCIsXG4gICAgcmVmOiBkYXRlQ29sUmVmXG4gIH0sIG1lc3NhZ2VzLmRhdGUpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInRoXCIsIHtcbiAgICBjbGFzc05hbWU6IFwicmJjLWhlYWRlclwiLFxuICAgIHJlZjogdGltZUNvbFJlZlxuICB9LCBtZXNzYWdlcy50aW1lKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiLCB7XG4gICAgY2xhc3NOYW1lOiBcInJiYy1oZWFkZXJcIlxuICB9LCBtZXNzYWdlcy5ldmVudCkpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICBjbGFzc05hbWU6IFwicmJjLWFnZW5kYS1jb250ZW50XCIsXG4gICAgcmVmOiBjb250ZW50UmVmXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwidGFibGVcIiwge1xuICAgIGNsYXNzTmFtZTogXCJyYmMtYWdlbmRhLXRhYmxlXCJcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiLCB7XG4gICAgcmVmOiB0Ym9keVJlZlxuICB9LCByYW5nZS5tYXAoZnVuY3Rpb24gKGRheSwgaWR4KSB7XG4gICAgcmV0dXJuIHJlbmRlckRheShkYXksIGV2ZW50cywgaWR4KTtcbiAgfSkpKSkpIDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtcbiAgICBjbGFzc05hbWU6IFwicmJjLWFnZW5kYS1lbXB0eVwiXG4gIH0sIG1lc3NhZ2VzLm5vRXZlbnRzSW5SYW5nZSkpO1xufVxuQWdlbmRhLnJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBfcmVmMikge1xuICB2YXIgX3JlZjIkbGVuZ3RoID0gX3JlZjIubGVuZ3RoLFxuICAgIGxlbmd0aCA9IF9yZWYyJGxlbmd0aCA9PT0gdm9pZCAwID8gREVGQVVMVF9MRU5HVEggOiBfcmVmMiRsZW5ndGgsXG4gICAgbG9jYWxpemVyID0gX3JlZjIubG9jYWxpemVyO1xuICB2YXIgZW5kID0gbG9jYWxpemVyLmFkZChzdGFydCwgbGVuZ3RoLCAnZGF5Jyk7XG4gIHJldHVybiB7XG4gICAgc3RhcnQ6IHN0YXJ0LFxuICAgIGVuZDogZW5kXG4gIH07XG59O1xuQWdlbmRhLm5hdmlnYXRlID0gZnVuY3Rpb24gKGRhdGUsIGFjdGlvbiwgX3JlZjMpIHtcbiAgdmFyIF9yZWYzJGxlbmd0aCA9IF9yZWYzLmxlbmd0aCxcbiAgICBsZW5ndGggPSBfcmVmMyRsZW5ndGggPT09IHZvaWQgMCA/IERFRkFVTFRfTEVOR1RIIDogX3JlZjMkbGVuZ3RoLFxuICAgIGxvY2FsaXplciA9IF9yZWYzLmxvY2FsaXplcjtcbiAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICBjYXNlIG5hdmlnYXRlLlBSRVZJT1VTOlxuICAgICAgcmV0dXJuIGxvY2FsaXplci5hZGQoZGF0ZSwgLWxlbmd0aCwgJ2RheScpO1xuICAgIGNhc2UgbmF2aWdhdGUuTkVYVDpcbiAgICAgIHJldHVybiBsb2NhbGl6ZXIuYWRkKGRhdGUsIGxlbmd0aCwgJ2RheScpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZGF0ZTtcbiAgfVxufTtcbkFnZW5kYS50aXRsZSA9IGZ1bmN0aW9uIChzdGFydCwgX3JlZjQpIHtcbiAgdmFyIF9yZWY0JGxlbmd0aCA9IF9yZWY0Lmxlbmd0aCxcbiAgICBsZW5ndGggPSBfcmVmNCRsZW5ndGggPT09IHZvaWQgMCA/IERFRkFVTFRfTEVOR1RIIDogX3JlZjQkbGVuZ3RoLFxuICAgIGxvY2FsaXplciA9IF9yZWY0LmxvY2FsaXplcjtcbiAgdmFyIGVuZCA9IGxvY2FsaXplci5hZGQoc3RhcnQsIGxlbmd0aCwgJ2RheScpO1xuICByZXR1cm4gbG9jYWxpemVyLmZvcm1hdCh7XG4gICAgc3RhcnQ6IHN0YXJ0LFxuICAgIGVuZDogZW5kXG4gIH0sICdhZ2VuZGFIZWFkZXJGb3JtYXQnKTtcbn07XG5cbnZhciBWSUVXUyA9IF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoe30sIHZpZXdzLk1PTlRILCBNb250aFZpZXcpLCB2aWV3cy5XRUVLLCBXZWVrKSwgdmlld3MuV09SS19XRUVLLCBXb3JrV2VlayksIHZpZXdzLkRBWSwgRGF5KSwgdmlld3MuQUdFTkRBLCBBZ2VuZGEpO1xuXG52YXIgX2V4Y2x1ZGVkJDEgPSBbXCJhY3Rpb25cIiwgXCJkYXRlXCIsIFwidG9kYXlcIl07XG5mdW5jdGlvbiBtb3ZlRGF0ZShWaWV3LCBfcmVmKSB7XG4gIHZhciBhY3Rpb24gPSBfcmVmLmFjdGlvbixcbiAgICBkYXRlID0gX3JlZi5kYXRlLFxuICAgIHRvZGF5ID0gX3JlZi50b2RheSxcbiAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfcmVmLCBfZXhjbHVkZWQkMSk7XG4gIFZpZXcgPSB0eXBlb2YgVmlldyA9PT0gJ3N0cmluZycgPyBWSUVXU1tWaWV3XSA6IFZpZXc7XG4gIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgY2FzZSBuYXZpZ2F0ZS5UT0RBWTpcbiAgICAgIGRhdGUgPSB0b2RheSB8fCBuZXcgRGF0ZSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBuYXZpZ2F0ZS5EQVRFOlxuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGludmFyaWFudChWaWV3ICYmIHR5cGVvZiBWaWV3Lm5hdmlnYXRlID09PSAnZnVuY3Rpb24nLCAnQ2FsZW5kYXIgVmlldyBjb21wb25lbnRzIG11c3QgaW1wbGVtZW50IGEgc3RhdGljIGAubmF2aWdhdGUoZGF0ZSwgYWN0aW9uKWAgbWV0aG9kLnMnKTtcbiAgICAgIGRhdGUgPSBWaWV3Lm5hdmlnYXRlKGRhdGUsIGFjdGlvbiwgcHJvcHMpO1xuICB9XG4gIHJldHVybiBkYXRlO1xufVxuXG52YXIgVG9vbGJhciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBmdW5jdGlvbiBUb29sYmFyKCkge1xuICAgIHZhciBfdGhpcztcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG9vbGJhcik7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cbiAgICBfdGhpcyA9IF9jYWxsU3VwZXIodGhpcywgVG9vbGJhciwgW10uY29uY2F0KGFyZ3MpKTtcbiAgICBfdGhpcy5uYXZpZ2F0ZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgIF90aGlzLnByb3BzLm9uTmF2aWdhdGUoYWN0aW9uKTtcbiAgICB9O1xuICAgIF90aGlzLnZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgX3RoaXMucHJvcHMub25WaWV3KHZpZXcpO1xuICAgIH07XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIF9pbmhlcml0cyhUb29sYmFyLCBfUmVhY3QkQ29tcG9uZW50KTtcbiAgcmV0dXJuIF9jcmVhdGVDbGFzcyhUb29sYmFyLCBbe1xuICAgIGtleTogXCJyZW5kZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgbWVzc2FnZXMgPSBfdGhpcyRwcm9wcy5sb2NhbGl6ZXIubWVzc2FnZXMsXG4gICAgICAgIGxhYmVsID0gX3RoaXMkcHJvcHMubGFiZWw7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXRvb2xiYXJcIlxuICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcInJiYy1idG4tZ3JvdXBcIlxuICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwge1xuICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxuICAgICAgICBvbkNsaWNrOiB0aGlzLm5hdmlnYXRlLmJpbmQobnVsbCwgbmF2aWdhdGUuVE9EQVkpXG4gICAgICB9LCBtZXNzYWdlcy50b2RheSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHtcbiAgICAgICAgdHlwZTogXCJidXR0b25cIixcbiAgICAgICAgb25DbGljazogdGhpcy5uYXZpZ2F0ZS5iaW5kKG51bGwsIG5hdmlnYXRlLlBSRVZJT1VTKVxuICAgICAgfSwgbWVzc2FnZXMucHJldmlvdXMpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCB7XG4gICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXG4gICAgICAgIG9uQ2xpY2s6IHRoaXMubmF2aWdhdGUuYmluZChudWxsLCBuYXZpZ2F0ZS5ORVhUKVxuICAgICAgfSwgbWVzc2FnZXMubmV4dCkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLXRvb2xiYXItbGFiZWxcIlxuICAgICAgfSwgbGFiZWwpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgICBjbGFzc05hbWU6IFwicmJjLWJ0bi1ncm91cFwiXG4gICAgICB9LCB0aGlzLnZpZXdOYW1lc0dyb3VwKG1lc3NhZ2VzKSkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ2aWV3TmFtZXNHcm91cFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB2aWV3TmFtZXNHcm91cChtZXNzYWdlcykge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG4gICAgICB2YXIgdmlld05hbWVzID0gdGhpcy5wcm9wcy52aWV3cztcbiAgICAgIHZhciB2aWV3ID0gdGhpcy5wcm9wcy52aWV3O1xuICAgICAgaWYgKHZpZXdOYW1lcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHJldHVybiB2aWV3TmFtZXMubWFwKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHtcbiAgICAgICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXG4gICAgICAgICAgICBrZXk6IG5hbWUsXG4gICAgICAgICAgICBjbGFzc05hbWU6IGNsc3goe1xuICAgICAgICAgICAgICAncmJjLWFjdGl2ZSc6IHZpZXcgPT09IG5hbWVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25DbGljazogX3RoaXMyLnZpZXcuYmluZChudWxsLCBuYW1lKVxuICAgICAgICAgIH0sIG1lc3NhZ2VzW25hbWVdKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XSk7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5cbi8qKlxuICogUmV0cmlldmUgdmlhIGFuIGFjY2Vzc29yLWxpa2UgcHJvcGVydHlcbiAqXG4gKiAgICBhY2Nlc3NvcihvYmosICduYW1lJykgICAvLyA9PiByZXRyaWV2ZXMgb2JqWyduYW1lJ11cbiAqICAgIGFjY2Vzc29yKGRhdGEsIGZ1bmMpICAgIC8vID0+IHJldHJpZXZlcyBmdW5jKGRhdGEpXG4gKiAgICAuLi4gb3RoZXJ3aXNlIG51bGxcbiAqL1xuZnVuY3Rpb24gYWNjZXNzb3IoZGF0YSwgZmllbGQpIHtcbiAgdmFyIHZhbHVlID0gbnVsbDtcbiAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ2Z1bmN0aW9uJykgdmFsdWUgPSBmaWVsZChkYXRhKTtlbHNlIGlmICh0eXBlb2YgZmllbGQgPT09ICdzdHJpbmcnICYmIF90eXBlb2YoZGF0YSkgPT09ICdvYmplY3QnICYmIGRhdGEgIT0gbnVsbCAmJiBmaWVsZCBpbiBkYXRhKSB2YWx1ZSA9IGRhdGFbZmllbGRdO1xuICByZXR1cm4gdmFsdWU7XG59XG52YXIgd3JhcEFjY2Vzc29yID0gZnVuY3Rpb24gd3JhcEFjY2Vzc29yKGFjYykge1xuICByZXR1cm4gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICByZXR1cm4gYWNjZXNzb3IoZGF0YSwgYWNjKTtcbiAgfTtcbn07XG5cbnZhciBfZXhjbHVkZWQgPSBbXCJ2aWV3XCIsIFwiZGF0ZVwiLCBcImdldE5vd1wiLCBcIm9uTmF2aWdhdGVcIl0sXG4gIF9leGNsdWRlZDIgPSBbXCJ2aWV3XCIsIFwidG9vbGJhclwiLCBcImV2ZW50c1wiLCBcImJhY2tncm91bmRFdmVudHNcIiwgXCJzdHlsZVwiLCBcImNsYXNzTmFtZVwiLCBcImVsZW1lbnRQcm9wc1wiLCBcImRhdGVcIiwgXCJnZXROb3dcIiwgXCJsZW5ndGhcIiwgXCJzaG93TXVsdGlEYXlUaW1lc1wiLCBcIm9uU2hvd01vcmVcIiwgXCJkb1Nob3dNb3JlRHJpbGxEb3duXCIsIFwiY29tcG9uZW50c1wiLCBcImZvcm1hdHNcIiwgXCJtZXNzYWdlc1wiLCBcImN1bHR1cmVcIl07XG5mdW5jdGlvbiB2aWV3TmFtZXMoX3ZpZXdzKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KF92aWV3cykpIHtcbiAgICByZXR1cm4gX3ZpZXdzO1xuICB9XG4gIHZhciB2aWV3cyA9IFtdO1xuICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKF92aWV3cyk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykge1xuICAgIHZhciBfT2JqZWN0JGVudHJpZXMkX2kgPSBfc2xpY2VkVG9BcnJheShfT2JqZWN0JGVudHJpZXNbX2ldLCAyKSxcbiAgICAgIGtleSA9IF9PYmplY3QkZW50cmllcyRfaVswXSxcbiAgICAgIHZhbHVlID0gX09iamVjdCRlbnRyaWVzJF9pWzFdO1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdmlld3MucHVzaChrZXkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmlld3M7XG59XG5mdW5jdGlvbiBpc1ZhbGlkVmlldyh2aWV3LCBfcmVmKSB7XG4gIHZhciBfdmlld3MgPSBfcmVmLnZpZXdzO1xuICB2YXIgbmFtZXMgPSB2aWV3TmFtZXMoX3ZpZXdzKTtcbiAgcmV0dXJuIG5hbWVzLmluZGV4T2YodmlldykgIT09IC0xO1xufVxudmFyIENhbGVuZGFyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIGZ1bmN0aW9uIENhbGVuZGFyKCkge1xuICAgIHZhciBfdGhpcztcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2FsZW5kYXIpO1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBfYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIF9hcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cbiAgICBfdGhpcyA9IF9jYWxsU3VwZXIodGhpcywgQ2FsZW5kYXIsIFtdLmNvbmNhdChfYXJncykpO1xuICAgIF90aGlzLmdldFZpZXdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHZpZXdzID0gX3RoaXMucHJvcHMudmlld3M7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2aWV3cykpIHtcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybSh2aWV3cywgZnVuY3Rpb24gKG9iaiwgbmFtZSkge1xuICAgICAgICAgIHJldHVybiBvYmpbbmFtZV0gPSBWSUVXU1tuYW1lXTtcbiAgICAgICAgfSwge30pO1xuICAgICAgfVxuICAgICAgaWYgKF90eXBlb2Yodmlld3MpID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gbWFwVmFsdWVzKHZpZXdzLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xuICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFZJRVdTW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gVklFV1M7XG4gICAgfTtcbiAgICBfdGhpcy5nZXRWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHZpZXdzID0gX3RoaXMuZ2V0Vmlld3MoKTtcbiAgICAgIHJldHVybiB2aWV3c1tfdGhpcy5wcm9wcy52aWV3XTtcbiAgICB9O1xuICAgIF90aGlzLmdldERyaWxsZG93blZpZXcgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsXG4gICAgICAgIHZpZXcgPSBfdGhpcyRwcm9wcy52aWV3LFxuICAgICAgICBkcmlsbGRvd25WaWV3ID0gX3RoaXMkcHJvcHMuZHJpbGxkb3duVmlldyxcbiAgICAgICAgZ2V0RHJpbGxkb3duVmlldyA9IF90aGlzJHByb3BzLmdldERyaWxsZG93blZpZXc7XG4gICAgICBpZiAoIWdldERyaWxsZG93blZpZXcpIHJldHVybiBkcmlsbGRvd25WaWV3O1xuICAgICAgcmV0dXJuIGdldERyaWxsZG93blZpZXcoZGF0ZSwgdmlldywgT2JqZWN0LmtleXMoX3RoaXMuZ2V0Vmlld3MoKSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZVxuICAgICAqIEBwYXJhbSB2aWV3Q29tcG9uZW50XG4gICAgICogQHBhcmFtIHsnbW9udGgnfCd3ZWVrJ3wnd29ya193ZWVrJ3wnZGF5J3wnYWdlbmRhJ30gW3ZpZXddIC0gb3B0aW9uYWxcbiAgICAgKiBwYXJhbWV0ZXIuIEl0IGFwcGVhcnMgd2hlbiByYW5nZSBjaGFuZ2Ugb24gdmlldyBjaGFuZ2luZy4gSXQgY291bGQgYmUgaGFuZHlcbiAgICAgKiB3aGVuIHlvdSBuZWVkIHRvIGhhdmUgYm90aDogcmFuZ2UgYW5kIHZpZXcgdHlwZSBhdCBvbmNlLCBpLmUuIGZvciBtYW5hZ2UgcmJjXG4gICAgICogc3RhdGUgdmlhIHVybFxuICAgICAqL1xuICAgIF90aGlzLmhhbmRsZVJhbmdlQ2hhbmdlID0gZnVuY3Rpb24gKGRhdGUsIHZpZXdDb21wb25lbnQsIHZpZXcpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgb25SYW5nZUNoYW5nZSA9IF90aGlzJHByb3BzMi5vblJhbmdlQ2hhbmdlLFxuICAgICAgICBsb2NhbGl6ZXIgPSBfdGhpcyRwcm9wczIubG9jYWxpemVyO1xuICAgICAgaWYgKG9uUmFuZ2VDaGFuZ2UpIHtcbiAgICAgICAgaWYgKHZpZXdDb21wb25lbnQucmFuZ2UpIHtcbiAgICAgICAgICBvblJhbmdlQ2hhbmdlKHZpZXdDb21wb25lbnQucmFuZ2UoZGF0ZSwge1xuICAgICAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXJcbiAgICAgICAgICB9KSwgdmlldyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ29uUmFuZ2VDaGFuZ2UgcHJvcCBub3Qgc3VwcG9ydGVkIGZvciB0aGlzIHZpZXcnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIF90aGlzLmhhbmRsZU5hdmlnYXRlID0gZnVuY3Rpb24gKGFjdGlvbiwgbmV3RGF0ZSkge1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IF90aGlzLnByb3BzLFxuICAgICAgICB2aWV3ID0gX3RoaXMkcHJvcHMzLnZpZXcsXG4gICAgICAgIGRhdGUgPSBfdGhpcyRwcm9wczMuZGF0ZSxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHMzLmdldE5vdyxcbiAgICAgICAgb25OYXZpZ2F0ZSA9IF90aGlzJHByb3BzMy5vbk5hdmlnYXRlLFxuICAgICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfdGhpcyRwcm9wczMsIF9leGNsdWRlZCk7XG4gICAgICB2YXIgVmlld0NvbXBvbmVudCA9IF90aGlzLmdldFZpZXcoKTtcbiAgICAgIHZhciB0b2RheSA9IGdldE5vdygpO1xuICAgICAgZGF0ZSA9IG1vdmVEYXRlKFZpZXdDb21wb25lbnQsIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcHJvcHMpLCB7fSwge1xuICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgZGF0ZTogbmV3RGF0ZSB8fCBkYXRlIHx8IHRvZGF5LFxuICAgICAgICB0b2RheTogdG9kYXlcbiAgICAgIH0pKTtcbiAgICAgIG9uTmF2aWdhdGUoZGF0ZSwgdmlldywgYWN0aW9uKTtcbiAgICAgIF90aGlzLmhhbmRsZVJhbmdlQ2hhbmdlKGRhdGUsIFZpZXdDb21wb25lbnQpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlVmlld0NoYW5nZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICBpZiAodmlldyAhPT0gX3RoaXMucHJvcHMudmlldyAmJiBpc1ZhbGlkVmlldyh2aWV3LCBfdGhpcy5wcm9wcykpIHtcbiAgICAgICAgX3RoaXMucHJvcHMub25WaWV3KHZpZXcpO1xuICAgICAgfVxuICAgICAgdmFyIHZpZXdzID0gX3RoaXMuZ2V0Vmlld3MoKTtcbiAgICAgIF90aGlzLmhhbmRsZVJhbmdlQ2hhbmdlKF90aGlzLnByb3BzLmRhdGUgfHwgX3RoaXMucHJvcHMuZ2V0Tm93KCksIHZpZXdzW3ZpZXddLCB2aWV3KTtcbiAgICB9O1xuICAgIF90aGlzLmhhbmRsZVNlbGVjdEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vblNlbGVjdEV2ZW50LCBhcmdzKTtcbiAgICB9O1xuICAgIF90aGlzLmhhbmRsZURvdWJsZUNsaWNrRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgICAgfVxuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uRG91YmxlQ2xpY2tFdmVudCwgYXJncyk7XG4gICAgfTtcbiAgICBfdGhpcy5oYW5kbGVLZXlQcmVzc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW40KSwgX2tleTQgPSAwOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7XG4gICAgICAgIGFyZ3NbX2tleTRdID0gYXJndW1lbnRzW19rZXk0XTtcbiAgICAgIH1cbiAgICAgIG5vdGlmeShfdGhpcy5wcm9wcy5vbktleVByZXNzRXZlbnQsIGFyZ3MpO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlU2VsZWN0U2xvdCA9IGZ1bmN0aW9uIChzbG90SW5mbykge1xuICAgICAgbm90aWZ5KF90aGlzLnByb3BzLm9uU2VsZWN0U2xvdCwgc2xvdEluZm8pO1xuICAgIH07XG4gICAgX3RoaXMuaGFuZGxlRHJpbGxEb3duID0gZnVuY3Rpb24gKGRhdGUsIHZpZXcpIHtcbiAgICAgIHZhciBvbkRyaWxsRG93biA9IF90aGlzLnByb3BzLm9uRHJpbGxEb3duO1xuICAgICAgaWYgKG9uRHJpbGxEb3duKSB7XG4gICAgICAgIG9uRHJpbGxEb3duKGRhdGUsIHZpZXcsIF90aGlzLmRyaWxsZG93blZpZXcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodmlldykgX3RoaXMuaGFuZGxlVmlld0NoYW5nZSh2aWV3KTtcbiAgICAgIF90aGlzLmhhbmRsZU5hdmlnYXRlKG5hdmlnYXRlLkRBVEUsIGRhdGUpO1xuICAgIH07XG4gICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICBjb250ZXh0OiBDYWxlbmRhci5nZXRDb250ZXh0KF90aGlzLnByb3BzKVxuICAgIH07XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIF9pbmhlcml0cyhDYWxlbmRhciwgX1JlYWN0JENvbXBvbmVudCk7XG4gIHJldHVybiBfY3JlYXRlQ2xhc3MoQ2FsZW5kYXIsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHM0ID0gdGhpcy5wcm9wcyxcbiAgICAgICAgdmlldyA9IF90aGlzJHByb3BzNC52aWV3LFxuICAgICAgICB0b29sYmFyID0gX3RoaXMkcHJvcHM0LnRvb2xiYXIsXG4gICAgICAgIGV2ZW50cyA9IF90aGlzJHByb3BzNC5ldmVudHMsXG4gICAgICAgIGJhY2tncm91bmRFdmVudHMgPSBfdGhpcyRwcm9wczQuYmFja2dyb3VuZEV2ZW50cyxcbiAgICAgICAgc3R5bGUgPSBfdGhpcyRwcm9wczQuc3R5bGUsXG4gICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzNC5jbGFzc05hbWUsXG4gICAgICAgIGVsZW1lbnRQcm9wcyA9IF90aGlzJHByb3BzNC5lbGVtZW50UHJvcHMsXG4gICAgICAgIGN1cnJlbnQgPSBfdGhpcyRwcm9wczQuZGF0ZSxcbiAgICAgICAgZ2V0Tm93ID0gX3RoaXMkcHJvcHM0LmdldE5vdyxcbiAgICAgICAgbGVuZ3RoID0gX3RoaXMkcHJvcHM0Lmxlbmd0aCxcbiAgICAgICAgc2hvd011bHRpRGF5VGltZXMgPSBfdGhpcyRwcm9wczQuc2hvd011bHRpRGF5VGltZXMsXG4gICAgICAgIG9uU2hvd01vcmUgPSBfdGhpcyRwcm9wczQub25TaG93TW9yZSxcbiAgICAgICAgZG9TaG93TW9yZURyaWxsRG93biA9IF90aGlzJHByb3BzNC5kb1Nob3dNb3JlRHJpbGxEb3duO1xuICAgICAgICBfdGhpcyRwcm9wczQuY29tcG9uZW50cztcbiAgICAgICAgX3RoaXMkcHJvcHM0LmZvcm1hdHM7XG4gICAgICAgIF90aGlzJHByb3BzNC5tZXNzYWdlcztcbiAgICAgICAgX3RoaXMkcHJvcHM0LmN1bHR1cmU7XG4gICAgICAgIHZhciBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfdGhpcyRwcm9wczQsIF9leGNsdWRlZDIpO1xuICAgICAgY3VycmVudCA9IGN1cnJlbnQgfHwgZ2V0Tm93KCk7XG4gICAgICB2YXIgVmlldyA9IHRoaXMuZ2V0VmlldygpO1xuICAgICAgdmFyIF90aGlzJHN0YXRlJGNvbnRleHQgPSB0aGlzLnN0YXRlLmNvbnRleHQsXG4gICAgICAgIGFjY2Vzc29ycyA9IF90aGlzJHN0YXRlJGNvbnRleHQuYWNjZXNzb3JzLFxuICAgICAgICBjb21wb25lbnRzID0gX3RoaXMkc3RhdGUkY29udGV4dC5jb21wb25lbnRzLFxuICAgICAgICBnZXR0ZXJzID0gX3RoaXMkc3RhdGUkY29udGV4dC5nZXR0ZXJzLFxuICAgICAgICBsb2NhbGl6ZXIgPSBfdGhpcyRzdGF0ZSRjb250ZXh0LmxvY2FsaXplcixcbiAgICAgICAgdmlld05hbWVzID0gX3RoaXMkc3RhdGUkY29udGV4dC52aWV3TmFtZXM7XG4gICAgICB2YXIgQ2FsVG9vbGJhciA9IGNvbXBvbmVudHMudG9vbGJhciB8fCBUb29sYmFyO1xuICAgICAgdmFyIGxhYmVsID0gVmlldy50aXRsZShjdXJyZW50LCB7XG4gICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyLFxuICAgICAgICBsZW5ndGg6IGxlbmd0aFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgT2JqZWN0LmFzc2lnbih7fSwgZWxlbWVudFByb3BzLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xzeChjbGFzc05hbWUsICdyYmMtY2FsZW5kYXInLCBwcm9wcy5ydGwgJiYgJ3JiYy1ydGwnKSxcbiAgICAgICAgc3R5bGU6IHN0eWxlXG4gICAgICB9KSwgdG9vbGJhciAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDYWxUb29sYmFyLCB7XG4gICAgICAgIGRhdGU6IGN1cnJlbnQsXG4gICAgICAgIHZpZXc6IHZpZXcsXG4gICAgICAgIHZpZXdzOiB2aWV3TmFtZXMsXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgb25WaWV3OiB0aGlzLmhhbmRsZVZpZXdDaGFuZ2UsXG4gICAgICAgIG9uTmF2aWdhdGU6IHRoaXMuaGFuZGxlTmF2aWdhdGUsXG4gICAgICAgIGxvY2FsaXplcjogbG9jYWxpemVyXG4gICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVmlldywgT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMsIHtcbiAgICAgICAgZXZlbnRzOiBldmVudHMsXG4gICAgICAgIGJhY2tncm91bmRFdmVudHM6IGJhY2tncm91bmRFdmVudHMsXG4gICAgICAgIGRhdGU6IGN1cnJlbnQsXG4gICAgICAgIGdldE5vdzogZ2V0Tm93LFxuICAgICAgICBsZW5ndGg6IGxlbmd0aCxcbiAgICAgICAgbG9jYWxpemVyOiBsb2NhbGl6ZXIsXG4gICAgICAgIGdldHRlcnM6IGdldHRlcnMsXG4gICAgICAgIGNvbXBvbmVudHM6IGNvbXBvbmVudHMsXG4gICAgICAgIGFjY2Vzc29yczogYWNjZXNzb3JzLFxuICAgICAgICBzaG93TXVsdGlEYXlUaW1lczogc2hvd011bHRpRGF5VGltZXMsXG4gICAgICAgIGdldERyaWxsZG93blZpZXc6IHRoaXMuZ2V0RHJpbGxkb3duVmlldyxcbiAgICAgICAgb25OYXZpZ2F0ZTogdGhpcy5oYW5kbGVOYXZpZ2F0ZSxcbiAgICAgICAgb25EcmlsbERvd246IHRoaXMuaGFuZGxlRHJpbGxEb3duLFxuICAgICAgICBvblNlbGVjdEV2ZW50OiB0aGlzLmhhbmRsZVNlbGVjdEV2ZW50LFxuICAgICAgICBvbkRvdWJsZUNsaWNrRXZlbnQ6IHRoaXMuaGFuZGxlRG91YmxlQ2xpY2tFdmVudCxcbiAgICAgICAgb25LZXlQcmVzc0V2ZW50OiB0aGlzLmhhbmRsZUtleVByZXNzRXZlbnQsXG4gICAgICAgIG9uU2VsZWN0U2xvdDogdGhpcy5oYW5kbGVTZWxlY3RTbG90LFxuICAgICAgICBvblNob3dNb3JlOiBvblNob3dNb3JlLFxuICAgICAgICBkb1Nob3dNb3JlRHJpbGxEb3duOiBkb1Nob3dNb3JlRHJpbGxEb3duXG4gICAgICB9KSkpO1xuICAgIH1cbiAgfV0sIFt7XG4gICAga2V5OiBcImdldERlcml2ZWRTdGF0ZUZyb21Qcm9wc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250ZXh0OiBDYWxlbmRhci5nZXRDb250ZXh0KG5leHRQcm9wcylcbiAgICAgIH07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldENvbnRleHRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29udGV4dChfcmVmMikge1xuICAgICAgdmFyIHN0YXJ0QWNjZXNzb3IgPSBfcmVmMi5zdGFydEFjY2Vzc29yLFxuICAgICAgICBlbmRBY2Nlc3NvciA9IF9yZWYyLmVuZEFjY2Vzc29yLFxuICAgICAgICBhbGxEYXlBY2Nlc3NvciA9IF9yZWYyLmFsbERheUFjY2Vzc29yLFxuICAgICAgICB0b29sdGlwQWNjZXNzb3IgPSBfcmVmMi50b29sdGlwQWNjZXNzb3IsXG4gICAgICAgIHRpdGxlQWNjZXNzb3IgPSBfcmVmMi50aXRsZUFjY2Vzc29yLFxuICAgICAgICByZXNvdXJjZUFjY2Vzc29yID0gX3JlZjIucmVzb3VyY2VBY2Nlc3NvcixcbiAgICAgICAgcmVzb3VyY2VJZEFjY2Vzc29yID0gX3JlZjIucmVzb3VyY2VJZEFjY2Vzc29yLFxuICAgICAgICByZXNvdXJjZVRpdGxlQWNjZXNzb3IgPSBfcmVmMi5yZXNvdXJjZVRpdGxlQWNjZXNzb3IsXG4gICAgICAgIGV2ZW50UHJvcEdldHRlciA9IF9yZWYyLmV2ZW50UHJvcEdldHRlcixcbiAgICAgICAgYmFja2dyb3VuZEV2ZW50UHJvcEdldHRlciA9IF9yZWYyLmJhY2tncm91bmRFdmVudFByb3BHZXR0ZXIsXG4gICAgICAgIHNsb3RQcm9wR2V0dGVyID0gX3JlZjIuc2xvdFByb3BHZXR0ZXIsXG4gICAgICAgIHNsb3RHcm91cFByb3BHZXR0ZXIgPSBfcmVmMi5zbG90R3JvdXBQcm9wR2V0dGVyLFxuICAgICAgICBkYXlQcm9wR2V0dGVyID0gX3JlZjIuZGF5UHJvcEdldHRlcixcbiAgICAgICAgdmlldyA9IF9yZWYyLnZpZXcsXG4gICAgICAgIHZpZXdzID0gX3JlZjIudmlld3MsXG4gICAgICAgIGxvY2FsaXplciA9IF9yZWYyLmxvY2FsaXplcixcbiAgICAgICAgY3VsdHVyZSA9IF9yZWYyLmN1bHR1cmUsXG4gICAgICAgIF9yZWYyJG1lc3NhZ2VzID0gX3JlZjIubWVzc2FnZXMsXG4gICAgICAgIG1lc3NhZ2VzJDEgPSBfcmVmMiRtZXNzYWdlcyA9PT0gdm9pZCAwID8ge30gOiBfcmVmMiRtZXNzYWdlcyxcbiAgICAgICAgX3JlZjIkY29tcG9uZW50cyA9IF9yZWYyLmNvbXBvbmVudHMsXG4gICAgICAgIGNvbXBvbmVudHMgPSBfcmVmMiRjb21wb25lbnRzID09PSB2b2lkIDAgPyB7fSA6IF9yZWYyJGNvbXBvbmVudHMsXG4gICAgICAgIF9yZWYyJGZvcm1hdHMgPSBfcmVmMi5mb3JtYXRzLFxuICAgICAgICBmb3JtYXRzID0gX3JlZjIkZm9ybWF0cyA9PT0gdm9pZCAwID8ge30gOiBfcmVmMiRmb3JtYXRzO1xuICAgICAgdmFyIG5hbWVzID0gdmlld05hbWVzKHZpZXdzKTtcbiAgICAgIHZhciBtc2dzID0gbWVzc2FnZXMobWVzc2FnZXMkMSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2aWV3TmFtZXM6IG5hbWVzLFxuICAgICAgICBsb2NhbGl6ZXI6IG1lcmdlV2l0aERlZmF1bHRzKGxvY2FsaXplciwgY3VsdHVyZSwgZm9ybWF0cywgbXNncyksXG4gICAgICAgIGdldHRlcnM6IHtcbiAgICAgICAgICBldmVudFByb3A6IGZ1bmN0aW9uIGV2ZW50UHJvcCgpIHtcbiAgICAgICAgICAgIHJldHVybiBldmVudFByb3BHZXR0ZXIgJiYgZXZlbnRQcm9wR2V0dGVyLmFwcGx5KHZvaWQgMCwgYXJndW1lbnRzKSB8fCB7fTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJhY2tncm91bmRFdmVudFByb3A6IGZ1bmN0aW9uIGJhY2tncm91bmRFdmVudFByb3AoKSB7XG4gICAgICAgICAgICByZXR1cm4gYmFja2dyb3VuZEV2ZW50UHJvcEdldHRlciAmJiBiYWNrZ3JvdW5kRXZlbnRQcm9wR2V0dGVyLmFwcGx5KHZvaWQgMCwgYXJndW1lbnRzKSB8fCB7fTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNsb3RQcm9wOiBmdW5jdGlvbiBzbG90UHJvcCgpIHtcbiAgICAgICAgICAgIHJldHVybiBzbG90UHJvcEdldHRlciAmJiBzbG90UHJvcEdldHRlci5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cykgfHwge307XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzbG90R3JvdXBQcm9wOiBmdW5jdGlvbiBzbG90R3JvdXBQcm9wKCkge1xuICAgICAgICAgICAgcmV0dXJuIHNsb3RHcm91cFByb3BHZXR0ZXIgJiYgc2xvdEdyb3VwUHJvcEdldHRlci5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cykgfHwge307XG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXlQcm9wOiBmdW5jdGlvbiBkYXlQcm9wKCkge1xuICAgICAgICAgICAgcmV0dXJuIGRheVByb3BHZXR0ZXIgJiYgZGF5UHJvcEdldHRlci5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cykgfHwge307XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb21wb25lbnRzOiBkZWZhdWx0cyhjb21wb25lbnRzW3ZpZXddIHx8IHt9LCBvbWl0KGNvbXBvbmVudHMsIG5hbWVzKSwge1xuICAgICAgICAgIGV2ZW50V3JhcHBlcjogTm9vcFdyYXBwZXIsXG4gICAgICAgICAgYmFja2dyb3VuZEV2ZW50V3JhcHBlcjogTm9vcFdyYXBwZXIsXG4gICAgICAgICAgZXZlbnRDb250YWluZXJXcmFwcGVyOiBOb29wV3JhcHBlcixcbiAgICAgICAgICBkYXRlQ2VsbFdyYXBwZXI6IE5vb3BXcmFwcGVyLFxuICAgICAgICAgIHdlZWtXcmFwcGVyOiBOb29wV3JhcHBlcixcbiAgICAgICAgICB0aW1lU2xvdFdyYXBwZXI6IE5vb3BXcmFwcGVyLFxuICAgICAgICAgIHRpbWVHdXR0ZXJXcmFwcGVyOiBOb29wV3JhcHBlclxuICAgICAgICB9KSxcbiAgICAgICAgYWNjZXNzb3JzOiB7XG4gICAgICAgICAgc3RhcnQ6IHdyYXBBY2Nlc3NvcihzdGFydEFjY2Vzc29yKSxcbiAgICAgICAgICBlbmQ6IHdyYXBBY2Nlc3NvcihlbmRBY2Nlc3NvciksXG4gICAgICAgICAgYWxsRGF5OiB3cmFwQWNjZXNzb3IoYWxsRGF5QWNjZXNzb3IpLFxuICAgICAgICAgIHRvb2x0aXA6IHdyYXBBY2Nlc3Nvcih0b29sdGlwQWNjZXNzb3IpLFxuICAgICAgICAgIHRpdGxlOiB3cmFwQWNjZXNzb3IodGl0bGVBY2Nlc3NvciksXG4gICAgICAgICAgcmVzb3VyY2U6IHdyYXBBY2Nlc3NvcihyZXNvdXJjZUFjY2Vzc29yKSxcbiAgICAgICAgICByZXNvdXJjZUlkOiB3cmFwQWNjZXNzb3IocmVzb3VyY2VJZEFjY2Vzc29yKSxcbiAgICAgICAgICByZXNvdXJjZVRpdGxlOiB3cmFwQWNjZXNzb3IocmVzb3VyY2VUaXRsZUFjY2Vzc29yKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfV0pO1xufShSZWFjdC5Db21wb25lbnQpO1xuQ2FsZW5kYXIuZGVmYXVsdFByb3BzID0ge1xuICBldmVudHM6IFtdLFxuICBiYWNrZ3JvdW5kRXZlbnRzOiBbXSxcbiAgZWxlbWVudFByb3BzOiB7fSxcbiAgcG9wdXA6IGZhbHNlLFxuICB0b29sYmFyOiB0cnVlLFxuICB2aWV3OiB2aWV3cy5NT05USCxcbiAgdmlld3M6IFt2aWV3cy5NT05USCwgdmlld3MuV0VFSywgdmlld3MuREFZLCB2aWV3cy5BR0VOREFdLFxuICBzdGVwOiAzMCxcbiAgbGVuZ3RoOiAzMCxcbiAgYWxsRGF5TWF4Um93czogSW5maW5pdHksXG4gIGRvU2hvd01vcmVEcmlsbERvd246IHRydWUsXG4gIGRyaWxsZG93blZpZXc6IHZpZXdzLkRBWSxcbiAgdGl0bGVBY2Nlc3NvcjogJ3RpdGxlJyxcbiAgdG9vbHRpcEFjY2Vzc29yOiAndGl0bGUnLFxuICBhbGxEYXlBY2Nlc3NvcjogJ2FsbERheScsXG4gIHN0YXJ0QWNjZXNzb3I6ICdzdGFydCcsXG4gIGVuZEFjY2Vzc29yOiAnZW5kJyxcbiAgcmVzb3VyY2VBY2Nlc3NvcjogJ3Jlc291cmNlSWQnLFxuICByZXNvdXJjZUlkQWNjZXNzb3I6ICdpZCcsXG4gIHJlc291cmNlVGl0bGVBY2Nlc3NvcjogJ3RpdGxlJyxcbiAgbG9uZ1ByZXNzVGhyZXNob2xkOiAyNTAsXG4gIGdldE5vdzogZnVuY3Rpb24gZ2V0Tm93KCkge1xuICAgIHJldHVybiBuZXcgRGF0ZSgpO1xuICB9LFxuICBkYXlMYXlvdXRBbGdvcml0aG06ICdvdmVybGFwJ1xufTtcbnZhciBDYWxlbmRhciQxID0gdW5jb250cm9sbGFibGUoQ2FsZW5kYXIsIHtcbiAgdmlldzogJ29uVmlldycsXG4gIGRhdGU6ICdvbk5hdmlnYXRlJyxcbiAgc2VsZWN0ZWQ6ICdvblNlbGVjdEV2ZW50J1xufSk7XG5cbnZhciB3ZWVrUmFuZ2VGb3JtYXQkNSA9IGZ1bmN0aW9uIHdlZWtSYW5nZUZvcm1hdChfcmVmLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmLnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYuZW5kO1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAnTU1NTSBERCcsIGN1bHR1cmUpICsgJyDigJMgJyArXG4gIC8vIHVwZGF0ZWQgdG8gdXNlIHRoaXMgbG9jYWxpemVyICdlcSgpJyBtZXRob2RcbiAgbG9jYWwuZm9ybWF0KGVuZCwgbG9jYWwuZXEoc3RhcnQsIGVuZCwgJ21vbnRoJykgPyAnREQnIDogJ01NTU0gREQnLCBjdWx0dXJlKTtcbn07XG52YXIgZGF0ZVJhbmdlRm9ybWF0JDUgPSBmdW5jdGlvbiBkYXRlUmFuZ2VGb3JtYXQoX3JlZjIsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYyLnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYyLmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ0wnLCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAnTCcsIGN1bHR1cmUpO1xufTtcbnZhciB0aW1lUmFuZ2VGb3JtYXQkNSA9IGZ1bmN0aW9uIHRpbWVSYW5nZUZvcm1hdChfcmVmMywgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZjMuc3RhcnQsXG4gICAgZW5kID0gX3JlZjMuZW5kO1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAnTFQnLCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAnTFQnLCBjdWx0dXJlKTtcbn07XG52YXIgdGltZVJhbmdlU3RhcnRGb3JtYXQkNSA9IGZ1bmN0aW9uIHRpbWVSYW5nZVN0YXJ0Rm9ybWF0KF9yZWY0LCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmNC5zdGFydDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ0xUJywgY3VsdHVyZSkgKyAnIOKAkyAnO1xufTtcbnZhciB0aW1lUmFuZ2VFbmRGb3JtYXQkNSA9IGZ1bmN0aW9uIHRpbWVSYW5nZUVuZEZvcm1hdChfcmVmNSwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIGVuZCA9IF9yZWY1LmVuZDtcbiAgcmV0dXJuICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAnTFQnLCBjdWx0dXJlKTtcbn07XG52YXIgZm9ybWF0cyQ1ID0ge1xuICBkYXRlRm9ybWF0OiAnREQnLFxuICBkYXlGb3JtYXQ6ICdERCBkZGQnLFxuICB3ZWVrZGF5Rm9ybWF0OiAnZGRkJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQ1LFxuICBldmVudFRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDUsXG4gIGV2ZW50VGltZVJhbmdlU3RhcnRGb3JtYXQ6IHRpbWVSYW5nZVN0YXJ0Rm9ybWF0JDUsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQkNSxcbiAgdGltZUd1dHRlckZvcm1hdDogJ0xUJyxcbiAgbW9udGhIZWFkZXJGb3JtYXQ6ICdNTU1NIFlZWVknLFxuICBkYXlIZWFkZXJGb3JtYXQ6ICdkZGRkIE1NTSBERCcsXG4gIGRheVJhbmdlSGVhZGVyRm9ybWF0OiB3ZWVrUmFuZ2VGb3JtYXQkNSxcbiAgYWdlbmRhSGVhZGVyRm9ybWF0OiBkYXRlUmFuZ2VGb3JtYXQkNSxcbiAgYWdlbmRhRGF0ZUZvcm1hdDogJ2RkZCBNTU0gREQnLFxuICBhZ2VuZGFUaW1lRm9ybWF0OiAnTFQnLFxuICBhZ2VuZGFUaW1lUmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQ1XG59O1xuZnVuY3Rpb24gZml4VW5pdCQyKHVuaXQpIHtcbiAgdmFyIGRhdGVQYXJ0ID0gdW5pdCA/IHVuaXQudG9Mb3dlckNhc2UoKSA6IHVuaXQ7XG4gIGlmIChkYXRlUGFydCA9PT0gJ0Z1bGxZZWFyJykge1xuICAgIGRhdGVQYXJ0ID0gJ3llYXInO1xuICB9IGVsc2UgaWYgKCFkYXRlUGFydCkge1xuICAgIGRhdGVQYXJ0ID0gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiBkYXRlUGFydDtcbn1cbmZ1bmN0aW9uIG1vbWVudCAobW9tZW50KSB7XG4gIHZhciBsb2NhbGUgPSBmdW5jdGlvbiBsb2NhbGUobSwgYykge1xuICAgIHJldHVybiBjID8gbS5sb2NhbGUoYykgOiBtO1xuICB9O1xuICBmdW5jdGlvbiBnZXRUaW1lem9uZU9mZnNldChkYXRlKSB7XG4gICAgLy8gZW5zdXJlcyB0aGlzIGdldHMgY2FzdCB0byB0aW1lem9uZVxuICAgIHJldHVybiBtb21lbnQoZGF0ZSkudG9EYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgfVxuICBmdW5jdGlvbiBnZXREc3RPZmZzZXQoc3RhcnQsIGVuZCkge1xuICAgIHZhciBfc3QkX3okbmFtZSwgX3N0JF96O1xuICAgIC8vIGNvbnZlcnQgdG8gbW9tZW50LCBpbiBjYXNlXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSBvZmZzZXQgaW4gdGhlIHRpbWV6b25lIG9mIHRoZSBFdmVudHMgKGxvY2FsKVxuICAgIC8vIG5vdCBpbiB0aGUgdGltZXpvbmUgb2YgdGhlIGNhbGVuZGFyIChtb21lbnQudHopXG4gICAgdmFyIHN0ID0gbW9tZW50KHN0YXJ0KS5sb2NhbCgpO1xuICAgIHZhciBlZCA9IG1vbWVudChlbmQpLmxvY2FsKCk7XG4gICAgLy8gaWYgbm90IHVzaW5nIG1vbWVudCB0aW1lem9uZVxuICAgIGlmICghbW9tZW50LnR6KSB7XG4gICAgICByZXR1cm4gc3QudG9EYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKSAtIGVkLnRvRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHVzaW5nIG1vbWVudC10aW1lem9uZSwgYW5kIGEgdGltZXpvbmUgaGFzIGJlZW4gYXBwbGllZCwgdGhlblxuICAgICAqIHVzZSB0aGlzIHRvIGdldCB0aGUgcHJvcGVyIHRpbWV6b25lIG9mZnNldCwgb3RoZXJ3aXNlIGRlZmF1bHRcbiAgICAgKiB0aGUgdGltZXpvbmUgdG8gdGhlIGJyb3dzZXIgbG9jYWxcbiAgICAgKi9cbiAgICB2YXIgdHpOYW1lID0gKF9zdCRfeiRuYW1lID0gc3QgPT09IG51bGwgfHwgc3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfc3QkX3ogPSBzdC5feikgPT09IG51bGwgfHwgX3N0JF96ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc3QkX3oubmFtZSkgIT09IG51bGwgJiYgX3N0JF96JG5hbWUgIT09IHZvaWQgMCA/IF9zdCRfeiRuYW1lIDogbW9tZW50LnR6Lmd1ZXNzKCk7XG4gICAgdmFyIHN0YXJ0T2Zmc2V0ID0gbW9tZW50LnR6LnpvbmUodHpOYW1lKS51dGNPZmZzZXQoK3N0KTtcbiAgICB2YXIgZW5kT2Zmc2V0ID0gbW9tZW50LnR6LnpvbmUodHpOYW1lKS51dGNPZmZzZXQoK2VkKTtcbiAgICByZXR1cm4gc3RhcnRPZmZzZXQgLSBlbmRPZmZzZXQ7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0RGF5U3RhcnREc3RPZmZzZXQoc3RhcnQpIHtcbiAgICB2YXIgZGF5U3RhcnQgPSBtb21lbnQoc3RhcnQpLnN0YXJ0T2YoJ2RheScpO1xuICAgIHJldHVybiBnZXREc3RPZmZzZXQoZGF5U3RhcnQsIHN0YXJ0KTtcbiAgfVxuXG4gIC8qKiogQkVHSU4gbG9jYWxpemVkIGRhdGUgYXJpdGhtZXRpYyBtZXRob2RzIHdpdGggbW9tZW50ICoqKi9cbiAgZnVuY3Rpb24gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCkge1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQkMih1bml0KTtcbiAgICB2YXIgZHRBID0gZGF0ZVBhcnQgPyBtb21lbnQoYSkuc3RhcnRPZihkYXRlUGFydCkgOiBtb21lbnQoYSk7XG4gICAgdmFyIGR0QiA9IGRhdGVQYXJ0ID8gbW9tZW50KGIpLnN0YXJ0T2YoZGF0ZVBhcnQpIDogbW9tZW50KGIpO1xuICAgIHJldHVybiBbZHRBLCBkdEIsIGRhdGVQYXJ0XTtcbiAgfVxuICBmdW5jdGlvbiBzdGFydE9mKCkge1xuICAgIHZhciBkYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQyKHVuaXQpO1xuICAgIGlmIChkYXRlUGFydCkge1xuICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5zdGFydE9mKGRhdGVQYXJ0KS50b0RhdGUoKTtcbiAgICB9XG4gICAgcmV0dXJuIG1vbWVudChkYXRlKS50b0RhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBlbmRPZigpIHtcbiAgICB2YXIgZGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQkMih1bml0KTtcbiAgICBpZiAoZGF0ZVBhcnQpIHtcbiAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZW5kT2YoZGF0ZVBhcnQpLnRvRGF0ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gbW9tZW50KGRhdGUpLnRvRGF0ZSgpO1xuICB9XG5cbiAgLy8gbW9tZW50IGNvbXBhcmlzb24gb3BlcmF0aW9ucyAqYWx3YXlzKiBjb252ZXJ0IGJvdGggc2lkZXMgdG8gbW9tZW50IG9iamVjdHNcbiAgLy8gcHJpb3IgdG8gcnVubmluZyB0aGUgY29tcGFyaXNvbnNcbiAgZnVuY3Rpb24gZXEoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnMgPSBkZWZpbmVDb21wYXJhdG9ycyhhLCBiLCB1bml0KSxcbiAgICAgIF9kZWZpbmVDb21wYXJhdG9yczIgPSBfc2xpY2VkVG9BcnJheShfZGVmaW5lQ29tcGFyYXRvcnMsIDMpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzMlswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczJbMV0sXG4gICAgICBkYXRlUGFydCA9IF9kZWZpbmVDb21wYXJhdG9yczJbMl07XG4gICAgcmV0dXJuIGR0QS5pc1NhbWUoZHRCLCBkYXRlUGFydCk7XG4gIH1cbiAgZnVuY3Rpb24gbmVxKGEsIGIsIHVuaXQpIHtcbiAgICByZXR1cm4gIWVxKGEsIGIsIHVuaXQpO1xuICB9XG4gIGZ1bmN0aW9uIGd0KGEsIGIsIHVuaXQpIHtcbiAgICB2YXIgX2RlZmluZUNvbXBhcmF0b3JzMyA9IGRlZmluZUNvbXBhcmF0b3JzKGEsIGIsIHVuaXQpLFxuICAgICAgX2RlZmluZUNvbXBhcmF0b3JzNCA9IF9zbGljZWRUb0FycmF5KF9kZWZpbmVDb21wYXJhdG9yczMsIDMpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzNFswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczRbMV0sXG4gICAgICBkYXRlUGFydCA9IF9kZWZpbmVDb21wYXJhdG9yczRbMl07XG4gICAgcmV0dXJuIGR0QS5pc0FmdGVyKGR0QiwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIGx0KGEsIGIsIHVuaXQpIHtcbiAgICB2YXIgX2RlZmluZUNvbXBhcmF0b3JzNSA9IGRlZmluZUNvbXBhcmF0b3JzKGEsIGIsIHVuaXQpLFxuICAgICAgX2RlZmluZUNvbXBhcmF0b3JzNiA9IF9zbGljZWRUb0FycmF5KF9kZWZpbmVDb21wYXJhdG9yczUsIDMpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzNlswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczZbMV0sXG4gICAgICBkYXRlUGFydCA9IF9kZWZpbmVDb21wYXJhdG9yczZbMl07XG4gICAgcmV0dXJuIGR0QS5pc0JlZm9yZShkdEIsIGRhdGVQYXJ0KTtcbiAgfVxuICBmdW5jdGlvbiBndGUoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnM3ID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnM4ID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzNywgMyksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnM4WzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzOFsxXSxcbiAgICAgIGRhdGVQYXJ0ID0gX2RlZmluZUNvbXBhcmF0b3JzOFsyXTtcbiAgICByZXR1cm4gZHRBLmlzU2FtZU9yQmVmb3JlKGR0QiwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIGx0ZShhLCBiLCB1bml0KSB7XG4gICAgdmFyIF9kZWZpbmVDb21wYXJhdG9yczkgPSBkZWZpbmVDb21wYXJhdG9ycyhhLCBiLCB1bml0KSxcbiAgICAgIF9kZWZpbmVDb21wYXJhdG9yczEwID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzOSwgMyksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnMxMFswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczEwWzFdLFxuICAgICAgZGF0ZVBhcnQgPSBfZGVmaW5lQ29tcGFyYXRvcnMxMFsyXTtcbiAgICByZXR1cm4gZHRBLmlzU2FtZU9yQmVmb3JlKGR0QiwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIGluUmFuZ2UoZGF5LCBtaW4sIG1heCkge1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAnZGF5JztcbiAgICB2YXIgZGF0ZVBhcnQgPSBmaXhVbml0JDIodW5pdCk7XG4gICAgdmFyIG1EYXkgPSBtb21lbnQoZGF5KTtcbiAgICB2YXIgbU1pbiA9IG1vbWVudChtaW4pO1xuICAgIHZhciBtTWF4ID0gbW9tZW50KG1heCk7XG4gICAgcmV0dXJuIG1EYXkuaXNCZXR3ZWVuKG1NaW4sIG1NYXgsIGRhdGVQYXJ0LCAnW10nKTtcbiAgfVxuICBmdW5jdGlvbiBtaW4oZGF0ZUEsIGRhdGVCKSB7XG4gICAgdmFyIGR0QSA9IG1vbWVudChkYXRlQSk7XG4gICAgdmFyIGR0QiA9IG1vbWVudChkYXRlQik7XG4gICAgdmFyIG1pbkR0ID0gbW9tZW50Lm1pbihkdEEsIGR0Qik7XG4gICAgcmV0dXJuIG1pbkR0LnRvRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIG1heChkYXRlQSwgZGF0ZUIpIHtcbiAgICB2YXIgZHRBID0gbW9tZW50KGRhdGVBKTtcbiAgICB2YXIgZHRCID0gbW9tZW50KGRhdGVCKTtcbiAgICB2YXIgbWF4RHQgPSBtb21lbnQubWF4KGR0QSwgZHRCKTtcbiAgICByZXR1cm4gbWF4RHQudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gbWVyZ2UoZGF0ZSwgdGltZSkge1xuICAgIGlmICghZGF0ZSAmJiAhdGltZSkgcmV0dXJuIG51bGw7XG4gICAgdmFyIHRtID0gbW9tZW50KHRpbWUpLmZvcm1hdCgnSEg6bW06c3MnKTtcbiAgICB2YXIgZHQgPSBtb21lbnQoZGF0ZSkuc3RhcnRPZignZGF5JykuZm9ybWF0KCdNTS9ERC9ZWVlZJyk7XG4gICAgLy8gV2UgZG8gaXQgdGhpcyB3YXkgdG8gYXZvaWQgaXNzdWVzIHdoZW4gdGltZXpvbmUgc3dpdGNoaW5nXG4gICAgcmV0dXJuIG1vbWVudChcIlwiLmNvbmNhdChkdCwgXCIgXCIpLmNvbmNhdCh0bSksICdNTS9ERC9ZWVlZIEhIOm1tOnNzJykudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gYWRkKGRhdGUsIGFkZGVyLCB1bml0KSB7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQyKHVuaXQpO1xuICAgIHJldHVybiBtb21lbnQoZGF0ZSkuYWRkKGFkZGVyLCBkYXRlUGFydCkudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gcmFuZ2Uoc3RhcnQsIGVuZCkge1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAnZGF5JztcbiAgICB2YXIgZGF0ZVBhcnQgPSBmaXhVbml0JDIodW5pdCk7XG4gICAgLy8gYmVjYXVzZSB0aGUgYWRkIG1ldGhvZCB3aWxsIHB1dCB0aGVzZSBpbiB0eiwgd2UgaGF2ZSB0byBzdGFydCB0aGF0IHdheVxuICAgIHZhciBjdXJyZW50ID0gbW9tZW50KHN0YXJ0KS50b0RhdGUoKTtcbiAgICB2YXIgZGF5cyA9IFtdO1xuICAgIHdoaWxlIChsdGUoY3VycmVudCwgZW5kKSkge1xuICAgICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgICAgY3VycmVudCA9IGFkZChjdXJyZW50LCAxLCBkYXRlUGFydCk7XG4gICAgfVxuICAgIHJldHVybiBkYXlzO1xuICB9XG4gIGZ1bmN0aW9uIGNlaWwoZGF0ZSwgdW5pdCkge1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQkMih1bml0KTtcbiAgICB2YXIgZmxvb3IgPSBzdGFydE9mKGRhdGUsIGRhdGVQYXJ0KTtcbiAgICByZXR1cm4gZXEoZmxvb3IsIGRhdGUpID8gZmxvb3IgOiBhZGQoZmxvb3IsIDEsIGRhdGVQYXJ0KTtcbiAgfVxuICBmdW5jdGlvbiBkaWZmKGEsIGIpIHtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2RheSc7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQyKHVuaXQpO1xuICAgIC8vIGRvbid0IHVzZSAnZGVmaW5lQ29tcGFyYXRvcnMnIGhlcmUsIGFzIHdlIGRvbid0IHdhbnQgdG8gbXV0YXRlIHRoZSB2YWx1ZXNcbiAgICB2YXIgZHRBID0gbW9tZW50KGEpO1xuICAgIHZhciBkdEIgPSBtb21lbnQoYik7XG4gICAgcmV0dXJuIGR0Qi5kaWZmKGR0QSwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIG1pbnV0ZXMoZGF0ZSkge1xuICAgIHZhciBkdCA9IG1vbWVudChkYXRlKTtcbiAgICByZXR1cm4gZHQubWludXRlcygpO1xuICB9XG4gIGZ1bmN0aW9uIGZpcnN0T2ZXZWVrKGN1bHR1cmUpIHtcbiAgICB2YXIgZGF0YSA9IGN1bHR1cmUgPyBtb21lbnQubG9jYWxlRGF0YShjdWx0dXJlKSA6IG1vbWVudC5sb2NhbGVEYXRhKCk7XG4gICAgcmV0dXJuIGRhdGEgPyBkYXRhLmZpcnN0RGF5T2ZXZWVrKCkgOiAwO1xuICB9XG4gIGZ1bmN0aW9uIGZpcnN0VmlzaWJsZURheShkYXRlKSB7XG4gICAgcmV0dXJuIG1vbWVudChkYXRlKS5zdGFydE9mKCdtb250aCcpLnN0YXJ0T2YoJ3dlZWsnKS50b0RhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBsYXN0VmlzaWJsZURheShkYXRlKSB7XG4gICAgcmV0dXJuIG1vbWVudChkYXRlKS5lbmRPZignbW9udGgnKS5lbmRPZignd2VlaycpLnRvRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIHZpc2libGVEYXlzKGRhdGUpIHtcbiAgICB2YXIgY3VycmVudCA9IGZpcnN0VmlzaWJsZURheShkYXRlKTtcbiAgICB2YXIgbGFzdCA9IGxhc3RWaXNpYmxlRGF5KGRhdGUpO1xuICAgIHZhciBkYXlzID0gW107XG4gICAgd2hpbGUgKGx0ZShjdXJyZW50LCBsYXN0KSkge1xuICAgICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgICAgY3VycmVudCA9IGFkZChjdXJyZW50LCAxLCAnZCcpO1xuICAgIH1cbiAgICByZXR1cm4gZGF5cztcbiAgfVxuICAvKioqIEVORCBsb2NhbGl6ZWQgZGF0ZSBhcml0aG1ldGljIG1ldGhvZHMgd2l0aCBtb21lbnQgKioqL1xuXG4gIC8qKlxuICAgKiBNb3ZlZCBmcm9tIFRpbWVTbG90cy5qcywgdGhpcyBtZXRob2Qgb3ZlcnJpZGVzIHRoZSBtZXRob2Qgb2YgdGhlIHNhbWUgbmFtZVxuICAgKiBpbiB0aGUgbG9jYWxpemVyLmpzLCB1c2luZyBtb21lbnQgdG8gY29uc3RydWN0IHRoZSBqcyBEYXRlXG4gICAqIEBwYXJhbSB7RGF0ZX0gZHQgLSBkYXRlIHRvIHN0YXJ0IHdpdGhcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG1pbnV0ZXNGcm9tTWlkbmlnaHRcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldFxuICAgKiBAcmV0dXJucyB7RGF0ZX1cbiAgICovXG4gIGZ1bmN0aW9uIGdldFNsb3REYXRlKGR0LCBtaW51dGVzRnJvbU1pZG5pZ2h0LCBvZmZzZXQpIHtcbiAgICByZXR1cm4gbW9tZW50KGR0KS5zdGFydE9mKCdkYXknKS5taW51dGUobWludXRlc0Zyb21NaWRuaWdodCArIG9mZnNldCkudG9EYXRlKCk7XG4gIH1cblxuICAvLyBtb21lbnQgd2lsbCBhdXRvbWF0aWNhbGx5IGhhbmRsZSBEU1QgZGlmZmVyZW5jZXMgaW4gaXQncyBjYWxjdWxhdGlvbnNcbiAgZnVuY3Rpb24gZ2V0VG90YWxNaW4oc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBkaWZmKHN0YXJ0LCBlbmQsICdtaW51dGVzJyk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0TWludXRlc0Zyb21NaWRuaWdodChzdGFydCkge1xuICAgIHZhciBkYXlTdGFydCA9IG1vbWVudChzdGFydCkuc3RhcnRPZignZGF5Jyk7XG4gICAgdmFyIGRheSA9IG1vbWVudChzdGFydCk7XG4gICAgcmV0dXJuIGRheS5kaWZmKGRheVN0YXJ0LCAnbWludXRlcycpICsgZ2V0RGF5U3RhcnREc3RPZmZzZXQoc3RhcnQpO1xuICB9XG5cbiAgLy8gVGhlc2UgdHdvIGFyZSB1c2VkIGJ5IERhdGVTbG90TWV0cmljc1xuICBmdW5jdGlvbiBjb250aW51ZXNQcmlvcihzdGFydCwgZmlyc3QpIHtcbiAgICB2YXIgbVN0YXJ0ID0gbW9tZW50KHN0YXJ0KTtcbiAgICB2YXIgbUZpcnN0ID0gbW9tZW50KGZpcnN0KTtcbiAgICByZXR1cm4gbVN0YXJ0LmlzQmVmb3JlKG1GaXJzdCwgJ2RheScpO1xuICB9XG4gIGZ1bmN0aW9uIGNvbnRpbnVlc0FmdGVyKHN0YXJ0LCBlbmQsIGxhc3QpIHtcbiAgICB2YXIgbUVuZCA9IG1vbWVudChlbmQpO1xuICAgIHZhciBtTGFzdCA9IG1vbWVudChsYXN0KTtcbiAgICByZXR1cm4gbUVuZC5pc1NhbWVPckFmdGVyKG1MYXN0LCAnbWludXRlcycpO1xuICB9XG4gIGZ1bmN0aW9uIGRheVNwYW4oc3RhcnQsIGVuZCkge1xuICAgIHZhciBtU3RhcnQgPSBtb21lbnQoc3RhcnQpO1xuICAgIHZhciBtRW5kID0gbW9tZW50KGVuZCk7XG4gICAgdmFyIGR1ciA9IG1vbWVudC5kdXJhdGlvbihtRW5kLmRpZmYobVN0YXJ0KSk7XG4gICAgcmV0dXJuIGR1ci5kYXlzKCk7XG4gIH1cblxuICAvLyBUaGVzZSB0d28gYXJlIHVzZWQgYnkgZXZlbnRMZXZlbHNcbiAgZnVuY3Rpb24gc29ydEV2ZW50cyhfcmVmNikge1xuICAgIHZhciBfcmVmNiRldnRBID0gX3JlZjYuZXZ0QSxcbiAgICAgIGFTdGFydCA9IF9yZWY2JGV2dEEuc3RhcnQsXG4gICAgICBhRW5kID0gX3JlZjYkZXZ0QS5lbmQsXG4gICAgICBhQWxsRGF5ID0gX3JlZjYkZXZ0QS5hbGxEYXksXG4gICAgICBfcmVmNiRldnRCID0gX3JlZjYuZXZ0QixcbiAgICAgIGJTdGFydCA9IF9yZWY2JGV2dEIuc3RhcnQsXG4gICAgICBiRW5kID0gX3JlZjYkZXZ0Qi5lbmQsXG4gICAgICBiQWxsRGF5ID0gX3JlZjYkZXZ0Qi5hbGxEYXk7XG4gICAgdmFyIHN0YXJ0U29ydCA9ICtzdGFydE9mKGFTdGFydCwgJ2RheScpIC0gK3N0YXJ0T2YoYlN0YXJ0LCAnZGF5Jyk7XG4gICAgdmFyIGR1ckEgPSBkYXlTcGFuKGFTdGFydCwgYUVuZCk7XG4gICAgdmFyIGR1ckIgPSBkYXlTcGFuKGJTdGFydCwgYkVuZCk7XG4gICAgcmV0dXJuIHN0YXJ0U29ydCB8fFxuICAgIC8vIHNvcnQgYnkgc3RhcnQgRGF5IGZpcnN0XG4gICAgZHVyQiAtIGR1ckEgfHxcbiAgICAvLyBldmVudHMgc3Bhbm5pbmcgbXVsdGlwbGUgZGF5cyBnbyBmaXJzdFxuICAgICEhYkFsbERheSAtICEhYUFsbERheSB8fFxuICAgIC8vIHRoZW4gYWxsRGF5IHNpbmdsZSBkYXkgZXZlbnRzXG4gICAgK2FTdGFydCAtICtiU3RhcnQgfHxcbiAgICAvLyB0aGVuIHNvcnQgYnkgc3RhcnQgdGltZSAqZG9uJ3QgbmVlZCBtb21lbnQgY29udmVyc2lvbiBoZXJlXG4gICAgK2FFbmQgLSArYkVuZCAvLyB0aGVuIHNvcnQgYnkgZW5kIHRpbWUgKmRvbid0IG5lZWQgbW9tZW50IGNvbnZlcnNpb24gaGVyZSBlaXRoZXJcbiAgICA7XG4gIH1cbiAgZnVuY3Rpb24gaW5FdmVudFJhbmdlKF9yZWY3KSB7XG4gICAgdmFyIF9yZWY3JGV2ZW50ID0gX3JlZjcuZXZlbnQsXG4gICAgICBzdGFydCA9IF9yZWY3JGV2ZW50LnN0YXJ0LFxuICAgICAgZW5kID0gX3JlZjckZXZlbnQuZW5kLFxuICAgICAgX3JlZjckcmFuZ2UgPSBfcmVmNy5yYW5nZSxcbiAgICAgIHJhbmdlU3RhcnQgPSBfcmVmNyRyYW5nZS5zdGFydCxcbiAgICAgIHJhbmdlRW5kID0gX3JlZjckcmFuZ2UuZW5kO1xuICAgIHZhciBzdGFydE9mRGF5ID0gbW9tZW50KHN0YXJ0KS5zdGFydE9mKCdkYXknKTtcbiAgICB2YXIgZUVuZCA9IG1vbWVudChlbmQpO1xuICAgIHZhciByU3RhcnQgPSBtb21lbnQocmFuZ2VTdGFydCk7XG4gICAgdmFyIHJFbmQgPSBtb21lbnQocmFuZ2VFbmQpO1xuICAgIHZhciBzdGFydHNCZWZvcmVFbmQgPSBzdGFydE9mRGF5LmlzU2FtZU9yQmVmb3JlKHJFbmQsICdkYXknKTtcbiAgICAvLyB3aGVuIHRoZSBldmVudCBpcyB6ZXJvIGR1cmF0aW9uIHdlIG5lZWQgdG8gaGFuZGxlIGEgYml0IGRpZmZlcmVudGx5XG4gICAgdmFyIHNhbWVNaW4gPSAhc3RhcnRPZkRheS5pc1NhbWUoZUVuZCwgJ21pbnV0ZXMnKTtcbiAgICB2YXIgZW5kc0FmdGVyU3RhcnQgPSBzYW1lTWluID8gZUVuZC5pc0FmdGVyKHJTdGFydCwgJ21pbnV0ZXMnKSA6IGVFbmQuaXNTYW1lT3JBZnRlcihyU3RhcnQsICdtaW51dGVzJyk7XG4gICAgcmV0dXJuIHN0YXJ0c0JlZm9yZUVuZCAmJiBlbmRzQWZ0ZXJTdGFydDtcbiAgfVxuICBmdW5jdGlvbiBpc1NhbWVEYXRlKGRhdGUxLCBkYXRlMikge1xuICAgIHZhciBkdCA9IG1vbWVudChkYXRlMSk7XG4gICAgdmFyIGR0MiA9IG1vbWVudChkYXRlMik7XG4gICAgcmV0dXJuIGR0LmlzU2FtZShkdDIsICdkYXknKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCwgY2FsbGVkIG9uY2UgaW4gdGhlIGxvY2FsaXplciBjb25zdHJ1Y3RvciwgaXMgdXNlZCBieSBldmVudExldmVsc1xuICAgKiAnZXZlbnRTZWdtZW50cygpJyB0byBhc3Npc3QgaW4gZGV0ZXJtaW5pbmcgdGhlICdzcGFuJyBvZiB0aGUgZXZlbnQgaW4gdGhlIGRpc3BsYXksXG4gICAqIHNwZWNpZmljYWxseSB3aGVuIHVzaW5nIGEgdGltZXpvbmUgdGhhdCBpcyBncmVhdGVyIHRoYW4gdGhlIGJyb3dzZXIgbmF0aXZlIHRpbWV6b25lLlxuICAgKiBAcmV0dXJucyBudW1iZXJcbiAgICovXG4gIGZ1bmN0aW9uIGJyb3dzZXJUWk9mZnNldCgpIHtcbiAgICAvKipcbiAgICAgKiBEYXRlLnByb3RvdHlwZS5nZXRUaW1lem9uZU9mZnNldCBob3JyaWZpY2FsbHkgZmxpcHMgdGhlIHBvc2l0aXZlL25lZ2F0aXZlIGZyb21cbiAgICAgKiB3aGF0IHlvdSBzZWUgaW4gaXQncyBzdHJpbmcsIHNvIHdlIGhhdmUgdG8ganVtcCB0aHJvdWdoIHNvbWUgaG9vcHMgdG8gZ2V0IGEgdmFsdWVcbiAgICAgKiB3ZSBjYW4gYWN0dWFsbHkgY29tcGFyZS5cbiAgICAgKi9cbiAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpO1xuICAgIHZhciBuZWcgPSAvLS8udGVzdChkdC50b1N0cmluZygpKSA/ICctJyA6ICcnO1xuICAgIHZhciBkdE9mZnNldCA9IGR0LmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgdmFyIGNvbXBhcmF0b3IgPSBOdW1iZXIoXCJcIi5jb25jYXQobmVnKS5jb25jYXQoTWF0aC5hYnMoZHRPZmZzZXQpKSk7XG4gICAgLy8gbW9tZW50IGNvcnJlY3RseSBwcm92aWRlcyBwb3NpdGl2ZS9uZWdhdGl2ZSBvZmZzZXQsIGFzIGV4cGVjdGVkXG4gICAgdmFyIG10T2Zmc2V0ID0gbW9tZW50KCkudXRjT2Zmc2V0KCk7XG4gICAgcmV0dXJuIG10T2Zmc2V0ID4gY29tcGFyYXRvciA/IDEgOiAwO1xuICB9XG4gIHJldHVybiBuZXcgRGF0ZUxvY2FsaXplcih7XG4gICAgZm9ybWF0czogZm9ybWF0cyQ1LFxuICAgIGZpcnN0T2ZXZWVrOiBmaXJzdE9mV2VlayxcbiAgICBmaXJzdFZpc2libGVEYXk6IGZpcnN0VmlzaWJsZURheSxcbiAgICBsYXN0VmlzaWJsZURheTogbGFzdFZpc2libGVEYXksXG4gICAgdmlzaWJsZURheXM6IHZpc2libGVEYXlzLFxuICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHZhbHVlLCBfZm9ybWF0LCBjdWx0dXJlKSB7XG4gICAgICByZXR1cm4gbG9jYWxlKG1vbWVudCh2YWx1ZSksIGN1bHR1cmUpLmZvcm1hdChfZm9ybWF0KTtcbiAgICB9LFxuICAgIGx0OiBsdCxcbiAgICBsdGU6IGx0ZSxcbiAgICBndDogZ3QsXG4gICAgZ3RlOiBndGUsXG4gICAgZXE6IGVxLFxuICAgIG5lcTogbmVxLFxuICAgIG1lcmdlOiBtZXJnZSxcbiAgICBpblJhbmdlOiBpblJhbmdlLFxuICAgIHN0YXJ0T2Y6IHN0YXJ0T2YsXG4gICAgZW5kT2Y6IGVuZE9mLFxuICAgIHJhbmdlOiByYW5nZSxcbiAgICBhZGQ6IGFkZCxcbiAgICBkaWZmOiBkaWZmLFxuICAgIGNlaWw6IGNlaWwsXG4gICAgbWluOiBtaW4sXG4gICAgbWF4OiBtYXgsXG4gICAgbWludXRlczogbWludXRlcyxcbiAgICBnZXRTbG90RGF0ZTogZ2V0U2xvdERhdGUsXG4gICAgZ2V0VGltZXpvbmVPZmZzZXQ6IGdldFRpbWV6b25lT2Zmc2V0LFxuICAgIGdldERzdE9mZnNldDogZ2V0RHN0T2Zmc2V0LFxuICAgIGdldFRvdGFsTWluOiBnZXRUb3RhbE1pbixcbiAgICBnZXRNaW51dGVzRnJvbU1pZG5pZ2h0OiBnZXRNaW51dGVzRnJvbU1pZG5pZ2h0LFxuICAgIGNvbnRpbnVlc1ByaW9yOiBjb250aW51ZXNQcmlvcixcbiAgICBjb250aW51ZXNBZnRlcjogY29udGludWVzQWZ0ZXIsXG4gICAgc29ydEV2ZW50czogc29ydEV2ZW50cyxcbiAgICBpbkV2ZW50UmFuZ2U6IGluRXZlbnRSYW5nZSxcbiAgICBpc1NhbWVEYXRlOiBpc1NhbWVEYXRlLFxuICAgIGRheVNwYW46IGRheVNwYW4sXG4gICAgYnJvd3NlclRaT2Zmc2V0OiBicm93c2VyVFpPZmZzZXRcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBsdXJhbGl6ZVVuaXQodW5pdCkge1xuICByZXR1cm4gL3MkLy50ZXN0KHVuaXQpID8gdW5pdCA6IHVuaXQgKyAncyc7XG59XG52YXIgd2Vla1JhbmdlRm9ybWF0JDQgPSBmdW5jdGlvbiB3ZWVrUmFuZ2VGb3JtYXQoX3JlZiwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZi5zdGFydCxcbiAgICBlbmQgPSBfcmVmLmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ01NTU0gZGQnLCBjdWx0dXJlKSArICcg4oCTICcgK1xuICAvLyB1cGRhdGVkIHRvIHVzZSB0aGlzIGxvY2FsaXplciAnZXEoKScgbWV0aG9kXG4gIGxvY2FsLmZvcm1hdChlbmQsIGxvY2FsLmVxKHN0YXJ0LCBlbmQsICdtb250aCcpID8gJ2RkJyA6ICdNTU1NIGRkJywgY3VsdHVyZSk7XG59O1xudmFyIGRhdGVSYW5nZUZvcm1hdCQ0ID0gZnVuY3Rpb24gZGF0ZVJhbmdlRm9ybWF0KF9yZWYyLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmMi5zdGFydCxcbiAgICBlbmQgPSBfcmVmMi5lbmQ7XG4gIHJldHVybiBsb2NhbC5mb3JtYXQoc3RhcnQsICdEJywgY3VsdHVyZSkgKyAnIOKAkyAnICsgbG9jYWwuZm9ybWF0KGVuZCwgJ0QnLCBjdWx0dXJlKTtcbn07XG52YXIgdGltZVJhbmdlRm9ybWF0JDQgPSBmdW5jdGlvbiB0aW1lUmFuZ2VGb3JtYXQoX3JlZjMsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYzLnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYzLmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ3QnLCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAndCcsIGN1bHR1cmUpO1xufTtcbnZhciB0aW1lUmFuZ2VTdGFydEZvcm1hdCQ0ID0gZnVuY3Rpb24gdGltZVJhbmdlU3RhcnRGb3JtYXQoX3JlZjQsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWY0LnN0YXJ0O1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAndCcsIGN1bHR1cmUpICsgJyDigJMgJztcbn07XG52YXIgdGltZVJhbmdlRW5kRm9ybWF0JDQgPSBmdW5jdGlvbiB0aW1lUmFuZ2VFbmRGb3JtYXQoX3JlZjUsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBlbmQgPSBfcmVmNS5lbmQ7XG4gIHJldHVybiAnIOKAkyAnICsgbG9jYWwuZm9ybWF0KGVuZCwgJ3QnLCBjdWx0dXJlKTtcbn07XG52YXIgZm9ybWF0cyQ0ID0ge1xuICBkYXRlRm9ybWF0OiAnZGQnLFxuICBkYXlGb3JtYXQ6ICdkZCBFRUUnLFxuICB3ZWVrZGF5Rm9ybWF0OiAnRUVFJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQ0LFxuICBldmVudFRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDQsXG4gIGV2ZW50VGltZVJhbmdlU3RhcnRGb3JtYXQ6IHRpbWVSYW5nZVN0YXJ0Rm9ybWF0JDQsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQkNCxcbiAgdGltZUd1dHRlckZvcm1hdDogJ3QnLFxuICBtb250aEhlYWRlckZvcm1hdDogJ01NTU0geXl5eScsXG4gIGRheUhlYWRlckZvcm1hdDogJ0VFRUUgTU1NIGRkJyxcbiAgZGF5UmFuZ2VIZWFkZXJGb3JtYXQ6IHdlZWtSYW5nZUZvcm1hdCQ0LFxuICBhZ2VuZGFIZWFkZXJGb3JtYXQ6IGRhdGVSYW5nZUZvcm1hdCQ0LFxuICBhZ2VuZGFEYXRlRm9ybWF0OiAnRUVFIE1NTSBkZCcsXG4gIGFnZW5kYVRpbWVGb3JtYXQ6ICd0JyxcbiAgYWdlbmRhVGltZVJhbmdlRm9ybWF0OiB0aW1lUmFuZ2VGb3JtYXQkNFxufTtcbmZ1bmN0aW9uIGZpeFVuaXQkMSh1bml0KSB7XG4gIHZhciBkYXRlUGFydCA9IHVuaXQgPyBwbHVyYWxpemVVbml0KHVuaXQudG9Mb3dlckNhc2UoKSkgOiB1bml0O1xuICBpZiAoZGF0ZVBhcnQgPT09ICdGdWxsWWVhcicpIHtcbiAgICBkYXRlUGFydCA9ICd5ZWFyJztcbiAgfSBlbHNlIGlmICghZGF0ZVBhcnQpIHtcbiAgICBkYXRlUGFydCA9IHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gZGF0ZVBhcnQ7XG59XG5cbi8vIEx1eG9uIGRvZXMgbm90IGN1cnJlbnRseSBoYXZlIHdlZWtJbmZvIGJ5IGN1bHR1cmVcbi8vIEx1eG9uIHVzZXMgMSBiYXNlZCB2YWx1ZXMgZm9yIG1vbnRoIGFuZCB3ZWVrZGF5XG4vLyBTbyB3ZSBkZWZhdWx0IHRvIFN1bmRheSAoNylcbmZ1bmN0aW9uIGx1eG9uIChEYXRlVGltZSkge1xuICB2YXIgX3JlZjYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LFxuICAgIF9yZWY2JGZpcnN0RGF5T2ZXZWVrID0gX3JlZjYuZmlyc3REYXlPZldlZWssXG4gICAgZmlyc3REYXlPZldlZWsgPSBfcmVmNiRmaXJzdERheU9mV2VlayA9PT0gdm9pZCAwID8gNyA6IF9yZWY2JGZpcnN0RGF5T2ZXZWVrO1xuICBmdW5jdGlvbiBmb3JtYXREYXRlKHZhbHVlLCBmb3JtYXQpIHtcbiAgICByZXR1cm4gRGF0ZVRpbWUuZnJvbUpTRGF0ZSh2YWx1ZSkudG9Gb3JtYXQoZm9ybWF0KTtcbiAgfVxuICBmdW5jdGlvbiBmb3JtYXREYXRlV2l0aEN1bHR1cmUodmFsdWUsIGN1bHR1cmUsIGZvcm1hdCkge1xuICAgIHJldHVybiBEYXRlVGltZS5mcm9tSlNEYXRlKHZhbHVlKS5zZXRMb2NhbGUoY3VsdHVyZSkudG9Gb3JtYXQoZm9ybWF0KTtcbiAgfVxuXG4gIC8qKiogQkVHSU4gbG9jYWxpemVkIGRhdGUgYXJpdGhtZXRpYyBtZXRob2RzIHdpdGggTHV4b24gKioqL1xuICBmdW5jdGlvbiBkZWZpbmVDb21wYXJhdG9ycyhhLCBiLCB1bml0KSB7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQxKHVuaXQpO1xuICAgIHZhciBkdEEgPSBkYXRlUGFydCA/IERhdGVUaW1lLmZyb21KU0RhdGUoYSkuc3RhcnRPZihkYXRlUGFydCkgOiBEYXRlVGltZS5mcm9tSlNEYXRlKGEpO1xuICAgIHZhciBkdEIgPSBkYXRlUGFydCA/IERhdGVUaW1lLmZyb21KU0RhdGUoYikuc3RhcnRPZihkYXRlUGFydCkgOiBEYXRlVGltZS5mcm9tSlNEYXRlKGIpO1xuICAgIHJldHVybiBbZHRBLCBkdEIsIGRhdGVQYXJ0XTtcbiAgfVxuXG4gIC8vIFNpbmNlIEx1eG9uIChhbmQgY3VycmVudCBJbnRsIEFQSSkgaGFzIG5vIHN1cHBvcnRcbiAgLy8gZm9yIGN1bHR1cmUgYmFzZWQgd2Vla0luZm8sIHdlIG5lZWQgdG8gaGFuZGxlXG4gIC8vIHRoZSBzdGFydCBvZiB0aGUgd2VlayBkaWZmZXJlbnRseVxuICAvLyBkZXBlbmRpbmcgb24gbG9jYWxlLCB0aGUgZmlyc3REYXlPZldlZWsgY291bGQgYWxzbyBiZSBTYXR1cmRheSwgU3VuZGF5IG9yIE1vbmRheVxuICBmdW5jdGlvbiBzdGFydE9mRFRXZWVrKGR0T2JqKSB7XG4gICAgdmFyIHdlZWtkYXkgPSBkdE9iai53ZWVrZGF5O1xuICAgIGlmICh3ZWVrZGF5ID09PSBmaXJzdERheU9mV2Vlaykge1xuICAgICAgcmV0dXJuIGR0T2JqLnN0YXJ0T2YoJ2RheScpOyAvLyBhbHJlYWR5IGJlZ2lubmluZyBvZiB3ZWVrXG4gICAgfSBlbHNlIGlmIChmaXJzdERheU9mV2VlayA9PT0gMSkge1xuICAgICAgcmV0dXJuIGR0T2JqLnN0YXJ0T2YoJ3dlZWsnKTsgLy8gZm93IGlzIE1vbmRheSwgd2hpY2ggaXMgTHV4b24gZGVmYXVsdFxuICAgIH1cbiAgICB2YXIgZGlmZiA9IGZpcnN0RGF5T2ZXZWVrID09PSA3ID8gd2Vla2RheSA6IHdlZWtkYXkgKyAoNyAtIGZpcnN0RGF5T2ZXZWVrKTtcbiAgICByZXR1cm4gZHRPYmoubWludXMoe1xuICAgICAgZGF5OiBkaWZmXG4gICAgfSkuc3RhcnRPZignZGF5Jyk7XG4gIH1cbiAgZnVuY3Rpb24gZW5kT2ZEVFdlZWsoZHRPYmopIHtcbiAgICB2YXIgd2Vla2RheSA9IGR0T2JqLndlZWtkYXk7XG4gICAgdmFyIGVvdyA9IGZpcnN0RGF5T2ZXZWVrID09PSAxID8gNyA6IGZpcnN0RGF5T2ZXZWVrIC0gMTtcbiAgICBpZiAod2Vla2RheSA9PT0gZW93KSB7XG4gICAgICByZXR1cm4gZHRPYmouZW5kT2YoJ2RheScpOyAvLyBhbHJlYWR5IGxhc3QgZGF5IG9mIHRoZSB3ZWVrXG4gICAgfSBlbHNlIGlmIChmaXJzdERheU9mV2VlayA9PT0gMSkge1xuICAgICAgcmV0dXJuIGR0T2JqLmVuZE9mKCd3ZWVrJyk7IC8vIHVzZSBMdXhvbiBkZWZhdWx0IChTdW5kYXkpXG4gICAgfVxuICAgIHZhciBmcm9tRGF0ZSA9IGZpcnN0RGF5T2ZXZWVrID4gZW93ID8gZHRPYmoucGx1cyh7XG4gICAgICBkYXk6IGZpcnN0RGF5T2ZXZWVrIC0gZW93XG4gICAgfSkgOiBkdE9iajtcbiAgICByZXR1cm4gZnJvbURhdGUuc2V0KHtcbiAgICAgIHdlZWtkYXk6IGVvd1xuICAgIH0pLmVuZE9mKCdkYXknKTtcbiAgfVxuXG4gIC8vIFRoaXMgcmV0dXJucyBhIERhdGVUaW1lIGluc3RhbmNlXG4gIGZ1bmN0aW9uIHN0YXJ0T2ZEVCgpIHtcbiAgICB2YXIgZGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbmV3IERhdGUoKTtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQkMSh1bml0KTtcbiAgICBpZiAoZGF0ZVBhcnQpIHtcbiAgICAgIHZhciBkdCA9IERhdGVUaW1lLmZyb21KU0RhdGUoZGF0ZSk7XG4gICAgICByZXR1cm4gZGF0ZVBhcnQuaW5jbHVkZXMoJ3dlZWsnKSA/IHN0YXJ0T2ZEVFdlZWsoZHQpIDogZHQuc3RhcnRPZihkYXRlUGFydCk7XG4gICAgfVxuICAgIHJldHVybiBEYXRlVGltZS5mcm9tSlNEYXRlKGRhdGUpO1xuICB9XG4gIGZ1bmN0aW9uIGZpcnN0T2ZXZWVrKCkge1xuICAgIHJldHVybiBmaXJzdERheU9mV2VlaztcbiAgfVxuXG4gIC8vIFRoaXMgcmV0dXJucyBhIEpTIERhdGUgZnJvbSBhIERhdGVUaW1lIGluc3RhbmNlXG4gIGZ1bmN0aW9uIHN0YXJ0T2YoKSB7XG4gICAgdmFyIGRhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG5ldyBEYXRlKCk7XG4gICAgdmFyIHVuaXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gc3RhcnRPZkRUKGRhdGUsIHVuaXQpLnRvSlNEYXRlKCk7XG4gIH1cblxuICAvLyBUaGlzIHJldHVybnMgYSBEYXRlVGltZSBpbnN0YW5jZVxuICBmdW5jdGlvbiBlbmRPZkRUKCkge1xuICAgIHZhciBkYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBuZXcgRGF0ZSgpO1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQxKHVuaXQpO1xuICAgIGlmIChkYXRlUGFydCkge1xuICAgICAgdmFyIGR0ID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShkYXRlKTtcbiAgICAgIHJldHVybiBkYXRlUGFydC5pbmNsdWRlcygnd2VlaycpID8gZW5kT2ZEVFdlZWsoZHQpIDogZHQuZW5kT2YoZGF0ZVBhcnQpO1xuICAgIH1cbiAgICByZXR1cm4gRGF0ZVRpbWUuZnJvbUpTRGF0ZShkYXRlKTtcbiAgfVxuICBmdW5jdGlvbiBlbmRPZigpIHtcbiAgICB2YXIgZGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbmV3IERhdGUoKTtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgIHJldHVybiBlbmRPZkRUKGRhdGUsIHVuaXQpLnRvSlNEYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gZXEoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnMgPSBkZWZpbmVDb21wYXJhdG9ycyhhLCBiLCB1bml0KSxcbiAgICAgIF9kZWZpbmVDb21wYXJhdG9yczIgPSBfc2xpY2VkVG9BcnJheShfZGVmaW5lQ29tcGFyYXRvcnMsIDIpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzMlswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczJbMV07XG4gICAgcmV0dXJuICtkdEEgPT0gK2R0QjtcbiAgfVxuICBmdW5jdGlvbiBuZXEoYSwgYiwgdW5pdCkge1xuICAgIHJldHVybiAhZXEoYSwgYiwgdW5pdCk7XG4gIH1cbiAgZnVuY3Rpb24gZ3QoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnMzID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnM0ID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzMywgMiksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnM0WzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzNFsxXTtcbiAgICByZXR1cm4gK2R0QSA+ICtkdEI7XG4gIH1cbiAgZnVuY3Rpb24gbHQoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnM1ID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnM2ID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzNSwgMiksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnM2WzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzNlsxXTtcbiAgICByZXR1cm4gK2R0QSA8ICtkdEI7XG4gIH1cbiAgZnVuY3Rpb24gZ3RlKGEsIGIsIHVuaXQpIHtcbiAgICB2YXIgX2RlZmluZUNvbXBhcmF0b3JzNyA9IGRlZmluZUNvbXBhcmF0b3JzKGEsIGIsIHVuaXQpLFxuICAgICAgX2RlZmluZUNvbXBhcmF0b3JzOCA9IF9zbGljZWRUb0FycmF5KF9kZWZpbmVDb21wYXJhdG9yczcsIDIpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzOFswXSxcbiAgICAgIGR0QiA9IF9kZWZpbmVDb21wYXJhdG9yczhbMV07XG4gICAgcmV0dXJuICtkdEEgPj0gK2R0QjtcbiAgfVxuICBmdW5jdGlvbiBsdGUoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnM5ID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnMxMCA9IF9zbGljZWRUb0FycmF5KF9kZWZpbmVDb21wYXJhdG9yczksIDIpLFxuICAgICAgZHRBID0gX2RlZmluZUNvbXBhcmF0b3JzMTBbMF0sXG4gICAgICBkdEIgPSBfZGVmaW5lQ29tcGFyYXRvcnMxMFsxXTtcbiAgICByZXR1cm4gK2R0QSA8PSArZHRCO1xuICB9XG4gIGZ1bmN0aW9uIGluUmFuZ2UoZGF5LCBtaW4sIG1heCkge1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAnZGF5JztcbiAgICB2YXIgZGF0ZVBhcnQgPSBmaXhVbml0JDEodW5pdCk7XG4gICAgdmFyIG1EYXkgPSBzdGFydE9mRFQoZGF5LCBkYXRlUGFydCk7XG4gICAgdmFyIG1NaW4gPSBzdGFydE9mRFQobWluLCBkYXRlUGFydCk7XG4gICAgdmFyIG1NYXggPSBzdGFydE9mRFQobWF4LCBkYXRlUGFydCk7XG4gICAgcmV0dXJuICttRGF5ID49ICttTWluICYmICttRGF5IDw9ICttTWF4O1xuICB9XG4gIGZ1bmN0aW9uIG1pbihkYXRlQSwgZGF0ZUIpIHtcbiAgICB2YXIgZHRBID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShkYXRlQSk7XG4gICAgdmFyIGR0QiA9IERhdGVUaW1lLmZyb21KU0RhdGUoZGF0ZUIpO1xuICAgIHZhciBtaW5EdCA9IERhdGVUaW1lLm1pbihkdEEsIGR0Qik7XG4gICAgcmV0dXJuIG1pbkR0LnRvSlNEYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gbWF4KGRhdGVBLCBkYXRlQikge1xuICAgIHZhciBkdEEgPSBEYXRlVGltZS5mcm9tSlNEYXRlKGRhdGVBKTtcbiAgICB2YXIgZHRCID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShkYXRlQik7XG4gICAgdmFyIG1heER0ID0gRGF0ZVRpbWUubWF4KGR0QSwgZHRCKTtcbiAgICByZXR1cm4gbWF4RHQudG9KU0RhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBtZXJnZShkYXRlLCB0aW1lKSB7XG4gICAgaWYgKCFkYXRlICYmICF0aW1lKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgdG0gPSBEYXRlVGltZS5mcm9tSlNEYXRlKHRpbWUpO1xuICAgIHZhciBkdCA9IHN0YXJ0T2ZEVChkYXRlLCAnZGF5Jyk7XG4gICAgcmV0dXJuIGR0LnNldCh7XG4gICAgICBob3VyOiB0bS5ob3VyLFxuICAgICAgbWludXRlOiB0bS5taW51dGUsXG4gICAgICBzZWNvbmQ6IHRtLnNlY29uZCxcbiAgICAgIG1pbGxpc2Vjb25kOiB0bS5taWxsaXNlY29uZFxuICAgIH0pLnRvSlNEYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gYWRkKGRhdGUsIGFkZGVyLCB1bml0KSB7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQxKHVuaXQpO1xuICAgIHJldHVybiBEYXRlVGltZS5mcm9tSlNEYXRlKGRhdGUpLnBsdXMoX2RlZmluZVByb3BlcnR5KHt9LCBkYXRlUGFydCwgYWRkZXIpKS50b0pTRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIHJhbmdlKHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2RheSc7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQxKHVuaXQpO1xuICAgIHZhciBjdXJyZW50ID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShzdGFydCkudG9KU0RhdGUoKTsgLy8gdGhpcyBpcyB0byBnZXQgaXQgdG8gdHpcbiAgICB2YXIgZGF5cyA9IFtdO1xuICAgIHdoaWxlIChsdGUoY3VycmVudCwgZW5kKSkge1xuICAgICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgICAgY3VycmVudCA9IGFkZChjdXJyZW50LCAxLCBkYXRlUGFydCk7XG4gICAgfVxuICAgIHJldHVybiBkYXlzO1xuICB9XG4gIGZ1bmN0aW9uIGNlaWwoZGF0ZSwgdW5pdCkge1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQkMSh1bml0KTtcbiAgICB2YXIgZmxvb3IgPSBzdGFydE9mKGRhdGUsIGRhdGVQYXJ0KTtcbiAgICByZXR1cm4gZXEoZmxvb3IsIGRhdGUpID8gZmxvb3IgOiBhZGQoZmxvb3IsIDEsIGRhdGVQYXJ0KTtcbiAgfVxuICBmdW5jdGlvbiBkaWZmKGEsIGIpIHtcbiAgICB2YXIgdW5pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2RheSc7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCQxKHVuaXQpO1xuICAgIC8vIGRvbid0IHVzZSAnZGVmaW5lQ29tcGFyYXRvcnMnIGhlcmUsIGFzIHdlIGRvbid0IHdhbnQgdG8gbXV0YXRlIHRoZSB2YWx1ZXNcbiAgICB2YXIgZHRBID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShhKTtcbiAgICB2YXIgZHRCID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShiKTtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihkdEIuZGlmZihkdEEsIGRhdGVQYXJ0LCB7XG4gICAgICBjb252ZXJzaW9uQWNjdXJhY3k6ICdsb25ndGVybSdcbiAgICB9KS50b09iamVjdCgpW2RhdGVQYXJ0XSk7XG4gIH1cbiAgZnVuY3Rpb24gZmlyc3RWaXNpYmxlRGF5KGRhdGUpIHtcbiAgICB2YXIgc3RhcnRPZk1vbnRoID0gc3RhcnRPZkRUKGRhdGUsICdtb250aCcpO1xuICAgIHJldHVybiBzdGFydE9mRFRXZWVrKHN0YXJ0T2ZNb250aCkudG9KU0RhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBsYXN0VmlzaWJsZURheShkYXRlKSB7XG4gICAgdmFyIGVuZE9mTW9udGggPSBlbmRPZkRUKGRhdGUsICdtb250aCcpO1xuICAgIHJldHVybiBlbmRPZkRUV2VlayhlbmRPZk1vbnRoKS50b0pTRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIHZpc2libGVEYXlzKGRhdGUpIHtcbiAgICB2YXIgY3VycmVudCA9IGZpcnN0VmlzaWJsZURheShkYXRlKTtcbiAgICB2YXIgbGFzdCA9IGxhc3RWaXNpYmxlRGF5KGRhdGUpO1xuICAgIHZhciBkYXlzID0gW107XG4gICAgd2hpbGUgKGx0ZShjdXJyZW50LCBsYXN0KSkge1xuICAgICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgICAgY3VycmVudCA9IGFkZChjdXJyZW50LCAxLCAnZGF5Jyk7XG4gICAgfVxuICAgIHJldHVybiBkYXlzO1xuICB9XG4gIC8qKiogRU5EIGxvY2FsaXplZCBkYXRlIGFyaXRobWV0aWMgbWV0aG9kcyB3aXRoIG1vbWVudCAqKiovXG5cbiAgLyoqXG4gICAqIE1vdmVkIGZyb20gVGltZVNsb3RzLmpzLCB0aGlzIG1ldGhvZCBvdmVycmlkZXMgdGhlIG1ldGhvZCBvZiB0aGUgc2FtZSBuYW1lXG4gICAqIGluIHRoZSBsb2NhbGl6ZXIuanMsIHVzaW5nIG1vbWVudCB0byBjb25zdHJ1Y3QgdGhlIGpzIERhdGVcbiAgICogQHBhcmFtIHtEYXRlfSBkdCAtIGRhdGUgdG8gc3RhcnQgd2l0aFxuICAgKiBAcGFyYW0ge051bWJlcn0gbWludXRlc0Zyb21NaWRuaWdodFxuICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0XG4gICAqIEByZXR1cm5zIHtEYXRlfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0U2xvdERhdGUoZHQsIG1pbnV0ZXNGcm9tTWlkbmlnaHQsIG9mZnNldCkge1xuICAgIHJldHVybiBzdGFydE9mRFQoZHQsICdkYXknKS5zZXQoe1xuICAgICAgbWludXRlczogbWludXRlc0Zyb21NaWRuaWdodCArIG9mZnNldFxuICAgIH0pLnRvSlNEYXRlKCk7XG4gIH1cblxuICAvLyBMdXhvbiB3aWxsIGF1dG9tYXRpY2FsbHkgaGFuZGxlIERTVCBkaWZmZXJlbmNlcyBpbiBpdCdzIGNhbGN1bGF0aW9uc1xuICBmdW5jdGlvbiBnZXRUb3RhbE1pbihzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIGRpZmYoc3RhcnQsIGVuZCwgJ21pbnV0ZXMnKTtcbiAgfVxuICBmdW5jdGlvbiBnZXRNaW51dGVzRnJvbU1pZG5pZ2h0KHN0YXJ0KSB7XG4gICAgdmFyIGRheVN0YXJ0ID0gc3RhcnRPZkRUKHN0YXJ0LCAnZGF5Jyk7XG4gICAgdmFyIGRheSA9IERhdGVUaW1lLmZyb21KU0RhdGUoc3RhcnQpO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKGRheS5kaWZmKGRheVN0YXJ0LCAnbWludXRlcycsIHtcbiAgICAgIGNvbnZlcnNpb25BY2N1cmFjeTogJ2xvbmd0ZXJtJ1xuICAgIH0pLnRvT2JqZWN0KCkubWludXRlcyk7XG4gIH1cblxuICAvLyBUaGVzZSB0d28gYXJlIHVzZWQgYnkgRGF0ZVNsb3RNZXRyaWNzXG4gIGZ1bmN0aW9uIGNvbnRpbnVlc1ByaW9yKHN0YXJ0LCBmaXJzdCkge1xuICAgIHJldHVybiBsdChzdGFydCwgZmlyc3QpO1xuICB9XG4gIGZ1bmN0aW9uIGNvbnRpbnVlc0FmdGVyKHN0YXJ0LCBlbmQsIGxhc3QpIHtcbiAgICByZXR1cm4gZ3RlKGVuZCwgbGFzdCk7XG4gIH1cbiAgZnVuY3Rpb24gZGF5U3BhbihzdGFydCwgZW5kKSB7XG4gICAgdmFyIGR0U3RhcnQgPSBEYXRlVGltZS5mcm9tSlNEYXRlKHN0YXJ0KTtcbiAgICB2YXIgZHRFbmQgPSBEYXRlVGltZS5mcm9tSlNEYXRlKGVuZCk7XG4gICAgcmV0dXJuIGR0RW5kLmRpZmYoZHRTdGFydCkuYXMoJ2RheXMnKTtcbiAgfVxuXG4gIC8vIFRoZXNlIHR3byBhcmUgdXNlZCBieSBldmVudExldmVsc1xuICBmdW5jdGlvbiBzb3J0RXZlbnRzKF9yZWY3KSB7XG4gICAgdmFyIF9yZWY3JGV2dEEgPSBfcmVmNy5ldnRBLFxuICAgICAgYVN0YXJ0ID0gX3JlZjckZXZ0QS5zdGFydCxcbiAgICAgIGFFbmQgPSBfcmVmNyRldnRBLmVuZCxcbiAgICAgIGFBbGxEYXkgPSBfcmVmNyRldnRBLmFsbERheSxcbiAgICAgIF9yZWY3JGV2dEIgPSBfcmVmNy5ldnRCLFxuICAgICAgYlN0YXJ0ID0gX3JlZjckZXZ0Qi5zdGFydCxcbiAgICAgIGJFbmQgPSBfcmVmNyRldnRCLmVuZCxcbiAgICAgIGJBbGxEYXkgPSBfcmVmNyRldnRCLmFsbERheTtcbiAgICB2YXIgc3RhcnRTb3J0ID0gK3N0YXJ0T2YoYVN0YXJ0LCAnZGF5JykgLSArc3RhcnRPZihiU3RhcnQsICdkYXknKTtcbiAgICB2YXIgZHVyQSA9IGRheVNwYW4oYVN0YXJ0LCBhRW5kKTtcbiAgICB2YXIgZHVyQiA9IGRheVNwYW4oYlN0YXJ0LCBiRW5kKTtcbiAgICByZXR1cm4gc3RhcnRTb3J0IHx8XG4gICAgLy8gc29ydCBieSBzdGFydCBEYXkgZmlyc3RcbiAgICBkdXJCIC0gZHVyQSB8fFxuICAgIC8vIGV2ZW50cyBzcGFubmluZyBtdWx0aXBsZSBkYXlzIGdvIGZpcnN0XG4gICAgISFiQWxsRGF5IC0gISFhQWxsRGF5IHx8XG4gICAgLy8gdGhlbiBhbGxEYXkgc2luZ2xlIGRheSBldmVudHNcbiAgICArYVN0YXJ0IC0gK2JTdGFydCB8fFxuICAgIC8vIHRoZW4gc29ydCBieSBzdGFydCB0aW1lICpkb24ndCBuZWVkIG1vbWVudCBjb252ZXJzaW9uIGhlcmVcbiAgICArYUVuZCAtICtiRW5kIC8vIHRoZW4gc29ydCBieSBlbmQgdGltZSAqZG9uJ3QgbmVlZCBtb21lbnQgY29udmVyc2lvbiBoZXJlIGVpdGhlclxuICAgIDtcbiAgfVxuICBmdW5jdGlvbiBpbkV2ZW50UmFuZ2UoX3JlZjgpIHtcbiAgICB2YXIgX3JlZjgkZXZlbnQgPSBfcmVmOC5ldmVudCxcbiAgICAgIHN0YXJ0ID0gX3JlZjgkZXZlbnQuc3RhcnQsXG4gICAgICBlbmQgPSBfcmVmOCRldmVudC5lbmQsXG4gICAgICBfcmVmOCRyYW5nZSA9IF9yZWY4LnJhbmdlLFxuICAgICAgcmFuZ2VTdGFydCA9IF9yZWY4JHJhbmdlLnN0YXJ0LFxuICAgICAgcmFuZ2VFbmQgPSBfcmVmOCRyYW5nZS5lbmQ7XG4gICAgdmFyIGVTdGFydCA9IHN0YXJ0T2Yoc3RhcnQsICdkYXknKTtcbiAgICB2YXIgc3RhcnRzQmVmb3JlRW5kID0gbHRlKGVTdGFydCwgcmFuZ2VFbmQsICdkYXknKTtcbiAgICAvLyB3aGVuIHRoZSBldmVudCBpcyB6ZXJvIGR1cmF0aW9uIHdlIG5lZWQgdG8gaGFuZGxlIGEgYml0IGRpZmZlcmVudGx5XG4gICAgdmFyIHNhbWVNaW4gPSBuZXEoZVN0YXJ0LCBlbmQsICdtaW51dGVzJyk7XG4gICAgdmFyIGVuZHNBZnRlclN0YXJ0ID0gc2FtZU1pbiA/IGd0KGVuZCwgcmFuZ2VTdGFydCwgJ21pbnV0ZXMnKSA6IGd0ZShlbmQsIHJhbmdlU3RhcnQsICdtaW51dGVzJyk7XG4gICAgcmV0dXJuIHN0YXJ0c0JlZm9yZUVuZCAmJiBlbmRzQWZ0ZXJTdGFydDtcbiAgfVxuXG4gIC8vIG1vbWVudCB0cmVhdHMgJ2RheScgYW5kICdkYXRlJyBlcXVhbGl0eSB2ZXJ5IGRpZmZlcmVudFxuICAvLyBtb21lbnQoZGF0ZTEpLmlzU2FtZShkYXRlMiwgJ2RheScpIHdvdWxkIHRlc3QgdGhhdCB0aGV5IHdlcmUgYm90aCB0aGUgc2FtZSBkYXkgb2YgdGhlIHdlZWtcbiAgLy8gbW9tZW50KGRhdGUxKS5pc1NhbWUoZGF0ZTIsICdkYXRlJykgd291bGQgdGVzdCB0aGF0IHRoZXkgd2VyZSBib3RoIHRoZSBzYW1lIGRhdGUgb2YgdGhlIG1vbnRoIG9mIHRoZSB5ZWFyXG4gIGZ1bmN0aW9uIGlzU2FtZURhdGUoZGF0ZTEsIGRhdGUyKSB7XG4gICAgdmFyIGR0ID0gRGF0ZVRpbWUuZnJvbUpTRGF0ZShkYXRlMSk7XG4gICAgdmFyIGR0MiA9IERhdGVUaW1lLmZyb21KU0RhdGUoZGF0ZTIpO1xuICAgIHJldHVybiBkdC5oYXNTYW1lKGR0MiwgJ2RheScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kLCBjYWxsZWQgb25jZSBpbiB0aGUgbG9jYWxpemVyIGNvbnN0cnVjdG9yLCBpcyB1c2VkIGJ5IGV2ZW50TGV2ZWxzXG4gICAqICdldmVudFNlZ21lbnRzKCknIHRvIGFzc2lzdCBpbiBkZXRlcm1pbmluZyB0aGUgJ3NwYW4nIG9mIHRoZSBldmVudCBpbiB0aGUgZGlzcGxheSxcbiAgICogc3BlY2lmaWNhbGx5IHdoZW4gdXNpbmcgYSB0aW1lem9uZSB0aGF0IGlzIGdyZWF0ZXIgdGhhbiB0aGUgYnJvd3NlciBuYXRpdmUgdGltZXpvbmUuXG4gICAqIEByZXR1cm5zIG51bWJlclxuICAgKi9cbiAgZnVuY3Rpb24gYnJvd3NlclRaT2Zmc2V0KCkge1xuICAgIC8qKlxuICAgICAqIERhdGUucHJvdG90eXBlLmdldFRpbWV6b25lT2Zmc2V0IGhvcnJpZmljYWxseSBmbGlwcyB0aGUgcG9zaXRpdmUvbmVnYXRpdmUgZnJvbVxuICAgICAqIHdoYXQgeW91IHNlZSBpbiBpdCdzIHN0cmluZywgc28gd2UgaGF2ZSB0byBqdW1wIHRocm91Z2ggc29tZSBob29wcyB0byBnZXQgYSB2YWx1ZVxuICAgICAqIHdlIGNhbiBhY3R1YWxseSBjb21wYXJlLlxuICAgICAqL1xuICAgIHZhciBkdCA9IG5ldyBEYXRlKCk7XG4gICAgdmFyIG5lZyA9IC8tLy50ZXN0KGR0LnRvU3RyaW5nKCkpID8gJy0nIDogJyc7XG4gICAgdmFyIGR0T2Zmc2V0ID0gZHQuZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgICB2YXIgY29tcGFyYXRvciA9IE51bWJlcihcIlwiLmNvbmNhdChuZWcpLmNvbmNhdChNYXRoLmFicyhkdE9mZnNldCkpKTtcbiAgICAvLyBtb21lbnQgY29ycmVjdGx5IHByb3ZpZGVzIHBvc2l0aXZlL25lZ2F0aXZlIG9mZnNldCwgYXMgZXhwZWN0ZWRcbiAgICB2YXIgbXRPZmZzZXQgPSBEYXRlVGltZS5sb2NhbCgpLm9mZnNldDtcbiAgICByZXR1cm4gbXRPZmZzZXQgPiBjb21wYXJhdG9yID8gMSA6IDA7XG4gIH1cbiAgcmV0dXJuIG5ldyBEYXRlTG9jYWxpemVyKHtcbiAgICBmb3JtYXQ6IGZ1bmN0aW9uIGZvcm1hdCh2YWx1ZSwgX2Zvcm1hdCwgY3VsdHVyZSkge1xuICAgICAgaWYgKGN1bHR1cmUpIHtcbiAgICAgICAgcmV0dXJuIGZvcm1hdERhdGVXaXRoQ3VsdHVyZSh2YWx1ZSwgY3VsdHVyZSwgX2Zvcm1hdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZm9ybWF0RGF0ZSh2YWx1ZSwgX2Zvcm1hdCk7XG4gICAgfSxcbiAgICBmb3JtYXRzOiBmb3JtYXRzJDQsXG4gICAgZmlyc3RPZldlZWs6IGZpcnN0T2ZXZWVrLFxuICAgIGZpcnN0VmlzaWJsZURheTogZmlyc3RWaXNpYmxlRGF5LFxuICAgIGxhc3RWaXNpYmxlRGF5OiBsYXN0VmlzaWJsZURheSxcbiAgICB2aXNpYmxlRGF5czogdmlzaWJsZURheXMsXG4gICAgbHQ6IGx0LFxuICAgIGx0ZTogbHRlLFxuICAgIGd0OiBndCxcbiAgICBndGU6IGd0ZSxcbiAgICBlcTogZXEsXG4gICAgbmVxOiBuZXEsXG4gICAgbWVyZ2U6IG1lcmdlLFxuICAgIGluUmFuZ2U6IGluUmFuZ2UsXG4gICAgc3RhcnRPZjogc3RhcnRPZixcbiAgICBlbmRPZjogZW5kT2YsXG4gICAgcmFuZ2U6IHJhbmdlLFxuICAgIGFkZDogYWRkLFxuICAgIGRpZmY6IGRpZmYsXG4gICAgY2VpbDogY2VpbCxcbiAgICBtaW46IG1pbixcbiAgICBtYXg6IG1heCxcbiAgICBnZXRTbG90RGF0ZTogZ2V0U2xvdERhdGUsXG4gICAgZ2V0VG90YWxNaW46IGdldFRvdGFsTWluLFxuICAgIGdldE1pbnV0ZXNGcm9tTWlkbmlnaHQ6IGdldE1pbnV0ZXNGcm9tTWlkbmlnaHQsXG4gICAgY29udGludWVzUHJpb3I6IGNvbnRpbnVlc1ByaW9yLFxuICAgIGNvbnRpbnVlc0FmdGVyOiBjb250aW51ZXNBZnRlcixcbiAgICBzb3J0RXZlbnRzOiBzb3J0RXZlbnRzLFxuICAgIGluRXZlbnRSYW5nZTogaW5FdmVudFJhbmdlLFxuICAgIGlzU2FtZURhdGU6IGlzU2FtZURhdGUsXG4gICAgZGF5U3BhbjogZGF5U3BhbixcbiAgICBicm93c2VyVFpPZmZzZXQ6IGJyb3dzZXJUWk9mZnNldFxuICB9KTtcbn1cblxudmFyIGRhdGVSYW5nZUZvcm1hdCQzID0gZnVuY3Rpb24gZGF0ZVJhbmdlRm9ybWF0KF9yZWYsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYuc3RhcnQsXG4gICAgZW5kID0gX3JlZi5lbmQ7XG4gIHJldHVybiBsb2NhbC5mb3JtYXQoc3RhcnQsICdkJywgY3VsdHVyZSkgKyAnIOKAkyAnICsgbG9jYWwuZm9ybWF0KGVuZCwgJ2QnLCBjdWx0dXJlKTtcbn07XG52YXIgdGltZVJhbmdlRm9ybWF0JDMgPSBmdW5jdGlvbiB0aW1lUmFuZ2VGb3JtYXQoX3JlZjIsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYyLnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYyLmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ3QnLCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAndCcsIGN1bHR1cmUpO1xufTtcbnZhciB0aW1lUmFuZ2VTdGFydEZvcm1hdCQzID0gZnVuY3Rpb24gdGltZVJhbmdlU3RhcnRGb3JtYXQoX3JlZjMsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYzLnN0YXJ0O1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAndCcsIGN1bHR1cmUpICsgJyDigJMgJztcbn07XG52YXIgdGltZVJhbmdlRW5kRm9ybWF0JDMgPSBmdW5jdGlvbiB0aW1lUmFuZ2VFbmRGb3JtYXQoX3JlZjQsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBlbmQgPSBfcmVmNC5lbmQ7XG4gIHJldHVybiAnIOKAkyAnICsgbG9jYWwuZm9ybWF0KGVuZCwgJ3QnLCBjdWx0dXJlKTtcbn07XG52YXIgd2Vla1JhbmdlRm9ybWF0JDMgPSBmdW5jdGlvbiB3ZWVrUmFuZ2VGb3JtYXQoX3JlZjUsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWY1LnN0YXJ0LFxuICAgIGVuZCA9IF9yZWY1LmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ01NTSBkZCcsIGN1bHR1cmUpICsgJyDigJMgJyArIGxvY2FsLmZvcm1hdChlbmQsIGVxKHN0YXJ0LCBlbmQsICdtb250aCcpID8gJ2RkJyA6ICdNTU0gZGQnLCBjdWx0dXJlKTtcbn07XG52YXIgZm9ybWF0cyQzID0ge1xuICBkYXRlRm9ybWF0OiAnZGQnLFxuICBkYXlGb3JtYXQ6ICdkZGQgZGQvTU0nLFxuICB3ZWVrZGF5Rm9ybWF0OiAnZGRkJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQzLFxuICBldmVudFRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDMsXG4gIGV2ZW50VGltZVJhbmdlU3RhcnRGb3JtYXQ6IHRpbWVSYW5nZVN0YXJ0Rm9ybWF0JDMsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQkMyxcbiAgdGltZUd1dHRlckZvcm1hdDogJ3QnLFxuICBtb250aEhlYWRlckZvcm1hdDogJ1knLFxuICBkYXlIZWFkZXJGb3JtYXQ6ICdkZGRkIE1NTSBkZCcsXG4gIGRheVJhbmdlSGVhZGVyRm9ybWF0OiB3ZWVrUmFuZ2VGb3JtYXQkMyxcbiAgYWdlbmRhSGVhZGVyRm9ybWF0OiBkYXRlUmFuZ2VGb3JtYXQkMyxcbiAgYWdlbmRhRGF0ZUZvcm1hdDogJ2RkZCBNTU0gZGQnLFxuICBhZ2VuZGFUaW1lRm9ybWF0OiAndCcsXG4gIGFnZW5kYVRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDNcbn07XG5mdW5jdGlvbiBvbGRHbG9iYWxpemUgKGdsb2JhbGl6ZSkge1xuICBmdW5jdGlvbiBnZXRDdWx0dXJlKGN1bHR1cmUpIHtcbiAgICByZXR1cm4gY3VsdHVyZSA/IGdsb2JhbGl6ZS5maW5kQ2xvc2VzdEN1bHR1cmUoY3VsdHVyZSkgOiBnbG9iYWxpemUuY3VsdHVyZSgpO1xuICB9XG4gIGZ1bmN0aW9uIGZpcnN0T2ZXZWVrKGN1bHR1cmUpIHtcbiAgICBjdWx0dXJlID0gZ2V0Q3VsdHVyZShjdWx0dXJlKTtcbiAgICByZXR1cm4gY3VsdHVyZSAmJiBjdWx0dXJlLmNhbGVuZGFyLmZpcnN0RGF5IHx8IDA7XG4gIH1cbiAgcmV0dXJuIG5ldyBEYXRlTG9jYWxpemVyKHtcbiAgICBmaXJzdE9mV2VlazogZmlyc3RPZldlZWssXG4gICAgZm9ybWF0czogZm9ybWF0cyQzLFxuICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHZhbHVlLCBfZm9ybWF0LCBjdWx0dXJlKSB7XG4gICAgICByZXR1cm4gZ2xvYmFsaXplLmZvcm1hdCh2YWx1ZSwgX2Zvcm1hdCwgY3VsdHVyZSk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gVE9ETzogZml4IHRoZSBnbG9iYWxpemVMb2NhbGl6ZXIgdG8gd29yayB3aXRoIGdsb2JhbGl6ZSAxLnhcblxudmFyIGRhdGVSYW5nZUZvcm1hdCQyID0gZnVuY3Rpb24gZGF0ZVJhbmdlRm9ybWF0KF9yZWYsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWYuc3RhcnQsXG4gICAgZW5kID0gX3JlZi5lbmQ7XG4gIHJldHVybiBsb2NhbC5mb3JtYXQoc3RhcnQsIHtcbiAgICBkYXRlOiAnc2hvcnQnXG4gIH0sIGN1bHR1cmUpICsgJyDigJMgJyArIGxvY2FsLmZvcm1hdChlbmQsIHtcbiAgICBkYXRlOiAnc2hvcnQnXG4gIH0sIGN1bHR1cmUpO1xufTtcbnZhciB0aW1lUmFuZ2VGb3JtYXQkMiA9IGZ1bmN0aW9uIHRpbWVSYW5nZUZvcm1hdChfcmVmMiwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZjIuc3RhcnQsXG4gICAgZW5kID0gX3JlZjIuZW5kO1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCB7XG4gICAgdGltZTogJ3Nob3J0J1xuICB9LCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCB7XG4gICAgdGltZTogJ3Nob3J0J1xuICB9LCBjdWx0dXJlKTtcbn07XG52YXIgdGltZVJhbmdlU3RhcnRGb3JtYXQkMiA9IGZ1bmN0aW9uIHRpbWVSYW5nZVN0YXJ0Rm9ybWF0KF9yZWYzLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmMy5zdGFydDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwge1xuICAgIHRpbWU6ICdzaG9ydCdcbiAgfSwgY3VsdHVyZSkgKyAnIOKAkyAnO1xufTtcbnZhciB0aW1lUmFuZ2VFbmRGb3JtYXQkMiA9IGZ1bmN0aW9uIHRpbWVSYW5nZUVuZEZvcm1hdChfcmVmNCwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIGVuZCA9IF9yZWY0LmVuZDtcbiAgcmV0dXJuICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCB7XG4gICAgdGltZTogJ3Nob3J0J1xuICB9LCBjdWx0dXJlKTtcbn07XG52YXIgd2Vla1JhbmdlRm9ybWF0JDIgPSBmdW5jdGlvbiB3ZWVrUmFuZ2VGb3JtYXQoX3JlZjUsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWY1LnN0YXJ0LFxuICAgIGVuZCA9IF9yZWY1LmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ01NTSBkZCcsIGN1bHR1cmUpICsgJyDigJMgJyArIGxvY2FsLmZvcm1hdChlbmQsIGVxKHN0YXJ0LCBlbmQsICdtb250aCcpID8gJ2RkJyA6ICdNTU0gZGQnLCBjdWx0dXJlKTtcbn07XG52YXIgZm9ybWF0cyQyID0ge1xuICBkYXRlRm9ybWF0OiAnZGQnLFxuICBkYXlGb3JtYXQ6ICdlZWUgZGQvTU0nLFxuICB3ZWVrZGF5Rm9ybWF0OiAnZWVlJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQyLFxuICBldmVudFRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDIsXG4gIGV2ZW50VGltZVJhbmdlU3RhcnRGb3JtYXQ6IHRpbWVSYW5nZVN0YXJ0Rm9ybWF0JDIsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQkMixcbiAgdGltZUd1dHRlckZvcm1hdDoge1xuICAgIHRpbWU6ICdzaG9ydCdcbiAgfSxcbiAgbW9udGhIZWFkZXJGb3JtYXQ6ICdNTU1NIHl5eXknLFxuICBkYXlIZWFkZXJGb3JtYXQ6ICdlZWVlIE1NTSBkZCcsXG4gIGRheVJhbmdlSGVhZGVyRm9ybWF0OiB3ZWVrUmFuZ2VGb3JtYXQkMixcbiAgYWdlbmRhSGVhZGVyRm9ybWF0OiBkYXRlUmFuZ2VGb3JtYXQkMixcbiAgYWdlbmRhRGF0ZUZvcm1hdDogJ2VlZSBNTU0gZGQnLFxuICBhZ2VuZGFUaW1lRm9ybWF0OiB7XG4gICAgdGltZTogJ3Nob3J0J1xuICB9LFxuICBhZ2VuZGFUaW1lUmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQyXG59O1xuZnVuY3Rpb24gZ2xvYmFsaXplIChnbG9iYWxpemUpIHtcbiAgdmFyIGxvY2FsZSA9IGZ1bmN0aW9uIGxvY2FsZShjdWx0dXJlKSB7XG4gICAgcmV0dXJuIGN1bHR1cmUgPyBnbG9iYWxpemUoY3VsdHVyZSkgOiBnbG9iYWxpemU7XG4gIH07XG5cbiAgLy8gcmV0dXJuIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWsgZnJvbSB0aGUgbG9jYWxlIGRhdGEuIERlZmF1bHRzIHRvICd3b3JsZCdcbiAgLy8gdGVycml0b3J5IGlmIG5vIHRlcnJpdG9yeSBpcyBkZXJpdmFibGUgZnJvbSBDTERSLlxuICAvLyBGYWlsaW5nIHRvIHVzZSBDTERSIHN1cHBsZW1lbnRhbCAobm90IGxvYWRlZD8pLCByZXZlcnQgdG8gdGhlIG9yaWdpbmFsXG4gIC8vIG1ldGhvZCBvZiBnZXR0aW5nIGZpcnN0IGRheSBvZiB3ZWVrLlxuICBmdW5jdGlvbiBmaXJzdE9mV2VlayhjdWx0dXJlKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBkYXlzID0gWydzdW4nLCAnbW9uJywgJ3R1ZScsICd3ZWQnLCAndGh1JywgJ2ZyaScsICdzYXQnXTtcbiAgICAgIHZhciBjbGRyID0gbG9jYWxlKGN1bHR1cmUpLmNsZHI7XG4gICAgICB2YXIgdGVycml0b3J5ID0gY2xkci5hdHRyaWJ1dGVzLnRlcnJpdG9yeTtcbiAgICAgIHZhciB3ZWVrRGF0YSA9IGNsZHIuZ2V0KCdzdXBwbGVtZW50YWwnKS53ZWVrRGF0YTtcbiAgICAgIHZhciBmaXJzdERheSA9IHdlZWtEYXRhLmZpcnN0RGF5W3RlcnJpdG9yeSB8fCAnMDAxJ107XG4gICAgICByZXR1cm4gZGF5cy5pbmRleE9mKGZpcnN0RGF5KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gYWNjdXJhdGVseSBkZXRlcm1pbmUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrLicgKyAnIElzIHN1cHBsZW1lbnRhbCBkYXRhIGxvYWRlZCBpbnRvIENMRFI/Jyk7XG4gICAgICB9XG4gICAgICAvLyBtYXliZSBjbGRyIHN1cHBsZW1lbnRhbCBpcyBub3QgbG9hZGVkPyByZXZlcnQgdG8gb3JpZ2luYWwgbWV0aG9kXG4gICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAvL2NsZHItZGF0YSBkb2Vzbid0IHNlZW0gdG8gYmUgemVybyBiYXNlZFxuICAgICAgdmFyIGxvY2FsZURheSA9IE1hdGgubWF4KHBhcnNlSW50KGxvY2FsZShjdWx0dXJlKS5mb3JtYXREYXRlKGRhdGUsIHtcbiAgICAgICAgcmF3OiAnZSdcbiAgICAgIH0pLCAxMCkgLSAxLCAwKTtcbiAgICAgIHJldHVybiBNYXRoLmFicyhkYXRlLmdldERheSgpIC0gbG9jYWxlRGF5KTtcbiAgICB9XG4gIH1cbiAgaWYgKCFnbG9iYWxpemUubG9hZCkgcmV0dXJuIG9sZEdsb2JhbGl6ZShnbG9iYWxpemUpO1xuICByZXR1cm4gbmV3IERhdGVMb2NhbGl6ZXIoe1xuICAgIGZpcnN0T2ZXZWVrOiBmaXJzdE9mV2VlayxcbiAgICBmb3JtYXRzOiBmb3JtYXRzJDIsXG4gICAgZm9ybWF0OiBmdW5jdGlvbiBmb3JtYXQodmFsdWUsIF9mb3JtYXQsIGN1bHR1cmUpIHtcbiAgICAgIF9mb3JtYXQgPSB0eXBlb2YgX2Zvcm1hdCA9PT0gJ3N0cmluZycgPyB7XG4gICAgICAgIHJhdzogX2Zvcm1hdFxuICAgICAgfSA6IF9mb3JtYXQ7XG4gICAgICByZXR1cm4gbG9jYWxlKGN1bHR1cmUpLmZvcm1hdERhdGUodmFsdWUsIF9mb3JtYXQpO1xuICAgIH1cbiAgfSk7XG59XG5cbnZhciBkYXRlUmFuZ2VGb3JtYXQkMSA9IGZ1bmN0aW9uIGRhdGVSYW5nZUZvcm1hdChfcmVmLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmLnN0YXJ0LFxuICAgIGVuZCA9IF9yZWYuZW5kO1xuICByZXR1cm4gXCJcIi5jb25jYXQobG9jYWwuZm9ybWF0KHN0YXJ0LCAnUCcsIGN1bHR1cmUpLCBcIiBcXHUyMDEzIFwiKS5jb25jYXQobG9jYWwuZm9ybWF0KGVuZCwgJ1AnLCBjdWx0dXJlKSk7XG59O1xudmFyIHRpbWVSYW5nZUZvcm1hdCQxID0gZnVuY3Rpb24gdGltZVJhbmdlRm9ybWF0KF9yZWYyLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmMi5zdGFydCxcbiAgICBlbmQgPSBfcmVmMi5lbmQ7XG4gIHJldHVybiBcIlwiLmNvbmNhdChsb2NhbC5mb3JtYXQoc3RhcnQsICdwJywgY3VsdHVyZSksIFwiIFxcdTIwMTMgXCIpLmNvbmNhdChsb2NhbC5mb3JtYXQoZW5kLCAncCcsIGN1bHR1cmUpKTtcbn07XG52YXIgdGltZVJhbmdlU3RhcnRGb3JtYXQkMSA9IGZ1bmN0aW9uIHRpbWVSYW5nZVN0YXJ0Rm9ybWF0KF9yZWYzLCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgc3RhcnQgPSBfcmVmMy5zdGFydDtcbiAgcmV0dXJuIFwiXCIuY29uY2F0KGxvY2FsLmZvcm1hdChzdGFydCwgJ2g6bW1hJywgY3VsdHVyZSksIFwiIFxcdTIwMTMgXCIpO1xufTtcbnZhciB0aW1lUmFuZ2VFbmRGb3JtYXQkMSA9IGZ1bmN0aW9uIHRpbWVSYW5nZUVuZEZvcm1hdChfcmVmNCwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIGVuZCA9IF9yZWY0LmVuZDtcbiAgcmV0dXJuIFwiIFxcdTIwMTMgXCIuY29uY2F0KGxvY2FsLmZvcm1hdChlbmQsICdoOm1tYScsIGN1bHR1cmUpKTtcbn07XG52YXIgd2Vla1JhbmdlRm9ybWF0JDEgPSBmdW5jdGlvbiB3ZWVrUmFuZ2VGb3JtYXQoX3JlZjUsIGN1bHR1cmUsIGxvY2FsKSB7XG4gIHZhciBzdGFydCA9IF9yZWY1LnN0YXJ0LFxuICAgIGVuZCA9IF9yZWY1LmVuZDtcbiAgcmV0dXJuIFwiXCIuY29uY2F0KGxvY2FsLmZvcm1hdChzdGFydCwgJ01NTU0gZGQnLCBjdWx0dXJlKSwgXCIgXFx1MjAxMyBcIikuY29uY2F0KGxvY2FsLmZvcm1hdChlbmQsIGVxKHN0YXJ0LCBlbmQsICdtb250aCcpID8gJ2RkJyA6ICdNTU1NIGRkJywgY3VsdHVyZSkpO1xufTtcbnZhciBmb3JtYXRzJDEgPSB7XG4gIGRhdGVGb3JtYXQ6ICdkZCcsXG4gIGRheUZvcm1hdDogJ2RkIGVlZScsXG4gIHdlZWtkYXlGb3JtYXQ6ICdjY2NjJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCQxLFxuICBldmVudFRpbWVSYW5nZUZvcm1hdDogdGltZVJhbmdlRm9ybWF0JDEsXG4gIGV2ZW50VGltZVJhbmdlU3RhcnRGb3JtYXQ6IHRpbWVSYW5nZVN0YXJ0Rm9ybWF0JDEsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQkMSxcbiAgdGltZUd1dHRlckZvcm1hdDogJ3AnLFxuICBtb250aEhlYWRlckZvcm1hdDogJ01NTU0geXl5eScsXG4gIGRheUhlYWRlckZvcm1hdDogJ2NjY2MgTU1NIGRkJyxcbiAgZGF5UmFuZ2VIZWFkZXJGb3JtYXQ6IHdlZWtSYW5nZUZvcm1hdCQxLFxuICBhZ2VuZGFIZWFkZXJGb3JtYXQ6IGRhdGVSYW5nZUZvcm1hdCQxLFxuICBhZ2VuZGFEYXRlRm9ybWF0OiAnY2NjIE1NTSBkZCcsXG4gIGFnZW5kYVRpbWVGb3JtYXQ6ICdwJyxcbiAgYWdlbmRhVGltZVJhbmdlRm9ybWF0OiB0aW1lUmFuZ2VGb3JtYXQkMVxufTtcbnZhciBkYXRlRm5zTG9jYWxpemVyID0gZnVuY3Rpb24gZGF0ZUZuc0xvY2FsaXplcihfcmVmNikge1xuICB2YXIgc3RhcnRPZldlZWsgPSBfcmVmNi5zdGFydE9mV2VlayxcbiAgICBnZXREYXkgPSBfcmVmNi5nZXREYXksXG4gICAgX2Zvcm1hdCA9IF9yZWY2LmZvcm1hdCxcbiAgICBsb2NhbGVzID0gX3JlZjYubG9jYWxlcztcbiAgcmV0dXJuIG5ldyBEYXRlTG9jYWxpemVyKHtcbiAgICBmb3JtYXRzOiBmb3JtYXRzJDEsXG4gICAgZmlyc3RPZldlZWs6IGZ1bmN0aW9uIGZpcnN0T2ZXZWVrKGN1bHR1cmUpIHtcbiAgICAgIHJldHVybiBnZXREYXkoc3RhcnRPZldlZWsobmV3IERhdGUoKSwge1xuICAgICAgICBsb2NhbGU6IGxvY2FsZXNbY3VsdHVyZV1cbiAgICAgIH0pKTtcbiAgICB9LFxuICAgIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KHZhbHVlLCBmb3JtYXRTdHJpbmcsIGN1bHR1cmUpIHtcbiAgICAgIHJldHVybiBfZm9ybWF0KG5ldyBEYXRlKHZhbHVlKSwgZm9ybWF0U3RyaW5nLCB7XG4gICAgICAgIGxvY2FsZTogbG9jYWxlc1tjdWx0dXJlXVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn07XG5cbnZhciB3ZWVrUmFuZ2VGb3JtYXQgPSBmdW5jdGlvbiB3ZWVrUmFuZ2VGb3JtYXQoX3JlZiwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZi5zdGFydCxcbiAgICBlbmQgPSBfcmVmLmVuZDtcbiAgcmV0dXJuIGxvY2FsLmZvcm1hdChzdGFydCwgJ01NTU0gREQnLCBjdWx0dXJlKSArICcg4oCTICcgK1xuICAvLyB1cGRhdGVkIHRvIHVzZSB0aGlzIGxvY2FsaXplciAnZXEoKScgbWV0aG9kXG4gIGxvY2FsLmZvcm1hdChlbmQsIGxvY2FsLmVxKHN0YXJ0LCBlbmQsICdtb250aCcpID8gJ0REJyA6ICdNTU1NIEREJywgY3VsdHVyZSk7XG59O1xudmFyIGRhdGVSYW5nZUZvcm1hdCA9IGZ1bmN0aW9uIGRhdGVSYW5nZUZvcm1hdChfcmVmMiwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZjIuc3RhcnQsXG4gICAgZW5kID0gX3JlZjIuZW5kO1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAnTCcsIGN1bHR1cmUpICsgJyDigJMgJyArIGxvY2FsLmZvcm1hdChlbmQsICdMJywgY3VsdHVyZSk7XG59O1xudmFyIHRpbWVSYW5nZUZvcm1hdCA9IGZ1bmN0aW9uIHRpbWVSYW5nZUZvcm1hdChfcmVmMywgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZjMuc3RhcnQsXG4gICAgZW5kID0gX3JlZjMuZW5kO1xuICByZXR1cm4gbG9jYWwuZm9ybWF0KHN0YXJ0LCAnTFQnLCBjdWx0dXJlKSArICcg4oCTICcgKyBsb2NhbC5mb3JtYXQoZW5kLCAnTFQnLCBjdWx0dXJlKTtcbn07XG52YXIgdGltZVJhbmdlU3RhcnRGb3JtYXQgPSBmdW5jdGlvbiB0aW1lUmFuZ2VTdGFydEZvcm1hdChfcmVmNCwgY3VsdHVyZSwgbG9jYWwpIHtcbiAgdmFyIHN0YXJ0ID0gX3JlZjQuc3RhcnQ7XG4gIHJldHVybiBsb2NhbC5mb3JtYXQoc3RhcnQsICdMVCcsIGN1bHR1cmUpICsgJyDigJMgJztcbn07XG52YXIgdGltZVJhbmdlRW5kRm9ybWF0ID0gZnVuY3Rpb24gdGltZVJhbmdlRW5kRm9ybWF0KF9yZWY1LCBjdWx0dXJlLCBsb2NhbCkge1xuICB2YXIgZW5kID0gX3JlZjUuZW5kO1xuICByZXR1cm4gJyDigJMgJyArIGxvY2FsLmZvcm1hdChlbmQsICdMVCcsIGN1bHR1cmUpO1xufTtcbnZhciBmb3JtYXRzID0ge1xuICBkYXRlRm9ybWF0OiAnREQnLFxuICBkYXlGb3JtYXQ6ICdERCBkZGQnLFxuICB3ZWVrZGF5Rm9ybWF0OiAnZGRkJyxcbiAgc2VsZWN0UmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCxcbiAgZXZlbnRUaW1lUmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdCxcbiAgZXZlbnRUaW1lUmFuZ2VTdGFydEZvcm1hdDogdGltZVJhbmdlU3RhcnRGb3JtYXQsXG4gIGV2ZW50VGltZVJhbmdlRW5kRm9ybWF0OiB0aW1lUmFuZ2VFbmRGb3JtYXQsXG4gIHRpbWVHdXR0ZXJGb3JtYXQ6ICdMVCcsXG4gIG1vbnRoSGVhZGVyRm9ybWF0OiAnTU1NTSBZWVlZJyxcbiAgZGF5SGVhZGVyRm9ybWF0OiAnZGRkZCBNTU0gREQnLFxuICBkYXlSYW5nZUhlYWRlckZvcm1hdDogd2Vla1JhbmdlRm9ybWF0LFxuICBhZ2VuZGFIZWFkZXJGb3JtYXQ6IGRhdGVSYW5nZUZvcm1hdCxcbiAgYWdlbmRhRGF0ZUZvcm1hdDogJ2RkZCBNTU0gREQnLFxuICBhZ2VuZGFUaW1lRm9ybWF0OiAnTFQnLFxuICBhZ2VuZGFUaW1lUmFuZ2VGb3JtYXQ6IHRpbWVSYW5nZUZvcm1hdFxufTtcbmZ1bmN0aW9uIGZpeFVuaXQodW5pdCkge1xuICB2YXIgZGF0ZVBhcnQgPSB1bml0ID8gdW5pdC50b0xvd2VyQ2FzZSgpIDogdW5pdDtcbiAgaWYgKGRhdGVQYXJ0ID09PSAnRnVsbFllYXInKSB7XG4gICAgZGF0ZVBhcnQgPSAneWVhcic7XG4gIH0gZWxzZSBpZiAoIWRhdGVQYXJ0KSB7XG4gICAgZGF0ZVBhcnQgPSB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIGRhdGVQYXJ0O1xufVxuZnVuY3Rpb24gZGF5anMgKGRheWpzTGliKSB7XG4gIC8vIGxvYWQgZGF5anMgcGx1Z2luc1xuICBkYXlqc0xpYi5leHRlbmQoaXNCZXR3ZWVuKTtcbiAgZGF5anNMaWIuZXh0ZW5kKGlzU2FtZU9yQWZ0ZXIpO1xuICBkYXlqc0xpYi5leHRlbmQoaXNTYW1lT3JCZWZvcmUpO1xuICBkYXlqc0xpYi5leHRlbmQobG9jYWxlRGF0YSk7XG4gIGRheWpzTGliLmV4dGVuZChsb2NhbGl6ZWRGb3JtYXQpO1xuICBkYXlqc0xpYi5leHRlbmQobWluTWF4KTtcbiAgZGF5anNMaWIuZXh0ZW5kKHV0Yyk7XG4gIHZhciBsb2NhbGUgPSBmdW5jdGlvbiBsb2NhbGUoZGosIGMpIHtcbiAgICByZXR1cm4gYyA/IGRqLmxvY2FsZShjKSA6IGRqO1xuICB9O1xuXG4gIC8vIGlmIHRoZSB0aW1lem9uZSBwbHVnaW4gaXMgbG9hZGVkLFxuICAvLyB0aGVuIHVzZSB0aGUgdGltZXpvbmUgYXdhcmUgdmVyc2lvblxuICB2YXIgZGF5anMgPSBkYXlqc0xpYi50eiA/IGRheWpzTGliLnR6IDogZGF5anNMaWI7XG4gIGZ1bmN0aW9uIGdldFRpbWV6b25lT2Zmc2V0KGRhdGUpIHtcbiAgICAvLyBlbnN1cmVzIHRoaXMgZ2V0cyBjYXN0IHRvIHRpbWV6b25lXG4gICAgcmV0dXJuIGRheWpzKGRhdGUpLnRvRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0RHN0T2Zmc2V0KHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgX3N0JHR6JCR4JCR0aW1lem9uZTtcbiAgICAvLyBjb252ZXJ0IHRvIGRheWpzLCBpbiBjYXNlXG4gICAgdmFyIHN0ID0gZGF5anMoc3RhcnQpO1xuICAgIHZhciBlZCA9IGRheWpzKGVuZCk7XG4gICAgLy8gaWYgbm90IHVzaW5nIHRoZSBkYXlqcyB0aW1lem9uZSBwbHVnaW5cbiAgICBpZiAoIWRheWpzLnR6KSB7XG4gICAgICByZXR1cm4gc3QudG9EYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKSAtIGVkLnRvRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIGEgZGVmYXVsdCB0aW1lem9uZSBoYXMgYmVlbiBhcHBsaWVkLCB0aGVuXG4gICAgICogdXNlIHRoaXMgdG8gZ2V0IHRoZSBwcm9wZXIgdGltZXpvbmUgb2Zmc2V0LCBvdGhlcndpc2UgZGVmYXVsdFxuICAgICAqIHRoZSB0aW1lem9uZSB0byB0aGUgYnJvd3NlciBsb2NhbFxuICAgICAqL1xuICAgIHZhciB0ek5hbWUgPSAoX3N0JHR6JCR4JCR0aW1lem9uZSA9IHN0LnR6KCkuJHguJHRpbWV6b25lKSAhPT0gbnVsbCAmJiBfc3QkdHokJHgkJHRpbWV6b25lICE9PSB2b2lkIDAgPyBfc3QkdHokJHgkJHRpbWV6b25lIDogZGF5anNMaWIudHouZ3Vlc3MoKTtcbiAgICAvLyBpbnZlcnQgb2Zmc2V0cyB0byBiZSBpbmxpbmUgd2l0aCBtb21lbnQuanNcbiAgICB2YXIgc3RhcnRPZmZzZXQgPSAtZGF5anMudHooK3N0LCB0ek5hbWUpLnV0Y09mZnNldCgpO1xuICAgIHZhciBlbmRPZmZzZXQgPSAtZGF5anMudHooK2VkLCB0ek5hbWUpLnV0Y09mZnNldCgpO1xuICAgIHJldHVybiBzdGFydE9mZnNldCAtIGVuZE9mZnNldDtcbiAgfVxuICBmdW5jdGlvbiBnZXREYXlTdGFydERzdE9mZnNldChzdGFydCkge1xuICAgIHZhciBkYXlTdGFydCA9IGRheWpzKHN0YXJ0KS5zdGFydE9mKCdkYXknKTtcbiAgICByZXR1cm4gZ2V0RHN0T2Zmc2V0KGRheVN0YXJ0LCBzdGFydCk7XG4gIH1cblxuICAvKioqIEJFR0lOIGxvY2FsaXplZCBkYXRlIGFyaXRobWV0aWMgbWV0aG9kcyB3aXRoIGRheWpzICoqKi9cbiAgZnVuY3Rpb24gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCkge1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQodW5pdCk7XG4gICAgdmFyIGR0QSA9IGRhdGVQYXJ0ID8gZGF5anMoYSkuc3RhcnRPZihkYXRlUGFydCkgOiBkYXlqcyhhKTtcbiAgICB2YXIgZHRCID0gZGF0ZVBhcnQgPyBkYXlqcyhiKS5zdGFydE9mKGRhdGVQYXJ0KSA6IGRheWpzKGIpO1xuICAgIHJldHVybiBbZHRBLCBkdEIsIGRhdGVQYXJ0XTtcbiAgfVxuICBmdW5jdGlvbiBzdGFydE9mKCkge1xuICAgIHZhciBkYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCh1bml0KTtcbiAgICBpZiAoZGF0ZVBhcnQpIHtcbiAgICAgIHJldHVybiBkYXlqcyhkYXRlKS5zdGFydE9mKGRhdGVQYXJ0KS50b0RhdGUoKTtcbiAgICB9XG4gICAgcmV0dXJuIGRheWpzKGRhdGUpLnRvRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIGVuZE9mKCkge1xuICAgIHZhciBkYXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCh1bml0KTtcbiAgICBpZiAoZGF0ZVBhcnQpIHtcbiAgICAgIHJldHVybiBkYXlqcyhkYXRlKS5lbmRPZihkYXRlUGFydCkudG9EYXRlKCk7XG4gICAgfVxuICAgIHJldHVybiBkYXlqcyhkYXRlKS50b0RhdGUoKTtcbiAgfVxuXG4gIC8vIGRheWpzIGNvbXBhcmlzb24gb3BlcmF0aW9ucyAqYWx3YXlzKiBjb252ZXJ0IGJvdGggc2lkZXMgdG8gZGF5anMgb2JqZWN0c1xuICAvLyBwcmlvciB0byBydW5uaW5nIHRoZSBjb21wYXJpc29uc1xuICBmdW5jdGlvbiBlcShhLCBiLCB1bml0KSB7XG4gICAgdmFyIF9kZWZpbmVDb21wYXJhdG9ycyA9IGRlZmluZUNvbXBhcmF0b3JzKGEsIGIsIHVuaXQpLFxuICAgICAgX2RlZmluZUNvbXBhcmF0b3JzMiA9IF9zbGljZWRUb0FycmF5KF9kZWZpbmVDb21wYXJhdG9ycywgMyksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnMyWzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzMlsxXSxcbiAgICAgIGRhdGVQYXJ0ID0gX2RlZmluZUNvbXBhcmF0b3JzMlsyXTtcbiAgICByZXR1cm4gZHRBLmlzU2FtZShkdEIsIGRhdGVQYXJ0KTtcbiAgfVxuICBmdW5jdGlvbiBuZXEoYSwgYiwgdW5pdCkge1xuICAgIHJldHVybiAhZXEoYSwgYiwgdW5pdCk7XG4gIH1cbiAgZnVuY3Rpb24gZ3QoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnMzID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnM0ID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzMywgMyksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnM0WzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzNFsxXSxcbiAgICAgIGRhdGVQYXJ0ID0gX2RlZmluZUNvbXBhcmF0b3JzNFsyXTtcbiAgICByZXR1cm4gZHRBLmlzQWZ0ZXIoZHRCLCBkYXRlUGFydCk7XG4gIH1cbiAgZnVuY3Rpb24gbHQoYSwgYiwgdW5pdCkge1xuICAgIHZhciBfZGVmaW5lQ29tcGFyYXRvcnM1ID0gZGVmaW5lQ29tcGFyYXRvcnMoYSwgYiwgdW5pdCksXG4gICAgICBfZGVmaW5lQ29tcGFyYXRvcnM2ID0gX3NsaWNlZFRvQXJyYXkoX2RlZmluZUNvbXBhcmF0b3JzNSwgMyksXG4gICAgICBkdEEgPSBfZGVmaW5lQ29tcGFyYXRvcnM2WzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzNlsxXSxcbiAgICAgIGRhdGVQYXJ0ID0gX2RlZmluZUNvbXBhcmF0b3JzNlsyXTtcbiAgICByZXR1cm4gZHRBLmlzQmVmb3JlKGR0QiwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIGd0ZShhLCBiLCB1bml0KSB7XG4gICAgdmFyIF9kZWZpbmVDb21wYXJhdG9yczcgPSBkZWZpbmVDb21wYXJhdG9ycyhhLCBiLCB1bml0KSxcbiAgICAgIF9kZWZpbmVDb21wYXJhdG9yczggPSBfc2xpY2VkVG9BcnJheShfZGVmaW5lQ29tcGFyYXRvcnM3LCAzKSxcbiAgICAgIGR0QSA9IF9kZWZpbmVDb21wYXJhdG9yczhbMF0sXG4gICAgICBkdEIgPSBfZGVmaW5lQ29tcGFyYXRvcnM4WzFdLFxuICAgICAgZGF0ZVBhcnQgPSBfZGVmaW5lQ29tcGFyYXRvcnM4WzJdO1xuICAgIHJldHVybiBkdEEuaXNTYW1lT3JCZWZvcmUoZHRCLCBkYXRlUGFydCk7XG4gIH1cbiAgZnVuY3Rpb24gbHRlKGEsIGIsIHVuaXQpIHtcbiAgICB2YXIgX2RlZmluZUNvbXBhcmF0b3JzOSA9IGRlZmluZUNvbXBhcmF0b3JzKGEsIGIsIHVuaXQpLFxuICAgICAgX2RlZmluZUNvbXBhcmF0b3JzMTAgPSBfc2xpY2VkVG9BcnJheShfZGVmaW5lQ29tcGFyYXRvcnM5LCAzKSxcbiAgICAgIGR0QSA9IF9kZWZpbmVDb21wYXJhdG9yczEwWzBdLFxuICAgICAgZHRCID0gX2RlZmluZUNvbXBhcmF0b3JzMTBbMV0sXG4gICAgICBkYXRlUGFydCA9IF9kZWZpbmVDb21wYXJhdG9yczEwWzJdO1xuICAgIHJldHVybiBkdEEuaXNTYW1lT3JCZWZvcmUoZHRCLCBkYXRlUGFydCk7XG4gIH1cbiAgZnVuY3Rpb24gaW5SYW5nZShkYXksIG1pbiwgbWF4KSB7XG4gICAgdmFyIHVuaXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6ICdkYXknO1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQodW5pdCk7XG4gICAgdmFyIGRqRGF5ID0gZGF5anMoZGF5KTtcbiAgICB2YXIgZGpNaW4gPSBkYXlqcyhtaW4pO1xuICAgIHZhciBkak1heCA9IGRheWpzKG1heCk7XG4gICAgcmV0dXJuIGRqRGF5LmlzQmV0d2Vlbihkak1pbiwgZGpNYXgsIGRhdGVQYXJ0LCAnW10nKTtcbiAgfVxuICBmdW5jdGlvbiBtaW4oZGF0ZUEsIGRhdGVCKSB7XG4gICAgdmFyIGR0QSA9IGRheWpzKGRhdGVBKTtcbiAgICB2YXIgZHRCID0gZGF5anMoZGF0ZUIpO1xuICAgIHZhciBtaW5EdCA9IGRheWpzTGliLm1pbihkdEEsIGR0Qik7XG4gICAgcmV0dXJuIG1pbkR0LnRvRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIG1heChkYXRlQSwgZGF0ZUIpIHtcbiAgICB2YXIgZHRBID0gZGF5anMoZGF0ZUEpO1xuICAgIHZhciBkdEIgPSBkYXlqcyhkYXRlQik7XG4gICAgdmFyIG1heER0ID0gZGF5anNMaWIubWF4KGR0QSwgZHRCKTtcbiAgICByZXR1cm4gbWF4RHQudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gbWVyZ2UoZGF0ZSwgdGltZSkge1xuICAgIGlmICghZGF0ZSAmJiAhdGltZSkgcmV0dXJuIG51bGw7XG4gICAgdmFyIHRtID0gZGF5anModGltZSkuZm9ybWF0KCdISDptbTpzcycpO1xuICAgIHZhciBkdCA9IGRheWpzKGRhdGUpLnN0YXJ0T2YoJ2RheScpLmZvcm1hdCgnTU0vREQvWVlZWScpO1xuICAgIC8vIFdlIGRvIGl0IHRoaXMgd2F5IHRvIGF2b2lkIGlzc3VlcyB3aGVuIHRpbWV6b25lIHN3aXRjaGluZ1xuICAgIHJldHVybiBkYXlqc0xpYihcIlwiLmNvbmNhdChkdCwgXCIgXCIpLmNvbmNhdCh0bSksICdNTS9ERC9ZWVlZIEhIOm1tOnNzJykudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gYWRkKGRhdGUsIGFkZGVyLCB1bml0KSB7XG4gICAgdmFyIGRhdGVQYXJ0ID0gZml4VW5pdCh1bml0KTtcbiAgICByZXR1cm4gZGF5anMoZGF0ZSkuYWRkKGFkZGVyLCBkYXRlUGFydCkudG9EYXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gcmFuZ2Uoc3RhcnQsIGVuZCkge1xuICAgIHZhciB1bml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAnZGF5JztcbiAgICB2YXIgZGF0ZVBhcnQgPSBmaXhVbml0KHVuaXQpO1xuICAgIC8vIGJlY2F1c2UgdGhlIGFkZCBtZXRob2Qgd2lsbCBwdXQgdGhlc2UgaW4gdHosIHdlIGhhdmUgdG8gc3RhcnQgdGhhdCB3YXlcbiAgICB2YXIgY3VycmVudCA9IGRheWpzKHN0YXJ0KS50b0RhdGUoKTtcbiAgICB2YXIgZGF5cyA9IFtdO1xuICAgIHdoaWxlIChsdGUoY3VycmVudCwgZW5kKSkge1xuICAgICAgZGF5cy5wdXNoKGN1cnJlbnQpO1xuICAgICAgY3VycmVudCA9IGFkZChjdXJyZW50LCAxLCBkYXRlUGFydCk7XG4gICAgfVxuICAgIHJldHVybiBkYXlzO1xuICB9XG4gIGZ1bmN0aW9uIGNlaWwoZGF0ZSwgdW5pdCkge1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQodW5pdCk7XG4gICAgdmFyIGZsb29yID0gc3RhcnRPZihkYXRlLCBkYXRlUGFydCk7XG4gICAgcmV0dXJuIGVxKGZsb29yLCBkYXRlKSA/IGZsb29yIDogYWRkKGZsb29yLCAxLCBkYXRlUGFydCk7XG4gIH1cbiAgZnVuY3Rpb24gZGlmZihhLCBiKSB7XG4gICAgdmFyIHVuaXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6ICdkYXknO1xuICAgIHZhciBkYXRlUGFydCA9IGZpeFVuaXQodW5pdCk7XG4gICAgLy8gZG9uJ3QgdXNlICdkZWZpbmVDb21wYXJhdG9ycycgaGVyZSwgYXMgd2UgZG9uJ3Qgd2FudCB0byBtdXRhdGUgdGhlIHZhbHVlc1xuICAgIHZhciBkdEEgPSBkYXlqcyhhKTtcbiAgICB2YXIgZHRCID0gZGF5anMoYik7XG4gICAgcmV0dXJuIGR0Qi5kaWZmKGR0QSwgZGF0ZVBhcnQpO1xuICB9XG4gIGZ1bmN0aW9uIG1pbnV0ZXMoZGF0ZSkge1xuICAgIHZhciBkdCA9IGRheWpzKGRhdGUpO1xuICAgIHJldHVybiBkdC5taW51dGVzKCk7XG4gIH1cbiAgZnVuY3Rpb24gZmlyc3RPZldlZWsoY3VsdHVyZSkge1xuICAgIHZhciBkYXRhID0gY3VsdHVyZSA/IGRheWpzTGliLmxvY2FsZURhdGEoY3VsdHVyZSkgOiBkYXlqc0xpYi5sb2NhbGVEYXRhKCk7XG4gICAgcmV0dXJuIGRhdGEgPyBkYXRhLmZpcnN0RGF5T2ZXZWVrKCkgOiAwO1xuICB9XG4gIGZ1bmN0aW9uIGZpcnN0VmlzaWJsZURheShkYXRlKSB7XG4gICAgcmV0dXJuIGRheWpzKGRhdGUpLnN0YXJ0T2YoJ21vbnRoJykuc3RhcnRPZignd2VlaycpLnRvRGF0ZSgpO1xuICB9XG4gIGZ1bmN0aW9uIGxhc3RWaXNpYmxlRGF5KGRhdGUpIHtcbiAgICByZXR1cm4gZGF5anMoZGF0ZSkuZW5kT2YoJ21vbnRoJykuZW5kT2YoJ3dlZWsnKS50b0RhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiB2aXNpYmxlRGF5cyhkYXRlKSB7XG4gICAgdmFyIGN1cnJlbnQgPSBmaXJzdFZpc2libGVEYXkoZGF0ZSk7XG4gICAgdmFyIGxhc3QgPSBsYXN0VmlzaWJsZURheShkYXRlKTtcbiAgICB2YXIgZGF5cyA9IFtdO1xuICAgIHdoaWxlIChsdGUoY3VycmVudCwgbGFzdCkpIHtcbiAgICAgIGRheXMucHVzaChjdXJyZW50KTtcbiAgICAgIGN1cnJlbnQgPSBhZGQoY3VycmVudCwgMSwgJ2QnKTtcbiAgICB9XG4gICAgcmV0dXJuIGRheXM7XG4gIH1cbiAgLyoqKiBFTkQgbG9jYWxpemVkIGRhdGUgYXJpdGhtZXRpYyBtZXRob2RzIHdpdGggZGF5anMgKioqL1xuXG4gIC8qKlxuICAgKiBNb3ZlZCBmcm9tIFRpbWVTbG90cy5qcywgdGhpcyBtZXRob2Qgb3ZlcnJpZGVzIHRoZSBtZXRob2Qgb2YgdGhlIHNhbWUgbmFtZVxuICAgKiBpbiB0aGUgbG9jYWxpemVyLmpzLCB1c2luZyBkYXlqcyB0byBjb25zdHJ1Y3QgdGhlIGpzIERhdGVcbiAgICogQHBhcmFtIHtEYXRlfSBkdCAtIGRhdGUgdG8gc3RhcnQgd2l0aFxuICAgKiBAcGFyYW0ge051bWJlcn0gbWludXRlc0Zyb21NaWRuaWdodFxuICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0XG4gICAqIEByZXR1cm5zIHtEYXRlfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0U2xvdERhdGUoZHQsIG1pbnV0ZXNGcm9tTWlkbmlnaHQsIG9mZnNldCkge1xuICAgIHJldHVybiBkYXlqcyhkdCkuc3RhcnRPZignZGF5JykubWludXRlKG1pbnV0ZXNGcm9tTWlkbmlnaHQgKyBvZmZzZXQpLnRvRGF0ZSgpO1xuICB9XG5cbiAgLy8gZGF5anMgd2lsbCBhdXRvbWF0aWNhbGx5IGhhbmRsZSBEU1QgZGlmZmVyZW5jZXMgaW4gaXQncyBjYWxjdWxhdGlvbnNcbiAgZnVuY3Rpb24gZ2V0VG90YWxNaW4oc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBkaWZmKHN0YXJ0LCBlbmQsICdtaW51dGVzJyk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0TWludXRlc0Zyb21NaWRuaWdodChzdGFydCkge1xuICAgIHZhciBkYXlTdGFydCA9IGRheWpzKHN0YXJ0KS5zdGFydE9mKCdkYXknKTtcbiAgICB2YXIgZGF5ID0gZGF5anMoc3RhcnQpO1xuICAgIHJldHVybiBkYXkuZGlmZihkYXlTdGFydCwgJ21pbnV0ZXMnKSArIGdldERheVN0YXJ0RHN0T2Zmc2V0KHN0YXJ0KTtcbiAgfVxuXG4gIC8vIFRoZXNlIHR3byBhcmUgdXNlZCBieSBEYXRlU2xvdE1ldHJpY3NcbiAgZnVuY3Rpb24gY29udGludWVzUHJpb3Ioc3RhcnQsIGZpcnN0KSB7XG4gICAgdmFyIGRqU3RhcnQgPSBkYXlqcyhzdGFydCk7XG4gICAgdmFyIGRqRmlyc3QgPSBkYXlqcyhmaXJzdCk7XG4gICAgcmV0dXJuIGRqU3RhcnQuaXNCZWZvcmUoZGpGaXJzdCwgJ2RheScpO1xuICB9XG4gIGZ1bmN0aW9uIGNvbnRpbnVlc0FmdGVyKHN0YXJ0LCBlbmQsIGxhc3QpIHtcbiAgICB2YXIgZGpFbmQgPSBkYXlqcyhlbmQpO1xuICAgIHZhciBkakxhc3QgPSBkYXlqcyhsYXN0KTtcbiAgICByZXR1cm4gZGpFbmQuaXNTYW1lT3JBZnRlcihkakxhc3QsICdtaW51dGVzJyk7XG4gIH1cbiAgZnVuY3Rpb24gZGF5U3BhbihzdGFydCwgZW5kKSB7XG4gICAgdmFyIHN0YXJ0RGF5ID0gZGF5anMoc3RhcnQpO1xuICAgIHZhciBlbmREYXkgPSBkYXlqcyhlbmQpO1xuICAgIHJldHVybiBlbmREYXkuZGlmZihzdGFydERheSwgJ2RheScpO1xuICB9XG5cbiAgLy8gVGhlc2UgdHdvIGFyZSB1c2VkIGJ5IGV2ZW50TGV2ZWxzXG4gIGZ1bmN0aW9uIHNvcnRFdmVudHMoX3JlZjYpIHtcbiAgICB2YXIgX3JlZjYkZXZ0QSA9IF9yZWY2LmV2dEEsXG4gICAgICBhU3RhcnQgPSBfcmVmNiRldnRBLnN0YXJ0LFxuICAgICAgYUVuZCA9IF9yZWY2JGV2dEEuZW5kLFxuICAgICAgYUFsbERheSA9IF9yZWY2JGV2dEEuYWxsRGF5LFxuICAgICAgX3JlZjYkZXZ0QiA9IF9yZWY2LmV2dEIsXG4gICAgICBiU3RhcnQgPSBfcmVmNiRldnRCLnN0YXJ0LFxuICAgICAgYkVuZCA9IF9yZWY2JGV2dEIuZW5kLFxuICAgICAgYkFsbERheSA9IF9yZWY2JGV2dEIuYWxsRGF5O1xuICAgIHZhciBzdGFydFNvcnQgPSArc3RhcnRPZihhU3RhcnQsICdkYXknKSAtICtzdGFydE9mKGJTdGFydCwgJ2RheScpO1xuICAgIHZhciBkdXJBID0gZGF5U3BhbihhU3RhcnQsIGFFbmQpO1xuICAgIHZhciBkdXJCID0gZGF5U3BhbihiU3RhcnQsIGJFbmQpO1xuICAgIHJldHVybiBzdGFydFNvcnQgfHxcbiAgICAvLyBzb3J0IGJ5IHN0YXJ0IERheSBmaXJzdFxuICAgIGR1ckIgLSBkdXJBIHx8XG4gICAgLy8gZXZlbnRzIHNwYW5uaW5nIG11bHRpcGxlIGRheXMgZ28gZmlyc3RcbiAgICAhIWJBbGxEYXkgLSAhIWFBbGxEYXkgfHxcbiAgICAvLyB0aGVuIGFsbERheSBzaW5nbGUgZGF5IGV2ZW50c1xuICAgICthU3RhcnQgLSArYlN0YXJ0IHx8XG4gICAgLy8gdGhlbiBzb3J0IGJ5IHN0YXJ0IHRpbWUgKmRvbid0IG5lZWQgZGF5anMgY29udmVyc2lvbiBoZXJlXG4gICAgK2FFbmQgLSArYkVuZCAvLyB0aGVuIHNvcnQgYnkgZW5kIHRpbWUgKmRvbid0IG5lZWQgZGF5anMgY29udmVyc2lvbiBoZXJlIGVpdGhlclxuICAgIDtcbiAgfVxuICBmdW5jdGlvbiBpbkV2ZW50UmFuZ2UoX3JlZjcpIHtcbiAgICB2YXIgX3JlZjckZXZlbnQgPSBfcmVmNy5ldmVudCxcbiAgICAgIHN0YXJ0ID0gX3JlZjckZXZlbnQuc3RhcnQsXG4gICAgICBlbmQgPSBfcmVmNyRldmVudC5lbmQsXG4gICAgICBfcmVmNyRyYW5nZSA9IF9yZWY3LnJhbmdlLFxuICAgICAgcmFuZ2VTdGFydCA9IF9yZWY3JHJhbmdlLnN0YXJ0LFxuICAgICAgcmFuZ2VFbmQgPSBfcmVmNyRyYW5nZS5lbmQ7XG4gICAgdmFyIHN0YXJ0T2ZEYXkgPSBkYXlqcyhzdGFydCkuc3RhcnRPZignZGF5Jyk7XG4gICAgdmFyIGVFbmQgPSBkYXlqcyhlbmQpO1xuICAgIHZhciByU3RhcnQgPSBkYXlqcyhyYW5nZVN0YXJ0KTtcbiAgICB2YXIgckVuZCA9IGRheWpzKHJhbmdlRW5kKTtcbiAgICB2YXIgc3RhcnRzQmVmb3JlRW5kID0gc3RhcnRPZkRheS5pc1NhbWVPckJlZm9yZShyRW5kLCAnZGF5Jyk7XG4gICAgLy8gd2hlbiB0aGUgZXZlbnQgaXMgemVybyBkdXJhdGlvbiB3ZSBuZWVkIHRvIGhhbmRsZSBhIGJpdCBkaWZmZXJlbnRseVxuICAgIHZhciBzYW1lTWluID0gIXN0YXJ0T2ZEYXkuaXNTYW1lKGVFbmQsICdtaW51dGVzJyk7XG4gICAgdmFyIGVuZHNBZnRlclN0YXJ0ID0gc2FtZU1pbiA/IGVFbmQuaXNBZnRlcihyU3RhcnQsICdtaW51dGVzJykgOiBlRW5kLmlzU2FtZU9yQWZ0ZXIoclN0YXJ0LCAnbWludXRlcycpO1xuICAgIHJldHVybiBzdGFydHNCZWZvcmVFbmQgJiYgZW5kc0FmdGVyU3RhcnQ7XG4gIH1cbiAgZnVuY3Rpb24gaXNTYW1lRGF0ZShkYXRlMSwgZGF0ZTIpIHtcbiAgICB2YXIgZHQgPSBkYXlqcyhkYXRlMSk7XG4gICAgdmFyIGR0MiA9IGRheWpzKGRhdGUyKTtcbiAgICByZXR1cm4gZHQuaXNTYW1lKGR0MiwgJ2RheScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kLCBjYWxsZWQgb25jZSBpbiB0aGUgbG9jYWxpemVyIGNvbnN0cnVjdG9yLCBpcyB1c2VkIGJ5IGV2ZW50TGV2ZWxzXG4gICAqICdldmVudFNlZ21lbnRzKCknIHRvIGFzc2lzdCBpbiBkZXRlcm1pbmluZyB0aGUgJ3NwYW4nIG9mIHRoZSBldmVudCBpbiB0aGUgZGlzcGxheSxcbiAgICogc3BlY2lmaWNhbGx5IHdoZW4gdXNpbmcgYSB0aW1lem9uZSB0aGF0IGlzIGdyZWF0ZXIgdGhhbiB0aGUgYnJvd3NlciBuYXRpdmUgdGltZXpvbmUuXG4gICAqIEByZXR1cm5zIG51bWJlclxuICAgKi9cbiAgZnVuY3Rpb24gYnJvd3NlclRaT2Zmc2V0KCkge1xuICAgIC8qKlxuICAgICAqIERhdGUucHJvdG90eXBlLmdldFRpbWV6b25lT2Zmc2V0IGhvcnJpZmljYWxseSBmbGlwcyB0aGUgcG9zaXRpdmUvbmVnYXRpdmUgZnJvbVxuICAgICAqIHdoYXQgeW91IHNlZSBpbiBpdCdzIHN0cmluZywgc28gd2UgaGF2ZSB0byBqdW1wIHRocm91Z2ggc29tZSBob29wcyB0byBnZXQgYSB2YWx1ZVxuICAgICAqIHdlIGNhbiBhY3R1YWxseSBjb21wYXJlLlxuICAgICAqL1xuICAgIHZhciBkdCA9IG5ldyBEYXRlKCk7XG4gICAgdmFyIG5lZyA9IC8tLy50ZXN0KGR0LnRvU3RyaW5nKCkpID8gJy0nIDogJyc7XG4gICAgdmFyIGR0T2Zmc2V0ID0gZHQuZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgICB2YXIgY29tcGFyYXRvciA9IE51bWJlcihcIlwiLmNvbmNhdChuZWcpLmNvbmNhdChNYXRoLmFicyhkdE9mZnNldCkpKTtcbiAgICAvLyBkYXlqcyBjb3JyZWN0bHkgcHJvdmlkZXMgcG9zaXRpdmUvbmVnYXRpdmUgb2Zmc2V0LCBhcyBleHBlY3RlZFxuICAgIHZhciBtdE9mZnNldCA9IGRheWpzKCkudXRjT2Zmc2V0KCk7XG4gICAgcmV0dXJuIG10T2Zmc2V0ID4gY29tcGFyYXRvciA/IDEgOiAwO1xuICB9XG4gIHJldHVybiBuZXcgRGF0ZUxvY2FsaXplcih7XG4gICAgZm9ybWF0czogZm9ybWF0cyxcbiAgICBmaXJzdE9mV2VlazogZmlyc3RPZldlZWssXG4gICAgZmlyc3RWaXNpYmxlRGF5OiBmaXJzdFZpc2libGVEYXksXG4gICAgbGFzdFZpc2libGVEYXk6IGxhc3RWaXNpYmxlRGF5LFxuICAgIHZpc2libGVEYXlzOiB2aXNpYmxlRGF5cyxcbiAgICBmb3JtYXQ6IGZ1bmN0aW9uIGZvcm1hdCh2YWx1ZSwgX2Zvcm1hdCwgY3VsdHVyZSkge1xuICAgICAgcmV0dXJuIGxvY2FsZShkYXlqcyh2YWx1ZSksIGN1bHR1cmUpLmZvcm1hdChfZm9ybWF0KTtcbiAgICB9LFxuICAgIGx0OiBsdCxcbiAgICBsdGU6IGx0ZSxcbiAgICBndDogZ3QsXG4gICAgZ3RlOiBndGUsXG4gICAgZXE6IGVxLFxuICAgIG5lcTogbmVxLFxuICAgIG1lcmdlOiBtZXJnZSxcbiAgICBpblJhbmdlOiBpblJhbmdlLFxuICAgIHN0YXJ0T2Y6IHN0YXJ0T2YsXG4gICAgZW5kT2Y6IGVuZE9mLFxuICAgIHJhbmdlOiByYW5nZSxcbiAgICBhZGQ6IGFkZCxcbiAgICBkaWZmOiBkaWZmLFxuICAgIGNlaWw6IGNlaWwsXG4gICAgbWluOiBtaW4sXG4gICAgbWF4OiBtYXgsXG4gICAgbWludXRlczogbWludXRlcyxcbiAgICBnZXRTbG90RGF0ZTogZ2V0U2xvdERhdGUsXG4gICAgZ2V0VGltZXpvbmVPZmZzZXQ6IGdldFRpbWV6b25lT2Zmc2V0LFxuICAgIGdldERzdE9mZnNldDogZ2V0RHN0T2Zmc2V0LFxuICAgIGdldFRvdGFsTWluOiBnZXRUb3RhbE1pbixcbiAgICBnZXRNaW51dGVzRnJvbU1pZG5pZ2h0OiBnZXRNaW51dGVzRnJvbU1pZG5pZ2h0LFxuICAgIGNvbnRpbnVlc1ByaW9yOiBjb250aW51ZXNQcmlvcixcbiAgICBjb250aW51ZXNBZnRlcjogY29udGludWVzQWZ0ZXIsXG4gICAgc29ydEV2ZW50czogc29ydEV2ZW50cyxcbiAgICBpbkV2ZW50UmFuZ2U6IGluRXZlbnRSYW5nZSxcbiAgICBpc1NhbWVEYXRlOiBpc1NhbWVEYXRlLFxuICAgIGJyb3dzZXJUWk9mZnNldDogYnJvd3NlclRaT2Zmc2V0XG4gIH0pO1xufVxuXG52YXIgY29tcG9uZW50cyA9IHtcbiAgZXZlbnRXcmFwcGVyOiBOb29wV3JhcHBlcixcbiAgdGltZVNsb3RXcmFwcGVyOiBOb29wV3JhcHBlcixcbiAgZGF0ZUNlbGxXcmFwcGVyOiBOb29wV3JhcHBlclxufTtcblxuZXhwb3J0IHsgQ2FsZW5kYXIkMSBhcyBDYWxlbmRhciwgRGF0ZUxvY2FsaXplciwgbmF2aWdhdGUgYXMgTmF2aWdhdGUsIHZpZXdzIGFzIFZpZXdzLCBjb21wb25lbnRzLCBkYXRlRm5zTG9jYWxpemVyLCBkYXlqcyBhcyBkYXlqc0xvY2FsaXplciwgZ2xvYmFsaXplIGFzIGdsb2JhbGl6ZUxvY2FsaXplciwgbHV4b24gYXMgbHV4b25Mb2NhbGl6ZXIsIG1vbWVudCBhcyBtb21lbnRMb2NhbGl6ZXIsIG1vdmVEYXRlIGFzIG1vdmUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/react-big-calendar/dist/react-big-calendar.esm.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/react-big-calendar/lib/css/react-big-calendar.css":
/*!************************************************************************!*\
  !*** ./node_modules/react-big-calendar/lib/css/react-big-calendar.css ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"fd23c40328c1\");\nif (false) {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcmVhY3QtYmlnLWNhbGVuZGFyL2xpYi9jc3MvcmVhY3QtYmlnLWNhbGVuZGFyLmNzcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsY0FBYztBQUM3QixJQUFJLEtBQVUsRUFBRSxFQUF1QiIsInNvdXJjZXMiOlsiL1VzZXJzL2phc29ua2ltL0Rlc2t0b3AvU3luYXBzZSBEYXNoYm9hcmQvbm9kZV9tb2R1bGVzL3JlYWN0LWJpZy1jYWxlbmRhci9saWIvY3NzL3JlYWN0LWJpZy1jYWxlbmRhci5jc3MiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgXCJmZDIzYzQwMzI4YzFcIlxuaWYgKG1vZHVsZS5ob3QpIHsgbW9kdWxlLmhvdC5hY2NlcHQoKSB9XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/react-big-calendar/lib/css/react-big-calendar.css\n");

/***/ }),

/***/ "(ssr)/./node_modules/react-big-calendar/node_modules/clsx/dist/clsx.m.js":
/*!**************************************************************************!*\
  !*** ./node_modules/react-big-calendar/node_modules/clsx/dist/clsx.m.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clsx: () => (/* binding */ clsx),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f);else for(t in e)e[t]&&(n&&(n+=\" \"),n+=t);return n}function clsx(){for(var e,t,f=0,n=\"\";f<arguments.length;)(e=arguments[f++])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clsx);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvcmVhY3QtYmlnLWNhbGVuZGFyL25vZGVfbW9kdWxlcy9jbHN4L2Rpc3QvY2xzeC5tLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsY0FBYyxhQUFhLCtDQUErQyx1REFBdUQsV0FBVywwQ0FBMEMseUNBQXlDLFNBQWdCLGdCQUFnQixxQkFBcUIsbUJBQW1CLGtEQUFrRCxTQUFTLGlFQUFlLElBQUkiLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXNvbmtpbS9EZXNrdG9wL1N5bmFwc2UgRGFzaGJvYXJkL25vZGVfbW9kdWxlcy9yZWFjdC1iaWctY2FsZW5kYXIvbm9kZV9tb2R1bGVzL2Nsc3gvZGlzdC9jbHN4Lm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcihlKXt2YXIgdCxmLG49XCJcIjtpZihcInN0cmluZ1wiPT10eXBlb2YgZXx8XCJudW1iZXJcIj09dHlwZW9mIGUpbis9ZTtlbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBlKWlmKEFycmF5LmlzQXJyYXkoZSkpZm9yKHQ9MDt0PGUubGVuZ3RoO3QrKyllW3RdJiYoZj1yKGVbdF0pKSYmKG4mJihuKz1cIiBcIiksbis9Zik7ZWxzZSBmb3IodCBpbiBlKWVbdF0mJihuJiYobis9XCIgXCIpLG4rPXQpO3JldHVybiBufWV4cG9ydCBmdW5jdGlvbiBjbHN4KCl7Zm9yKHZhciBlLHQsZj0wLG49XCJcIjtmPGFyZ3VtZW50cy5sZW5ndGg7KShlPWFyZ3VtZW50c1tmKytdKSYmKHQ9cihlKSkmJihuJiYobis9XCIgXCIpLG4rPXQpO3JldHVybiBufWV4cG9ydCBkZWZhdWx0IGNsc3g7Il0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/react-big-calendar/node_modules/clsx/dist/clsx.m.js\n");

/***/ })

};
;